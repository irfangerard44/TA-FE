/**
 * Ogma
 * @description Graph visualization library
 * @version 3.2.0 (built on Mon Nov 02 2020 19:31:51 GMT+0100 (Central European Standard Time))
 * @author Linkurious SAS
 * @license (c) Linkurious 2020. All rights reserved.
 * @preserve
 */
/* eslint-disable */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Ogma=e()}(this,function(){"use strict";function d(t){return"function"==typeof t||"[object Function]"===e.call(t)}function h(value){var t=function(value){var t=Number(value);return isNaN(t)?0:0!==t&&isFinite(t)?(0<t?1:-1)*Math.floor(Math.abs(t)):t}(value);return Math.min(Math.max(t,0),r)}var e,r;Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(value){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),e=t.length>>>0,r=arguments[1]>>0,i=r<0?Math.max(e+r,0):Math.min(r,e),n=arguments[2],o=void 0===n?e:n>>0,a=o<0?Math.max(e+o,0):Math.min(o,e);i<a;)t[i]=value,i++;return t}}),Array.prototype.copyWithin||(Array.prototype.copyWithin=function(t,e){if(null==this)throw new TypeError("this is null or not defined");var r=Object(this),i=r.length>>>0,n=t>>0,o=n<0?Math.max(i+n,0):Math.min(n,i),a=e>>0,s=a<0?Math.max(i+a,0):Math.min(a,i),u=arguments[2],l=void 0===u?i:u>>0,d=l<0?Math.max(i+l,0):Math.min(l,i),h=Math.min(d-s,i-o),c=1;for(s<o&&o<s+h&&(c=-1,s+=h-1,o+=h-1);0<h;)s in r?r[o]=r[s]:delete r[o],s+=c,o+=c,h--;return r}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t){if(null==this)throw new TypeError;var e=Object(this),r=e.length>>>0;if(0==r)return-1;var i=r-1;1<arguments.length&&((i=Number(arguments[1]))!=i?i=0:0!=i&&i!=1/0&&i!=-1/0&&(i=(0<i?1:-1)*Math.floor(Math.abs(i))));for(var n=0<=i?Math.min(i,r-1):r-Math.abs(i);0<=n;n--)if(n in e&&e[n]===t)return n;return-1}),Array.from||(Array.from=(e=Object.prototype.toString,r=Math.pow(2,53)-1,function(t,e,r){var i=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,o=1<arguments.length?e:void 0;if(void 0!==o){if(!d(o))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(n=r)}for(var a,s=h(i.length),u=d(this)?Object(new this(s)):new Array(s),l=0;l<s;)a=i[l],u[l]=o?void 0===n?o(a,l):o.call(n,a,l):a,l+=1;return u.length=s,u})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0==i)return!1;var n,o,a=0|e,s=Math.max(0<=a?a:i-Math.abs(a),0);for(;s<i;){if((n=r[s])===(o=t)||"number"==typeof n&&"number"==typeof o&&isNaN(n)&&isNaN(o))return!0;s++}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),r=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var i=arguments[1],n=0;n<r;){var o=e[n];if(t.call(i,o,n,e))return o;n++}},configurable:!0,writable:!0});var i=[Uint32Array,Uint16Array,Uint8Array,Int32Array,Int16Array,Int8Array,Float32Array,Float64Array],n=["join","slice","reverse","forEach","map","includes","copyWithin","reduce","indexOf","sort","filter","every","some","fill"];ArrayBuffer.isView||(ArrayBuffer.isView=function(t){for(var e=0;e<i.length;++e)if(t instanceof i[e])return!0;return!1});for(var o,a=function(r){return function(t,e){return new r(Array.prototype.slice.call(this,t,e))}},t=function(s){for(var t=0,e=n;t<e.length;t++){var r=e[t];if(!s.prototype[r]){var i="slice"===r?a(s):Array.prototype[r];s.prototype[r]=i}}s.from||(s.from=function(t,e,r){var i=s.__proto__;if("function"!=typeof this)throw new TypeError("# is not a constructor");if(this.__proto__!==i)throw new TypeError("this is not a typed array.");if("function"!=typeof(e=e||function(t){return t}))throw new TypeError("specified argument is not a function");if(!(t=Object(t)).length)return new this(0);for(var n=[],o=0;o<t.length;o++)n.push(t[o]);var a=new this((n=n.map(e,r)).length);for(o=0;o<a.length;o++)a[o]=n[o];return a})},s=0,u=i;s<u.length;s++){t(u[s])}function l(){}function c(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],m(t,this)}function f(r,i){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,c._immediateFn(function(){var t=1===r._state?i.onFulfilled:i.onRejected;if(null!==t){var e;try{e=t(r._value)}catch(t){return void p(i.promise,t)}g(i.promise,e)}else(1===r._state?g:p)(i.promise,r._value)})):r._deferreds.push(i)}function g(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof c)return e._state=3,e._value=t,void _(e);if("function"==typeof r)return void m((i=r,n=t,function(){i.apply(n,arguments)}),e)}e._state=1,e._value=t,_(e)}catch(t){p(e,t)}var i,n}function p(t,e){t._state=2,t._value=e,_(t)}function _(t){2===t._state&&0===t._deferreds.length&&c._immediateFn(function(){t._handled||c._unhandledRejectionFn(t._value)});for(var e=0,r=t._deferreds.length;e<r;e++)f(t,t._deferreds[e]);t._deferreds=null}function v(t,e,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=r}function m(t,e){var r=!1;try{t(function(value){r||(r=!0,g(e,value))},function(t){r||(r=!0,p(e,t))})}catch(t){if(r)return;r=!0,p(e,t)}}"undefined"==typeof CanvasRenderingContext2D||CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(t){}),Math.log2||(Math.log2=function(t){return Math.log(t)*Math.LOG2E}),Math.sign||(Math.sign=function(t){return(0<t?1:0)-(t<0?1:0)||+t}),Number.isNaN||(Number.isNaN=function(value){return"number"==typeof value&&isNaN(value)}),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{enumerable:!1,configurable:!1,writable:!1,value:Math.pow(2,53)-1}),o=setTimeout,c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){var r=new this.constructor(l);return f(this,new v(t,e,r)),r},c.all=function(t){var s=Array.prototype.slice.call(t);return new c(function(i,n){if(0===s.length)return i([]);var o=s.length;function a(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if("function"==typeof r)return void r.call(t,function(t){a(e,t)},n)}s[e]=t,0==--o&&i(s)}catch(t){n(t)}}for(var t=0;t<s.length;t++)a(t,s[t])})},c.resolve=function(value){return value&&"object"==typeof value&&value.constructor===c?value:new c(function(t){t(value)})},c.reject=function(value){return new c(function(t,e){e(value)})},c.race=function(n){return new c(function(t,e){for(var r=0,i=n.length;r<i;r++)n[r].then(t,e)})},c._immediateFn="object"==typeof global&&"function"==typeof global.setImmediate?function(t){global.setImmediate(t)}:function(t){o(t,0)},c._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},c._setImmediateFn=function(t){c._immediateFn=t},c._setUnhandledRejectionFn=function(t){c._unhandledRejectionFn=t},"object"!=typeof global||global.Promise||(global.exports=c),"object"!=typeof window||"Promise"in window||(window.Promise=c),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var r=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>r.length)&&(e=r.length),e-=t.length;var i=r.lastIndexOf(t,e);return-1!==i&&i===e}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t}),String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t){var e=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),i=1;i<arguments.length;i++){var n=e[i];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},writable:!0,configurable:!0});var y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function b(t,e){function r(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var I=function(){return(I=Object.assign||function(t){for(var e,r=arguments,i=1,n=arguments.length;i<n;i++)for(var o in e=r[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function x(){for(var t=arguments,e=0,r=0,i=arguments.length;r<i;r++)e+=t[r].length;var n=Array(e),o=0;for(r=0;r<i;r++)for(var a=arguments[r],s=0,u=a.length;s<u;s++,o++)n[o]=a[s];return n}var E={},A={},S={},w=function(t){return null};if("object"==typeof global&&(A=global),"object"==typeof window&&(S=window),"object"==typeof module&&"function"==typeof module.require){var T=module.require.bind(module);w=function(t){try{return T(t)}catch(t){return null}}}else"function"==typeof A.require&&(w=function(t){var e=module.require;try{return e(t)}catch(t){return null}});function C(t,e){var r=(void 0===e?{}:e).throwOnError,i=null;if(!i&&t&&(i=E[t]),!i&&t&&(i=w(t)),!i&&t&&(i=S[t]),!i&&t&&(i=A[t]),i||!r)return i;var n=['unable to find module "'+t+'"; make sure one of these statements is true:',"- Ogma.libraries['"+t+"'] is set to the right library","- require('"+t+"') returns the right library","- window['"+t+"'] is set to the right library"].join("\n");throw new Error(n)}function X(t,e){for(var r=1,i=t.length;r<i;r++){for(var n=t[r],o=r;0<o&&e.get(t[o-1])>e.get(n);)t[o]=t[o-1],--o;t[o]=n}return t}function M(value){return Array.isArray(value)||ArrayBuffer.isView(value)}function L(value){return Array.isArray(value)?value:[value]}function N(t){for(var e=[],r=0;r<t.length;++r){var i=t[r];if(Array.isArray(i))for(var n=0;n<i.length;++n)e.push(i[n]);else e.push(i)}return e}function O(t,e){var r=t.indexOf(e);return-1!==r&&(t.splice(r,1),!0)}function k(t,e){for(var r,i,n=0,o=t.length-1;n<=o;)if((i=t[r=(n+o)/2|0])<e)n=1+r;else{if(!(e<i))return r;o=r-1}return-1}function R(t){if(!t)return[];if("string"==typeof t)return t.split(".");if(Array.isArray(t)){for(var e=0;e<t.length;++e)if("string"!=typeof t[e])throw new TypeError(t[e]+" is not a string");return t.slice()}throw new TypeError('invalid property path "'+t+'": expected string or array of strings')}function F(e,r,i){var n,o,t;if(0===r)return function(){e.apply(i,arguments)};function a(){n=!1,o&&(t.apply(i,o),o=null)}return t=function(){var t;return n?o=arguments:(t=e.apply(i,arguments),setTimeout(a,r),n=!0),t}}function D(){return 120===new Uint8Array(new Uint32Array([305419896]).buffer)[0]}function P(t){return t.reduce(function(t,e){return t.then(e)},Promise.resolve())}function z(t,e,r,i,n,o,a,s){return t+n+256*(e+o)+65536*(r+a)+16777216*(i+s)}function B(t){return!(null===t||"object"!=typeof t||M(t)||t instanceof RegExp||"undefined"!=typeof HTMLElement&&t instanceof HTMLElement)}function U(t){for(var e=Object.keys(t),r=new Array(e.length),i=0;i<e.length;++i)r[i]=t[e[i]];return r}function V(t,e,r){if(Array.isArray(t))return t.forEach(e,r);if(!B(t))throw new Error("forEach: invalid argument "+JSON.stringify(t));var i=Object.keys(t);if(void 0!==r)for(var n=0;n<i.length;++n){var o=i[n];e.call(r,t[o],o)}else for(n=0;n<i.length;++n){e(t[o=i[n]],o)}}function j(t){if(Array.isArray(t)){for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=j(t[r]);return e}if(!J(t))return t;for(var i={},n=0,o=Object.keys(t);n<o.length;n++){var a=o[n];i[a]=j(t[a])}return i}function G(t,e,value){for(var r="string"==typeof e?e.split("."):e,i=0;i<r.length-1;++i){var n=r[i],o=t[n];o||(o={},t[n]=o),t=o}t[r[r.length-1]]=value}function H(t,e){var r=R(e);if(!r.length)return t;if(t){for(var i=0;i<r.length-1;++i){var n=t[r[i]];if(!n)return;t=n}return t[r[r.length-1]]}}function q(t,e,r){void 0===r&&(r="."),e=e||function(t){return!B(t)};for(var i={},n=Object.keys(t),o=0;o<n.length;++o){var a=n[o],value=t[a];if(e(value))i[a]=value;else for(var s=q(value,e),u=Object.keys(s),l=0;l<u.length;l++){var d=u[l];i[""+a+r+d]=s[d]}}return i}function W(t){for(var e={},r=Object.keys(t),i=0;i<r.length;++i){var n=r[i];G(e,n,t[n])}return e}function Y(t,e,r){void 0===r&&(r=[]);for(var i=Object.keys(t),n=0;n<i.length;++n){var o=i[n],value=t[o],a=e?e+o:o;J(value)?Y(value,a+".",r):r.push(a)}return r}function Z(t,e){if(void 0===e&&(e=[]),J(t))for(var r=0,i=Object.keys(t);r<i.length;r++){Z(t[i[r]],e)}else e.push(t);return e}function K(t){for(var e in t)"function"==typeof t[e]&&delete t[e];return t}function Q(value,t){if(void 0===value)return j(t);if(!B(value))return value;for(var e={},r=0,i=Object.keys(t);r<i.length;r++){var n=i[r],o=t[n],a=value[n];B(o)?e[n]=Q(a,o):e[n]=void 0===a?j(o):a}return e}function J(value){return value&&(value.constructor===Object||!value.constructor)}function $(t,e){if(!J(e)||!J(t))return e;for(var r=Object.assign({},t),i=0,n=Object.keys(e);i<n.length;i++){var o=n[i];r[o]=$(r[o],e[o])}return r}function tt(r,t){return null==t?r:t.reduce(function(t,e){return t[e]=r[e],t},{})}var et,rt=(et=0,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(t){var e=Date.now(),r=Math.min(16,Math.max(0,16-(e-et))),i=et=e+r;return setTimeout(function(){return t(i)},r)}),it="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:function(t){return clearTimeout(t)};function nt(e,r){return rt(function(t){e.call(r,t)})}function ot(t){t&&it(t)}var at,st,ut,lt,dt="object"==typeof global&&null!==global&&void 0!==global.it,ht="undefined"!=typeof document,ct="undefined"!=typeof window,ft=ct&&!window.__OGMA_HEADLESS,gt=ft&&ht,pt=(_t.prototype.open=function(t,e){this.method=t,this.url=e,_t.onSend&&_t.onSend(this)},_t.prototype.respond=function(t,e,r){this.readyState=4,this.status=t,this.headers=e,this.responseText=r,this.response=r,this.onreadystatechange()},_t.prototype.send=function(){this.readyState=4},_t.onCreate=function(){},_t.onSend=function(){},_t);function _t(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,_t.onCreate&&_t.onCreate(this)}var vt=(mt.prototype.readAsDataURL=function(t){this._blob=t,mt.onRead&&mt.onRead(this)},mt.prototype.load=function(t){this.result="function"==typeof t?t(this._blob):t,this.onload&&this.onload()},mt.onCreate=function(){},mt.onRead=function(){},mt);function mt(){this.onload=function(){},mt.onCreate&&mt.onCreate(this)}function yt(){return st||{createElementNS:function(){return null},createElement:function(){return null},implementation:{createDocument:function(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}function bt(t,e){if(document&&document.defaultView){var value=t.style[e];if((!value||"auto"===value)&&yt().defaultView){var r=document.defaultView.getComputedStyle(t,null);value=r?r[e]:null}return"auto"===value?null:value}return null}at=C("xmldom"),st=ht?document:at?(new at.DOMImplementation).createDocument():null,ut="undefined"!=typeof XMLHttpRequest?XMLHttpRequest:pt,lt="undefined"!=typeof FileReader?FileReader:vt;var xt=(Object.defineProperty(Et.prototype,"offsetWidth",{get:function(){return parseFloat(this.style.width||"0")},enumerable:!0,configurable:!0}),Object.defineProperty(Et.prototype,"offsetHeight",{get:function(){return parseFloat(this.style.height||"0")},enumerable:!0,configurable:!0}),Object.defineProperty(Et.prototype,"firstChild",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(Et.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(Et.prototype,"classList",{get:function(){return{length:0,value:"",add:function(){},remove:function(){},contains:function(t){return!1},item:null}},enumerable:!0,configurable:!0}),Object.defineProperty(Et.prototype,"innerHTML",{get:function(){return""},set:function(t){},enumerable:!0,configurable:!0}),Et.prototype.appendChild=function(){},Et.prototype.removeChild=function(){},Et.prototype.addEventListener=function(){},Et.prototype.removeEventListener=function(){},Et.prototype.insertBefore=function(){},Et.prototype.contains=function(t){return!1},Et);function Et(){this.onmousewheel=function(){},this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:void 0,left:void 0,position:"",backgroundColor:void 0}}function At(){return new xt}var St=ct?function(){return window.devicePixelRatio}:function(){return 1};function wt(t){var e,r,i,n=";base64,";if(-1===t.indexOf(n))return r=(e=t.split(","))[0].split(":")[1],Ct(i=decodeURIComponent(e[1]),r);r=(e=t.split(n))[0].split(":")[1];for(var o=(i=window.atob(e[1])).length,a=new Uint8Array(o),s=0;s<o;++s)a[s]=i.charCodeAt(s);return Ct([a],r)}var Tt=function(t,e){this.data=t,this.type=e};function Ct(t,e){return"undefined"!=typeof Blob?new Blob(t,{type:e}):new Tt(t,e)}function Mt(t,e,r){if(!ft)return t;var i,n,o=null,a=null,s=null;if(window.Blob?(i=t,o="blob"===(n=r)?i:"dataURL"===n?wt(i):Ct([i],"text/xml"),a=window.URL.createObjectURL(o)):s="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(t),navigator.msSaveBlob)navigator.msSaveBlob(o,e);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(o,e);else{var u=document.createElement("a");u.setAttribute("href",a||s),u.setAttribute("download",e),document.body.appendChild(u),u.click(),document.body.removeChild(u)}return a&&setTimeout(function(){window.URL.revokeObjectURL(a)},0),t}function It(t,e,r,i){if(void 0===i&&(i=St()),t.style.width=e+"px",t.style.height=r+"px","IMG"===t.tagName||"CANVAS"===t.tagName){var n=t;n.width=e*i,n.height=r*i}}function Lt(e,t){V(t,function(value,t){void 0!==value&&e.setAttribute(t,value)})}var Nt="http://www.w3.org/2000/svg",Ot="http://www.w3.org/2000/xmlns/",kt="http://www.w3.org/1999/xlink";function Rt(t,e){var r=st.createElementNS(Nt,t);return r.style||(r.style={}),e&&Lt(r,e),r}function Ft(t){if(st)return st.createTextNode(t)}function Dt(r){return"undefined"==typeof Image?Promise.resolve(null):new Promise(function(t){var e=new Image;e.src=r,e.onload=function(){return t(e)},e.onerror=function(){return t(null)}})}function Pt(t){if(0===t.indexOf("http://")||0===t.indexOf("https://"))return t;var e=window.location.origin,r=window.location.pathname,i=r.lastIndexOf("/");return-1===i?e+"/"+t:e+r.substr(0,i)+"/"+t}function zt(n){return new Promise(function(e,r){var i=new ut;i.open("GET",Pt(n),!0),i.onreadystatechange=function(){if(4===i.readyState){var t=i.status;200===t?e(i.responseText):r(0!==t?new Error('cannot retrieve file at url "'+n+'"; the server responded with status code '+t+"."):new Error('cannot send XMLHttpRequest to url "'+n+"\"; if you're using the local file protocol this is most likely the cause."))}},i.onerror=function(){r(new Error('cannot retrieve file at url "'+n+'"; the XMLHttpRequest failed.'))},i.send()})}function Bt(t){return"undefined"!=typeof HTMLElement&&t instanceof HTMLElement}function Ut(t,e){t.style.cursor=e,t.style.cursor!==e&&(t.style.cursor="-webkit-"+e)}function Vt(i){return new Promise(function(t,e){var r=new ut;r.responseType="blob",r.open("GET",Pt(i),!0),r.onreadystatechange=function(){4===r.readyState&&(200===r.status?t(r.response):e(r.status))},r.onerror=function(t){return e(t)},r.send()})}function jt(t){return Vt(t).then(function(i){return new Promise(function(t,e){var r=new lt;r.onerror=e,r.onload=function(){return t(r.result)},r.readAsDataURL(i)})})}function Gt(t,e){void 0===e&&(e=!0);var r=e?"&#13;":"\n";return(""+t).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,r).replace(/[\r\n]/g,r)}var Ht={0:"left",1:"middle",2:"right"};function qt(t){if(t.baseURI)return t.baseURI;var e=t.getElementsByTagName("base");return 0<e.length?e[0].href:t.URL||t.location.href}function Wt(o,t,a,s){return new Promise(function(e){var r=t,i=Date.now(),n=(a-t)*Math.min(1,1/(s/16));!function t(){Date.now()-i<s?(r=Math.min(1,Math.max(0,r+n)),o.style.opacity=r.toString(),nt(t)):e()}()})}var Xt="undefined"!=typeof performance&&performance.now?function(){return 0|performance.now()}:function(){return Date.now()},Yt=Xt();function Zt(){return Xt()-Yt}function Kt(){var t=new Date,e=t.getDate(),r=t.getMonth()+1;return t.getFullYear()+"-"+(r<10?"0"+r:r)+"-"+(e<10?"0"+e:e)}function Qt(){var t=new Date;return"["+Jt((t.getUTCHours()-(t.getTimezoneOffset()/60|0))%24)+":"+Jt(t.getUTCMinutes())+":"+Jt(t.getUTCSeconds())+":"+Jt(t.getUTCMilliseconds(),3)+"]"}function Jt(t,e){void 0===e&&(e=2);for(var r=Math.pow(10,e-1),i=String(t);1<r;)t<r&&(i="0"+i),r/=10;return i}var $t,te,ee=ct&&!window.PointerEvent&&!!window.MSPointerEvent,re=ct&&!(!window.PointerEvent&&!ee),ie=ee?"MSPointerDown":"pointerdown",ne=ee?"MSPointerMove":"pointermove",oe=ee?"MSPointerUp":"pointerup",ae=ee?"MSPointerCancel":"pointercancel",se={},ue=0;function le(t){return"mouse"===t.pointerType||t.MSPOINTER_TYPE_MOUSE&&t.pointerType===t.MSPOINTER_TYPE_MOUSE}function de(t){return"mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE}function he(t){se[t.pointerId]=t}function ce(t){se[t.pointerId]&&(se[t.pointerId]=t)}function fe(t){delete se[t.pointerId]}function ge(t,e){for(var r in t.touches=[],se)t.touches.push(se[r]);t.changedTouches=[t],e(t)}function pe(t,e,r){function i(t){le(t)||(de(t)&&t.preventDefault(),ge(t,r))}return t(e,ie,i,!1),i}function _e(t,e,r){function i(t){de(t)&&t.preventDefault(),ge(t,r)}return t(e,ae,i,!1),i}function ve(t,e,r){function i(t){le(t)&&0===t.buttons||ge(t,r)}return t(e,ne,i,!1),i}function me(t,e,r){function i(t){return ge(t,r)}return t(e,oe,i,!1),t(e,ae,i,!1),i}function ye(t,e,r,i){return r===$t.START?t(e,ie,i,!1):r===$t.MOVE?t(e,ne,i,!1):r===$t.END&&(t(e,oe,i,!1),t(e,ae,i,!1))}(te=$t=$t||{}).START="touchstart",te.MOVE="touchmove",te.END="touchend",te.CANCEL="touchcancel";var be,xe,Ee=(Ae.prototype.onMounted=function(t,e){},Ae.prototype.destroy=function(t){},Ae);function Ae(){}(xe=be=be||{}).MOVE="move",xe.DOWN="down",xe.UP="up",xe.CLICK="click",xe.DOUBLE_CLICK="doubleClick",xe.HOVER="hover",xe.UNHOVER="unhover",xe.WHEEL="wheel",xe.DRAG_START="dragStart",xe.DRAG_PROGRESS="dragProgress",xe.DRAG_END="dragEnd",xe.GESTURE_START="gestureStart",xe.GESTURE_PROGRESS="gestureProgress",xe.GESTURE_END="gestureEnd",xe.RESIZE="resize",xe.ADD_NODES="addNodes",xe.ADD_EDGES="addEdges",xe.REMOVE_NODES="removeNodes",xe.REMOVE_EDGES="removeEdges",xe.REQUEST_ELEMENTS_TO_DELETE="requestElementsToDelete",xe.BEFORE_REMOVE_NODES="beforeRemoveNodes",xe.BEFORE_REMOVE_EDGES="beforeRemoveEdges",xe.CLEAR_GRAPH="clear",xe.EXCLUDED_STATE_CHANGE="excludedStateChange",xe.BEFORE_UPDATE_ATTRIBUTES="beforeUpdateAttributes",xe.UPDATE_ATTRIBUTES="updateAttributes",xe.RENDERER_STATE_CHANGE="rendererStateChange",xe.UPDATE_NODE_DATA="updateNodeData",xe.UPDATE_EDGE_DATA="updateEdgeData",xe.SET_DATA="setData",xe.START_ZOOM="startZoom",xe.VIEW_CHANGED="viewChanged",xe.MOVE_END="moveEnd",xe.CAMERA_MOVE="cameraMove",xe.CAMERA_ROTATE="cameraRotate",xe.CAMERA_PAN="cameraPan",xe.CAMERA_ZOOM="cameraZoom",xe.NODES_DRAG_START="startMoveNodesByDragging",xe.NODES_DRAG_PROGRESS="progressMoveNodesByDragging",xe.NODES_DRAG_END="endMoveNodesByDragging",xe.ANIMATE="animate",xe.NEW_FRAME="newFrame",xe.BEFORE_NEW_FRAME="beforeNewFrame",xe.AFTER_NEW_FRAME="afterNewFrame",xe.SET_CONTAINER="setContainer",xe.RELOAD_FONTS="reloadFonts",xe.SET_MULTIPLE_ATTRIBUTES="setMultipleAttributes",xe.MOUSE_LEAVE="mouseLeave",xe.MOUSE_DOWN="mouseDown",xe.MOUSE_UP="mouseUp",xe.MOUSE_MOVE="mouseMove",xe.MOUSE_WHEEL="mouseWheel",xe.MOUSE_CLICK="mouseClick",xe.MOUSE_DOUBLE_CLICK="mouseDoubleClick",xe.DOCUMENT_MOUSE_MOVE="documentMouseMove",xe.DOCUMENT_MOUSE_UP="documentMouseUp",xe.DROP="drop",xe.VIRTUAL_DOWN="virtualDown",xe.VIRTUAL_UP="virtualUp",xe.VIRTUAL_MOVE="virtualMove",xe.VIRTUAL_CLICK="virtualClick",xe.VIRTUAL_DOUBLE_CLICK="virtualDoubleClick",xe.VIRTUAL_WHEEL="virtualWheel",xe.TOUCH_DOWN="touchDown",xe.TOUCH_UP="touchUp",xe.TOUCH_TAP="touchTap",xe.TOUCH_DOUBLE_TAP="touchDoubleTap",xe.TOUCH_MOVE="touchMove",xe.TOUCH_START_GESTURE="touchStartGesture",xe.TOUCH_PROGRESS_GESTURE="touchProgressGesture",xe.TOUCH_END_GESTURE="touchEndGesture",xe.DOCUMENT_TOUCH_MOVE="documentTouchMove",xe.DOCUMENT_TOUCH_UP="documentTouchUp",xe.GEO_LOADED="geoLoaded",xe.GEO_ENABLED="geoEnabled",xe.GEO_DISABLED="geoDisabled",xe.GEO_READY="geoReady",xe.TOOLTIP_HIDE="hideTooltip",xe.TOOLTIP_SHOW="showTooltip",xe.CONNECT_NODES="connectNodes",xe.LAYOUT_START="layoutStart",xe.LAYOUT_END="layoutEnd",xe.LAYOUT_COMPUTED="layoutComputed",xe.LASSO_ENABLED="lassoEnabled",xe.LASSO_DISABLED="lassoDisabled";var Se,we=["graphics","legend","brand"],Te=(b(Ce,Se=Ee),Ce.prototype.onMounted=function(t,e){e.container&&t.setContainer(e.container)},Ce.prototype.addWindowEventListener=function(t,e,r){this._isRealBrowser&&this.addElementEventListener(window,t,e,r)},Ce.prototype.addDirectWindowEventListener=function(t,e,r){this._isRealBrowser&&window.addEventListener(t,e,r)},Ce.prototype.removeDirectWindowEventListener=function(t,e){this._isRealBrowser&&window.removeEventListener(t,e)},Ce.prototype.addDocumentEventListener=function(t,e,r){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,t,e,r),e},Ce.prototype.removeDocumentEventListener=function(t,e){this._isDocumentReady&&document.documentElement.removeEventListener(t,e)},Ce.prototype.addMediaListener=function(t,e){if(this._isDocumentReady&&"function"==typeof window.matchMedia){var r=window.matchMedia(t);r.addListener(e),this._onDetachDom.push(function(){return r.removeListener(e)})}},Ce.prototype.addElementEventListener=function(t,e,r,i){return this._isDestroyed||(t.addEventListener(e,r,i),this._onDetachDom.push(function(){return t.removeEventListener(e,r,i)})),r},Ce.prototype.detachFromDom=function(){this._onDetachDom.forEach(function(t){return t()}),this._onDetachDom=[],this._emptyContainer()},Ce.prototype.setTimeout=function(t,e){var r=this;void 0===e&&(e=0);var i=setTimeout(function(){r._timeouts.splice(r._timeouts.indexOf(i),1),t()},e);return this._timeouts.push(i),i},Ce.prototype.clearTimeout=function(t){return t&&(clearTimeout(t),this._timeouts.splice(this._timeouts.indexOf(t),1)),null},Ce.prototype.clearAllTimeouts=function(){this._timeouts.forEach(clearTimeout),this._timeouts=[]},Ce.prototype.stopFrames=function(){this._isDestroyed=!0,this._nextFrame&&(ot(this._nextFrame),this._nextFrame=null)},Ce.prototype.isDestroyed=function(){return this._isDestroyed},Ce.prototype.getDimensions=function(){return{width:this._width,height:this._height}},Ce.prototype.setDimensions=function(t){this._resize(t)},Ce.prototype.setLayer=function(t,e,r){var i=(void 0===r?{}:r).automaticResize,n=void 0!==i&&i;e&&(e._ogmaLayer=t,n&&(e.style.position="absolute",e.style.top="0px",e.style.left="0px",It(e,this._width,this._height,St()))),this._layers[t]={element:e,automaticResize:n},this._updateContainerContent()},Ce.prototype.setContainer=function(t){var e,r=this;if("string"==typeof t){if(!(e=document.getElementById(t)))throw new Error('unable to find DOM element with id "'+t+'"')}else e=t;if(e!==this._container){null===e&&this._emptyContainer();var i=this._container;this._isFullScreen=!1,this._container=e,this._container&&["fullscreenchange","webkitfullscreenchange"].forEach(function(t){r.addElementEventListener(r._container,t,r._onFullscreenChange)}),this._resize(),this._updateContainerContent(),this._events.fire(be.SET_CONTAINER,{element:e,prevElement:i})}},Ce.prototype.getContainer=function(){return this._container},Ce.prototype.appendElement=function(t){null!==this._container&&this._container.appendChild(t)},Ce.prototype.focus=function(){this._focus=!0},Ce.prototype.blur=function(){this._focus=!1},Ce.prototype.hasFocus=function(){return this._focus},Ce.prototype.forceResize=function(){this._resize()},Ce.prototype._beforeOrAfterNextFrame=function(t){var e=t?this._afterNextFramePromises:this._beforeNextFramePromises,r=new Promise(function(t){e.push(function(){return t(),r})});return this._refresh(),r},Ce.prototype.beforeNextFrame=function(){return this._beforeOrAfterNextFrame(!1)},Ce.prototype.afterNextFrame=function(){return this._beforeOrAfterNextFrame(!0)},Ce.prototype.refresh=function(t){t&&(this._refreshUntil=Math.max(this._refreshUntil,t)),this._refresh()},Ce.prototype._emptyContainer=function(){if(this._container){for(var t=[],e=0;e<this._container.childNodes.length;++e){var r=this._container.childNodes[e];r._ogmaLayer&&t.push(r)}for(e=0;e<t.length;++e)this._container.removeChild(t[e])}},Ce.prototype._fillContainer=function(){var r=this;if(this._container){var t=bt(this._container,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(this._container.style.position="relative");var i=this._container.firstChild;we.forEach(function(t){var e=r._layers[t];e&&e.element&&r._container&&r._container.insertBefore(e.element,i)})}},Ce.prototype._updateContainerContent=function(){this._emptyContainer(),this._fillContainer()},Ce.prototype._resize=function(t){if(this._container||t){var r,i,e=this._width,n=this._height;if(this._container){var o=this._settings.get("minimumWidth"),a=this._settings.get("minimumHeight"),s=this._container.clientWidth||1,u=this._container.clientHeight||1;r=Math.max(o,t?t.width:s),i=Math.max(a,t?t.height:u)}else null!=t&&(r=t.width,i=t.height);r===e&&i===n||(this._width=r,this._height=i,V(this._layers,function(t){var e=t.element;t.automaticResize&&It(e,r,i)}),this._events.fire(be.RESIZE,{prevWidth:e,prevHeight:n,width:r,height:i,difWidth:r-e,difHeight:i-n}))}},Ce.prototype._refresh=function(){var t=this;this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=nt(function(){return t._playFrame()}))},Ce.prototype._playFrame=function(){var r=this,t=Zt(),e=t-this._currentTime,i=N([this._beforeNextFramePromises,function(){return r._events.fire(be.BEFORE_NEW_FRAME,{elapsed:e})},function(){return r._events.fire(be.NEW_FRAME,{elapsed:e})},function(){return r._events.fire(be.AFTER_NEW_FRAME,{elapsed:e})},this._afterNextFramePromises,function(){r._inFrame=!1,(r._mustRefresh||t<r._refreshUntil+17)&&(r._mustRefresh=!1,r._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=t,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],i.reduce(function(t,e){return t.then(function(){if(!r._isDestroyed)return e()})},Promise.resolve())},Ce.prototype.isPlayingFrame=function(){return this._inFrame||!!this._nextFrame},Ce.prototype.setFullScreen=function(value){var e=this,t=Promise.resolve();return value!==this._isFullScreen?(this._container&&(t=value?function(t){return Me()?Promise.resolve():t.requestFullscreen?t.requestFullscreen():t.requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?Promise.resolve(t.webkitRequestFullScreen()):t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():Promise.resolve()}(this._container):Me()&&"undefined"!=typeof document?document.exitFullscreen?document.exitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?Promise.resolve(document.webkitCancelFullScreen()):document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():Promise.resolve():Promise.resolve()),t.then(function(){return new Promise(function(t){e.setTimeout(function(){e._isFullScreen=Me(),t(void 0)},200)})})):t},Ce.prototype.isFullScreen=function(){return Me()},Ce.prototype.debounceBeforeFrame=function(e){function r(){var t=o;n=!1,o=[],e(),t.forEach(function(t){return t()})}var i=this,n=!1,o=[];return function(){return new Promise(function(t){o.push(t),n||(n=!0,i.beforeNextFrame().then(r))})}},Ce.prototype.destroy=function(){!function(){if(ue--,ht&&0===ue){var t=document.documentElement;t.removeEventListener(ie,he,!0),t.removeEventListener(ne,ce,!0),t.removeEventListener(oe,fe,!0),t.removeEventListener(ae,fe,!0)}}(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()},Ce);function Ce(t,e){var r=t.events,i=t.settings,n=void 0===e?{}:e,o=n.width,a=void 0===o?300:o,s=n.height,u=void 0===s?300:s,l=Se.call(this)||this;return l._layers={},l._focus=!1,l._container=null,l._isFullScreen=!1,l._beforeNextFramePromises=[],l._afterNextFramePromises=[],l._refreshUntil=0,l._currentTime=Zt(),l._timeouts=[],l._isDestroyed=!1,l._onDetachDom=[],l._isRealBrowser=ft,l._isDocumentReady=gt,l._inFrame=!1,l._mustRefresh=!1,l._nextFrame=null,l._onWindowResize=function(){return l._resize()},l._onWindowFocus=function(){return l.refresh()},l._onFullscreenChange=function(){l._isFullScreen=Me()},l._events=r,l._settings=i,l._width=a,l._height=u,l._settings.register("minimumWidth",300,function(){return l._resize()},!1),l._settings.register("minimumHeight",300,function(){return l._resize()},!1),l._events.register([be.BEFORE_NEW_FRAME,be.NEW_FRAME,be.AFTER_NEW_FRAME,be.SET_CONTAINER,be.RESIZE]),l._onDetachDom=[],function(){if(ht&&0===ue&&re){var t=document.documentElement;t.addEventListener(ie,he,!0),t.addEventListener(ne,ce,!0),t.addEventListener(oe,fe,!0),t.addEventListener(ae,fe,!0)}ue++}(),l.addWindowEventListener("resize",l._onWindowResize),l.addWindowEventListener("focus",l._onWindowFocus),l}function Me(){return"undefined"!=typeof document&&!!(document.fullscreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}var Ie,Le=(b(Ne,Ie=Ee),Ne.prototype.setProperty=function(t,e,value,r){var i=(void 0===r?{}:r).dispatch,n=void 0!==i&&i;this._setDataProperty(t.isNode,t._indexes,e,value,n),this._events.fire(be.SET_DATA,{elements:t})},Ne.prototype.getProperty=function(t,e){return this._getDataProperty(t.isNode,t._indexes,e)},Ne.prototype._setDataProperty=function(t,e,r,value,i){i&&"function"==typeof value&&(i=!1);for(var n=Oe(r),o="function"==typeof value,a=t?this._nodeList:this._edgeList,s=t?this._nodeDataList:this._edgeDataList,u=function(t,e){for(var r=0;r<t.length;++r){var i=t[r],n=i.property;if(null===e&&null===n)return i;if(e&&n&&n.length===e.length){for(var o=!0,a=0;a<n.length;++a)if(n[a]!==e[a]){o=!1;break}if(o)return i}}var s={property:e&&e.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,edges:null};return t.push(s),s}(t?this._nodeChanges:this._edgeChanges,n),l=0;l<e.length;++l){var d=e[l],h=s.get(d),c=a.get(d),f=i?value[l]:value,g=void 0,p=void 0;if(null===n)g=h,p=o?f(c):f,s.set(d,p);else{null==h&&(h={},s.set(d,h));for(var _=n.length,v=0;v<_;v++){var m=n[v],y=h[m];v<_-1?(null==y&&(y={},h[m]=y),h=y):(g=y,p=o?f(c):f,h[m]=p)}}u.indexes.push(d),u.previousValues.push(g),u.newValues.push(p)}this._scheduleEvents()},Ne.prototype._getDataProperty=function(t,e,r,i){var n=Oe(r);i=i||new Array(e.length);for(var o=t?this._nodeDataList:this._edgeDataList,a=0;a<e.length;++a){var s=e[a],u=o.get(s),value=void 0;if(null!==n&&n.length)if(null==u)value=void 0;else for(var l=n.length,d=0;d<l&&u;++d)value=u=u[n[d]];else value=u;i[a]=value}return i},Ne.prototype._scheduleEvents=function(){this._shouldTriggerEvents=!0,this._dom.refresh()},Ne.prototype._triggerEvents=function(){var t=this._prepareEvtPayload(!0),e=this._prepareEvtPayload(!1);this._events.fire(be.UPDATE_NODE_DATA,t),this._events.fire(be.UPDATE_EDGE_DATA,e)},Ne.prototype._prepareEvtPayload=function(t){var e=t?this._graph.nodeList:this._graph.edgeList,r=t?"_nodeChanges":"_edgeChanges",i=[],n=this[r];this[r]=[];for(var o=[],a=0;a<n.length;++a){var s=n[a],u=s.indexes,l=s.property,d=s.newValues,h=s.previousValues;i=i.concat(u||[]),t?o.push({property:l,newValues:d,previousValues:h,nodes:e(u)}):o.push({property:l,newValues:d,previousValues:h,edges:e(u)})}return t?{nodes:e(i).dedupe(),isNode:t,changes:o}:{edges:e(i).dedupe(),isNode:t,changes:o}},Ne);function Ne(t){var e,r=t.dom,i=t.graph,n=t.events,d=Ie.call(this)||this;return d._nodeChanges=[],d._edgeChanges=[],d._shouldTriggerEvents=!1,d._dom=r,d._graph=i,d._events=n,d._nodeDataList=d._graph.createAttribute(!0,{name:"data",storage:"any"}),d._edgeDataList=d._graph.createAttribute(!1,{name:"data",storage:"any"}),d._nodeList=d._graph.getNodeAttribute("object"),d._edgeList=d._graph.getEdgeAttribute("object"),d._events.register([be.SET_DATA,be.UPDATE_NODE_DATA,be.UPDATE_EDGE_DATA]),d._events.on(((e={})[be.ADD_NODES+" "+be.ADD_EDGES]=function(t){for(var e=t.nodes,r=t.edges,i=t.objects,n=e||r,o=n.isNode,a=n.size,s=n._indexes,u=d[o?"_nodeDataList":"_edgeDataList"],l=0;l<a;++l)u.set(s[l],i[l].data)},e[be.BEFORE_NEW_FRAME]=function(){d._shouldTriggerEvents&&(d._shouldTriggerEvents=!1,d._triggerEvents())},e)),d}function Oe(t){return"string"==typeof t?t.split("."):M(t)?t:null}var ke={1:Pe(1),2:Pe(2),4:Pe(4),8:Fe(),16:Fe(),32:Fe(),int8:Fe(),int16:Fe(),int32:Fe(),float:Fe(),any:Fe()},Re={1:ze(1),2:ze(2),4:ze(4),8:De(),16:De(),32:De(),int8:De(),int16:De(),int32:De(),float:De(),any:De()};function Fe(){return new Function("array","index","return array[index];")}function De(){return new Function("array","index","value","array[index] = value;")}function Pe(t){var e=8/t;return new Function("array","index","return (array[index / "+e+" | 0] >> ((index % "+e+") * "+t+")) & "+((1<<t)-1)+";")}function ze(t){return new Function("array","index","value","\n    var offset = (index % "+8/t+") * "+t+";\n    var finalIndex = index / "+8/t+" | 0;\n    var orMask = value << offset;\n    var andMask = 255 - (("+(Math.pow(2,t)-1)+" - value) << offset);\n\n    array[finalIndex] = (array[finalIndex] & andMask) | orMask;")}var Be={get:function(t){return this._getArrayElt(this._buffer,t)},set:function(t,value){this._setArrayElt(this._buffer,t,value)}},Ue={get:function(t){return this._byIndex[this._getArrayElt(this._buffer,t)]},set:function(t,value){var e=this._byName[value];void 0===e&&(e=this._nextIndex++,this._byIndex.push(value),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[value]=e);this._setArrayElt(this._buffer,t,e)}},Ve=(je.prototype.getValues=function(){return Object.keys(this._byName||{})},je.prototype.getName=function(){return this._name},je.prototype.get=function(t){return this._get(t)},je.prototype.set=function(t,value){this._set(t,value)},je.prototype._get=function(t){return this._defaultValue},je.prototype._set=function(t,value){value!==this._defaultValue&&(this._initialize(),this._set(t,value))},je.prototype.setFallback=function(t){this._fallback=t,this.get=this._getWithFallback},je.prototype._getWithFallback=function(t){var value=this._get(t);return void 0===value&&this._fallback?this._fallback.get(t):value},je.prototype._initialize=function(){this._initialized=!0,this._buffer=He(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)},je.prototype.increaseNbElements=function(t){var e=Ge(t+1);if(!(e<=this._nbElements)){if(this._initialized)if("any"===this._elementSize)for(var r=this._nbElements;r<e;++r)this._buffer.push(this._defaultValue);else{var i=He(e,this._elementSize);i.set(this._buffer),this._buffer=i,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=e}},je.prototype.increaseElementSize=function(){var t=this._elementSize;if("number"!=typeof t||32===t)throw new Error("FlexArray: cannot increase element size");var e=2*t,r=ke[e],i=Re[e];if(this._initialized){var n=this._nbElements,o=this._getArrayElt,a=this._buffer,s=He(n,e);if(8<=t)s.set(a);else for(var u=0;u<n;++u)i(s,u,o(a,u));this._buffer=s}this._elementSize=e,this._getArrayElt=r,this._setArrayElt=i},je.prototype.buffer=function(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer},je.prototype.elementBitSize=function(){return this._elementSize},je.prototype.capacity=function(){return this._nbElements},je.prototype.byteSize=function(){return this._nbElements*this._elementSize/8},je.prototype.isInitialized=function(){return this._initialized||this._fallback&&this._fallback.isInitialized()},je.prototype.getMultiple=function(t,e){var r=t.length;void 0===e&&(e=new Array(r));for(var i=0,n=r;i<n;++i)e[i]=this.get(t[i]);return e},je.prototype.fill=function(t,value){for(var e=0,r=t.length;e<r;++e)this.set(t[e],value)},je.prototype.setMultiple=function(t,e,r){if(r||!Array.isArray(e)&&!ArrayBuffer.isView(e))for(i=0,n=t.length;i<n;++i)this.set(t[i],e);else for(var i=0,n=t.length;i<n;++i)this.set(t[i],e[i])},je.prototype.reset=function(){return this._initialized&&this._reset(0),this},je.prototype._reset=function(t){var value="resource"===this._storage?0:this._defaultValue;if(this._buffer)if("number"!=typeof this._elementSize||8<=this._elementSize)this._buffer.fill(value,t);else{for(var e=8/this._elementSize,r=0,i=0;i<e;++i)r<<=this._elementSize,r+=value;if(void 0===t)this._buffer.fill(r);else{var n=t+(8-t%8);for(i=t;i<n;++i)this._setArrayElt(this._buffer,i,value);this._buffer.fill(r,n/8)}}},je.prototype._getElementBitSize=function(){if(this._nextIndex)return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))},je);function je(t){this._initialized=!1;var e,r,i=t.name,n=t.storage,o=t.size||0,a=(e=t.default,r=n,void 0===e&&"any"!==r&&"resource"!==r?0:e),s=Math.max(8,Ge(o+1)),u="resource"===n?1:n;this._name=i,this._storage=n,this._getArrayElt=ke[u],this._setArrayElt=Re[u],this._elementSize=u,this._nbElements=s,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=a,this._BASE_VALUE="any"===n?void 0:0,this._methods=Be,this._initialized=!1,this._buffer=null,"resource"===n&&(this._methods=Ue,this._byName={},this._byIndex=[],this._nextIndex=1,this._byName[a]=0,this._byIndex.push(a))}function Ge(t){for(var e=2;e<t;)e*=2;return e}function He(t,e){return"any"===e?new Array(t):"float"===e?new Float32Array(t):"int8"===e?new Int8Array(t):"int16"===e?new Int16Array(t):"int32"===e?new Int32Array(t):32===e?new Uint32Array(t):16===e?new Uint16Array(t):new Uint8Array(Math.ceil(t/8*e))}function qe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function We(t){for(var e=0,r=0;r<t.length;++r)e+=t[r];return e}function Xe(value,t,e){return Math.max(t,Math.min(e,value))}function Ye(t,e,r){return t+(e-t)*r}function Ze(t,e,r){return t*(1-r)+e*r}function Ke(t){if(!t.length)return-1/0;for(var e=t[0],r=1,i=t.length;r<i;++r){var n=t[r];e<n&&(e=n)}return e}function Qe(t){if(!t.length)return 1/0;for(var e=t[0],r=1,i=t.length;r<i;++r){var n=t[r];n<e&&(e=n)}return e}function Je(t,e){return Math.log(t)/Math.log(e)}var $e=(tr.prototype.isBusy=function(){return this._busy},tr.prototype.markBusy=function(){return this._busy=!0,this},tr.prototype.sliceAndReset=function(){this._busy=!1;var t=this.slice(0,this._size);return this.reset(),t},tr.prototype.reset=function(){return this._size=0,this},tr.prototype.reserve=function(value){return value>this._capacity&&this._setCapacity(qe(value)),this},tr.prototype._setCapacity=function(t){var e=new Uint32Array(t);e.set(this._buffer),this._buffer=e,this._capacity=t},tr.prototype.push=function(value){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=value,this},tr.prototype.pushUnchecked=function(value){return this._buffer[this._size++]=value,this},tr.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this._size),this._buffer.slice(t,e)},tr.prototype.getBuffer=function(){return this._buffer},tr.prototype.getLength=function(){return this._size},tr.prototype.getCapacity=function(){return this._capacity},tr.prototype.setLength=function(value){return this._size=value,this},tr.prototype.isEmpty=function(){return 0===this._size},tr);function tr(){this._buffer=new Uint32Array(4),this._capacity=4,this._size=0,this._busy=!1}var er=(rr.prototype.addElements=function(t){for(var e=[],r=0,i=t.length;r<i;++r){var n=t[r],o=this._idToIndex[n];void 0===o&&(o=this._getNextIndex(),this._idToIndex[n]=o,this._indexToId[o]=n),e.push(o)}for(var a=0,s=this._flexArrays;a<s.length;a++)s[a].increaseNbElements(this._nextIndex);for(var u=0,l=this._indexLists;u<l.length;u++)l[u].reserve(this._nextIndex);return new Uint32Array(e)},rr.prototype.removeElements=function(t){for(var e=0,r=t.length;e<r;++e){var i=t[e],n=this._indexToId[i];void 0!==n&&(delete this._idToIndex[n],this._removeIndex(i))}},rr.prototype.clear=function(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(var t=0,e=this._flexArrays;t<e.length;t++)e[t].reset();for(var r=0,i=this._indexLists;r<i.length;r++)i[r].reset()},rr.prototype.has=function(t){return void 0!==this._indexToId[t]},rr.prototype.getIndex=function(t,e){void 0===e&&(e=!1);var r=this._idToIndex[t];if(void 0===r&&e)throw new Error(this._name+' id "'+t+'" not found');return r},rr.prototype.createFlexArray=function(t){var e=t.name;if(e&&this._flexArraysByName[e])throw new Error(this._name+' flexArray "'+e+'" already exists');var r=t.default;void 0===r&&"any"!==t.storage&&"resource"!==t.storage&&(r=0);var i,n=this._nextIndex,o={storage:t.storage,size:n,name:e,default:r};return void 0===r&&"any"!==t.storage&&t.storage,i=new Ve(o),this._flexArrays.push(i),this._defaultValues.push(t.default),e&&(this._flexArraysByName[e]=i),i},rr.prototype.getFlexArray=function(t){return this._flexArraysByName[t]},rr.prototype.getAllFlexArrays=function(){return this._flexArraysByName},rr.prototype.createIndexList=function(){var t=new $e;return t.reserve(this._nextIndex),this._indexLists.push(t),t},rr.prototype.getId=function(t){return this._indexToId[t]},rr.prototype.getMaxIndex=function(){return this._nextIndex-1},rr.prototype._removeIndex=function(t){this._indexesToBeFreed.push(t)},rr.prototype._getNextIndex=function(){var t=this._freeIndexes.pop();return void 0===t&&(t=this._nextIndex++),t},rr.prototype.freeIndexes=function(){for(var t=0,e=this._indexesToBeFreed;t<e.length;t++){var r=e[t];this._indexToId[r]=void 0,this._freeIndexes.push(r)}for(var i=0;i<this._flexArrays.length;++i)for(var n=this._flexArrays[i],o=this._defaultValues[i],a=0,s=this._indexesToBeFreed;a<s.length;a++)r=s[a],n.set(r,o);this._indexesToBeFreed=[]},rr);function rr(t){var i=this;this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=t?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new Ve({storage:"int32"}),this._idFlexArray.get=function(t){return i._indexToId[t]},this._idFlexArray.getMultiple=function(t){for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=i._indexToId[t[r]];return e},this._flexArraysByName.id=this._idFlexArray}var ir=(nr.prototype.addEntry=function(t){return void 0===t&&(t=this._nextIndex++),t>=this._capacity&&this._reserve(t+1),this._sizes[t]=0,t},nr.prototype.get=function(t){var e=this._sizes[t],r=this._MAX_LIST_SIZE*t;if(e<=this._MAX_LIST_SIZE){for(var i=0,n=this._constList.length=e;i<n;++i)this._constList[i]=this._buffer[r+i];return this._constList}if(e!==this._BIG_LIST)throw new Error("Table: "+t+" out of bounds ("+e+")");var o=this._buffer[r];return this._bigLists[o]},nr.prototype.size=function(t){var e=this._sizes[t];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length},nr.prototype.sizes=function(t){for(var e=this._sizes,r=this._bigLists,i=this._buffer,n=this._MAX_LIST_SIZE,o=t.length,a=new Array(o),s=0;s<o;s++){var u=t[s],l=e[u];a[s]=l<=n?l:r[i[u*n]].length}return a},nr.prototype.addTo=function(t,value){var e=this._sizes[t],r=t*this._MAX_LIST_SIZE;if(e<this._MAX_LIST_SIZE)this._buffer[r+e]=value,this._sizes[t]=e+1;else if(e===this._BIG_LIST){var i=this._buffer[r];this._bigLists[i].push(value)}else{for(var n=new Array(this._MAX_LIST_SIZE),o=0;o<this._MAX_LIST_SIZE;++o)n[o]=this._buffer[r+o];n.push(value),this._bigLists.push(n),this._sizes[t]=this._BIG_LIST,this._buffer[r]=this._bigLists.length-1}return this},nr.prototype.removeFrom=function(t,value){return this.removeFromAndGetSize(t,value),this},nr.prototype.removeFromAndGetSize=function(t,value){var e=this._MAX_LIST_SIZE*t,r=this._sizes[t];if(r<=this._MAX_LIST_SIZE){for(var i=e,n=e+r;i<n;++i)if(this._buffer[i]===value)return--r,this._buffer[i]=this._buffer[n-1],this._sizes[t]=r}else if(r===this._BIG_LIST){var o=this._buffer[e],a=this._bigLists[o];if(-1!==(i=a.indexOf(value)))return a.splice(i,1),a.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')},nr.prototype.reserve=function(t){return this._capacity<t&&this._reserve(t),this},nr.prototype._reserve=function(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t))),this._buffer=or(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=or(this._sizes,this._capacity)},nr);function nr(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=8,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}function or(t,e){var r=new t.constructor(e);return r.set(t),r}var ar="_visible",sr="_data",ur="_hovered",lr="_hoverExtremityHighlighted",dr="_selected",hr="_selectionExtremityHighlighted",cr="_dragged",fr="_rewirable",gr="_export",pr="_faded",_r="_transparent",vr=-1,mr="out",yr="both",br=[dr,cr,hr,ur,lr,fr,gr,pr,_r,"_visual_groups"],xr=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"],Er=void 0,Ar=(Sr.prototype.getAdjacentDirections=function(t){return this._neighborTable.get(t)},Sr.prototype.getEdgeIndexesInDirection=function(t){return this._parallelTable.get(t)},Sr.prototype.allocateNodes=function(t){this._neighborTable.reserve(t.length);for(var e=0;e<t.length;++e)this._neighborTable.addEntry(t[e])},Sr.prototype.allocateEdges=function(t,e,r){this._parallelTable.reserve(Math.floor(t.length/2));for(var i=0;i<t.length;i++){var n=t[i],o=e[i],a=r[i];this._sourceList.set(n,o),this._targetList.set(n,a),this.addToAdjacencyList(n)}},Sr.prototype.getExtremity=function(t,e){var r=t?this._sourceList:this._targetList;if(e.isList){for(var i=this._graph.acquireIndexList(!0),n=0;n<e._indexes.length;n++)i.push(r.get(e._indexes[n]));return this._graph.nodeList(i.sliceAndReset())}return this._graph.getObjectList(!0).get(r.get(e._index))},Sr.prototype.setExtremities=function(t,e,r){for(var i=0;i<t.length;++i)this.removeFromAdjacencyList(t[i]);for(null!==e&&this._sourceList.setMultiple(t,e),null!==r&&this._targetList.setMultiple(t,r),i=0;i<t.length;++i)this.addToAdjacencyList(t[i])},Sr.prototype.addToAdjacencyList=function(t){var e=this._sourceList.get(t),r=this._targetList.get(t),i=wr(e,r),n=this._parallelEdgesIndex[i];n===Er&&(n=this._parallelTable.addEntry(),this._parallelEdgesIndex[i]=n,this._neighborTable.addTo(e,n),e!==r&&this._neighborTable.addTo(r,n)),this._parallelTable.addTo(n,t)},Sr.prototype.removeFromAdjacencyList=function(t){var e=this._sourceList.get(t),r=this._targetList.get(t),i=wr(e,r),n=this._parallelEdgesIndex[i];n!==Er&&0===this._parallelTable.removeFromAndGetSize(n,t)&&(this._neighborTable.removeFrom(e,n),e!==r&&this._neighborTable.removeFrom(r,n),this._parallelEdgesIndex[i]=Er)},Sr.prototype.getParallelEdges=function(t,e){void 0===e&&(e={});for(var r=e.filter||"visible",i=this._graph.acquireIndexList(!1),n=this._graph.getFilter(!1,r),o=0;o<t._indexes.length;o++){var a=t._indexes[o],s=wr(this._sourceList.get(a),this._targetList.get(a)),u=this._parallelEdgesIndex[s];if(u!==Er){var l=this._parallelTable.get(+u);if(l)for(var d=0,h=l;d<h.length;d++){var c=h[d];n(c)&&i.push(c)}}}return this._graph.edgeList(i.sliceAndReset())},Sr.prototype.fastGetNodesAdjacentElements=function(t){for(var e=this._graph.acquireIndexList(!0),r=this._graph.acquireIndexList(!1),i=this._sourceList,n=this._targetList,o=0;o<t.length;o++)for(var a=t[o],s=0,u=this._neighborTable.get(a);s<u.length;s++){var l=u[s],d=this._parallelTable.get(l),h=d[0],c=i.get(h),f=n.get(h);if(0!==c&&0!==f){e.push(c+f-a);for(var g=0,p=d;g<p.length;g++){var _=p[g];r.push(_)}}}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(r.sliceAndReset())}},Sr.prototype.fastGetEdgesAdjacentElements=function(t){for(var e=this._graph.acquireIndexList(!0),r=this._graph.acquireIndexList(!1),i=this._sourceList,n=this._targetList,o=0;o<t.length;o++){var a=t[o],s=i.get(a),u=n.get(a),l=wr(s,u),d=this._parallelEdgesIndex[l];if(d!==Er){var h=this._parallelTable.get(+d);if(h)for(var c=0,f=h;c<f.length;c++){var g=f[c];r.push(g)}}e.push(s),e.push(u)}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(r.sliceAndReset())}},Sr.prototype.getDeduper=function(t){return(t?this.nodeDeduper:this.edgeDeduper).reset()},Sr.prototype.collectAdjacentEdges=function(t,e,r,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var o="in"===e,a=!(e===mr||o||n),s=this._graph.acquireIndexList(!1),u=this._graph.getFilter(!1,r),l=i?this.getDeduper(!1):this._fakeDeduper,d=this._fakeInvertedDeduper,h=this._sourceList,c=this._targetList;if(n){d=this.getDeduper(!0);for(var f=0;f<t.length;f++)d.set(t[f],1)}for(f=0;f<t.length;f++)for(var g=t[f],p=0,_=this._neighborTable.get(g);p<_.length;p++){var v=_[p],m=this._parallelTable.get(v);if(a)for(var y=0,b=m;y<b.length;y++)u(A=b[y])&&0===l.get(A)&&(s.push(A),l.set(A,1));else for(var x=0,E=m;x<E.length;x++){var A=E[x],S=h.get(A),w=c.get(A),T=S+w-g;o!=(w===g)&&S!==w||!u(A)||0!==l.get(A)||1!==d.get(T)||(s.push(A),l.set(A,1))}}return s.sliceAndReset()},Sr.prototype.collectAdjacentNodes=function(t,e,r,i,n,o){void 0===i&&(i=!1);var a="in"!==e,s=e!==mr,u=this._graph.acquireIndexList(!0),l=this._graph.getFilter(!1,r),d=i?this.getDeduper(!0):this._fakeDeduper,h=this._sourceList,c=this._targetList;if(n)for(var f=0;f<n.length;f++){var g=n[f];u.push(g),d.set(g,1)}if(o)for(f=0;f<o.length;f++)g=o[f],d.set(g,1);for(f=0;f<t.length;f++)for(var p=t[f],_=0,v=this._neighborTable.get(p);_<v.length;_++)for(var m=v[_],y=0,b=this._parallelTable.get(m);y<b.length;y++){var x=b[y];if(l(x)){var E=h.get(x),A=c.get(x);if(g=E+A-p,(s&&p===A||a&&p===E)&&0===d.get(g)){u.push(g),d.set(g,1);break}}}return u.sliceAndReset()},Sr.prototype.getAdjacentElements=function(t,e,r){void 0===r&&(r={});var i=r.direction||yr,n=r.filter||"visible",o=r.policy||"union",a=!!r.bothExtremities;if(t){var s="include-sources"===o?e:null,u="exclude-sources"===o?e:null;return this.collectAdjacentNodes(e,i,n,!0,s,u)}return this.collectAdjacentEdges(e,i,n,!0,a)},Sr.prototype.getEdgesBetweenTwoNodes=function(t,e){var r=wr(t,e),i=this._parallelEdgesIndex[r];if(i===Er)return new Uint32Array;var n=this._parallelTable.get(+i);return new Uint32Array(n)},Sr.prototype.getConnectedComponents=function(t,e){var r,i=void 0===e?{}:e,n=i.filter,o=void 0===n?"visible":n,a=i.returnIds,s=void 0!==a&&a,u=i.internalIndexes,l=void 0!==u&&u,d=this._graph,h=[],c={},f=d.acquireIndexList(!0);"string"==typeof o?r=d.getFilter(!0,o):(r=o,o="visible");for(var g=0;g<t.length;g++)r(v=t[g])&&f.push(v);var p=f.sliceAndReset(),_={filter:o};for(g=0;g<p.length;g++){var v;if(!c[v=p[g]]){for(var m=[v],y=[];0!==m.length;){var b=m.pop();!c[b]&&r(b)&&(m.push.apply(m,this.getAdjacentElements(!0,new Uint32Array([b]),_)),c[b]=!0,y.push(b))}0<y.length&&h.push(y)}}if(s){var x=d.getNodeAttribute("id");for(g=0;g<h.length;g++)h[g]=x.getMultiple(h[g])}else if(!l)for(g=0;g<h.length;g++)h[g]=d.nodeList(new Uint32Array(h[g]));return h},Sr.prototype.getAdjacencyList=function(t){for(var e=t.directed,r=t.ids,i=t.weight,n=t.nodes,o=e?mr:yr,a=new Array(n.length),s=this._graph,u=0;u<n.length;++u)a[u]=this.collectAdjacentEdges(new Uint32Array([n[u]]),o,"all");var l=s.getEdgeAttribute("source"),d=s.getEdgeAttribute("target"),h=s.getEdgeAttribute("width"),c=s.getNodeAttribute("id"),f=[],g="number"==typeof i,p=!("function"==typeof i||g||!i);for(u=0;u<a.length;u++){for(var _=a[u],v=n[u],m=_.length,y=new(r?Array:Uint32Array)(m),b=new Array(m),x=0;x<m;x++){var E=_[x],A=l.get(E),S=d.get(E),w=e||v===A?S:A;if(r&&(w=c.get(w)),y[x]=w,i){if(g&&(b[x]=i),"function"==typeof i){var T=s.getNode(A),C=s.getNode(S);b[x]=i(T,C)}p&&(b[x]=h.get(E)||1)}}var M=I({nodes:y,id:r?c.get(v):v},i&&{weights:b});f.push(M)}return f},Sr.prototype.degrees=function(t,e){if("in"!==e&&e!==mr)return this._neighborTable.sizes(t);for(var r=new Array(t.length),i="in"===e,n=0,o=t.length;n<o;n++)r[n]=this._degree(t[n],i);return r},Sr.prototype._degree=function(t,e){for(var r=this._neighborTable.get(t),i=this._sourceList,n=this._targetList,o=0,a=0;a<r.length;++a)for(var s=this._parallelTable.get(r[a]),u=0;u<s.length;++u){var l=s[u],d=i.get(l),h=n.get(l);if(e&&h===t||!e&&d===t){o+=1;break}}return o},Sr.prototype.getDegree=function(t,e){for(var r=this._getDegreeOptions(e),i=r.direction,n=r.filter,o=new Array(t.length),a=new Uint32Array(1),s=0;s<t.length;++s)a[0]=t[s],o[s]=this.collectAdjacentNodes(a,i,n).length;return o},Sr.prototype._getDegreeOptions=function(t){var e={direction:yr,filter:"visible"};return"string"==typeof t?e.direction=t:t&&("string"==typeof t.direction&&(e.direction=t.direction),"string"==typeof t.filter&&(e.filter=t.filter)),e},Sr);function Sr(t){this._neighborTable=new ir,this._parallelTable=new ir,this._parallelEdgesIndex=[],this._fakeDeduper={get:function(){return 0},set:function(){},reset:function(){return this}},this._fakeInvertedDeduper={get:function(){return 1},set:function(){},reset:function(){return this}},this._graph=t,this.nodeDeduper=t.createNodeAttribute({storage:1}),this.edgeDeduper=t.createEdgeAttribute({storage:1}),this._sourceList=t.getEdgeAttribute("source"),this._targetList=t.getEdgeAttribute("target")}function wr(t,e){var r=t<e?t:e;return 67108864*r+(t+e-r)}function Tr(t){dt||console.warn(Qt()+" "+t)}var Cr=[];function Mr(t){"object"==typeof t&&null!==t||(t={});var e="function"==typeof t.data?t.data:function(t){return t};return{attributes:Array.isArray(t.attributes)?t.attributes:t.attributes||Cr,data:e}}function Ir(t){1<t&&Tr("getData: more than one argument were specified, you probably want to use a single array argument instead of multiple arguments")}function Lr(t,r){for(var e=function(t){var e=r;Object.keys(e).forEach(function(r){var i=e[r];t.prototype[r]=function(t,e){return Tr('Deprecated method "'+r+'"; please use "'+i+'" instead.'),this[i](t,e)}})},i=0,n=t;i<n.length;i++){e(n[i])}}function Nr(t){var e=t.getFlexArray("removed"),r=t.getFlexArray("excluded"),i=t.getFlexArray("virtual");return{all:function(t){return 0===e.get(t)},visible:function(t){return 0===r.get(t)},raw:function(t){return 0===i.get(t)&&0===e.get(t)},_all:function(t){return!0}}}function Or(t,e,r){return{all:kr(r.all,t,e),visible:kr(r.visible,t,e),raw:kr(r.raw,t,e),_all:kr(r._all,t,e)}}function kr(i,n,o){var a=null;return{getList:function(){if(!a){var t=n(),e=o();e.reset();for(var r=1;r<=t;++r)i(r)&&e.push(r);a=e.sliceAndReset()}return a},invalidList:function(){a=null}}}function Rr(t){if(void 0===t)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if("string"!=typeof t&&("number"!=typeof t||!isFinite(t)))throw new Error(t+" is not a valid id, expected string or number");return t}function Fr(t,e,r){for(var i=t.getObjectList(e.isNode),n=0;n<e._indexes.length;++n){var o=e._indexes[n];r(i.get(o),n)}}function Dr(t,e,r){for(var i=new Array(e.size),n=t.getObjectList(e.isNode),o=0;o<e._indexes.length;++o){var a=e._indexes[o],s=n.get(a);i[o]=r(s,o)}return i}function Pr(t,e,r){r=r||function(){return!0};for(var i=e.isNode,n=t.acquireIndexList(i),o=t.getObjectList(i),a=t.getListFactory(i),s=0;s<e._indexes.length;++s){var u=e._indexes[s],l=o.get(u);if(l)r(l,s)&&n.push(u)}return a(n.sliceAndReset())}function zr(t,e,r,i){var n=t.getListFactory(e.isNode);if(!r)return{valid:e,invalid:n()};for(var o=t.acquireIndexList(e.isNode),a=t.acquireIndexList(e.isNode),s=t.getObjectList(e.isNode),u=0;u<e._indexes.length;u++){var l=e._indexes[u],d=s.get(l);if(void 0!==d)(r(d,i)?o:a).pushUnchecked(l)}return{valid:n(o.sliceAndReset()),invalid:n(a.sliceAndReset())}}function Br(t,e,r,i){for(var n=t.getObjectList(e.isNode),o=i,a=0;a<e._indexes.length;++a){var s=e._indexes[a];o=r(o,n.get(s),a)}return o}function Ur(t,e){for(var r=e.isNode,i=t.topology.getDeduper(r),n=t.acquireIndexList(r),o=t.getListFactory(r),a=0;a<e._indexes.length;a++){var s=e._indexes[a];0===i.get(s)&&(i.set(s,1),n.push(s))}return o(n.sliceAndReset())}function Vr(t,e,r){for(var i=e.isNode,n=r.topology.getDeduper(i),o=r.acquireIndexList(i),a=r.getListFactory(i),s=0;s<e._indexes.length;s++){var u=e._indexes[s];n.set(u,1)}for(s=0;s<t._indexes.length;s++){u=t._indexes[s];0===n.get(u)&&o.push(u)}return a(o.sliceAndReset())}function jr(t,e){for(var r=e.isNode,i=t.storage.fetch(r),n=i.getFlexArray("excluded"),o=i.getMaxIndex(),a=t.topology.getDeduper(r),s=t.acquireIndexList(r),u=t.getListFactory(r),l=0;l<e._indexes.length;l++)a.set(e._indexes[l],1);for(var d=1;d<=o;++d)0===a.get(d)&&0===n.get(d)&&s.push(d);return u(s.sliceAndReset())}function Gr(t,e,r){var i=t.getListFactory(e.isNode),n=new Uint32Array(e._indexes.length+r._indexes.length);return n.set(e._indexes),n.set(r._indexes,e._indexes.length),i(n)}function Hr(t,e){return t.getObjectList(e.isNode).getMultiple(e._indexes)}function qr(t,e){var r=t.getStorage(e.isNode);if(e.isList){for(var i=new Array(e.size),n=0;n<e._indexes.length;++n)i[n]=r.getId(e._indexes[n]);return i}return r.getId(e._index)}function Wr(t,e){return t.topology.getExtremity(!0,e)}function Xr(t,e){return t.topology.getExtremity(!1,e)}function Yr(t,e,r){return t.getObjectList(e.isNode).get(e._indexes[r])}function Zr(t,e,n){var r=t.getListFactory(e.isNode),o=t.getObjectList(e.isNode),i=e._indexes.slice();return i.sort(function(t,e){var r=o.get(t),i=o.get(e);return n(r,i)}),r(i)}var Kr=new Uint32Array(1),Qr=(Object.defineProperty(Jr.prototype,"_indexes",{get:function(){return Kr[0]=this._index,Kr},enumerable:!0,configurable:!0}),Jr.prototype.setAttributes=function(t,e,r){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e,r)},Jr.prototype.setAttribute=function(t,value,e){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,value,e)},Jr.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]},Jr.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]},Jr.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},Jr.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},Jr.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]},Jr.prototype.isInView=function(t){return this._ogma.modules.locate.isElementInView(this,t)},Jr.prototype.getParallelEdges=function(t){return this._ogma.modules.graph.getParallelEdges(this,t)},Jr.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},Jr.prototype.isVisible=function(){return!this.isExcluded()},Jr.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},Jr.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)},Jr.prototype.setVisible=function(value){return this.setExcluded(!value)},Jr.prototype.toList=function(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))},Jr.prototype.getId=function(){return qr(this._ogma.modules.graph,this)},Jr.prototype.getSource=function(){return Wr(this._ogma.modules.graph,this)},Jr.prototype.getTarget=function(){return Xr(this._ogma.modules.graph,this)},Jr.prototype.getExtremities=function(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))},Jr.prototype.setSource=function(t){this._ogma.modules.graph.setSource(this,t)},Jr.prototype.setTarget=function(t){this._ogma.modules.graph.setTarget(this,t)},Jr.prototype.slice=function(){return this.toList()},Jr.prototype.toJSON=function(t){void 0===t&&(t={});var e=Mr(t),r=e.attributes,i=e.data;return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(r),data:i(j(this.getData()))}},Jr.prototype.get=function(t){return 0===t?this:void 0},Jr.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},Jr.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Jr.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},Jr.prototype.getBoundingBox=function(t){return this._ogma.modules.locate.getBoundingBox(this,t)},Jr.prototype.setData=function(t,value){return arguments.length<2&&(value=t,t=null),this._ogma.modules.data.setProperty(this,t,value),this},Jr.prototype.getData=function(t){return Ir(arguments.length),this._ogma.modules.data.getProperty(this,t||null)[0]},Jr.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},Jr.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},Jr.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},Jr.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},Jr.prototype.hasClass=function(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)},Jr.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},Jr.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},Jr.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},Jr.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},Jr.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},Jr.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},Jr.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},Jr);function Jr(t,e){this.size=1,this.isNode=!1,this.isList=!1,this._index=t,this._ogma=e}Lr([Qr],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var $r=(Object.defineProperty(ti.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),ti.prototype.setAttributes=function(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)},ti.prototype.setAttribute=function(t,value,e){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,value,e)},ti.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)},ti.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)},ti.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},ti.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},ti.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)},ti.prototype.getPreviousAttribute=function(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)},ti.prototype.getParallelEdges=function(t){return this._ogma.modules.graph.getParallelEdges(this,t)},ti.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},ti.prototype.isVisible=function(){return this.isExcluded().map(function(value){return!value})},ti.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},ti.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)},ti.prototype.setVisible=function(value){return this.setExcluded(!value)},ti.prototype.toList=function(){return this},ti.prototype.toArray=function(){return Hr(this._ogma.modules.graph,this)},ti.prototype.clone=function(){return this._ogma.modules.graph.edgeList(this._indexes.slice())},ti.prototype.getId=function(){return qr(this._ogma.modules.graph,this)},ti.prototype.getSource=function(){return Wr(this._ogma.modules.graph,this)},ti.prototype.getTarget=function(){return Xr(this._ogma.modules.graph,this)},ti.prototype.getExtremities=function(){return this.getSource().concat(this.getTarget())},ti.prototype.get=function(t){return Yr(this._ogma.modules.graph,this,t)},ti.prototype.forEach=function(t){Fr(this._ogma.modules.graph,this,t)},ti.prototype.map=function(t){return Dr(this._ogma.modules.graph,this,t)},ti.prototype.filter=function(t){return Pr(this._ogma.modules.graph,this,t)},ti.prototype.reduce=function(t,e){return Br(this._ogma.modules.graph,this,t,e)},ti.prototype.concat=function(t){return Gr(this._ogma.modules.graph,this,t)},ti.prototype.dedupe=function(){return Ur(this._ogma.modules.graph,this)},ti.prototype.subtract=function(t){return Vr(this,t,this._ogma.modules.graph)},ti.prototype.slice=function(t,e){return this._ogma.modules.graph.edgeList(this._indexes.slice(t,e))},ti.prototype.indexOf=function(t){return t instanceof Qr?this._indexes.indexOf(t._index):-1},ti.prototype.includes=function(t){return-1!==this.indexOf(t)},ti.prototype.sort=function(t){return Zr(this._ogma.modules.graph,this,t)},ti.prototype.inverse=function(){return jr(this._ogma.modules.graph,this)},ti.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},ti.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},ti.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},ti.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},ti.prototype.getBoundingBox=function(t){return this._ogma.modules.locate.getBoundingBox(this,t)},ti.prototype.setData=function(t,e){if(arguments.length<2&&(e=t,t=null),"function"!=typeof e&&!M(e))throw new Error("invalid argument "+e+"; expected array or function");return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this},ti.prototype.fillData=function(t,value){return arguments.length<2&&(value=t,t=null),this._ogma.modules.data.setProperty(this,t,value,{dispatch:!1}),this},ti.prototype.getData=function(t){return Ir(arguments.length),this._ogma.modules.data.getProperty(this,t||null)},ti.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},ti.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},ti.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},ti.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},ti.prototype.hasClass=function(e){var r=this;return this.map(function(t){return r._ogma.modules.classes.hasSingleElementClass(e,t)})},ti.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},ti.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},ti.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)},ti.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)},ti.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},ti);function ti(t,e){this.isList=!0,this.isNode=!1,this._indexes=t,this._ogma=e}Lr([$r],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var ei="geo.latitude",ri="geo.longitude",ii=85.0511287798,ni=1,oi={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://{s}.tile.osm.org/{z}/{x}/{y}.png",subdomains:"abc",tms:!1,wms:!1},crs:void 0},ai={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1};function si(){return ct||"undefined"!=typeof global&&!global.process}function ui(t){return Math.log2(t)+ni}function li(t){return null!=t&&!isNaN(t)}function di(t,e){return ci(t,e,"longitude")}function hi(t,e){return ci(t,e,"latitude")}function ci(t,e,r){if(isNaN(e))throw new TypeError("node "+t+": "+e+" is not a valid "+r)}var fi=yt().createElement("div");function gi(t,e,r,i){var n,o,a,s,u,l,d,h;o=!0,a=e,s=r,u=i,l=(n=t).getAttribute(o,s),d=n.getAttribute(o,u),h=a._indexes,d.setMultiple(h,l.getMultiple(h))}function pi(o){var t=o.getAttributes(["text.minVisibleSize","text.size","text.scale","minVisibleSize","width"]),a={};return t.forEach(function(t,e){var r=t.text,i=t.minVisibleSize,n=t.width;a[o.get(e).getId()]={"text.minVisibleSize":r.minVisibleSize,"text.size":r.size,"text.scale":r.scale,minVisibleSize:i,size:Math.max(1,Number(n))}}),a}var _i=new Uint32Array(1),vi=(Object.defineProperty(mi.prototype,"_indexes",{get:function(){return _i[0]=this._index,_i},enumerable:!0,configurable:!0}),mi.prototype.setAttributes=function(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)},mi.prototype.setAttribute=function(t,value,e){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,value,e)},mi.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},mi.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]},mi.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]},mi.prototype.getPosition=function(){return this.getAttributes(["x","y"])},mi.prototype.getPositionOnScreen=function(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())},mi.prototype.isInScreen=function(){var t=this.getPositionOnScreen(),e=this._ogma.modules.camera;return 0<=t.x&&t.x<=e.width&&0<=t.y&&t.y<=e.height},mi.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},mi.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]},mi.prototype.getPreviousAttribute=function(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)},mi.prototype.isInView=function(t){return this._ogma.modules.locate.isElementInView(this,t)},mi.prototype.getAdjacentNodes=function(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)},mi.prototype.getAdjacentEdges=function(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)},mi.prototype.getDegree=function(t){return this._ogma.modules.graph.getDegree(this,t)[0]},mi.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},mi.prototype.getConnectedComponent=function(t){return this._ogma.modules.graph.getConnectedComponentByNode(this,t)[0]},mi.prototype.isVisible=function(){return!this.isExcluded()},mi.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},mi.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)},mi.prototype.setVisible=function(value){return this.setExcluded(!value)},mi.prototype.toList=function(){return this._ogma.nodeList(new Uint32Array([+this._index]))},mi.prototype.getId=function(){return qr(this._ogma.modules.graph,this)},mi.prototype.slice=function(){return this.toList()},mi.prototype.toJSON=function(t){void 0===t&&(t={});var e=Mr(t),r=e.attributes,i=e.data;return{id:this.getId(),attributes:this.getAttributes(r),data:i(j(this.getData()))}},mi.prototype.get=function(t){return 0===t?this:void 0},mi.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},mi.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},mi.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},mi.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},mi.prototype.setData=function(t,value){return arguments.length<2&&(value=t,t=null),this._ogma.modules.data.setProperty(this,t,value),this},mi.prototype.getData=function(t){return Ir(arguments.length),this._ogma.modules.data.getProperty(this,t||null)[0]},mi.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},mi.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},mi.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},mi.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},mi.prototype.hasClass=function(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)},mi.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},mi.prototype.getGeoCoordinates=function(){var t=this._ogma.modules.graph,e=t.getNodeAttribute(ei).get(this._index),r=t.getNodeAttribute(ri).get(this._index);return{latitude:li(e)?e:void 0,longitude:li(r)?r:void 0}},mi.prototype.setGeoCoordinates=function(t){var e=this;return this.toList().setGeoCoordinates([t]).then(function(){return e})},mi.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},mi.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},mi.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},mi.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},mi.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},mi.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},mi);function mi(t,e){this.size=1,this.isNode=!0,this.isList=!1,this._index=t,this._ogma=e}Lr([vi],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var yi=(Object.defineProperty(bi.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),bi.prototype.setAttributes=function(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)},bi.prototype.setAttribute=function(t,e,r){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,r)},bi.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)},bi.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)},bi.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},bi.prototype.getPosition=function(){return this.getAttributes(["x","y"])},bi.prototype.getPositionOnScreen=function(){var e=this;return this.getPosition().map(function(t){return e._ogma.modules.camera.graphToScreenCoordinates(t)})},bi.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},bi.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)},bi.prototype.getPreviousAttribute=function(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)},bi.prototype.getAdjacentNodes=function(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)},bi.prototype.getAdjacentEdges=function(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)},bi.prototype.getDegree=function(t){return this._ogma.modules.graph.getDegree(this,t)},bi.prototype.getConnectedComponents=function(t){return this._ogma.modules.graph.getConnectedComponents(this,t)},bi.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},bi.prototype.isVisible=function(){return this.isExcluded().map(function(value){return!value})},bi.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},bi.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)},bi.prototype.setVisible=function(value){return this.setExcluded(!value)},bi.prototype.toList=function(){return this},bi.prototype.toArray=function(){return Hr(this._ogma.modules.graph,this)},bi.prototype.clone=function(){return this._ogma.modules.graph.nodeList(this._indexes.slice())},bi.prototype.getId=function(){return qr(this._ogma.modules.graph,this)},bi.prototype.get=function(t){return Yr(this._ogma.modules.graph,this,t)},bi.prototype.forEach=function(t){Fr(this._ogma.modules.graph,this,t)},bi.prototype.map=function(t){return Dr(this._ogma.modules.graph,this,t)},bi.prototype.filter=function(t){return Pr(this._ogma.modules.graph,this,t)},bi.prototype.reduce=function(t,e){return Br(this._ogma.modules.graph,this,t,e)},bi.prototype.concat=function(t){return Gr(this._ogma.modules.graph,this,t)},bi.prototype.dedupe=function(){return Ur(this._ogma.modules.graph,this)},bi.prototype.subtract=function(t){return Vr(this,t,this._ogma.modules.graph)},bi.prototype.slice=function(t,e){return this._ogma.modules.graph.nodeList(this._indexes.slice(t,e))},bi.prototype.indexOf=function(t){return t instanceof vi?this._indexes.indexOf(t._index):-1},bi.prototype.includes=function(t){return-1!==this.indexOf(t)},bi.prototype.inverse=function(){return jr(this._ogma.modules.graph,this)},bi.prototype.sort=function(t){return Zr(this._ogma.modules.graph,this,t)},bi.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},bi.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},bi.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},bi.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},bi.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},bi.prototype.setData=function(t,e){if(arguments.length<2&&(e=t,t=null),"function"!=typeof e&&!M(e))throw new Error("invalid argument "+e+"; expected array or function");return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this},bi.prototype.fillData=function(t,value){return arguments.length<2&&(value=t,t=null),this._ogma.modules.data.setProperty(this,t,value,{dispatch:!1}),this},bi.prototype.getData=function(t){return Ir(arguments.length),this._ogma.modules.data.getProperty(this,t||null)},bi.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},bi.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},bi.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},bi.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},bi.prototype.hasClass=function(e){var r=this;return this.map(function(t){return r._ogma.modules.classes.hasSingleElementClass(e,t)})},bi.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},bi.prototype.getGeoCoordinates=function(){for(var t=this._ogma.modules.graph,e=new Array(this._indexes.length),r=t.getNodeAttribute(ei).getMultiple(this._indexes),i=t.getNodeAttribute(ri).getMultiple(this._indexes),n=0,o=this._indexes.length;n<o;n++)e[n]={latitude:r[n],longitude:i[n]};return e},bi.prototype.setGeoCoordinates=function(t){var e=this,r=this._ogma.modules.geo,i=this._ogma.modules.graph,n=this.getId(),o=this._indexes,a=new Array(o.length),s=new Array(o.length);if(null===t&&(t=new Array(o.length).fill(null)),t.length!==o.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(var u=0,l=o.length;u<l;u++){var d=t[u]||{latitude:void 0,longitude:void 0},h=d.latitude,c=d.longitude,f=n[u];null==h&&null==c?h=c=void 0:(hi(f,h),di(f,c)),a[u]=h,s[u]=c}return this.setData(r.latitudePath,a),this.setData(r.longitudePath,s),i.getNodeAttribute(ei).setMultiple(o,a),i.getNodeAttribute(ri).setMultiple(o,s),this._ogma.modules.transformations.refresh().then(function(){return e})},bi.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},bi.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)},bi.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)},bi.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},bi);function bi(t,e){this.isList=!0,this.isNode=!0,this._indexes=t,this._ogma=e}function xi(t,e,r,i){return void 0===r&&(r={}),void 0===i&&(i={}),Ai(t,e,[r],i).get(0)}function Ei(i,n,t,o){if(void 0===o&&(o={}),o.batchSize){for(var e=[],r=0;r<t.length;r+=o.batchSize)e.push(t.slice(r,r+o.batchSize));var a=n?i.nodeList():i.edgeList();return e.reduce(function(t,e){var r;return t.then(function(t){return r=t,i.getDom().afterNextFrame()}).then(function(){return Ai(i,n,e,o)}).then(function(t){return r.concat(t)})},Promise.resolve(a))}return Promise.resolve(Ai(i,n,t,o))}function Ai(t,e,r,i){t.setIndexFreeStep(0);for(var n=t.storage.fetch(e),o=[],a=[],s=[],u=[],l=new Set,d=i.virtual,h=void 0!==d&&d,c=0,f=r;c<f.length;c++){var g=f[c];if("object"!=typeof g||null===g||Array.isArray(g))throw new Error(g+" is not a valid "+(e?"node":"edge"));var p=Rr(g.id);if(!n.getIndex(p,!1)&&!l.has(p)&&(a.push(p),o.push(g),l.add(p),!e)){var _=g,v=t.getExtremityIndex(p,_.source,"source"),m=t.getExtremityIndex(p,_.target,"target");s.push(v),u.push(m)}}var y=n.addElements(a);e?t.topology.allocateNodes(y):t.topology.allocateEdges(y,s,u);for(var b=n.getFlexArray("object"),x=n.getFlexArray("excluded"),E=n.getFlexArray("removed"),A=n.getFlexArray("virtual"),S=e?t.node:t.edge,w=e?t.nodeList:t.edgeList,T=t.getCacheLists(e),C=w(y),M=0;M<y.length;M++){var I=y[M];b.set(I,S(I))}return x.setMultiple(y,0),E.setMultiple(y,0),A.setMultiple(y,h?1:0),T.visible.invalidList(),T.all.invalidList(),T._all.invalidList(),h||T.raw.invalidList(),0!==C.size&&(e?t.fireEvent(be.ADD_NODES,{virtual:h,objects:o,nodes:C}):t.fireEvent(be.ADD_EDGES,{virtual:h,objects:o,edges:C})),C}Lr([yi],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var Si,wi=(b(Ti,Si=Ee),Ti.prototype.onMounted=function(t,e){if(e.graph){var r=e.graph,i=r.nodes,n=r.edges;i&&this.addNodes(i),n&&this.addEdges(n)}},Ti.prototype.createIndexList=function(t){return this.storage.fetch(t).createIndexList()},Ti.prototype.setIndexFreeStep=function(t){this._indexFreeStep=t},Ti.prototype.getDom=function(){return this._dom},Ti.prototype.acquireIndexList=function(t){var e=t?this._nodeIndexLists:this._edgeIndexLists,r=e.find(function(t){return!t.isBusy()});return r||(r=this.createIndexList(t),e.push(r)),r.markBusy(),r},Ti.prototype.getObjectList=function(t){return t?this._nodes:this._edges},Ti.prototype.getListFactory=function(t){return t?this.nodeList:this.edgeList},Ti.prototype.getStorage=function(t){return t?this.storage.nodes:this.storage.edges},Ti.prototype.getFilter=function(t,e){var r=t?this._nodeFilters:this._edgeFilters;return r[e]||r.visible},Ti.prototype.fireEvent=function(t,e){this._events.fire(t,e)},Ti.prototype.getCacheLists=function(t){return t?this._nodeCacheLists:this._edgeCacheLists},Ti.prototype._resolvePromises=function(){var t=this._promisesToResolve;this._promisesToResolve=[],t.forEach(function(t){return t()})},Ti.prototype._initialize=function(){var t=this;this._nodeCacheLists=Or(function(){return t.getNodeMaxIndex()},function(){return t.acquireIndexList(!0)},this._nodeFilters),this._edgeCacheLists=Or(function(){return t.getEdgeMaxIndex()},function(){return t.acquireIndexList(!1)},this._edgeFilters),this.topology=new Ar(this),this._resolvePromises()},Ti.prototype.getNodeMaxIndex=function(){return this.storage.nodes.getMaxIndex()},Ti.prototype.getEdgeMaxIndex=function(){return this.storage.edges.getMaxIndex()},Ti.prototype.isExcluded=function(t){return this.storage.fetch(t.isNode).getFlexArray("excluded").getMultiple(t._indexes)},Ti.prototype.setExcluded=function(t,value){for(var e=value?1:0,r=t.isNode,i=this.storage.fetch(r),n=i.getFlexArray("excluded"),o=i.getFlexArray("removed"),a=this.acquireIndexList(r),s=this.getListFactory(r),u=0;u<t._indexes.length;u++){var l=t._indexes[u],d=n.get(l),h=o.get(l);e!==d&&0===h&&a.push(l)}var c=a.sliceAndReset();if(c.length){this.getCacheLists(t.isNode).visible.invalidList();var f=s(c);n.setMultiple(c,e),this._events.fire(be.EXCLUDED_STATE_CHANGE,{elements:f,value:value})}},Ti.prototype.addNode=function(t,e){return xi(this,!0,t,e)},Ti.prototype.addEdge=function(t,e){return xi(this,!1,t,e)},Ti.prototype.addNodes=function(t,e){return Ei(this,!0,t,e)},Ti.prototype.addEdges=function(t,e){return Ei(this,!1,t,e)},Ti.prototype.getExtremityIndex=function(t,e,r){if(e instanceof vi)return e._index;var i=this.storage.nodes.getIndex(e);if(!i)throw new Error("addEdge(s): invalid "+r+' for edge "'+t+'"; node "'+e+'" does not exist');return i},Ti.prototype.getNodes=function(t){return this.getElements(!0,t)},Ti.prototype.getEdges=function(t){return this.getElements(!1,t)},Ti.prototype.getElements=function(t,e){var r=t?this.nodeList:this.edgeList,i=t?yi:$r,n=t?vi:Qr;if(e&&"string"!=typeof e){var o=this.acquireIndexList(t),a=this.storage.fetch(t);if(e instanceof n)o.push(e._index);else if(M(e))for(var s=0,u=e;s<u.length;s++){var l=u[s];l instanceof n?o.push(l._index):(f=a.getIndex(l))&&o.push(f)}else if(e instanceof i)for(var d=this.getFilter(t,"all"),h=e,c=0;c<h._indexes.length;c++){var f;d(f=h._indexes[c])&&o.push(f)}return r(o.sliceAndReset())}var g=e||"visible",p=this.getCacheLists(t)[g];if(!p)throw new Error('getNodes/getEdges: unexpected argument "'+g+'"');return r(p.getList())},Ti.prototype.getNode=function(t){return this._getElement(!0,t)},Ti.prototype.getEdge=function(t){return this._getElement(!1,t)},Ti.prototype._getElement=function(t,e){if(e instanceof(t?vi:Qr))return e;var r=this.getStorage(t),i=this.getObjectList(t),n=r.getIndex(e);return n?i.get(n):void 0},Ti.prototype.clear=function(){this._events.fire(be.CLEAR_GRAPH),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()},Ti.prototype.createAttribute=function(t,e){return this.storage.fetch(t).createFlexArray(e)},Ti.prototype.createNodeAttribute=function(t){return this.createAttribute(!0,t)},Ti.prototype.createEdgeAttribute=function(t){return this.createAttribute(!1,t)},Ti.prototype.getAttribute=function(t,e){return this.storage.fetch(t).getFlexArray(e)},Ti.prototype.getAttributes=function(e,t){var r=this;return t.map(function(t){return r.getAttribute(e,t)})},Ti.prototype.getNodeAttribute=function(t){return this.storage.nodes.getFlexArray(t)},Ti.prototype.getNodeAttributes=function(t){return this.getAttributes(!0,t)},Ti.prototype.getEdgeAttribute=function(t){return this.storage.edges.getFlexArray(t)},Ti.prototype.getEdgeAttributes=function(t){return this.getAttributes(!1,t)},Ti.prototype.getAllNodeAttributes=function(){return this.storage.nodes.getAllFlexArrays()},Ti.prototype.getAllEdgeAttributes=function(){return this.storage.edges.getAllFlexArrays()},Ti.prototype.setSource=function(t,e){var r=this.getNode(e);r&&this.topology.setExtremities(t._indexes,r._indexes,null)},Ti.prototype.setTarget=function(t,e){var r=this.getNode(e);r&&this.topology.setExtremities(t._indexes,null,r._indexes)},Ti.prototype.getParallelEdges=function(t,e){return void 0===e&&(e={}),this.topology.getParallelEdges(t,e)},Ti.prototype.getEdgesBetweenTwoNodes=function(t,e){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(t._index,e._index))},Ti.prototype.getAdjacentDirections=function(t){return this.topology.getAdjacentDirections(t)},Ti.prototype.getEdgeIndexesInDirection=function(t){return this.topology.getEdgeIndexesInDirection(t)},Ti.prototype.fastGetNodesAdjacentElements=function(t){return this.topology.fastGetNodesAdjacentElements(t._indexes)},Ti.prototype.fastGetEdgesAdjacentElements=function(t){return this.topology.fastGetEdgesAdjacentElements(t._indexes)},Ti.prototype.getAdjacentNodes=function(t,e){return this.nodeList(this.topology.getAdjacentElements(!0,t._indexes,e))},Ti.prototype.getAdjacentEdges=function(t,e){return this.edgeList(this.topology.getAdjacentElements(!1,t._indexes,e))},Ti.prototype.getDegree=function(t,e){return this.topology.getDegree(t._indexes,e)},Ti.prototype.degrees=function(t,e){return this.topology.degrees(t,e)},Ti.prototype.getAdjacencyList=function(t){var e=void 0===t?{}:t,r=e.directed,i=void 0!==r&&r,n=e.internalIndexes,o=void 0!==n&&n,a=e.weight,s=void 0===a?1:a,u=e.nodes,l=e.indexes;return this.topology.getAdjacencyList({directed:i,weight:s,ids:!o,nodes:l||this.getNodes(u)._indexes})},Ti.prototype.getConnectedComponents=function(t,e){return this.topology.getConnectedComponents(t._indexes,e)},Ti.prototype.getConnectedComponentByNode=function(t,e){return this.topology.getConnectedComponents(t._indexes,e)},Ti);function Ti(t,e){var r=t.dom,i=t.events,n=Si.call(this)||this;n.storage={nodes:new er(!0),edges:new er(!1),fetch:function(t){return t?this.nodes:this.edges}},n._promisesToResolve=[],n._indexFreeStep=0,n._nodeIndexLists=[],n._edgeIndexLists=[],n._onNewFrame=function(){1===n._indexFreeStep?n._indexFreeStep=2:2===n._indexFreeStep&&(n.storage.nodes.freeIndexes(),n.storage.edges.freeIndexes(),n._indexFreeStep=0)},n._events=i,n._dom=r,n._events.register([be.ADD_NODES,be.ADD_EDGES,be.EXCLUDED_STATE_CHANGE],[be.CLEAR_GRAPH,be.BEFORE_REMOVE_NODES,be.REQUEST_ELEMENTS_TO_DELETE,be.REMOVE_NODES,be.BEFORE_REMOVE_EDGES,be.REMOVE_EDGES]);return[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach(function(t){n.createNodeAttribute(t),n.createEdgeAttribute(t)}),n.node=e.node,n.edge=e.edge,n.nodeList=e.nodeList,n.edgeList=e.edgeList,n._nodes=n.createAttribute(!0,{name:"object",storage:"any"}),n._edges=n.createAttribute(!1,{name:"object",storage:"any"}),n.createAttribute(!1,{name:"source",storage:32}),n.createAttribute(!1,{name:"target",storage:32}),n._nodeFilters=Nr(n.storage.nodes),n._edgeFilters=Nr(n.storage.edges),n._initialize(),n._events.on(be.NEW_FRAME,n._onNewFrame),n}var Ci=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],Mi=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function Ii(t,e){void 0===e&&(e=[0,0,0,0]);var r=Mi.exec(t);return r?(e[0]=parseInt(r[1])/255,e[1]=parseInt(r[2])/255,e[2]=parseInt(r[3])/255,e[3]=void 0===r[4]?1:parseFloat(r[4]),e):null}function Li(t){return t<16?"0"+t.toString(16):t.toString(16)}function Ni(t){var e=t[0],r=t[1],i=t[2],n=t[3];return"rgba("+(256*e|0)+","+(256*r|0)+","+(256*i|0)+","+(void 0===n?1:n)+")"}function Oi(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,r,i){return e+e+r+r+i+i});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255,1]:null}var ki=[0,0,0,0],Ri=(Fi.prototype.parseColor=function(t){var e=this._colorByName.get(t);if(void 0===e){var r=t+"",i=("#"===r.charAt(0)?Oi:Ii)(r);this._colorByName.set(t,i),e=i}return e},Fi.prototype.toHexa=function(t){var e=this.parseColor(t);if(!e)return null;var r=e[0],i=e[1],n=e[2];return"#"+Li(255*r)+Li(255*i)+Li(255*n)},Fi.prototype.rgbaToRgb=function(t){var e=1,r=t;return r&&Ii(t,ki)&&(r="rgb("+255*ki[0]+","+255*ki[1]+","+255*ki[2]+")",e=parseFloat(ki[3].toString())),{color:r,opacity:e}},Fi);function Fi(){this._colorByName=new Map,this._colorByName.set(null,[0,0,0,0]),this._colorByName.set("transparent",[0,0,0,0]);for(var t=0;t<Ci.length;t+=2){var e=Ci[t].toLowerCase(),value=Ci[t+1];this._colorByName.set(e,Oi(value))}}var Di,Pi=2,zi=4,Bi=5,Ui=6,Vi=7,ji=1,Gi=2,Hi=3,qi=4,Wi=5,Xi=((Di={})[Pi]="image",Di[zi]="piechart",Di[3]="text",Di[Bi]="icon",Di[Ui]="badge",Di),Yi=(Zi.prototype.reset=function(){this._init_()},Zi.prototype._init_=function(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:1,attributes:{}}},Zi.prototype._increaseNextId=function(){var t=this._nextPatternId++;for(t%256==255&&(t=this._nextPatternId++);this._patterns.length<=t;)this._patterns.push(void 0);return t},Zi.prototype._createPattern=function(t){var e=t.type,r=t.attributes,i={id:this._increaseNextId(),type:e,attributes:this._cloneAttributes(e,r)};return this._patterns[i.id]=i,this._mustUpdate=!0,i},Zi.prototype._cloneAttributes=function(t,e){return t===Pi?{image:e.image,scaled:e.scaled,duplicated:e.duplicated}:3===t||t===Bi||t===Ui?{font:e.font,size:e.size,style:e.style,text:e.text,paddingLeft:e.paddingLeft,paddingTop:e.paddingTop,align:e.align||"center",offset:e.offset||0}:t===zi&&e.colors?{colors:e.colors,colorArray:e.colors.split(";").map(function(t){return t.trim()})}:{}},Zi.prototype.getPatternList=function(){return this._patterns.filter(function(t){return t})},Zi.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},Zi.prototype.setPixelRatio=function(value){value!==this._pixelRatio&&(this._pixelRatio=value,this._mustUpdate=!0)},Zi.prototype.getPixelRatio=function(){return this._pixelRatio},Zi.prototype.notifyUpdate=function(){this._mustUpdate=!0},Zi.prototype.getIdFromDefinition=function(t){var e=t.type,r=t.attributes,i=3===e||e===Bi||e===Ui,n=0;return e&&1!==e&&e!==Vi&&(e!==Pi||r.image)&&(!i||r.text&&r.font)&&(n=this._addPattern(t),3===e&&"normal"===r.style&&(r.style="bold",this._addPattern(t))),n},Zi.prototype._addPattern=function(t){var e=this._getPatternHash(t),r=this._patternsByHash[e];return r||(65500<this._nextPatternId?Tr("maximum number of pattern exceeded"):(r=this._createPattern(t).id,this._patternsByHash[e]=r)),r},Zi.prototype._getPatternHash=function(t){var e=t.type,r=t.attributes,i=[Xi[e]];return e===Pi?i.push(r.scaled?"scaled":"non-scaled",r.duplicated?"duplicated":"non-duplicated",r.image.src||r.image.toDataURL()):3===e?i.push(r.text,r.font,r.style,r.size,r.align||"center",r.offset||0):e===Bi||e===Ui?i.push(r.text,r.font,r.style,r.size,r.paddingLeft,r.paddingTop):i.push(r.colors),i.join("+")},Zi.prototype.getDefinitionFromId=function(t){if(t&&this._patterns[t]){var e=this._patterns[t];if(e)return e}return this._nullPattern},Zi.prototype.getVersion=function(){return this._version},Zi);function Zi(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}var Ki=Math.round(Math.log2(512)),Qi=Math.round(Math.log2(128)),Ji=Ki+Qi,$i=128,tn=Math.round(Math.sqrt(16)),en=$i*tn,rn=16,nn=1,on=256,an=5,sn=5;function un(t){return t.map(function(t){var e=t.x,r=t.y,i=t.r;return{x:e,y:r,r:void 0===i?0:i}})}var ln=(dn.prototype.register=function(t,e){var r=e.getDistanceFromStrokeVertically,i=e.getDistanceFromStrokeHorizontally,n=e.points,o=e.hole,a=e.isSimple;if(!this._byName[t]){for(var s=a?1:8,u=a?7:15;this._byId[s];)s+=1;if(u<s)throw new Error("max number of shape exceeded");var l={id:s,name:t,getDistanceFromStrokeVertically:r,getDistanceFromStrokeHorizontally:i,points:un(n.slice()),hole:o?un(o.slice()):null,isSimple:!!a};return this._mustUpdate=!0,this._byId[s]=l,this._byName[t]=l}},dn.prototype.getIdFromName=function(t){return this._byName[t].id},dn.prototype.getNameFromId=function(t){var e=this._byId[t];return e?e.name:""},dn.prototype.getDefinitionFromName=function(t){return this._byName[t]},dn.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},dn.prototype.getVersion=function(){return this._version},dn.prototype.getShapeList=function(){return this._byId.filter(function(t){return t})},dn);function dn(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(16)}var hn=(cn.prototype.update=function(){this._mustUpdate&&(this.version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))},cn.prototype.allocate=function(t){var e=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+t<=this._capacity?(e=this._nbCellsAllocated,this._nbCellsAllocated+=t,this._mustUpdate=!0):this._isFullyAllocated=!0,e},cn.prototype.free=function(t,e){for(var r=0;r<e;r++){var i=(t+r)*this.elementSize;this._dataView.setUint16(i,0)}this._mustUpdate=!0,this._nbCellsFreed+=e},cn.prototype.triggerUpdate=function(){this._mustUpdate=!0},cn.prototype.isEmpty=function(){return this._nbCellsFreed===this._nbCellsAllocated},cn.prototype.isFullyFreed=function(){return this._isFullyFreed},cn.prototype.getId=function(){return this._id},cn.prototype.getDataView=function(){return this._dataView},cn.prototype.getByteArray=function(){return this._byteArray},cn.prototype.getSize=function(){return this._nbCellsAllocated},cn.prototype.getNbSideElementsPerMainElement=function(){return this._nbSideElementsPerMainElement},cn.prototype.hasSideData=function(){return 0<this._nbSideElementsPerMainElement},cn.prototype.getSideDataView=function(){return this._sideDataView},cn.prototype.getSideByteArray=function(){return this._sideByteArray},cn.prototype.getTotalSideElementsSize=function(){return this._totalSideElementsSize},cn);function cn(t){var e=t.elementSize,r=t.sideElementSize,i=t.nbSideElementsPerMainElement,n=t.id,o=t.depth,a=t.elementType,s=t.animated,u=t.stencilUsage;this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=512,this.version=0,this._id=n,this.depth=o,this.type=a,this.animated=s,this.stencilUsage=u,this.elementSize=e,this._sideElementSize=r,this._nbSideElementsPerMainElement=i,this._totalSideElementsSize=i*r,this._byteCapacity=this._capacity*this.elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}var fn=(gn.prototype.reset=function(){this._init_()},gn.prototype._init_=function(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0},gn.prototype._fillBlockInfo=function(t,e,r,i){return this._blockInfo.buffer=t,this._blockInfo.offset=e,this._blockInfo.size=r,this._blockInfo.address=i,this._blockInfo},gn.prototype._createBuffer=function(t,e,r,i,n){var o=e?128:56,a=this._buffersById.length,s=new hn({elementSize:o,sideElementSize:6,nbSideElementsPerMainElement:i,id:a,depth:r,elementType:t,animated:e,stencilUsage:n});return this._buffersById.push(s),s},gn.prototype.getBlockInfo=function(t){return this._fillBlockInfo(this._buffersById[t>>Ji],(t>>Qi)%512,t%128,t)},gn.prototype.allocateBlock=function(t,e,r,i,n,o,a){var s=function(t,e){for(var value=0;value<t;)value+=e;return value}(o,8);this._mustUpdate=!0;var u=null,l=-1;if(t){var d=this.getBlockInfo(t),h=d.buffer,c=d.offset,f=d.size,g=d.size===n,p=h.depth===i,_=h.type===e,v=h.animated===r,m=h.getNbSideElementsPerMainElement()===s,y=h.stencilUsage===a;g&&p&&_&&v&&m&&y?(h.triggerUpdate(),u=h,l=c):h.free(c,f)}if(-1===l){var b=+r,x=s/8,E=this._buffersByDepth[i]||Array(2),A=(this._buffersByDepth[i]=E)[b]||[],S=(E[b]=A)[e]||Array(16),w=(A[e]=S)[x]||Array(4),T=(S[x]=w)[a]||[],C=(w[a]=T)[T.length-1];C&&(l=(u=C).allocate(n)),-1===l&&(l=(u=this._createBuffer(e,r,i,s,a)).allocate(n),T.push(u))}var M=((u.getId()<<Ki)+l<<Qi)+n;return this._fillBlockInfo(u,l,n,M)},gn.prototype.freeBlock=function(t){if(t){this._mustUpdate=!0;var e=this.getBlockInfo(t);e.buffer.free(e.offset,e.size)}return 0},gn.prototype._sortBuffersByDepth=function(){for(var t=[],e=0;e<this._buffersByDepth.length;e++){var r=this._buffersByDepth[e];if(r)for(var i=0;i<r.length;i++){var n=r[i];if(n)for(var o=0;o<n.length;o++){var a=n[o];if(a)for(var s=0;s<a.length;s++){var u=a[s];if(u)for(var l=0;l<u.length;l++){var d=u[l];if(d)for(var h=0;h<d.length;h++){var c=d[h];c.update(),c.isFullyFreed()?(this._buffersById[c.getId()]=void 0,d.splice(h,1),--h):t.push(c)}}}}}}this._buffersByAscendingDepth=t,this._buffersByDescendingDepth=t.slice().reverse()},gn.prototype.update=function(){this._mustUpdate&&(this._sortBuffersByDepth(),this.version+=1,this._mustUpdate=!1)},gn.prototype.getBuffers=function(){return this._buffersById},gn.prototype.getBuffersByAscendingDepth=function(){return this._buffersByAscendingDepth},gn.prototype.getBuffersByDescendingDepth=function(){return this._buffersByDescendingDepth},gn);function gn(){this.version=0,this.version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}var pn=300,_n=150,vn=(Object.defineProperty(mn.prototype,"__dummy",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(mn.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),mn.prototype.getContext=function(t){return"2d"===t?this.__context:null},mn.prototype.toDataURL=function(t){return void 0===t&&(t="png"),"data:image/"+t+";base64,"},mn.prototype.addEventListener=function(){},mn.prototype.removeEventListener=function(){},mn.prototype.getBoundingClientRect=function(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}},mn);function mn(){this.style={},this.width=pn,this.height=_n,this.__context=new yn,this.style={},this.width=pn,this.height=_n}var yn=(Object.defineProperty(bn.prototype,"font",{set:function(t){var e=t.match(/\d+/);e&&(this._fontSize=parseFloat(e[0]))},enumerable:!0,configurable:!0}),Object.defineProperty(bn.prototype,"fillStyle",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(bn.prototype,"textBaseline",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(bn.prototype,"textAlign",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(bn.prototype,"strokeStyle",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(bn.prototype,"lineWidth",{set:function(t){},enumerable:!0,configurable:!0}),bn.prototype.fill=function(){},bn.prototype.stroke=function(){},bn.prototype.clearRect=function(){},bn.prototype.fillRect=function(){},bn.prototype.strokeRect=function(){},bn.prototype.beginPath=function(){},bn.prototype.closePath=function(){},bn.prototype.moveTo=function(){},bn.prototype.lineTo=function(){},bn.prototype.rect=function(){},bn.prototype.arc=function(){},bn.prototype.save=function(){},bn.prototype.restore=function(){},bn.prototype.clip=function(){},bn.prototype.translate=function(){},bn.prototype.rotate=function(){},bn.prototype.fillText=function(){},bn.prototype.setLineDash=function(){},bn.prototype.quadraticCurveTo=function(){},bn.prototype.bezierCurveTo=function(){},bn.prototype.drawImage=function(){},bn.prototype.measureText=function(t){return{width:t.length*Math.ceil(.625*this._fontSize)}},bn.prototype.getImageData=function(){return{width:0,height:0,data:new Uint8ClampedArray(0)}},bn);function bn(){this._fontSize=10}var xn=C("canvas")||C("canvas-prebuilt");function En(){if(ht)return document.createElement("canvas");if(xn){var t=null;return(t="createCanvas"in xn?xn.createCanvas(pn,_n):new xn(pn,_n)).style={},t}return new vn}function An(t,e,r,i){void 0===r&&(r=t.width),void 0===i&&(i=t.height),e.clearRect(0,0,r,i)}function Sn(t,e,r,i){void 0===i&&(i=""),t.font=i+" "+r+"px "+e}function wn(){return null!==Tn(En(),{})}function Tn(t,e){var r=t.getContext("webgl",e);return(r=r||t.getContext("experimental-webgl",e))||null}function Cn(){return{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,unusedFlag2:!1,unusedFlag3:!1}}function Mn(t){return void 0===t&&(t={}),t.pieceId=0,t.shape="",t.x1=0,t.y1=0,t.x2=0,t.y2=0,t.rectWidthOrSourceRadiusScaled=0,t.rectWidthOrSourceRadiusFixed=0,t.rectHeightOrTargetRadiusScaled=0,t.rectHeightOrTargetRadiusFixed=0,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern=t.pattern||{type:0,attributes:{}},t.pattern.type=0,t.opacity=1,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1,t.isSelfLoop=!1,t.isText=!1,t.adjustTextAngle=!1,t.isBadge=!1,t.unusedFlag2=!1,t.unusedFlag3=!1,t}function In(){return{valid:!1,id:void 0,end:Cn(),start:Cn(),animation:{duration:0,beginTime:-1,easing:"linear"}}}function Ln(t,e,r,i){t.width=e*i,t.height=r*i,t.style.width=e+"px",t.style.height=r+"px"}var Nn=(On.createInitData=function(){return null},On.getName=function(){return null},On.isAvailable=function(){return!0},On.prototype.getDomElement=function(){return null},On.prototype._initCanvas=function(t){t.style.touchAction="none"},On.prototype.export=function(t){return Promise.resolve()},On.prototype.extractElement=function(t,e){return this._memoryManager.extractGenericElement(t,e,this._scales)},On.prototype._compareDimensions=function(t,e,r){return(t!==this._width||e!==this._height||r!==this._pixelRatio)&&(this._width=t,this._height=e,this._pixelRatio=r,!0)},On.prototype._compareView=function(t,e,r,i){return(t!==this._viewX||e!==this._viewY||r!==this._viewZoom||i!==this._viewAngle)&&(this._viewX=t,this._viewY=e,this._viewZoom=r,this._viewAngle=i,this._viewAngleCos=Math.cos(i),this._viewAngleSin=Math.sin(i),!0)},On.prototype._compareCurrentTime=function(t){return t!==this._currentTime&&(this._currentTime=t,!0)},On.prototype._compareBackgroundColor=function(t,e){return(t!==this._backgroundColor||e!==this._renderBackground)&&(this._renderBackground=e,this._backgroundColor=t,this._backgroundRgba=this._colorManager.parseColor(this._backgroundColor),!0)},On.prototype._compareShapes=function(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)},On.prototype._comparePatterns=function(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)},On.prototype._compareBoundaries=function(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)},On.prototype._compareTexts=function(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)},On.prototype._compareIsDisplayableBuffer=function(t){return this._isBufferDisplayable!==t&&(this._isBufferDisplayable=t,!0)},On.prototype._compareHideImages=function(t){return this._hideImages!==t&&(this._hideImages=t,!0)},On.prototype.renderFrame=function(t){var e=t.x,r=t.y,i=t.zoom,n=t.angle,o=t.width,a=t.height,s=t.pixelRatio,u=t.backgroundColor,l=t.currentTime,d=t.isBufferDisplayable,h=t.hideImages,c=t.renderBackground,f=this._compareShapes(),g=this._comparePatterns(),p=this._compareBoundaries(),_=this._compareTexts(),v=this._compareDimensions(o,a,s),m=this._compareView(e,r,i,n),y=this._compareCurrentTime(l),b=this._compareBackgroundColor(u,c),x=this._compareIsDisplayableBuffer(d),E=this._compareHideImages(h);if(p){var A=this._boundariesManager,S=this._scales;S.bytesToActualCoord=1,S.bytesToActualScaledSize=A.maxScaledSize/65535,S.bytesToActualMinVisibleSize=A.maxMinVisibleSize/15,S.bytesToActualSymbolicSize=A.maxSymbolicSize/255,S.bytesToActualDashLength=A.maxDashLength/3,S.bytesToActualGapLength=A.maxGapLength/3,S.bytesToActualPatternScale=A.maxPatternScale/255}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:f,patternsChanged:g,boundariesChanged:p,textsChanged:_,dimensionsChanged:v,viewChanged:m,currentTimeChanged:y,backgroundColorChanged:b,isBufferDisplayableChanged:x,isHideImagesChanged:E}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)},On.prototype._render=function(t){},On.prototype._beforeFirstFrame=function(){},On.prototype._afterFirstFrame=function(){},On.prototype.destroy=function(){},On.prototype.ensureAnimationsReady=function(){},On.prototype.getImageData=function(){return null},On.prototype.setViewportClipping=function(t){},On);function On(t){var e=t.bufferList,r=t.patternManager,i=t.boundariesManager,n=t.colorManager,o=t.shapeManager,a=t.textManager,s=t.easingManager,u=t.memoryManager;this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._hideImages=!1,this._genericObject=In(),this._littleEndian=D(),this._bufferList=e,this._shapeManager=o,this._patternManager=r,this._boundariesManager=i,this._textManager=a,this._colorManager=n,this._easingManager=s,this._memoryManager=u}var kn,Rn,Fn="#define D3D9_FIX 0\n#define ANIMATED 0\nprecision highp float;\nprecision mediump int;\nattribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_final_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec4 a_final_offsetScaled_offsetFixed_paddingTop_paddingLeft;\nattribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_prev_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec4 a_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft;\nattribute /*float*/ vec2 a_animationBeginTime_animationDuration; \nattribute /*ushort*/ vec4 a_animationEasing; \nattribute /*ushort*/ vec3 a_text_charId_charOffsetXY; \nattribute vec3 a_vertexInfo;\nuniform float u_viewWidth;\nuniform float u_viewHeight;\nuniform float u_viewX;\nuniform float u_viewY;\nuniform float u_viewAngle;\nuniform float u_viewZoom;\nuniform float u_currentTime;\nuniform float u_pixelRatio;\nuniform sampler2D u_patternInfoTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float EPSILON = 0.000001;\nconst float INFINITY = 10000000.0;\nconst float PI = 3.14159265359;\nconst float P2_17 = 131072.0;\nconst float P2_16 = 65536.0;\nconst float P2_14 = 32768.0;\nconst float P2_12 = 4096.0;\nconst float P2_8 = 256.0;\nconst float P2_7 = 128.0;\nconst float P2_6 = 64.0;\nconst float P2_5 = 32.0;\nconst float P2_4 = 16.0;\nconst float P2_3 = 8.0;\nconst float P2_2 = 4.0;\nconst float P2_1 = 2.0;\nuniform float BYTES_TO_COORD;\nuniform float BYTES_TO_SCALED_SIZE;\nuniform float BYTES_TO_MIN_VISIBLE_SIZE;\nuniform float BYTES_TO_SYMBOLIC_SIZE;\nuniform float BYTES_TO_CURVATURE;\nuniform float BYTES_TO_DASH_LENGTH;\nuniform float BYTES_TO_GAP_LENGTH;\nuniform float BYTES_TO_PATTERN_SCALE;\nuniform float PATTERN_POSITION_UNIT_SIZE;\nuniform float PATTERN_INFO_TEXTURE_SIZE;\nuniform float PATTERN_NEAREST_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nuniform float PATTERN_MIPMAP_TEXTURE_SIZE;\nconst float BYTES_TO_OFFSET_ANGLE = 0.0;\nconst float BYTES_TO_COLOR = 0.0;\nconst float SDF_FONT_SIZE = 0.0;\nconst float SDF_GAMMA = 0.0;\nconst float CURVATURE_RATIO = 0.0;\nconst float PATTERN_PADDING = 0.0;\nconst float TEXT_WIDTH_MULTIPLIER = 0.0;\nconst float TEXT_HEIGHT_MULTIPLIER = 0.0;\nconst float SELF_LOOP_CURVATURE_RATIO = 0.0;\nconst float EDGE_ARROW_SIZE_RATIO = 0.0;\nconst float CURVE_SUBDIVISIONS = 0.0;\nconst float PIECE_NODE_COMPONENT = 0.0;\nconst float PIECE_EDGE_BODY = 0.0;\nconst float PIECE_EDGE_HEAD = 0.0;\nconst float PIECE_EDGE_TAIL = 0.0;\nconst float PIECE_EDGE_TEXT = 0.0;\nconst float MAX_TEXT_SIZE = 0.0;\nconst float BYTES_TO_TEXT_OFFSET_X = 0.0;\nconst float BYTES_TO_TEXT_OFFSET_Y = 0.0;\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SHAPE_TEXTURE_SIZE = 0.0;\nconst float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;\nconst float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;\nconst float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;\nconst float MAX_SHAPES = 0.0;\nconst float FIRST_COMPLEX_SHAPE_ID = 0.0;\nconst float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;\nconst float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;\nconst float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;\nconst float T_STEP_PER_CURVE_PIECE = 1.0 / CURVE_SUBDIVISIONS;\nconst float HEAD_TAIL_PX_ADJUST = 1.5;\nconst float SDF_SMOOTH_FACTOR = 2.0;\nstruct nv {\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nfloat oc;\nfloat od;\n};\nstruct oe {\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\n};\nstruct om {\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nfloat oc;\nfloat od;\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\nfloat bu;\nfloat on;\nfloat oo;\nfloat op;\nfloat oq;\nfloat or;\nfloat os;\nvec4 bd;\nvec4 be;\nvec4 bz;\nfloat ot;\nfloat ou;\nfloat ov;\nfloat ow;\nfloat ox;\nfloat oy;\nfloat oz;\nfloat pa;\nfloat pb;\nfloat pc;\nfloat pd;\nfloat pe;\nfloat pf;\nfloat pg;\nfloat ph;\nfloat pi;\nfloat pj;\nfloat pk;\nfloat pl;\n};\nstruct pm {\nfloat pn;\nvec2 po;\nvec4 bd;\nvec4 be;\nfloat bu;\nfloat pp;\nfloat pq;\nfloat ny;\nfloat pr;\nvec2 ps;\nfloat pt;\nvec2 bi;\nvec2 pu;\nvec2 pv;\nfloat pw;\nfloat px;\nvec4 bz;\nvec2 py;\nfloat pz;\nfloat qa;\nvec2 qb;\nvec2 qc;\nvec2 qd;\n};\nfloat qe(float ly, float qf, float qg) {\nfloat qh = mod(ly, pow(2.0, qg));\nreturn floor(qh / pow(2.0, qf));\n}\nnv qi(float ly) {\nnv qj;\nqj.nw = qe(ly, 0.0, 4.0);\nqj.nx = qe(ly, 4.0, 8.0);\nqj.ny = qe(ly, 8.0, 10.0);\nqj.nz = qe(ly, 10.0, 12.0);\nqj.oa = qe(ly, 12.0, 13.0);\nqj.ob = qe(ly, 13.0, 14.0);\nqj.oc = qe(ly, 14.0, 15.0);\nqj.od = qe(ly, 15.0, 16.0);\nreturn qj;\n}\noe qk(float ly) {\noe qj;\nqj.of = qe(ly, 0.0, 8.0);\nqj.og = qe(ly, 8.0, 11.0);\nqj.oh = qe(ly, 11.0, 12.0);\nqj.oi = qe(ly, 12.0, 13.0);\nqj.oj = qe(ly, 13.0, 14.0);\nqj.ok = qe(ly, 14.0, 15.0);\nqj.ol = qe(ly, 15.0, 16.0);\nreturn qj;\n}\nvec4 ql(in float ly) {\nreturn vec4(\nqe(ly, 0.0, 4.0),\nqe(ly, 4.0, 8.0),\nqe(ly, 8.0, 12.0),\nqe(ly, 12.0, 16.0)\n);\n}\nvec2 qm(in float ly) {\nreturn vec2(mod(ly, 256.0), floor(ly / 256.0));\n}\nvec2 qn(in float ly) {\nfloat qo = floor(ly / P2_6);\nfloat qp = ly - (qo * P2_6);\nreturn vec2(qo, qp);\n}\nvec2 qq(in float ly) {\nfloat qr = floor(ly / P2_7);\nfloat qs = ly - (qr * P2_7);\nreturn vec2(qr, qs);\n}\nvec2 qt(in vec2 qu, in float qv) {\nfloat qw = cos(qv);\nfloat qx = sin(qv);\nreturn vec2(qw * qu.x + qx * qu.y, -qx * qu.x + qw * qu.y);\n}\nvec4 qy(in vec4 qz) {\nreturn floor(qz / 256.0) - 128.0;\n}\nvec4 ra(in vec4 qz) {\nreturn mod(qz, 256.0) - 128.0;\n}\nfloat rb(float ly) {\nreturn ly - 128.0;\n}\nvec2 rb(vec2 ly) {\nreturn ly - 128.0;\n}\nvec2 rc(vec2 rd) {\nreturn vec2(-rd.y, rd.x);\n}\nvec2 re(vec2 rf, vec2 gj, vec2 rg, float t) {\nfloat rh = 1.0 - t;\nreturn (rh * rh * rf) + (2.0 * rh * t * gj) + (t * t * rg);\n}\nvec2 ri(vec2 rf, vec2 rj, vec2 rk, vec2 rg, float t) {\nfloat rh = 1.0 - t;\nfloat rl = rh * rh;\nfloat rm = rl * rh;\nfloat rn = t * t;\nfloat ro = rn * t;\nreturn (rm * rf) + (3.0 * rl * t * rj) + (3.0 * rh * rn * rk) + (ro * rg);\n}\nvec2 rp(vec2 rf, vec2 gj, vec2 rg, float t) {\nfloat rh = (1.0 - t);\nvec2 qu = (rh * gj + t * rg) - (rh * rf + t * gj);\nreturn normalize(qu);\n}\nvec2 rq(vec2 rf, vec2 gj, vec2 rg, float t) {\nreturn rc(rp(rf, gj, rg, t));\n}\nvec2 rr(vec2 rf, vec2 rj, vec2 rk, vec2 rg, float t) {\nfloat rh = 1.0 - t;\nfloat rl = rh * rh;\nfloat rn = t * t;\nvec2 qu = rl * (rj - rf) + 2.0 * rh * t * (rk - rj) + rn * (rg - rk);\nreturn normalize(qu);\n}\nvec2 rs(vec2 rf, vec2 rj, vec2 rk, vec2 rg, float t) {\nreturn rc(rr(rf, rj, rk, rg, t));\n}\nfloat sd(float or, float se, float t) {\nfloat y = abs(or) / CURVATURE_RATIO + EPSILON;\nfloat ow = y * y;\nfloat rh = t - 0.5;\nfloat rl = rh * rh;\nfloat sf = 1.0 / (16.0 * ow);\nfloat sg = sqrt(rl + sf);\nfloat sh = (0.5 / y) * sqrt(ow + 0.25);\nfloat si = (abs(2.0 * y)) * ((rh * sg) + (0.5 * sh) + (sf * log(abs((rh + sg) / (-0.5 + sh)))));\nreturn si * se;\n}\nfloat sj(vec2 rf, vec2 sk, vec2 sl, vec2 rg, float sm) {\nvec2 py = (rf + sk + sl) / 3.0;\nvec2 sn = py - sk;\nvec2 so = sk - sl;\nfloat sp = dot(sn, sn);\nfloat sq = dot(so, so) / 4.0;\nfloat sy = sqrt(sp - sq) * SELF_LOOP_TO_CIRCLE_APPROX * 1.55;\nreturn 2.0 * PI * sy * sm;\n}\nfloat sz(float ly) {\nreturn ly - 32.0;\n}\nfloat ta(float ly) {\nreturn ly - 512.0;\n}\nfloat tb(float ly) {\nreturn ly - P2_14;\n}\nvoid tc() {\ngl_Position = vec4(-10.0, -10.0, 1.0, 1.0);\n}\nvec4 td(vec2 te) {\nreturn vec4(((vec2(te.x, u_viewHeight - te.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);\n}\nfloat ti(float ap, float aq) {\nreturn step(ap - EPSILON, aq) * step(aq, ap + EPSILON);\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nbool tj(float ly) {\nreturn ly > 0.5;\n}\nvec2 tk(vec2 tl) {\nreturn qt((tl - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;\n}\nfloat tm(float qa) {\nreturn qa * EDGE_ARROW_SIZE_RATIO;\n}\nfloat tn(float to, float tp) {\nreturn to * BYTES_TO_SCALED_SIZE * u_viewZoom + tp;\n}\nfloat tv(float pp, float tt, float tu) {\nfloat tw = tu - tt;\nfloat a = 1.0 / tw;\nfloat b = -tt / tw;\nreturn pp * a + b;\n}\nstruct tx {\nvec2 ty;\nvec2 tz;\n};\ntx ua(vec2 ub, float sy, float or) {\ntx ma;\nfloat uc = (sy + sy / SELF_LOOP_CURVATURE_RATIO * or) * SELF_LOOP_CURVATURE_RATIO;\nfloat ud = -u_viewAngle + PI;\nfloat ue = -u_viewAngle + PI / 2.0;\nma.ty = ub + vec2(cos(ud), sin(ud)) * uc;\nma.tz = ub + vec2(cos(ue), sin(ue)) * uc;\nreturn ma;\n}\nfloat uj(vec2 uk, vec2 sk, vec2 sl, vec2 ul, float um) {\nvec2 un = uk;\nfloat t = 0.0;\nfloat uo = 0.0;\nfloat up = sj(uk, sk, sl, ul, 1.0);\nreturn um / up;\n}\nom uq(\nvec4 ur,\nvec4 us,\nvec4 ut,\nvec4 uu,\nvec4 uv,\nvec4 uw,\nvec3 ux\n) {\nom a;\nnv ax = qi(ur.x);\noe uy = qk(ur.y);\nvec4 uz = ql(ur.z);\nvec2 va = qm(ur.w);\na.nw = ax.nw;\na.nx = ax.nx;\na.ny = ax.ny;\na.nz = ax.nz;\na.oa = ax.oa;\na.ob = ax.ob;\na.oc = ax.oc;\na.od = ax.od;\na.of = uy.of;\na.og = uy.og;\na.oh = uy.oh;\na.oi = uy.oi;\na.oj = uy.oj;\na.ok = uy.ok;\na.ol = uy.ol;\na.bu = uz.x;\na.on = uz.y;\na.oo = uz.z;\na.op = uz.w;\na.oq = va.x;\na.or = va.y;\na.os = us.x;\na.bd = ql(us.y);\na.be = ql(us.z);\na.bz = ql(us.w);\na.ot = ut.x;\na.ou = ut.y;\na.ov = ut.z;\na.ow = ut.w;\na.ox = uu.x;\na.oy = uu.y;\na.oz = uu.z;\na.pa = uu.w;\na.pb = uv.x;\na.pc = uv.y;\na.pd = uv.z;\na.pe = uv.w;\na.pf = uw.x;\na.pg = uw.y;\na.pk = tb(uw.z);\na.pl = tb(uw.w);\na.ph = ux.x;\nfloat x = ux.y;\nfloat y = mod(x, P2_8);\nif (ux.z > 0.0) x += ux.z * P2_16;\na.pi = ((x - y) / P2_8) - P2_16;\na.pj = (y - P2_7) * BYTES_TO_TEXT_OFFSET_Y;\nreturn a;\n}\n/**\n* vq a pm cj aa vr om.\n* dw dx cy dm vs vt, aa vr om ds dm\n* vu fx aa vv bg vw vx cy aa vt,\n* vy dj aa vz wa.\n*/\nbool wb(const in om a, out pm ma) {\nfloat nw = a.nw;\nfloat nx = a.nx;\nfloat ny = a.ny * BYTES_TO_DASH_LENGTH;\nfloat nz = a.nz * BYTES_TO_GAP_LENGTH;\nfloat oa = a.oa;\nfloat ob = a.ob;\nfloat oc = a.oc;\nfloat od = a.od;\nfloat of = a.of * BYTES_TO_PATTERN_SCALE;\nfloat og = a.og * BYTES_TO_OFFSET_ANGLE;\nfloat oh = a.oh;\nfloat oi = a.oi;\nfloat oj = a.oj;\nfloat ok = a.ok;\nfloat ol = a.ol;\nfloat bu = a.bu * BYTES_TO_COLOR;\nfloat on = a.on * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat oo = a.oo * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat op = a.op * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat oq = a.oq * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom + step(a.oq, EPSILON) * INFINITY;\nfloat or = rb(a.or);\nfloat os = a.os;\nvec4 bd = a.bd * BYTES_TO_COLOR;\nvec4 be = a.be * BYTES_TO_COLOR;\nvec4 bz = a.bz * BYTES_TO_COLOR;\nvec2 wc = vec2(a.ot, a.ou) * BYTES_TO_COORD;\nvec2 wd = vec2(a.ov, a.ow) * BYTES_TO_COORD;\nvec2 uk = tk(wc);\nvec2 ul = tk(wd);\nfloat we = tn(a.ox, a.oy);\nfloat wf = tn(a.oz, a.pa);\nfloat wg = tn(a.pb, a.pc);\nfloat pn = tn(a.pd, a.pe);\nfloat vb = tn(a.pf, a.pg);\nvec2 wh = a_vertexInfo.xy;\nvec2 wi = vec2(0.0, 0.0);\nfloat wj = we;\nfloat wk = wf;\nfloat wl = wf * of;\nif (oh > EPSILON) {\nif (a.ph < EPSILON) return false;\nwl = wg;\nos = a.ph;\nwe = wl * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;\nwf = wl * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;\n}\nbool xe = abs(or) > EPSILON && ti(nx, PIECE_EDGE_BODY) < EPSILON;\nbool xf = xe && a_vertexInfo.z > EPSILON;\nif (nw < EPSILON || nx < EPSILON || oq < on || xf) {\nreturn false;\n}\npn *= step(oo, oq);\nfloat xs = 0.0;\nfloat xt = 1.0;\nfloat xp = 0.0;\nfloat xr = 1.0;\nfloat xu = 0.0;\nfloat ye = 1.0;\nfloat yg = 1.0;\nfloat yr = 0.0;\nfloat ys = 0.0;\nvec2 py;\nvec2 qb;\nvec2 qc;\nvec2 qd;\nfloat qa;\nfloat pz;\nfloat zl = 0.0;\nfloat zm = 1.0;\nif (ti(nx, PIECE_NODE_COMPONENT) > EPSILON) {\npy = ceil((uk + ul) / 2.0);\nqb = normalize(vec2(wd.x - wc.x + 0.001, wc.y - wd.y));\nqc = rc(qb);\nqd = qc;\nqa = we;\npz = wf;\n} else {\nyg = 0.0;\nfloat aaa = distance(uk, ul);\nvec2 aab = normalize(ul - uk);\nvec2 aac = (uk + ul) / 2.0;\nvec2 aad = rc(aab);\nvec2 aae = aac + (aad * aaa * -or / CURVATURE_RATIO);\nif (ti(nx, PIECE_EDGE_TEXT) > 0.0) {\nfloat aaf;\nfloat aag = pn;\npn = 0.0;\nif (od > EPSILON) {\ntx gj = ua(uk, aag / 2.0, or);\npy = ri(uk, gj.ty, gj.tz, ul, 0.5);\nqb = rr(uk, gj.ty, gj.tz, ul, 0.5);\nqc = rc(qb);\nqd = qc;\naaf = sj(uk, gj.ty, gj.tz, ul, 0.5);\n} else if (abs(or) > EPSILON) {\npy = re(uk, aae, ul, 0.5);\nqb = rp(uk, aae, ul, 0.5);\nqc = rc(qb);\nqd = qc;\naaf = sd(or, aaa, 1.0);\n} else {\npy = aac;\nqb = aab;\nqc = aad;\nqd = aad;\naaf = aaa;\n}\nqa = we;\npz = wf;\nif(wj > aaf - aag && od < EPSILON){\nif(oi > EPSILON){\nqb = vec2(1.0, 0.0);\nqc = vec2(0.0, 1.0);\nqd = vec2(0.0, 1.0);\n} else {\nqb = vec2(0,0);\nqc = vec2(0.0, 0.0);\nqd = vec2(0.0, 0.0);\n}\n} else {\nfloat qv = -atan(qb.y, qb.x);\nzl = qv;\nog -= qv;\nif ((qv > PI / 2.0 || qv < -PI / 2.0)) {\nog += (1.0 - od) * PI;\nzm = -1.0;\nqb *= -1.0;\nqc *= -1.0;\nqd *= -1.0;\n}\n}\n} else {\nfloat yk = wg;\nfloat aao = we;\nfloat aap = wf;\nfloat aaq = oa + ob;\nfloat aar = tm(yk);\nfloat aas = oa * aar;\nfloat aat = ob * aar;\nfloat aau = ti(nx, PIECE_EDGE_HEAD);\nfloat aav = ti(nx, PIECE_EDGE_TAIL);\nfloat aaw = INFINITY * od + aaa - aao - aap;\nfloat aax = min(aaw / aaq, aar);\nfloat abg =\nob * (aar + max(aao + aax - aat, 0.0))\n+ (1.0 - ob) * oc * aao;\nfloat abh =\noa * (aar + max(aap + aax - aas, 0.0))\n+ (1.0 - oa) * oc * aap;\nif (aau > EPSILON || aav > EPSILON) {\nvec2 abk = aau * ul + aav * uk;\nfloat vb = aau * abh + aav * abg + (HEAD_TAIL_PX_ADJUST - 0.5);\nfloat abl = aau * aas + aav * aat;\nvec2 abm;\nif (od > EPSILON) {\ntx gj = ua(uk, aao, or);\nfloat aaf = sj(uk, gj.ty, gj.tz, ul, 1.0);\nfloat um = aau * (aaf - abh) + aav * abg;\nfloat t = uj(uk, gj.ty, gj.tz, ul, um);\nabm = ri(uk, gj.ty, gj.tz, ul, t);\n} else {\nfloat aaf = sd(or, aaa, 1.0);\nfloat t = (aau * (aaf - abh) + aav * abg) / aaf;\nabm = re(uk, aae, ul, t);\n}\nqb = normalize(abk - abm);\nqc = rc(qb);\nqd = qc;\npy = abk - qb * (vb - abl / 2.0);\nqa = abl;\npz = abl;\nny = 0.0;\nnz = 0.0;\n} else {\nfloat abq;\nfloat abr;\nfloat abt;\nif (abs(or) < EPSILON) {\npy = aac;\nqb = aab;\nqc = aad;\nqd = qc;\nqa = aaa;\nabq = aaa;\nabr = 0.0;\nabt = aaa;\n} else {\nfloat abv = a_vertexInfo.z;\nfloat abw = abv * T_STEP_PER_CURVE_PIECE;\nfloat rn = abw + T_STEP_PER_CURVE_PIECE;\nif (od < EPSILON) {\nvec2 abx = re(uk, aae, ul, abw);\nvec2 aby = re(uk, aae, ul, rn);\npy = (abx + aby) / 2.0;\nqb = normalize(aby - abx);\nqc = rq(uk, aae, ul, abw);\nqd = rq(uk, aae, ul, rn);\nqa = distance(abx, aby);\nabq = sd(or, aaa, 1.0);\nabr = sd(or, aaa, abw);\nabt = sd(or, aaa, rn);\n} else {\ntx gj = ua(uk, aao, or);\nvec2 sk = gj.ty;\nvec2 sl = gj.tz;\nvec2 abx = ri(uk, sk, sl, ul, abw);\nvec2 aby = ri(uk, sk, sl, ul, rn);\npy = (abx + aby) / 2.0;\nqb = normalize(aby - abx);\nqc = rs(uk, sk, sl, ul, abw);\nqd = rs(uk, sk, sl, ul, rn);\nqa = distance(abx, aby);\nabq = sj(uk, sk, sl, ul, 1.0);\nabr = sj(uk, sk, sl, ul, abw);\nabt = sj(uk, sk, sl, ul, rn);\n}\n}\npz = wg;\nxp = (abg - 1.0) / abq;\nxr = 1.0 - (abh - HEAD_TAIL_PX_ADJUST) / abq;\nxs = abr / abq;\nxt = abt / abq;\nxu = abq;\nif (oc > 0.0 && aaw > 5.0) {\nfloat ace = (abq * pz) / (abq - abg);\nfloat up = abq;\nfloat ot = abg;\nfloat ov = abq - abh;\nfloat a = -ace / up;\nfloat b = ace;\nfloat ou = a * ot + b;\nfloat ow = a * ov + b;\nfloat acf = ou / (ot - ov);\nfloat acg = -acf * ov;\npz = acg;\nys = acf * up + acg + 1.0;\n}\n}\n}\n}\nvec2 bi = vec2(0.0, 0.0);\nvec2 pu = vec2(EPSILON, EPSILON);\nvec2 pv = vec2(-EPSILON, -EPSILON);\nfloat pw = -1.0;\nfloat px = 0.0;\nbool ach = false;\nvec2 aci = vec2(0,0);\nvec2 acj = vec2(0,0);\nvec2 ack = vec2(0,0);\nif (os > EPSILON && oq > op) {\nfloat acn = floor(os / PATTERN_INFO_TEXTURE_SIZE);\nfloat aco = os - (acn * PATTERN_INFO_TEXTURE_SIZE);\nvec4 acp = texture2D(u_patternInfoTexture, vec2(aco, acn) / 255.0) * 255.0;\nvec2 acq = qq(acp.z);\nvec2 acr = qq(acp.w);\npw = acq.x * 2.0 + acr.x;\nfloat acs = 0.0;\nif (ao(pw, FILTER_NEAREST)) { \nacs = PATTERN_NEAREST_TEXTURE_SIZE;\n} else if (ao(pw, FILTER_LINEAR)) { \nacs = PATTERN_LINEAR_TEXTURE_SIZE;\n} else if (ao(pw, FILTER_LINEAR_SDF)) { \nacs = PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nach = true;\n} else if (ao(pw, FILTER_MIPMAP)) { \nacs = PATTERN_MIPMAP_TEXTURE_SIZE;\n}\nfloat acv = 1.0 / acs;\nvec2 acw = (vec2(acq.y, acr.y) * PATTERN_POSITION_UNIT_SIZE) * acv / 2.0;\nacj += (acp.xy * PATTERN_POSITION_UNIT_SIZE * acv) + acw;\nacj += PATTERN_PADDING * acv;\nacw -= PATTERN_PADDING * acv * 2.0;\nvec2 acx = vec2(qa / 2.0, pz / 2.0) * acv;\nvec2 acy = vec2(pn, pn) * acv;\nfloat ada = 1.0 * u_pixelRatio;\nfloat adb = SDF_SMOOTH_FACTOR;\nif (of > EPSILON) {\nif (ach) { \nif (a.oj > EPSILON) {\nadb = SDF_SMOOTH_FACTOR * u_pixelRatio / SDF_GAMMA;\naci = vec2(-a.pl,-a.pk) / (1.0 /of);\n}\npx = adb * SDF_GAMMA / wl / u_pixelRatio;\nada = SDF_FONT_SIZE / wl;\n} else { \nada = (acw.y / acx.y) / of;\n}\n}\nack = (acx + acy) * ada;\nacw += PATTERN_PADDING * acv;\npu = acj - acw;\npv = acj + acw;\n}\nif (oh > EPSILON) {\nwi.y = (a.pj) * wl;\nye = 0.0;\nyg = 0.0;\nwi.x = a.pi * wl * BYTES_TO_TEXT_OFFSET_X;\nwi += vec2(1.0, 1.0);\nwi = qt(wi, zl);\nwi *= zm;\n}\nvec2 adg = vec2(cos(og), sin(og)) * vb;\nvec2 adh = py + adg + wi;\nfloat adi = pn * 2.0;\nfloat adj = qa + yg * (adi + 1.0);\nfloat adk = pz + ye * (adi + 1.0);\nvec2 adl = qb * adj / 2.0;\nvec2 adm = qc * adk / 2.0;\nvec2 adn = qd * adk / 2.0;\nfloat ado = (xt - xs);\nfloat adp = wh.x / 2.0 + 0.5;\nfloat pp = xs + ado * adp;\nfloat pt = yr + (ys - yr) * pp / 2.0;\nfloat adq = step(nw, FIRST_COMPLEX_SHAPE_ID - EPSILON);\nfloat adr = adq * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - adq) * COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat ads = adr / COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat adt = ads * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;\nfloat adu = ads * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);\nvec2 aec = vec2(\nmod(nw, NB_SHAPES_BY_SIDE),\nfloor(nw / NB_SHAPES_BY_SIDE)\n);\nvec2 aed = aec + vec2(adt) +\nvec2(xs * adu, 0.0);\nvec2 aeg = vec2(ado, 1.0) * adu;\nvec2 po = (aed + aeg * (wh / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;\nvec2 ps = vec2(adj / ado, adk) / 2.0;\nfloat aen = ny * wg;\nfloat aeo = nz * wg;\nfloat pq = aen + aeo;\nfloat pr = (pp * xu) / pq;\nbi = acj\n+ ack\n* (wh + aci/ps* u_viewZoom * 2.0);\nma.po = po;\nma.ps = ps;\nma.pn = pn;\nma.bd = bd;\nma.be = be;\nma.bu = bu;\nma.pp = tv(pp, xp, xr);\nma.pq = pq;\nma.ny = aen;\nma.pr = pr;\nma.pt = pt;\nma.bi = bi;\nma.pu = pu;\nma.pv = pv;\nma.pw = pw;\nma.px = px;\nma.bz = bz;\nma.py = adh;\nma.qa = adj;\nma.pz = adk;\nma.qb = qb;\nma.qc = qc;\nma.qd = qd;\nreturn true;\n}\nfloat aer(float aes, float aet, vec4 aeu) {\nfloat aev = clamp(((u_currentTime - aes) / aet), 0.0, 1.0);\nfloat r = aev;\nfloat aew = r * r;\nfloat aex = aew * r;\nvec4 aey = aev < 0.5 ? qy(aeu) : ra(aeu);\nfloat aez = aey.x;\nfloat afa = aey.y;\nfloat afb = aey.z;\nfloat afc = aey.w;\nfloat afd = aez + afa * r + afb * aew + afc * aex;\nreturn afd;\n}\nvoid main() {\nom a_final = uq(\na_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_final_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_final_x1_y1_x2_y2,\na_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_final_offsetScaled_offsetFixed_paddingTop_paddingLeft,\na_text_charId_charOffsetXY\n);\n#if ANIMATED\nfloat aes = a_animationBeginTime_animationDuration.x;\nfloat aet = a_animationBeginTime_animationDuration.y;\nvec4 aeu = a_animationEasing;\nfloat wa = aer(aes, aet, aeu);\nom a_prev = uq(\na_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_prev_x1_y1_x2_y2,\na_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_prev_offsetScaled_offsetFixed_paddingTop_paddingLeft,\na_text_charId_charOffsetXY\n);\nconst float ONE = 1.0;\na_final.nw = mix(a_prev.nw, a_final.nw, ONE);\na_final.ny = mix(a_prev.ny, a_final.ny, wa);\na_final.nz = mix(a_prev.nz, a_final.nz, wa);\na_final.oa = mix(a_prev.oa, a_final.oa, ONE);\na_final.ob = mix(a_prev.ob, a_final.ob, ONE);\na_final.nx = mix(a_prev.nx, a_final.nx, ONE);\na_final.of = mix(a_prev.of, a_final.of, ONE);\na_final.oh = mix(a_prev.oh, a_final.oh, ONE);\na_final.oi = mix(a_prev.oi, a_final.oi, ONE);\na_final.oj = mix(a_prev.oj, a_final.oj, ONE);\na_final.ok = mix(a_prev.ok, a_final.ok, ONE);\na_final.od = mix(a_prev.od, a_final.od, ONE);\na_final.og = mix(a_prev.og, a_final.og, wa);\na_final.bu = mix(a_prev.bu, a_final.bu, wa);\na_final.on = mix(a_prev.on, a_final.on, wa);\na_final.oo = mix(a_prev.oo, a_final.oo, wa);\na_final.op = mix(a_prev.op, a_final.op, wa);\na_final.oq = mix(a_prev.oq, a_final.oq, wa);\na_final.or = mix(a_prev.or, a_final.or, wa);\na_final.os = mix(a_prev.os, a_final.os, ONE);\na_final.bd = mix(a_prev.bd, a_final.bd, wa);\na_final.be = mix(a_prev.be, a_final.be, wa);\na_final.bz = mix(a_prev.bz, a_final.bz, wa);\na_final.ot = mix(a_prev.ot, a_final.ot, wa);\na_final.ou = mix(a_prev.ou, a_final.ou, wa);\na_final.ov = mix(a_prev.ov, a_final.ov, wa);\na_final.ow = mix(a_prev.ow, a_final.ow, wa);\na_final.ox = mix(a_prev.ox, a_final.ox, wa);\na_final.oy = mix(a_prev.oy, a_final.oy, wa);\na_final.oz = mix(a_prev.oz, a_final.oz, wa);\na_final.pa = mix(a_prev.pa, a_final.pa, wa);\na_final.pb = mix(a_prev.pb, a_final.pb, wa);\na_final.pc = mix(a_prev.pc, a_final.pc, wa);\na_final.pd = mix(a_prev.pd, a_final.pd, wa);\na_final.pe = mix(a_prev.pe, a_final.pe, wa);\na_final.pf = mix(a_prev.pf, a_final.pf, wa);\na_final.pg = mix(a_prev.pg, a_final.pg, wa);\na_final.ph = mix(a_prev.ph, a_final.ph, ONE);\na_final.pi = mix(a_prev.pi, a_final.pi, ONE);\na_final.pj = mix(a_prev.pj, a_final.pj, ONE);\n#endif\npm ma;\nbool afh = wb(a_final, ma);\nif (!afh) {\ntc();\nreturn;\n}\nvec2 wh = a_vertexInfo.xy;\na = ma.bd;\nb = ma.be;\nc = ma.bz;\nd = ma.po;\ne = ma.bi;\n#if D3D9_FIX\n#else\nj = ma.pn;\nk = ma.pu;\nl = ma.pv;\nm = vec2(ma.bu, ma.pt);\nn = ma.pp;\no = ma.pq;\np = vec2(ma.ny, ma.pr);\nq = ma.ps;\nr = ma.px;\ns = ma.pw;\n#endif\nfloat afk = step(wh.x, 0.0);\nfloat afl = 1.0 - afk;\nvec2 te = ma.py\n+ (ma.qb * (ma.qa / 2.0) * wh.x)\n+ ((afk * ma.qc + afl * ma.qd) * (ma.pz / 2.0) * wh.y);\ngl_Position = td(te);\n}\n",Dn="#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SDF_GAMMA = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 ax = texture2D(u_shapeTexture, d);\nfloat ay = aj(ax.b, ax.a) * q.x;\nfloat az = aj(ax.r, ax.g) * q.y;\naz += as;\nfloat bc = min(ay, az);\nvec4 bd = a;\nvec4 be = b;\nif (s > -EPSILON) {\nvec2 bi = e;\nfloat bv =\nstep(k.x, bi.x) *\nstep(bi.x, l.x) *\nstep(k.y, bi.y) *\nstep(bi.y, l.y);\nfloat bw = bv;\nvec4 bz;\nif (ao(s, FILTER_NEAREST)) {\nbz = texture2D(u_patternNearestTexture, bi);\n} else if (ao(s, FILTER_LINEAR)) { \nbz = texture2D(u_patternLinearTexture, bi);\n} else if (ao(s, FILTER_LINEAR_SDF)) { \nbz = texture2D(u_patternLinearSdfTexture, bi);\nbz.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bz.a);\n} else if (ao(s, FILTER_MIPMAP)) { \nbz = texture2D(u_patternMipmapTexture, bi);\n}\nbz.rgb += c.rgb;\nbz.a *= bw;\nbd = ad(bd, bz);\n}\nfloat cl = clamp(bc, 0.0, 1.0);\nfloat cm = clamp(bc - j, 0.0, 1.0);\nfloat cn = cl - cm;\ncn = 1.0 - clamp(bc - j, 0.0, 1.0);\nbd.a *= cm;\nbe.a *= cn;\nvec4 co = ad(bd, be);\nfloat cp = cl;\nco.rgb = mix(u_backgroundColor, co.rgb, ar);\nif (o > EPSILON) {\nfloat de = fract(au) * o;\nfloat df = clamp(min(de, at - de), 0.0, 1.0);\ncp *= df;\n}\nif (n < 0.0 || n > 1.0 || cp < EPSILON) {\ndiscard;\n}\nco.a *= cp;\nco.rgb *= co.a;\ngl_FragColor = co;\n}\n";(Rn=kn=kn||{})[Rn.INIT=0]="INIT",Rn[Rn.COMPILING=1]="COMPILING",Rn[Rn.DONE=2]="DONE";var Pn=(zn.prototype.setConstant=function(t,value){this._constants[t]=value},zn.prototype.setMacro=function(t,value){this._macros[t]=value},zn.prototype.getState=function(){return this._state},zn.prototype.getProgram=function(){return this._program},zn.prototype.compile=function(){var t=this._gl,e=Bn(this._vertexSource,this._macros,this._constants),r=Bn(this._fragmentSource,this._macros,this._constants);this._program&&(t.deleteProgram(this._program),t.deleteShader(this._vertexShader),t.deleteShader(this._fragmentShader));var i=t.createProgram(),n=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER);if(!(i&&n&&o))throw new Error("Error instantiating WebGL program");this._program=i,this._vertexShader=n,this._fragmentShader=o,t.shaderSource(this._vertexShader,e),t.compileShader(this._vertexShader),t.attachShader(this._program,this._vertexShader),t.shaderSource(this._fragmentShader,r),t.compileShader(this._fragmentShader),t.attachShader(this._program,this._fragmentShader),t.linkProgram(this._program),this._state=kn.COMPILING},zn.prototype.getError=function(){var t=this._gl;return t.getShaderParameter(this._vertexShader,t.COMPILE_STATUS)?t.getShaderParameter(this._fragmentShader,t.COMPILE_STATUS)?t.getProgramParameter(this._program,t.LINK_STATUS)?(this._state=kn.DONE,null):{step:"link",message:t.getProgramInfoLog(this._program)||""}:{step:"fragment",message:t.getShaderInfoLog(this._fragmentShader)||""}:{step:"vertex",message:t.getShaderInfoLog(this._vertexShader)||""}},zn);function zn(t,e){var r=e.vertex,i=e.fragment,n=e.constants,o=e.macros;this._state=kn.INIT,this._gl=t,this._vertexSource=r,this._fragmentSource=i,this._constants=j(n||{}),this._macros=j(o||{})}function Bn(t,e,r){for(var i=Object.keys(e),n=Object.keys(r),o=0;o<i.length;++o){var a=i[o],s=e[a];t=t.replace("#define "+a+" 0","#define "+a+" "+s)}for(o=0;o<n.length;++o){var u=n[o],value=r[u],l=value+(value%1==0?".0":"");t=t.replace("const float "+u+" = 0.0;","const float "+u+" = "+l+";")}return t}var Un,Vn,jn=0,Gn=((Un={})[0]={min:"NEAREST",mag:"NEAREST",mipmap:!1},Un[1]={min:"LINEAR",mag:"LINEAR",mipmap:!1},Un[2]={min:"LINEAR",mag:"LINEAR",mipmap:!1},Un[3]={min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0},Un),Hn=((Vn={})[jn]="ALPHA",Vn[1]="RGBA",Vn);function qn(value){return Math.ceil((value+2*nn)/rn)*rn}function Wn(t,e,r,i,n){for(var o=0,a=t.length;o<a;++o){var s=t[o],u=s.x,l=s.y,d=u+i,h=l+n,c=d<r&&h<r;if(c)for(var f=u;f<d;++f)if(1===e[f+l*r]){c=!1;break}if(c)for(f=l;f<h;++f)if(1===e[u+f*r]){c=!1;break}if(c){for(f=u;f<d;++f)for(var g=l;g<h;++g)e[f+g*r]=1;return t.splice(o,1),t.push({x:u,y:h},{x:d,y:l}),s}}return null}function Xn(t,e,r,i,n,o,a){var s=4*t,u=e>>1<<7,l=e%2<<7;a[s]=r/rn,a[1+s]=i/rn,a[2+s]=u+n/rn,a[3+s]=l+o/rn}function Yn(t,e,r,i,n,o,a){i|=0,n|=0,o|=0,a|=0,e|=0;for(var s=0;s<o;++s)for(var u=0;u<a;++u){var l=4*(i+s+(n+u)*e),d=4*(s+u*o);t[l]=r[d],t[1+l]=r[1+d],t[2+l]=r[2+d],t[3+l]=r[3+d]}}function Zn(t,e){for(var r=0,i=4,n=0;n<t.length;++n){var o=t[n],a=o.width,s=o.height,u=qn(a),l=qn(s);r+=u*l,i=Math.max(i,Math.max(u,l))}var d=qe(Math.max(i,Math.sqrt(r)));return Math.min(d,e)}function Kn(t,e){return Math.floor((e-t)/2)}function Qn(t,e,r,i,n,o,a){var s=Gn[o],u=s.min,l=s.mag,d=s.mipmap,h=t[Hn[a]];if(a===jn){for(var c=new Uint8Array(n*n),f=0;f<c.length;++f)c[f]=i[4*f+3];i=c}t.activeTexture(t.TEXTURE0+r),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,h,n,n,0,h,t.UNSIGNED_BYTE,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[l]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[u]),d&&t.generateMipmap(t.TEXTURE_2D)}function Jn(t,e,r,i,n){for(var o=new Uint8Array(r*r*4),a=Math.ceil(r/rn),s=new Uint8Array(a*a),u=[{x:0,y:0}],l=0;l<e.length;++l){var d=e[l],h=d.id,c=qn(d.width)/rn,f=qn(d.height)/rn,g=Wn(u,s,a,c,f);if(g){var p=d.width,_=d.height,v=d.pixels,m=c*rn,y=f*rn,b=g.x*rn+Kn(p,m),x=g.y*rn+Kn(_,y);Yn(o,r,v,b,x,p,_),Xn(h,t,b,x,m,y,n)}else{if(r<i)return Jn(t,e,2*r,i,n);Tr("exceeded max WebGL texture size of "+i+"; some texts/icons/images won't be displayed"),Xn(h,t,0,0,0,0,n)}}return{texture:o,size:r}}function $n(t,e,r,i){for(var n=t.getDistanceFromStrokeVertically,o=t.getDistanceFromStrokeHorizontally,a=e*(1-r)/2,s=(e-1)/2,u=0;u<e;++u)for(var l=0;l<e;++l){var d=4*(l*e+u),h=(u-s)/a,c=(l-s)/a,f=Xe(n(h,c),-1,1),g=Xe(o(h,c),-1,1);eo(i,d,to(f),to(g))}}function to(value){return 32768*((value+1)/2)}function eo(t,e,r,i){t[e]=r>>8,t[e+1]=r%256,t[e+2]=i>>8,t[e+3]=i%256}function ro(t,e){for(var r=-Math.PI/2,i=2*Math.PI/t.length,n=0,o=t;n<o.length;n++){var a=r+i;e(o[n],r,a),r=a}}function io(i,t,n,o,a){ro(t,function(t,e,r){i.beginPath(),i.moveTo(n,o),i.arc(n,o,a,e,r),i.fillStyle=t,i.fill()})}var no=(oo.prototype.refresh=function(t){for(var e=0,r=t.getShapeList();e<r.length;e++){var i=r[e];if(!this._shapesWritten.includes(i.id)){var n=i.isSimple?32:$i,o=i.isSimple?this._simpleShapePixels:this._complexShapePixels;$n(i,n,1/16,o),this._loadShapeInGpu(i.id,n,o),this._shapesWritten.push(i.id)}}},oo.prototype._loadShapeInGpu=function(t,e,r){var i=this._gl,n=en,o=t%tn*$i,a=Math.floor(t/tn)*$i;if(this._texture)i.bindTexture(i.TEXTURE_2D,this._texture);else{var s=new Uint8Array(n*n*4);this._texture=i.createTexture(),i.activeTexture(i.TEXTURE0+this._glTextureUnit),i.bindTexture(i.TEXTURE_2D,this._texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,n,n,0,i.RGBA,i.UNSIGNED_BYTE,s)}i.texSubImage2D(i.TEXTURE_2D,0,o,a,e,e,i.RGBA,i.UNSIGNED_BYTE,r)},oo.prototype.getTextureSize=function(){return en},oo.prototype.getSamplingSize=function(){return $i},oo.prototype.getBufferRatio=function(){return 1/16},oo.prototype.getTextureUnit=function(){return this._glTextureUnit},oo);function oo(t,e){this._gl=t,this._glTextureUnit=e,this._simpleShapePixels=new Uint8Array(4096),this._complexShapePixels=new Uint8Array(65536),this._shapesWritten=[]}var ao=1e20,so=(uo.prototype.setOptions=function(t){var e=t.fontSize,r=void 0===e?24:e,i=t.buffer,n=void 0===i?8:i,o=t.cutoff,a=void 0===o?.25:o,s=t.radius,u=void 0===s?6:s;this._fontSize=r,this._buffer=n,this._cutoff=a,this._radius=u,this._height=Math.ceil(this._fontSize+2*this._buffer*1.5)},uo.prototype.draw=function(t,e,r){Sn(this._ctx,e,this._fontSize,r);var value,i=this._ctx.measureText(t).width+2*this._buffer,n=(value=i,Math.ceil((value+2*nn)/rn)*rn-2*nn),o=this._height,a=n*o,s=Math.max(n,o);this._canvas.width<n&&(this._canvas.width=n,Sn(this._ctx,e,this._fontSize,r),this._ctx.textAlign="center",this._ctx.textBaseline="middle",this._ctx.fillStyle="black"),a>this._gridSize&&(this._gridOuter=new Float64Array(a),this._gridInner=new Float64Array(a),this._gridSize=a),s>this._maxDimension&&(this._f=new Float64Array(s),this._d=new Float64Array(s),this._z=new Float64Array(s+1),this._v=new Int16Array(s),this._maxDimension=s),this._ctx.clearRect(0,0,n,o),this._ctx.fillText(t,n/2,o/2);for(var u=this._ctx.getImageData(0,0,n,o),l=new Uint8ClampedArray(a),d=0;d<a;d++){var h=u.data[4*d+3]/255;this._gridOuter[d]=1==h?0:0==h?ao:Math.pow(Math.max(0,.5-h),2),this._gridInner[d]=1==h?ao:0==h?0:Math.pow(Math.max(0,h-.5),2)}for(lo(this._gridOuter,n,o,this._f,this._d,this._v,this._z),lo(this._gridInner,n,o,this._f,this._d,this._v,this._z),d=0;d<a;d++){var c=this._gridOuter[d]-this._gridInner[d];l[d]=Math.max(0,Math.min(255,Math.round(255-255*(c/this._radius+this._cutoff))))}return{height:o,width:n,distance:l}},uo);function uo(t){var e=void 0===t?{}:t,r=e.fontSize,i=void 0===r?24:r,n=e.buffer,o=void 0===n?8:n,a=e.radius,s=void 0===a?6:a,u=e.cutoff,l=void 0===u?.25:u;this._maxDimension=1,this._gridSize=1,this._fontSize=i,this._buffer=o,this._radius=s,this._cutoff=l,this._height=Math.ceil(this._fontSize+2*this._buffer*1.5),this._canvas=En(),this._canvas.height=this._height,this._canvas.width=1;var d=this._canvas.getContext("2d");(this._ctx=d).textBaseline="middle",d.textAlign="center",d.fillStyle="black"}function lo(t,e,r,i,n,o,a){for(var s=0;s<e;s++){for(var u=0;u<r;u++)i[u]=t[u*e+s];ho(i,n,o,a,r);for(u=0;u<r;u++)t[u*e+s]=n[u]}for(u=0;u<r;u++){for(s=0;s<e;s++)i[s]=t[u*e+s];ho(i,n,o,a,e);for(s=0;s<e;s++)t[u*e+s]=Math.sqrt(n[s])}}function ho(t,e,r,i,n){i[r[0]=0]=-ao,i[1]=+ao;for(var o=1,a=0;o<n;o++){for(var s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);s<=i[a];)a--,s=(t[o]+o*o-(t[r[a]]+r[a]*r[a]))/(2*o-2*r[a]);r[++a]=o,i[a]=s,i[a+1]=+ao}for(o=0,a=0;o<n;o++){for(;i[a+1]<o;)a++;e[o]=(o-r[a])*(o-r[a])+t[r[a]]}}var co=128-2*nn,fo=128-2*nn,go={fontSize:24,cutoff:.275,radius:6},po={fontSize:24,cutoff:.25,radius:8},_o=(vo.prototype.refresh=function(t){this._pixelRatio=t.getPixelRatio();for(var e=this._gl,r=this._getPatternsByFilter(t.getPatternList()),i=0;i<r.length;++i){var n=i,o=r[i],a=Jn(n,o,Zn(o,this._maxTextureSize),this._maxTextureSize,this._patternIdToInfoTexture),s=a.texture,u=a.size,l=this._glTextures[n]||(this._glTextures[n]=e.createTexture()),d=0===n?jn:1;Qn(e,l,this._glUnit+1+n,s,u,n,d),this._textureSizes[n]=u}var h=this._glTextureInfo||(this._glTextureInfo=e.createTexture()),c=this._patternIdToInfoTexture;Qn(e,h,this._glUnit,c,256,0,1)},vo.prototype.bindMetDataTexture=function(){var t=this._gl;t.activeTexture(t.TEXTURE0+this._glUnit),t.bindTexture(t.TEXTURE_2D,this._glTextureInfo)},vo.prototype.getInfoTextureUnit=function(){return this._glUnit},vo.prototype.getNearestTextureUnit=function(){return this._glUnit+1+0},vo.prototype.getLinearTextureUnit=function(){return this._glUnit+1+1},vo.prototype.getLinearSdfTextureUnit=function(){return this._glUnit+1+2},vo.prototype.getMipmapTextureUnit=function(){return this._glUnit+1+3},vo.prototype.getInfoTextureSize=function(){return 256},vo.prototype.getNearestTextureSize=function(){return this._textureSizes[0]},vo.prototype.getLinearTextureSize=function(){return this._textureSizes[1]},vo.prototype.getLinearSdfTextureSize=function(){return this._textureSizes[2]},vo.prototype.getMipmapTextureSize=function(){return this._textureSizes[3]},vo.prototype._getPatternsByFilter=function(t){for(var e=new Array(4),r=0;r<4;++r)e[r]=[];for(r=0;r<t.length;++r){var i=this._getPatternPixels(t[r]);e[i.filter].push(i)}return e},vo.prototype._getPatternPixels=function(t){var e,r=t.id,i=t.type,n=t.attributes,o=n.text,a=n.font,s=n.style,u=n.image,l=n.scaled,d=n.duplicated,h=n.colorArray;switch(i){case Pi:e=d?this._getDuplicatedImagePixels(u):l?this._getScaledImagePixels(u):this._getNonScaledImagePixels(u);break;case 3:e=this._getSdfTextPixels(o,a,s);break;case Bi:e=this._getIconPixels(o,a,s);break;case Ui:e=this._getBadgeIconPixels(o,a,s);break;case zi:e=this._getPieChartPixels(h);break;default:throw new Error('pattern type "'+i+'" does not exist')}return e.id=r,e},vo.prototype._getScaledImagePixels=function(t){var e=t.width,r=t.height;if(on<e||on<r){var i=on/Math.max(t.width,t.height);e*=i,r*=i}return e&&r&&(e=qn(e),r=qn(r)),e-=2*nn,r-=2*nn,this._getImagePixels(t,e,r)},vo.prototype._getNonScaledImagePixels=function(t){return this._getImagePixels(t,t.width,t.height)},vo.prototype._getDuplicatedImagePixels=function(t){if(0===t.width||0===t.height)return this._getImagePixels(t,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=En(),this._canvasForDuplicatedImage.width=on,this._canvasForDuplicatedImage.height=on);for(var e=this._canvasForDuplicatedImage,r=e.getContext("2d"),i=t.width,n=t.height,o=(on-i)/2,a=(on-n)/2;0<o;)o-=i;for(;0<a;)a-=n;for(var s=o;s<on;s+=i)for(var u=a;u<on;u+=n)r.drawImage(t,s,u);return this._getImagePixels(e,on,on)},vo.prototype._getImagePixels=function(t,e,r){var i;if(0===e||0===r)i=new Uint8Array(0);else{(this._imageCanvas.width<e||this._imageCanvas.height<r)&&(this._imageCanvas.width=e,this._imageCanvas.height=r);var n=this._imageCanvasContext;An(this._imageCanvas,n,e,r);try{n.drawImage(t,0,0,e,r)}catch(t){}i=n.getImageData(0,0,e,r).data}return{width:e,height:r,pixels:i,filter:3}},vo.prototype._getPieChartPixels=function(t){var e=fo,r=this._imageCanvasContext,i=e/2,n=e/2;return An(this._imageCanvas,r,e,e),r.save(),r.rect(0,0,e,e),r.clip(),io(r,t,i,n,e),r.restore(),{width:e,height:e,pixels:r.getImageData(0,0,e,e).data,filter:1}},vo.prototype._getTextPixels=function(t,e,r,i,n,o){var a=this._imageCanvasContext,s=n*this._pixelRatio;Sn(a,r,s,i);var u=Math.ceil(a.measureText(e).width);0===u&&(u=s);var l=0,d=0;3===t||(l=2*Math.ceil(1.5*s/2),d=2*Math.ceil(u/2));var h=Math.ceil(u+d),c=Math.ceil(s+l),f=this._imageCanvas.height<c||this._imageCanvas.width<h;return this._imageCanvas.height<c&&(this._imageCanvas.height=c),this._imageCanvas.width<h&&(this._imageCanvas.width=h),f&&Sn(a,r,s,i),a.clearRect(0,0,h,c),a.fillStyle="black",a.textBaseline="middle",a.textAlign="left",a.fillText(e,o+d/2,c/2),{width:h,height:c,pixels:a.getImageData(0,0,h,c).data,filter:t}},vo.prototype._getIconPixels=function(t,e,r){return this._getTextPixels(3,t,e,r,co,0)},vo.prototype._getBadgeIconPixels=function(t,e,r){return this._sdfGenerator.setOptions(po),this._getSdfPixels(t,e,r)},vo.prototype._getSdfTextPixels=function(t,e,r){return this._sdfGenerator.setOptions(go),this._getSdfPixels(t,e,r)},vo.prototype._getSdfPixels=function(t,e,r){for(var i=this._sdfGenerator.draw(t,e,r),n=i.width,o=i.height,distance=i.distance,a=new Uint8Array(n*o*4),s=0;s<distance.length;++s)a[4*s+3]=distance[s];return{width:n,height:o,pixels:a,filter:2}},vo);function vo(t,e){this._patternIdToInfoTexture=new Uint8Array(262144),this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=t,this._glUnit=e;var r=En();r.width=on,r.height=on,this._imageCanvasContext=r.getContext("2d"),this._imageCanvas=r,this._canvasForDuplicatedImage,this._sdfGenerator=new so(go),this._maxTextureSize=Math.min(4096,t.getParameter(t.MAX_TEXTURE_SIZE))}function mo(){for(var t=yt(),e=t.styleSheets,r=qt(t),i=[],n=[],o=0;o<e.length;o++){var a=e[o];null==a.href?i.push({href:r,content:a.ownerNode.textContent}):n.push(a.href)}var s=/@font-face\s*\{[^}]+\}/g;return Promise.all(n.map(function(e){return zt(e).then(function(t){return{href:e,content:t}}).catch(function(){return null})})).then(function(t){return t.concat(i)}).then(function(t){for(var e=[],r=0;r<t.length;r++){var i=t[r];if(null!==i){var n=i.href,o=i.content.match(s);if(o){var a=xo(o,n);e.push.apply(e,a)}}}return e})}function yo(t,i){return Promise.all(t.map(function(t){var e=t.formats,o=t.originalRule;return Promise.all(e.map(function(t){var e=t.format,r=t.url;return i?jt(r).then(function(t){return{format:e,src:t}}).catch(function(){return null}):{format:e,src:r}})).then(function(t){for(var e=[],r=0;r<t.length;r++){var i=t[r];null!==i&&e.push("url('"+i.src+"') format('"+i.format+"')")}if(0===e.length)return o;var n="src: "+e.join(",")+";";return o.replace(/src\s*:[^;]+;/g,n)})}))}var bo={"embedded-opentype":!0,svg:!0};function xo(t,e){for(var r=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,i=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,n=[],o=0;o<t.length;o++){var a=t[o],s=a.match(i);if(s){for(var u=s[1],l=[],d=void 0;d=r.exec(a);){var h=d[1],c=d[2];bo[c.toLowerCase()]||l.push({format:c,url:Eo(h,e)})}n.push({name:u,formats:l,originalRule:a})}}return n}function Eo(t,e){if(/^http(s)?:/.test(t))return t;if("/"===t[0]){var r=e.match(/((\w+:\/\/)([^/]+))/);return r?r[1]+t:t}var i=t.split("/"),n=e.split("/");for("/"!==e[e.length-1]&&n.pop();".."===i[0];)i.shift(),n.pop();return n.concat(i).join("/").replace(/[\w](\/{2,})/g,function(t){return t[0]+"/"})}function Ao(t,e){return(t+e)*(t+e+1)/2+e}function So(t){if(t.keys)return Array.from(t.keys());var r=[];return t.forEach(function(t,e){return r.push(e)}),r}function wo(t){if(t.values)return Array.from(t.values());var e=[];return t.forEach(function(value){return e.push(value)}),e}var To=(Co.prototype.reset=function(){this._map.clear()},Co.prototype.set=function(t,e,value){this._map.set(Ao(t,e),value)},Co.prototype.get=function(t,e){return this._map.get(Ao(t,e))},Co);function Co(){this._map=new Map}var Mo="undefined"==typeof HTMLElement?function(t){return!1}:function(t){return t instanceof HTMLElement},Io=function(t){return"object"!=typeof t||null===t||M(t)||((e=t)instanceof RegExp||e instanceof Date);var e};function Lo(t,e,r){if(void 0===e&&(e=[]),void 0===r&&(r=[]),!Mo(t)){if(Io(t))e.push({path:r.slice(),value:t});else for(var i=Object.keys(t),n=0;n<i.length;++n){var o=i[n],a=r.slice();a.push(o),Lo(t[o],e,a)}return e}}var No=(Object.defineProperty(Oo.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Oo.prototype.set=function(t,value){var e=this._getIndex(t);-1!==e?this._values[e]=value:(ko(this._cachedPath,t)&&(this._cachedIndex=this._keys.length),this._keys.push(t),this._values.push(value),this._size+=1)},Oo.prototype.get=function(t){var e=this._getIndex(t);if(-1!==e)return this._values[e]},Oo.prototype.has=function(t){return-1!==this._getIndex(t)},Oo.prototype.keys=function(){return this._keys.slice()},Oo.prototype._getIndex=function(t){if(ko(t,this._cachedPath))return this._cachedIndex;this._cachedPath=t.slice();for(var e=this._keys,r=0;r<e.length;++r)if(ko(e[r],t))return this._cachedIndex=r;return this._cachedIndex=-1},Oo);function Oo(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}function ko(t,e){if(t.length===e.length){for(var r=0;r<t.length;++r)if(t[r]!==e[r])return;return 1}}var Ro=Set.prototype.keys?function(t){return Array.from(t.keys())}:function(t){var e=[];return t.forEach(function(t){return e.push(t)}),e},Fo=Set.prototype.values?function(t){return Array.from(t.values())}:function(t){var e=[];return t.forEach(function(t,value){return e.push(value)}),e},Do=C("web-worker");function Po(t){return Do?function t(e){if(ArrayBuffer.isView(e))return Array.from(e);if(Array.isArray(e)){for(var r=0;r<e.length;++r)e[r]=t(e[r]);return e}if(J(e)){for(var i=Object.keys(e),n=0,o=i;n<o.length;n++){var a=o[n];e[a]=t(e[a])}return e}return e}(t):t}function zo(t){return Do?function(t){if(Do)return new Do("data:application/javascript,"+t.replace(/\n/g,""))}(t):"undefined"==typeof URL||-1!==navigator.appVersion.indexOf("MSIE 10")?new Bo(t):function(e){try{var t=new Blob([e],{type:"application/javascript"}),r=URL.createObjectURL(t);return new Worker(r)}catch(t){return new Bo(e)}}(t)}var Bo=(Uo.prototype.terminate=function(){this.terminated=!1,this._otherSide.terminated=!0},Uo.prototype.addEventListener=function(t,e){this.listeners.push(e)},Uo.prototype.postMessage=function(t){setTimeout(Ho,0,this._otherSide,{data:t})},Uo);function Uo(t){this._main=!0,this.listeners=[],this.terminated=!1,this._f=new Function("self",t),this._otherSide=new jo(this),this._f(this._otherSide)}var Vo,jo=(Go.prototype.addEventListener=function(t,e){this.listeners.push(e)},Go.prototype.postMessage=function(t){setTimeout(Ho,0,this._otherSide,{data:t})},Go);function Go(t){this._main=!1,this.listeners=[],this.terminated=!1,this._otherSide=t}function Ho(t,e){if(!t.terminated)for(var r=0;r<t.listeners.length;r++)t.listeners[r](e)}var qo=C("xmldom");Vo="undefined"!=typeof XMLSerializer?XMLSerializer:qo?qo.XMLSerializer:null;var Wo=(Xo.prototype.setAttribute=function(t,value){this._attributes[t]=value},Xo.prototype.appendChild=function(t){this._children.push(t)},Object.defineProperty(Xo.prototype,"tagName",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(Xo.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(Xo.prototype,"childNodes",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(Xo.prototype,"firstChild",{get:function(){return this._children[0]||null},enumerable:!0,configurable:!0}),Xo.prototype.serialize=function(){var t=this._name,e=this._attributes,r=this._children,i=Object.keys(e).filter(function(t){return void 0!==e[t]}).map(function(t){return" "+t+'="'+e[t]+'"'}).join(""),n=r.map(function(t){return t.serialize()}).join("");return n.length?"<"+t+i+">"+n+"</"+t+">":"<"+t+i+"/>"},Xo.prototype.cloneNode=function(t){for(var e=new Xo(this._name),r=0,i=Object.keys(this._attributes);r<i.length;r++){var n=i[r];e.setAttribute(n,this._attributes[n])}if(t)for(var o=0;o<this._children.length;o++)e.appendChild(this._children[o].cloneNode(t));return e},Xo);function Xo(t){this._attributes={},this._children=[],this._name=t}var Yo=(Zo.prototype.serialize=function(){return this._text},Zo.prototype.cloneNode=function(){return new Zo(this._text)},Zo);function Zo(t){this._text=t}var Ko=(Qo.prototype.appendChild=function(t){this._children.push(t)},Qo.prototype.serialize=function(){return this._meta.concat(this._children.map(function(t){return t.serialize()})).join("")},Qo.prototype.createElement=function(t){return new Wo(t)},Qo.prototype.createTextNode=function(t){return new Yo(t)},Qo);function Qo(){this._children=[],this._meta=[],this._children=[],this._meta=[]}function Jo(){return new Ko}function $o(t){if(Vo)return(new Vo).serializeToString(t)}function ta(){return yt().implementation.createDocument("","",null)}var ea=(ra.prototype.add=function(t){var e=this._keyToIndex[t];-1===e&&(e=this._size++,this._heap[e]=t),this._keyToIndex[t]=this._bubble(e)},ra.prototype.removeMin=function(){if(0===this._size)return NaN;var t=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),t},ra.prototype.isEmpty=function(){return 0===this._size},ra.prototype.has=function(t){return-1!==this._keyToIndex[t]},ra.prototype._bubble=function(t){var value=this._indexToValue(t),e=this._getParentIndex(t),r=this._indexToValue(e),i=t;if(0!==t&&value<r)i=this._swap(t,e);else{var n=this._getLeftChildIndex(t),o=this._getRightChildIndex(t),a=this._indexToValue(n),s=this._indexToValue(o),u=Math.min(value,a,s);u===value||(i=u===a?this._swap(t,n):this._swap(t,o))}return i===t?t:this._bubble(i)},ra.prototype._indexToValue=function(t){return t>=this._size?1/0:this._keyToValue[this._heap[t]]},ra.prototype._getParentIndex=function(t){return(t-1)/2|0},ra.prototype._getLeftChildIndex=function(t){return 2*t+1},ra.prototype._getRightChildIndex=function(t){return 2*t+2},ra.prototype._swap=function(t,e){var r=this._heap[t],i=this._heap[e];return this._heap[t]=i,this._heap[e]=r,this._keyToIndex[r]=e,this._keyToIndex[i]=t,e},ra);function ra(t){this._heap=[],this._size=0,this._keyToValue=t,this._keyToIndex=new Int32Array(t.length),this._keyToIndex.fill(-1)}var ia=(na.prototype._get=function(t){return t.isNode?this._nodes:this._edges},na.prototype.addOrRemoveElements=function(t,e){return e?this.addElements(t):this.removeElements(t)},na.prototype.addElements=function(t){for(var e=this._get(t),r=e.elementList,i=e.flexArray,n=e.indexList,o=n.getLength(),a=0;a<t._indexes.length;a++){var s=t._indexes[a];1!==i.get(s)&&(i.set(s,1),n.pushUnchecked(s))}return r(n.slice(o))},na.prototype.removeElements=function(t){for(var e=this._get(t),r=e.elementList,i=e.flexArray,n=e.indexList,o=n.getLength(),a=n.getBuffer(),s=0,u=0;u<t._indexes.length;u++){var l=t._indexes[u];0!==i.get(l)&&(i.set(l,0),s+=1)}if(s===o)return r(n.sliceAndReset());if(0===s)return r();var d=this._graph.acquireIndexList(t.isNode),h=0;for(u=0;u<o;++u)l=a[u],0===i.get(l)?(h+=1,d.pushUnchecked(l)):a[u-h]=l;return n.setLength(o-s),r(d.sliceAndReset())},na.prototype.hasElement=function(t){return!!this._get(t).flexArray.get(t._index)},na.prototype.clear=function(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())},na.prototype.isEmpty=function(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()},na.prototype.getElements=function(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}},na);function na(t,e){this._graph=t,this._nodes={elementList:t.nodeList,flexArray:t.createNodeAttribute({storage:1,name:e}),indexList:t.createIndexList(!0)},this._edges={elementList:t.edgeList,flexArray:t.createEdgeAttribute({storage:1,name:e}),indexList:t.createIndexList(!1)}}var oa=function(){return{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},aa=(sa.prototype.reset=function(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this},sa.prototype.addPoint=function(t,e,r,i){return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,e),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,e),void 0!==r&&void 0!==i&&("scaled"===i?(this.minScaledSize=Math.min(this.minScaledSize,r),this.maxScaledSize=Math.max(this.maxScaledSize,r)):(this.minFixedSize=Math.min(this.minFixedSize,r),this.maxFixedSize=Math.max(this.maxFixedSize,r))),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY,this},sa.prototype.computeForZoom=function(t){var e=Math.max(this.maxScaledSize,this.maxFixedSize/t);return sa.from({minX:this.minX-e/2,minY:this.minY-e/2,maxX:this.maxX+e/2,maxY:this.maxY+e/2,width:this.width+e,height:this.height+e})},sa.from=function(t){var e=void 0===t?{}:t,r=e.minX,i=e.minY,n=e.maxX,o=e.maxY,a=e.width,s=e.height,u=new sa;return null!=r&&(u.minX=r),null!=i&&(u.minY=i),null!=n&&(u.maxX=n),null!=o&&(u.maxY=o),null!=n&&null!=r&&(u.width=a||(n-r)/2,u.cx=(r+n)/2),null!=o&&null!=i&&(u.height=s||(o-i)/2,u.cy=(i+o)/2),u},sa.fromValues=function(t,e,r){for(var i=1/0,n=1/0,o=-1/0,a=-1/0,s=-1/0,u=0;u<t.length;u++){var l=t[u],d=e[u],h=r[u];l-h<i&&(i=l-h),d-h<n&&(n=d-h),o<l+h&&(o=l+h),a<d+h&&(a=d+h),s<h&&(s=h)}var c=sa.from({minX:i,minY:n,maxX:o,maxY:a});return c.maxScaledSize=s,c},sa.prototype.pad=function(value){return this.minX-=value,this.minY-=value,this.maxX+=value,this.maxY+=value,this.width+=2*value,this.height+=2*value,this},sa.prototype.isValid=function(){return isFinite(this.width)&&isFinite(this.height)},sa.prototype.extend=function(t){return this.addPoint(t.minX,t.minY),this.addPoint(t.maxX,t.maxY),this},sa.prototype.bottomLeft=function(){return{x:this.minX,y:this.minY}},sa.prototype.topRight=function(){return{x:this.maxX,y:this.maxY}},sa);function sa(t){void 0===t&&(t={});var e=t.xValues,r=void 0===e?[]:e,i=t.yValues,n=void 0===i?[]:i,o=t.scaledSizeValues,a=void 0===o?[]:o,s=t.fixedSizeValues,u=void 0===s?[]:s;this.minX=Qe(r),this.minY=Qe(n),this.maxX=Ke(r),this.maxY=Ke(n),this.minScaledSize=Qe(a),this.maxScaledSize=Ke(a),this.minFixedSize=Qe(u),this.maxFixedSize=Ke(u),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}var ua=(la.prototype.on=function(t,e){if("string"!=typeof t)throw new TypeError("Event name must be string");if("function"!=typeof e)throw new TypeError("Event handler must be function");var r=this._events=this._events||{};return(r[t]=r[t]||[]).push(e),this},la.prototype.off=function(t,e){if("string"!=typeof t)throw new TypeError("Event name must be string");var r=this._events=this._events||{},i=r[t];if(M(i))if("function"!=typeof e)r[t]=null;else{var n=i.indexOf(e);-1!==n&&i.splice(n,1),0===i.length&&(r[t]=null)}return this},la.prototype.fire=function(t){for(var e=arguments,r=[],i=1;i<arguments.length;i++)r[i-1]=e[i];if("string"!=typeof t)throw new TypeError("Event name must be string");var n=(this._events=this._events||{})[t];if(M(n))for(var o=r,a=0;a<n.length;a++){var s=n[a];s&&s.apply(this,o)}return this},la.prototype.once=function(i,n){var o=this,a=function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];n.apply(o,e),o.off(i,a)};return a.handler=n,this.on(i,a)},la.prototype.hasListener=function(t,e){if(!t||!e)return!1;var r=(this._events=this._events||{})[t];if(M(r))for(var i=0,n=r.length;i<n;i++){var o=r[i];if(o===e||o.handler===e)return!0}return!1},la.prototype.getListeners=function(t){return(this._events=this._events||{})[t]},la);function la(){}var da=Object.freeze({__proto__:null,BoundingBox:aa,FlexArray:Ve,EventTarget:ua,ColorManager:Ri,Table:ir,requestAnimFrame:nt,cancelAnimFrame:ot,getDocument:yt,getStyle:bt,DummyDomElement:xt,createDummyDomElement:At,getPixelRatio:St,dataUrlToBlob:wt,createBlob:Ct,isBlob:function(t){return"undefined"!=typeof Blob&&t instanceof Blob||t instanceof Tt},promptDownload:Mt,resizeElement:It,setAttributes:Lt,SVG_NS:Nt,XML_NS:Ot,XLINK:kt,createSvgElement:Rt,createTextNode:Ft,getImage:Dt,fetch:zt,isHTMLElement:Bt,applyCursorStyle:Ut,fetchBinary:Vt,fetchBinaryAsBase64:jt,escapeDOMAttribute:Gt,BUTTON_MAPPING:Ht,baseURI:qt,fadeElement:Wt,DummyCanvas:vn,DummyCanvasRenderingContext2D:yn,createCanvas:En,clearCanvas:An,setCtxFont:Sn,isWebGLSupported:wn,getWebglContext:Tn,getDocumentFontRules:mo,getEmbeddedFontRules:yo,resolvePath:Eo,IndexList:$e,mapKeys:So,mapValues:wo,Map2:To,isInteger:function(t){return"number"==typeof t&&t%1==0},toPropertyPath:R,throttle:F,debounce:function(e,r,i){var n,o,a,s,u,l=0===r||void 0===r?100:r;function d(){var t=Date.now()-s;t<l&&0<=t?n=setTimeout(d,l-t):(n=null,i||(u=e.apply(a,o),a=o=null))}function t(){a=this,o=arguments,s=Date.now();var t=i&&!n;return n=n||setTimeout(d,r),t&&(u=e.apply(a,o),a=o=null),u}return t.clear=function(){n&&(clearTimeout(n),n=null)},t.flush=function(){n&&(u=e.apply(a,o),a=o=null,clearTimeout(n),n=null)},t},processQueue:function(r,i){return new Promise(function(t,e){return function e(r,i,n,o,a){n(r[i],i,r,o,a).then(function(t){i===r.length-1?o(t):e(r,i+1,n,o,a)}).catch(a)}(r,0,i,t,e)})},isLittleEndian:D,promiseQueue:P,hash8:z,unorderedHash:function(t,e){return t<e?t*e+Math.pow(e-t-1,2)/4:t*e+Math.pow(t-e-1,2)/4},isRawObject:B,getValues:U,forEach:V,deepCopy:j,updateObject:function e(r,t){V(t,function(t,value){"object"==typeof value&&null!==value?("object"==typeof r[t]&&null!==r[t]||(r[t]={}),e(r[t],value)):r[t]=value})},extendList:function(e,t){t.forEach(function(t){-1===e.indexOf(t)&&e.push(t)})},setProperty:G,getProperty:H,flatten:q,unflatten:W,getFlattenedKeys:Y,getLeafValues:Z,ensureTransferable:K,getOptions:Q,isObject:J,mergeValues:$,pick:tt,objToValueList:Lo,PathMap:No,smartRequire:C,setKeys:Ro,setValues:Fo,getCurrentTime:Zt,getDate:Kt,getTime:Qt,formatWorkerMessage:Po,createWorker:zo,insertSortAsc:X,insertSortDesc:function(t,e){for(var r=1,i=t.length;r<i;r++){for(var n=t[r],o=r;0<o&&e.get(t[o-1])<e.get(n);)t[o]=t[o-1],--o;t[o]=n}return t},isArray:M,toArray:L,flattenArray:N,concatenateArrays:function(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];if(0===e.length)return[];for(var i=e[0].constructor,n=0,o=0,a=e;o<a.length;o++){n+=(h=a[o]).length}for(var s=new i(n),u=0,l=0,d=e;l<d.length;l++){for(var h=d[l],c=0;c<h.length;c++)s[u+c]=h[c];u+=h.length}return s},removeFromArray:O,binaryIndexOf:k,parseColorRgba:Ii,toHexa:Li,componentsToRGBA:Ni,parseColorHex:Oi,createDummyXmlDocument:Jo,serializeXMLDocument:$o,createXmlDocument:ta,PrioritySet:ea,nextPowerOfTwo:qe,computeSum:We,clamp:Xe,mix:Ye,lerp:Ze,computeMax:Ke,computeMin:Qe,getBaseLog:Je,ElementSet:ia,displayPixelsOnScreen:function(t,e,r,i){void 0===i&&(i=0),void 0===e&&(e=r=Math.sqrt(t.length/4)),void 0===r&&(r=e);var n=document.createElement("canvas"),o=n.getContext("2d");if(o){var a=o.createImageData(e,r);n.style.imageRendering="pixelated",n.style.border="1px solid black",n.style.margin="2px",n.style.position="absolute",n.style.top=n.style.left="0px",n.width=e,n.height=r,a.data.set(t),o.putImageData(a,0,0);var s=document.getElementById("graph-container");s&&(s.style.position="static"),setTimeout(function(){return document.body.appendChild(n)},i)}}}),ha={byte:1,ubyte:1,short:2,ushort:2,ulong:4,float:4},ca={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",ulong:"UNSIGNED_LONG",float:"FLOAT"},fa=(ga.prototype._finishInit=function(){var e=this,r=this._gl,t=this._ext,i=this._programWrapper.getError();if(i)throw new Error('WebGL compilation at step "'+i.step+":\n"+i.message+'"');var n=this._programWrapper.getProgram();this._program=n,r.useProgram(n),this._metaData.attributes.forEach(function(t){t.location=r.getAttribLocation(e._program,t.name),t.byteSize=t.size*ha[t.type],t.glType=ca[t.type]}),this._specialAttributes=this._createSpecialAttributesFunctions();for(var o=[],a=[],s=0,u=this._metaData.attributes;s<u.length;s++){var l=u[s];-1!==l.location&&(l.name.startsWith("a_text")?a.push(l):o.push(l))}this._baseAttributes=_a(o,r,t),this._textAttributes=_a(a,r,t),this._setupUniforms=function(t,e,r){for(var i={},n=[],o=0;o<t.length;++o){var a=t[o],s=a.id,u=a.name,l=a.type,d=e.getUniformLocation(r,u),h=pa[l](s);d&&(i[s]=d,n.push(h))}var c=new Function("gl","l","u",n.join("\n"));return function(t){return c(e,i,t)}}(this._metaData.uniforms,r,n)},ga.prototype._createSpecialAttributesFunctions=function(){return _a([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)},ga.prototype.startPass=function(t){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(t),this._specialAttributes.enable(),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)},ga.prototype._setupAttributes=function(t,e){var r=e.glBuffer,i=e.dataBuffer,n=e.divisor;t.enabled&&!r?t.disable():!t.enabled&&r&&t.enable(),r&&t.setup(r,i,n)},ga.prototype.setupBaseAttributes=function(t){this._setupAttributes(this._baseAttributes,t)},ga.prototype.setupTextAttributes=function(t){this._setupAttributes(this._textAttributes,t)},ga.prototype._resetStencil=function(){var t=this._gl;this._stencilUsage=1,t.disable(t.STENCIL_TEST)},ga.prototype.setupStencil=function(t){if(t!==this._stencilUsage){var e=this._gl;1!==t?(e.enable(e.STENCIL_TEST),2===t?(e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.stencilFunc(e.ALWAYS,1,1)):3===t&&(e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.stencilFunc(e.EQUAL,0,1))):e.disable(e.STENCIL_TEST),this._stencilUsage=t}},ga.prototype.endPass=function(){this._specialAttributes.disable(),this._baseAttributes.disable(),this._textAttributes.disable()},ga);function ga(t){var e=t.gl,r=t.ext,i=t.specialGlBuffers,n=t.metaData,o=t.programWrapper;this._stencilUsage=1,this._gl=e,this._ext=r,this._specialGlBuffers=i,this._metaData=j(n),this._programWrapper=o}var pa={int:function(t){return"gl.uniform1i(l."+t+", u."+t+");"},sampler2D:function(t){return"gl.uniform1i(l."+t+", u."+t+");"},float:function(t){return"gl.uniform1f(l."+t+", u."+t+");"},vec2:function(t){return"gl.uniform2f(l."+t+", u."+t+"[0], u."+t+"[1]);"},vec3:function(t){return"gl.uniform3f(l."+t+", u."+t+"[0], u."+t+"[1], u."+t+"[2]);"},vec4:function(t){return"gl.uniform4f(l."+t+", u."+t+"[0], u."+t+"[1], u."+t+"[2], u."+t+"[3]);"}};function _a(t,e,r){var i,n,o,a,s,u,l,d,h,c,f,g,p,_=(i=e,n=t.map(function(t){return"gl.enableVertexAttribArray("+t.location+");"}).join("\n"),o=new Function("gl",n),function(){return o(i)}),v=(a=e,s=t.map(function(t){return"gl.disableVertexAttribArray("+t.location+");"}).join("\n"),u=new Function("gl",s),function(){return u(a)});return{enable:function(){_(),this.enabled=!0},disable:function(){v(),this.enabled=!1},setup:(d=e,h=r,c=(l=t).reduce(function(t,e){return t+e.byteSize},0),f=0,g=x(["gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);","if (dataBuffer) gl.bufferData(gl.ARRAY_BUFFER, dataBuffer, gl.STATIC_DRAW);"],l.map(function(t){var e=t.location,r=t.size,i=t.glType,n=t.byteSize,o="gl.vertexAttribPointer(\n        "+e+", "+r+", gl."+i+",\n        false, "+c+", "+f+"\n      );";return f+=n,o}),l.map(function(t){return"ext.vertexAttribDivisorANGLE("+t.location+", divisor);"})).join("\n"),p=new Function("gl","ext","glBuffer","dataBuffer","divisor",g),function(t,e,r){return p(d,h,t,e,r)}),enabled:!1}}var va=(ma.prototype.setDataBuffer=function(t){this._dataBuffer!==t&&(this._program=t.animated?this._animationProgram:this._staticProgram,this._dataBuffer=t,this._dataBufferChanged=!0,t.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!t.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),delete this._sideGlBuffer))},ma.prototype.markAsUnused=function(){return this._used=!1,this},ma.prototype.getProgram=function(){return this._program},ma.prototype.markAsUsed=function(){return this._used=!0,this},ma.prototype.isUsed=function(){return this._used},ma.prototype.draw=function(){var t=this._gl,e=this._dataBuffer.type,r=2===e,i=r?this._dataBuffer.getNbSideElementsPerMainElement():1,n=3===e?41:1,o=this._dataBuffer.getSize(),a=this._dataBuffer.stencilUsage,s=this._dataBuffer.version,u=this._version!==s||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:u?this._dataBuffer.getByteArray():null,divisor:i}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:u&&r?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(a),u&&(this._version=s,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(t.TRIANGLES,0,6*n,o*i)},ma.prototype.destroy=function(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)},ma);function ma(t){var e=t.gl,r=t.ext,i=t.staticProgram,n=t.animationProgram;this._version=0,this._used=!1,this._dataBufferChanged=!1,this._gl=e,this._ext=r,this._staticProgram=i,this._animationProgram=n,this._glBuffer=this._gl.createBuffer()}function ya(t,e){if(e<2)return t;for(var r=t.split("\n"),i=[],n=0;n<r.length;++n){var o=r[n];if(o.length<e)i.push(o);else for(var a=ba(r[n],e),s=0;s<a.length;++s)i.push(a[s])}return i.join("\n")}function ba(t,e){for(var r=[""],i=t.split(" "),n=0;n<i.length;n++){var o=r[r.length-1],a=i[n];o.length+1+a.length<=e?r[r.length-1]+=(0<o.length?" ":"")+a:r.push(a)}return r}function xa(t,e){if(null===t)return null;for(var r=(t=t.toString()).split("\n"),i=[],n=0,o=0;o<r.length;o++){var a=r[o];if(!e||e<=1||a.length<e)i.push(a),n=Math.max(n,a.length);else for(var s=ba(r[o],e),u=0;u<s.length;u++)a=s[u],i.push(a),n=Math.max(n,a.length)}return{data:i,maxLength:n,lines:i.length}}function Ea(){var t=C("@mapbox/mapbox-gl-rtl-text")||C("mapbox-gl-rtl-text"),s=t?t.processBidirectionalText:ct?window.processBidirectionalText:null,e=t?t.applyArabicShaping:ct?window.applyArabicShaping:null;return{processBidirectionalText:s?function(t){if(null===t||null==t)return"";for(var e=[],r=0,i="",n=t.split("\n"),o=0;o<n.length;o++){var a=n[o];o<n.length-1&&e.push(n[o].length+r),i+=0<o?""+a:a,r+=a.length}return s(i,e).join("\n")}:function(t){return t},applyArabicShaping:e?function(t){return null===t?null:"number"==typeof t?t.toString():e(t)}:function(t){return null===t?null:t.toString()}}}var Aa=D(),Sa="\n".charCodeAt(0),wa=(Ta.prototype._init=function(){this._mustClear=!1,this._clear()},Ta.prototype.reset=function(){this._init()},Ta.prototype.clear=function(){this._mustClear=!0},Ta.prototype._measureChar=function(t,e,r){return Sn(this._ctx,e,24,r),this._ctx.measureText(t).width/24},Ta.prototype._getAtlas=function(t,e,r){var i=r===vr?0:r,n=this._byFont[t]||(this._byFont[t]={}),o=n[e]||(n[e]=new Array(50));return o[i]||(o[i]=new Array(256))},Ta.prototype._getMeasurementAtlas=function(t,e){var r=this._widthAtlases[e];return r[t]||(r[t]=new Array(256))},Ta.prototype.measureText=function(t,e,r,i){if(void 0===i&&(i=1),!e)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;for(var n=this._getMeasurementAtlas(e,r),o=0,a=0,s=1,u=0;u<t.length;++u){var l=t.charCodeAt(u);if(l===Sa)o<a&&(o=a),a=0,s+=1;else{var d=n[l];void 0===d&&(d=this._measureChar(t[u],e,r),n[l]=d),a+=d}}return o<a&&(o=a),this._textDimensions.width=o*i,this._textDimensions.height=s*i,this._textDimensions},Ta.prototype._getCharInfo=function(t,e,r,i,n,o){var a=t[e];if(!a){var s=String.fromCharCode(e);a={ratio:this._measureChar(s,r,i),patternId:new Array(1)};for(var u=0;u<1;++u){var l=+u;a.patternId[u]=this._patternManager.getIdFromDefinition({id:0,type:3,attributes:{text:s,font:r,style:i,size:n,align:o,offset:l}})}t[e]=a}return a},Ta.prototype.storeTextInDataView=function(t,e,r,i){var n=e;if(i&&i.type===Vi){for(var o=i.attributes,a=o.font,s=o.style,u=o.size,l=o.align,d="center"===l,h=this._getAtlas(a,s,u),c=0,f=1,g=0,p=0,_=this._lineWidthList,v=this._processBidirectionalText(i.attributes.text),m=0;m<v.length;++m)(E=v.charCodeAt(m))===Sa?(c<g&&(c=g),_[p]=g,p++,g=0,f++):g+=(A=this._getCharInfo(h,E,a,s,u,l)).ratio;c<(_[p]=g)&&(c=g),p=0;var y=-(d?_[p]:c)/2,b=(1-f)/2,x=0;for(m=0;m<v.length;++m){var E,A=h[E=v.charCodeAt(m)];if(E===Sa)p+=1,y=-(d?_[p]:c)/2,b+=1,x=0;else{var S=A.ratio,w=A.patternId[0];y+=(S+x)/2,x=S;var T=(Xe(1e3*y+65536,0,131071)<<8)+Xe(2*b+128,0,255);t.setUint16(n,w,Aa),t.setUint32(n+2,T,Aa),n+=6}}}this._fillWithZeros(t,n,r)},Ta.prototype.extractTextFromDataView=function(t,e,r){for(var i=t,n=Aa,o=i.getUint16(e,n),a=this._textPattern,s=this._patternManager.getDefinitionFromId(o).attributes,u=s.font,l=s.style,d=s.size,h=s.align,c=this._getAtlas(u,l,d),f=[],g=0,p=0,_=0,v=null,m=e;m<r;m+=6){var y=i.getUint16(m,n);if(!y)break;var b=(i.getUint8(m+2)-128)/2,x=this._patternManager.getDefinitionFromId(y);if(!x||!x.attributes||!x.attributes.text)break;var E=x.attributes.text.charCodeAt(0),A=c[E];null===v?v=b:v<b&&(p<g&&(p=g),g=0,_+=1,f.push(Sa),v=b),f.push(E),A&&(g+=A.ratio)}p<g&&(p=g);var S=String.fromCharCode.apply(null,f);return a.attributes.style=l,a.attributes.font=u,a.attributes.size=d,a.attributes.align=h,a.attributes.text=this._processBidirectionalText(S),a.dimensions&&(a.dimensions.width=p,a.dimensions.height=_),a},Ta.prototype._fillWithZeros=function(t,e,r){for(var i=e;i<r;i+=6)t.setUint16(i,0)},Ta.prototype._clear=function(){this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}},Ta.prototype.update=function(){this._mustClear&&(this._clear(),this._mustClear=!1)},Ta.prototype.getVersion=function(){return 0},Ta);function Ta(t){this._patternManager=t,this._canvas=En(),this._ctx=this._canvas.getContext("2d"),this._processBidirectionalText=Ea().processBidirectionalText,this._textPattern={id:0,type:Vi,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init()}var Ca,Ma=wn(),Ia={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!("undefined"!=typeof window&&window.FORCE_WEBGL)},La={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},Na=(b(Oa,Ca=Error),Oa);function Oa(){return null!==Ca&&Ca.apply(this,arguments)||this}function ka(value,t){if(!value&&t){var e=new Na(La[t]);throw e.code=t,e}}var Ra,Fa=(b(Da,Ra=Nn),Da.isAvailable=function(){return Ma||ka(null,"NO_WEBGL"),Ma},Da.createInitData=function(){var t=En(),e=Tn(t,Ia),r=e&&"function"==typeof e.getExtension?e.getExtension("ANGLE_instanced_arrays"):null,i={BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:24,CURVATURE_RATIO:an,PATTERN_PADDING:nn,TEXT_WIDTH_MULTIPLIER:1,TEXT_HEIGHT_MULTIPLIER:1.5,SELF_LOOP_CURVATURE_RATIO:sn,EDGE_ARROW_SIZE_RATIO:3,CURVE_SUBDIVISIONS:41,PIECE_NODE_COMPONENT:ji,PIECE_EDGE_BODY:Gi,PIECE_EDGE_HEAD:Hi,PIECE_EDGE_TAIL:qi,PIECE_EDGE_TEXT:Wi,MAX_TEXT_SIZE:25,BYTES_TO_TEXT_OFFSET_X:.001,BYTES_TO_TEXT_OFFSET_Y:.5,FILTER_NEAREST:0,FILTER_LINEAR:1,FILTER_LINEAR_SDF:2,FILTER_MIPMAP:3,SHAPE_TEXTURE_SIZE:en,SIMPLE_SHAPE_SAMPLING_SIZE:32,COMPLEX_SHAPE_SAMPLING_SIZE:$i,SHAPE_SAMPLING_BUFFER_RATIO:1/16,MAX_SHAPES:15..toString(),FIRST_COMPLEX_SHAPE_ID:8,SELF_LOOP_TO_CIRCLE_APPROX:.9721,SDF_GAMMA:1.4142},n=new Pn(e,{vertex:Fn,fragment:Dn,constants:i,macros:{ANIMATED:0}}),o=new Pn(e,{vertex:Fn,fragment:Dn,constants:i,macros:{ANIMATED:1}});return e&&r&&(n.compile(),e.flush()),{canvas:t,gl:e,ext:r,staticProgramWrapper:n,animationProgramWrapper:o}},Da.getName=function(){return"WebGL"},Da.prototype._afterFirstFrame=function(){this._animationProgramWrapper.getState()===kn.INIT&&this._animationProgramWrapper.compile()},Da.prototype.ensureAnimationsReady=function(){var t=this._animationProgramWrapper.getState();t!==kn.DONE&&(t===kn.INIT&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())},Da.prototype.getDomElement=function(){return this._glCanvas},Da.prototype._initGl=function(){var t=this._gl;t.clearColor(0,0,0,0),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},Da.prototype._computeShaderInfo=function(){var t,e;this._shaderMetadata=(t=Dn,za(e={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]},Fn),za(e,t),e)},Da.prototype._initGlPrograms=function(){this._staticProgram=new fa({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new fa({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})},Da.prototype._initSpecialGlBuffers=function(){for(var t=this._gl,e=t.createBuffer(),r=new Int8Array(738),i=0;i<41;++i)for(var n=[-1,-1,i,1,-1,i,1,1,i,-1,-1,i,-1,1,i,1,1,i],o=i*n.length,a=0;a<n.length;a++)r[a+o]=n[a];t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW),this._specialGlBuffers={vertexInfo:e}},Da.prototype._computeUniforms=function(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_UNIT_SIZE:rn,SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}},Da.prototype._render=function(t){var e=t.shapesChanged,r=t.patternsChanged,i=t.dimensionsChanged,n=t.backgroundColorChanged,o=this._gl;if(e&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetDataTexture()),r&&this._patternTexture.refresh(this._patternManager),i&&(this._mustResize=!0),n){var a=this._renderBackground?this._backgroundRgba:[0,0,0,0],s=a[0],u=a[1],l=a[2],d=a[3];o.clearColor(s*d,u*d,l*d,d)}var h=this._computeUniforms(),c=this._getSortedBufferList();this._mustResize&&c.length&&(It(this._glCanvas,this._width,this._height,this._pixelRatio),o.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),o.clear(o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT);for(var f=0;f<c.length;++f)this._displayBuffer(c[f],h);this._endFrame()},Da.prototype._displayBuffer=function(t,e){var r=t.getProgram();r!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=r,this._currentProgram.startPass(e)),t.markAsUsed(),t.draw()},Da.prototype._getSortedBufferList=function(){for(var t=this._bufferList.getBuffersByAscendingDepth(),e=[],r=0;r<this._bufferDrawers.length;++r)(n=this._bufferDrawers[r])&&n.markAsUnused();for(r=0;r<t.length;++r){var i=t[r];(n=this._getBufferDrawer(i)).markAsUsed(),!i.isEmpty()&&this._isBufferDisplayable(i)&&e.push(n)}for(r=0;r<this._bufferDrawers.length;++r){var n;(n=this._bufferDrawers[r])&&!n.isUsed()&&(n.destroy(),this._bufferDrawers[r]=void 0)}return e},Da.prototype._endFrame=function(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)},Da.prototype._getBufferDrawer=function(t){var e=t.getId(),r=this._bufferDrawers[e];if(!r){for(;this._bufferDrawers.length<=e;)this._bufferDrawers.push(void 0);r=new va({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._bufferDrawers[e]=r}return r.setDataBuffer(t),r},Da.prototype.destroy=function(){var t=this._gl.getExtension("WEBGL_lose_context");t&&t.loseContext()},Da.prototype.getImageData=function(){var t=this._glCanvas.width,e=this._glCanvas.height;return(this._2dcanvas.width<t||this._2dcanvas.height<e)&&(this._2dcanvas.width=t,this._2dcanvas.height=e),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,t,e)},Da.prototype._getImageDataFlippedYAxis=function(){var t=this._gl,e=this._glCanvas.width,r=this._glCanvas.height,i=this._ctx.createImageData(e,r),n=new Uint8Array(i.data.buffer);return t.readPixels(0,0,e,r,t.RGBA,t.UNSIGNED_BYTE,n),i},Da);function Da(t){var e=Ra.call(this,t)||this;e._2dcanvas=En(),e._ctx=e._2dcanvas.getContext("2d"),e._bufferDrawers=[],e._mustResize=!1;var r=t.initData||Da.createInitData(),i=r.canvas,n=r.gl,o=r.ext,a=r.staticProgramWrapper,s=r.animationProgramWrapper;return ka(n,"NO_WEBGL"),ka(o,"NO_ANGLE_INSTANCED_ARRAYS"),e._glCanvas=i,e._gl=n,e._ext=o,e._staticProgramWrapper=a,e._animationProgramWrapper=s,e._shapeTexture=new no(e._gl,0),e._patternTexture=new _o(e._gl,1),e._initCanvas(e._glCanvas),e._computeShaderInfo(),e._initSpecialGlBuffers(),e._initGlPrograms(),e._initGl(),e}var Pa={float:1,vec2:2,vec3:3,vec4:4};function za(t,e){for(var r=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,i=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,n=[],o=r.exec(e);o;){var a=o[0];"#endif"===a?n.pop():a.startsWith("#if")?n.push(o[4]):t.attributes.push({name:o[3],size:Pa[o[2]],type:o[1],tags:n.slice(),location:null,byteSize:0,glType:null}),o=r.exec(e)}for(o=i.exec(e);o;){if(!t.uniforms.some(function(t){return t.id===o[1]})){var s=o[1],u=o[2],l=u.replace("u_","");t.uniforms.push({id:l,name:u,type:s})}o=i.exec(e)}}var Ba=0,Ua=1,Va=2,ja=30,Ga=0,Ha=1,qa=2,Wa=3,Xa=4,Ya=5,Za=6,Ka=Math.PI,Qa=2*Math.PI,Ja=Ka*(5/4),$a=Ka*(7/4),ts=.75*Ka,es=.25*Ka,rs=1.1,is=.07,ns=1,os=1,as=.17,ss=1,us=-Ka/2,ls=Ka/2,ds=2/3,hs={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},cs={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},fs={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0};function gs(t,e,r,i,n){var o=1-n;return o*o*o*t+3*n*o*o*e+3*n*n*o*r+n*n*n*i}function ps(t,e,r,i){var n=1-i;return n*n*t+2*n*i*e+i*i*r}function _s(t,e,r,i,n,o){var a=o||{x:0,y:0},s=(t+r)/2,u=(e+i)/2,l=t-r,d=e-i,distance=Math.sqrt(l*l+d*d);if(0===distance)return a.x=s,a.y=u,a;var h=d/distance,c=-l/distance,f=-distance*n/an;return a.x=s+h*f,a.y=u+c*f,a}function vs(t,e,r,i,n,o){var a=o||{x1:0,y1:0,x2:0,y2:0},s=(i+i/sn*r)*sn,u=-n+Ka,l=Ka/2-n;return a.x1=t+Math.cos(u)*s,a.y1=e+Math.sin(u)*s,a.x2=t+Math.cos(l)*s,a.y2=e+Math.sin(l)*s,a}var ms,ys=(b(bs,ms=Nn),bs.prototype._resetCachePoints=function(){this._nextCachePoint=0},bs.prototype._point=function(t,e){var r=this._cachePoints[this._nextCachePoint++];return r||(r={x:0,y:0},this._cachePoints.push(r)),r.x=t,r.y=e,r},bs.prototype.setViewportClipping=function(t){this._clipViewport=t},bs.prototype._formatAngle=function(t){return t<-Math.PI?t+2*Math.PI:t>Math.PI?t-2*Math.PI:t},bs.prototype._computeAnimationRatio=function(t){var e=t.beginTime,r=t.duration,i=t.easing,n=(this._currentTime-e)/r,o=n*n,a=o*n,s=this._easingManager.getCoefficients(i),u=n<.5?0:4;return Xe(s[u]+s[1+u]*n+s[2+u]*o+s[3+u]*a,0,1)},bs.prototype._mixColor=function(t,e,r,i){if(t===e)return t;var n=this._colorManager.parseColor(t),o=n[0],a=n[1],s=n[2],u=n[3],l=this._colorManager.parseColor(e),d=l[0],h=l[1],c=l[2],f=l[3];return"rgba("+Math.round(255*Ze(o,d,r))+","+Math.round(255*Ze(a,h,r))+","+Math.round(255*Ze(s,c,r))+","+Ze(u,f,i)+")"},bs.prototype._displayBuffer=function(t){for(var e=t.getSize(),r=t.animated,i=0;i<e;++i){var n=this.extractElement(t,i);n.valid&&this._displayElement(n,r)}},bs.prototype._mixAttributes=function(t,e,r){var i=this._computeAnimationRatio(r);return t.dashLength=Ze(e.dashLength,t.dashLength,i),t.gapLength=Ze(e.gapLength,t.gapLength,i),t.offsetAngle=Ze(e.offsetAngle,t.offsetAngle,i),t.opacity=Ze(e.opacity,t.opacity,i),t.globalMinVisibleSize=Ze(e.globalMinVisibleSize,t.globalMinVisibleSize,i),t.strokeMinVisibleSize=Ze(e.strokeMinVisibleSize,t.strokeMinVisibleSize,i),t.patternMinVisibleSize=Ze(e.patternMinVisibleSize,t.patternMinVisibleSize,i),t.symbolicSize=Ze(e.symbolicSize,t.symbolicSize,i),t.curvature=Ze(e.curvature,t.curvature,i),t.fillColor=this._mixColor(e.fillColor,t.fillColor,i,i),t.strokeColor=this._mixColor(e.strokeColor,t.strokeColor,i,i),t.patternColor=this._mixColor(e.patternColor,t.patternColor,i,i),t.x1=Ze(e.x1,t.x1,i),t.y1=Ze(e.y1,t.y1,i),t.x2=Ze(e.x2,t.x2,i),t.y2=Ze(e.y2,t.y2,i),t.rectWidthOrSourceRadiusScaled=Ze(e.rectWidthOrSourceRadiusScaled,t.rectWidthOrSourceRadiusScaled,i),t.rectWidthOrSourceRadiusFixed=Ze(e.rectWidthOrSourceRadiusFixed,t.rectWidthOrSourceRadiusFixed,i),t.rectHeightOrTargetRadiusScaled=Ze(e.rectHeightOrTargetRadiusScaled,t.rectHeightOrTargetRadiusScaled,i),t.rectHeightOrTargetRadiusFixed=Ze(e.rectHeightOrTargetRadiusFixed,t.rectHeightOrTargetRadiusFixed,i),t.thicknessOrFontSizeScaled=Ze(e.thicknessOrFontSizeScaled,t.thicknessOrFontSizeScaled,i),t.thicknessOrFontSizeFixed=Ze(e.thicknessOrFontSizeFixed,t.thicknessOrFontSizeFixed,i),t.strokeWidthScaled=Ze(e.strokeWidthScaled,t.strokeWidthScaled,i),t.strokeWidthFixed=Ze(e.strokeWidthFixed,t.strokeWidthFixed,i),t.offsetScaled=Ze(e.offsetScaled,t.offsetScaled,i),t.offsetFixed=Ze(e.offsetFixed,t.offsetFixed,i),t},bs.prototype._computeRenderInfo=function(t){var e=this._viewZoom,r=this._point(t.x1,t.y1),i=this._point(t.x2,t.y2);return{shape:this._shapeManager.getDefinitionFromName(t.shape),pieceId:t.pieceId,dashLength:t.dashLength,gapLength:t.gapLength,hasHead:t.hasHead,hasTail:t.hasTail,isBodyTriangle:t.isBodyTriangle,isSelfLoop:t.isSelfLoop,patternScale:t.patternScale,offsetAngle:this._formatAngle(t.offsetAngle),isText:t.isText,adjustTextAngle:t.adjustTextAngle,isBadge:t.isBadge,unusedFlag2:t.unusedFlag2,unusedFlag3:t.unusedFlag3,opacity:t.opacity,globalMinVisibleSize:t.globalMinVisibleSize,strokeMinVisibleSize:t.strokeMinVisibleSize,patternMinVisibleSize:t.patternMinVisibleSize,symbolicSize:0===t.symbolicSize?1/0:t.symbolicSize*e,curvature:t.curvature,pattern:t.pattern,fillColor:t.fillColor,strokeColor:t.strokeColor,patternColor:t.patternColor,pos1OnGraph:r,pos2OnGraph:i,pos1:this._graphToScreenCoordinates(r),pos2:this._graphToScreenCoordinates(i),rectWidthOrSourceRadius:t.rectWidthOrSourceRadiusScaled*e+t.rectWidthOrSourceRadiusFixed,rectHeightOrTargetRadius:t.rectHeightOrTargetRadiusScaled*e+t.rectHeightOrTargetRadiusFixed,thicknessOrFontSize:t.thicknessOrFontSizeScaled*e+t.thicknessOrFontSizeFixed,strokeWidth:t.strokeWidthScaled*e+t.strokeWidthFixed,offset:t.offsetScaled*e+t.offsetFixed}},bs.prototype._applyBackgroundBlending=function(t){1!==t.opacity&&(t.fillColor=this._blendColor(t.fillColor,t.opacity),t.strokeColor=this._blendColor(t.strokeColor,t.opacity),t.textColor=this._blendColor(t.textColor,t.opacity))},bs.prototype._pointArray=function(t){var e=this._pointCopies[t];if(!e){e=new Array(t),this._pointCopies[t]=e;for(var r=0;r<t;++r)e[r]={x:0,y:0,r:0}}return e},bs.prototype._scalePoints=function(t,e,r,i){for(var n=t.shape.points.length,o=this._pointArray(n),a=0;a<n;++a){var s=t.shape.points[a],u=o[a];u.x=e.x+s.x*r,u.y=e.y+s.y*i,u.r=s.r*r}var l=t.pos2OnGraph.x-t.pos1OnGraph.x,d=t.pos2OnGraph.y-t.pos1OnGraph.y;if(0!=l||0!=d)for(var h=Math.sqrt(l*l+d*d),c=l/h,f=d/h,g=0,p=o;g<p.length;g++){var _=p[g],v=_.x-e.x,m=_.y-e.y;_.x=e.x+c*v+f*m,_.y=e.y-f*v+c*m}return o},bs.prototype._drawPoints=function(t){1===t.length?this._drawCircle(t[0],t[0].r):this._drawPolygon(t)},bs.prototype._computeCenter=function(t){var e=Math.cos(t.offsetAngle),r=Math.sin(t.offsetAngle),i=(t.pos1.x+t.pos2.x)/2+e*t.offset,n=(t.pos1.y+t.pos2.y)/2+r*t.offset;return this._point(i,n)},bs.prototype._displayNodeComponent=function(e,t,r,i){var n=this,o=this._computeCenter(e);if(e.pattern.type!==Vi){var a=e.rectWidthOrSourceRadius/2,s=e.rectHeightOrTargetRadius/2,u=this._scalePoints(e,o,a,s);if((t||i)&&this._drawPoints(u),t&&this._fill(e.fillColor),i){if(this._startClip(),e.pattern.type===zi){var l=e.pattern.attributes.colorArray;1!==e.opacity&&(l=l.map(function(t){return n._blendColor(t,e.opacity)})),this._displayPieChart(o,a,l)}else if(e.pattern.type===Bi||e.pattern.type===Ui){var d=0,h=Math.round(e.rectHeightOrTargetRadius*e.patternScale),c=e.pattern.attributes.text,f=e.patternColor,g=e.pattern.attributes.font,p=e.pattern.attributes.style,_=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius,m=e.pattern.attributes.paddingTop,y=e.pattern.attributes.paddingLeft;this._displayText(o,d,c,f,g,h,p,_,v,y,m)}else if(e.pattern.type===Pi){var b=e.pattern.attributes.image;if(b.isDummy||b.width&&b.height){var x=e.pattern.attributes.duplicated,E=x?1:e.patternScale,A=e.rectWidthOrSourceRadius*E,S=e.rectHeightOrTargetRadius*E,w=e.pattern.attributes.scaled,T=e.opacity;this._displayImage(o,A,S,b,w,x,T)}}this._endClip()}if(r){var C=e.strokeWidth/2,M=this._scalePoints(e,o,a+C,s+C);this._drawPoints(M),this._stroke(e.strokeColor,e.strokeWidth)}}else i&&(d=0,h=e.thicknessOrFontSize,c=e.pattern.attributes.text,f=e.patternColor,g=e.pattern.attributes.font,p=e.pattern.attributes.style,_=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius,this._displayText(o,d,c,f,g,h,p,_,v))},bs.prototype._displayElement=function(t,e){if(t.end&&t.end.shape&&t.end.pieceId&&(!e||t.start&&t.animation)){this._resetCachePoints();var r=e?this._mixAttributes(t.end,t.start,t.animation):t.end,i=this._computeRenderInfo(r);if(!(i.symbolicSize<i.globalMinVisibleSize||0===i.opacity)){this._applyBackgroundBlending(i);var n=!!(i.strokeColor&&0<i.strokeWidth&&i.symbolicSize>=i.strokeMinVisibleSize),o=!!(1!==i.pattern.type&&i.symbolicSize>=i.patternMinVisibleSize),a=!!i.fillColor;if(i.pieceId===ji)return this._displayNodeComponent(i,a,n,o);var s,u,l,d,h,c,f,g,p,_,v,m,y,b,x,E,A,S,w,T,C,M,I,L=i.pos2.x-i.pos1.x,N=i.pos2.y-i.pos1.y,O=Math.sqrt(L*L+N*N),k=null,R=null;if(i.isSelfLoop){var F=i.pieceId===Wi?i.strokeWidth/2:i.rectWidthOrSourceRadius,D=this._getSelfLoopControlPoints(i.pos1,i.curvature,F),P=D.x1,z=D.y1,B=D.x2,U=D.y2;k=this._point(P,z),R=this._point(B,U),m=i.pos1,y=k,b=R,i.pos2,x=1,E=(m.x+y.x+b.x)/3,A=(m.y+y.y+b.y)/3,S=E-y.x,w=A-y.y,T=y.x-b.x,C=y.y-b.y,M=S*S+w*w,I=(T*T+C*C)/4,s=1.9442*Math.sqrt(M-I)*3.14159265359*x}else s=i.curvature?(k=this._getQuadraticCurveControlPoint(i),u=i.curvature,l=O,d=1,h=Math.abs(u)/an+1e-6,g=(f=d-.5)*f,p=1/(16*(c=h*h)),_=Math.sqrt(g+p),v=.5/h*Math.sqrt(.25+c),Math.abs(2*h)*(f*_+.5*v+p*Math.log(Math.abs((f+_)/(v-.5))))*l):O;if(i.pieceId===Wi){var V=i.strokeWidth,j=this._getPointOnLine(i.pos1,k,R,i.pos2,.5),G=this._getTangentOnLine(i.pos1,k,R,i.pos2,.5);if(i.rectWidthOrSourceRadius>=s-V&&!i.isSelfLoop){if(!i.adjustTextAngle)return;G.x=1,G.y=0,i.offset=0}var H=-Math.atan2(G.y,G.x),q=this._formatAngle(i.offsetAngle-H);(!i.isSelfLoop&&q<0||i.isSelfLoop&&i.offsetAngle<0)&&(G.x*=-1,G.y*=-1),(H>Math.PI/2||H<-Math.PI/2)&&(H+=Math.PI);var W=this._getOrthogonal(G),X=j.x+W.x*i.offset,Y=j.y+W.y*i.offset;if(i.fillColor){var Z=this._pointArray(4),K=i.rectWidthOrSourceRadius/2,Q=i.rectHeightOrTargetRadius/2,J=G.x*K,$=G.y*K,tt=W.x*Q,et=W.y*Q,rt=Z[0],it=Z[1],nt=Z[2],ot=Z[3];rt.x=X+J+tt,rt.y=Y+$+et,it.x=X+J-tt,it.y=Y+$-et,nt.x=X-J-tt,nt.y=Y-$-et,ot.x=X-J+tt,ot.y=Y-$+et,this._drawPoints(Z),this._fill(i.fillColor)}else{var at=this._point(X,Y),st=H,ut=i.thicknessOrFontSize,lt=i.pattern.attributes.text,dt=i.patternColor,ht=i.pattern.attributes.font,ct=i.pattern.attributes.style,ft=i.pattern.attributes.align,gt=i.rectWidthOrSourceRadius;this._displayText(at,st,lt,dt,ht,ut,ct,ft,gt)}}else{var pt=i.pieceId===Hi,_t=i.pieceId===qi,vt=Math.cos(i.offsetAngle),mt=Math.sin(i.offsetAngle);i.pos1.x+=vt*i.offset,i.pos1.y+=mt*i.offset,i.pos2.x+=vt*i.offset,i.pos2.y+=mt*i.offset;var yt="line"===i.shape.name,bt=i.thicknessOrFontSize,xt=i.rectWidthOrSourceRadius,Et=i.rectHeightOrTargetRadius,At=+i.hasHead,St=+i.hasTail,wt=+i.isBodyTriangle,Tt=At+St,Ct=3*bt,Mt=At*Ct,It=St*Ct,Lt=i.isSelfLoop?1/0:O-xt-Et,Nt=Math.min(Lt/Tt,Ct),Ot=St*(Ct+Math.max(xt+Nt-It,0))+(1-St)*wt*xt,kt=At*(Ct+Math.max(Et+Nt-Mt,0))+(1-At)*wt*Et;if(pt||_t){var Rt=_t?-1:1,Ft=(pt?s-kt:Ot)-Rt,Dt=null,Pt=null;if(i.isSelfLoop&&k&&R){var zt=this._getTFromLengthOnCubicCurve(i.pos1,k,R,i.pos2,Ft-i.strokeWidth/2*Rt);Dt=this._getPointOnCubicCurve(i.pos1,k,R,i.pos2,zt),Pt=this._getTangentOnCubicCurve(i.pos1,k,R,i.pos2,zt)}else Pt=i.curvature&&k?(zt=this._getTFromLengthOnQuadraticCurve(i.pos1,k,i.pos2,Ft-i.strokeWidth/2*Rt),Dt=this._getPointOnQuadraticCurve(i.pos1,k,i.pos2,zt),this._getTangentOnQuadraticCurve(i.pos1,k,i.pos2,zt)):(zt=Ft/s,Dt=this._mixPoints(i.pos1,i.pos2,zt),this._point(L/O,N/O));if(Pt.x*=Rt,Pt.y*=Rt,a){if(i.shape.hole){var Bt=this._makeEdgeExtremityPoints(Dt,Pt,Ct,i.shape.hole);this._drawPoints(Bt),this._startReverseClip()}Z=this._makeEdgeExtremityPoints(Dt,Pt,Ct,i.shape.points),this._drawPoints(Z),this._fill(i.fillColor),i.shape.hole&&this._endReverseClip()}if(n){i.shape.hole&&(Bt=this._makeEdgeExtremityPoints(Dt,Pt,Ct,i.shape.hole),this._drawPoints(Bt),this._stroke(i.strokeColor,i.strokeWidth));var Ut=Ct+i.strokeWidth/2;Z=this._makeEdgeExtremityPoints(Dt,Pt,Ut,i.shape.points),this._drawPoints(Z),this._stroke(i.strokeColor,i.strokeWidth)}}else{if(s-Ot-kt<=0)return;if(yt){var Vt=function(t,e,r,i,n,o){var a=[];if(r&&a.push(0,r),n&&o){for(var s=n*e,u=o*e,l=s+u,d=t-i-r-l,h=0;h<d;)a.push(s,u),h+=l;var c=t-i-r-h,f=Math.min(s,c),g=Math.max(c-f,0);a.push(f,g)}else a.push(t-i-r,0);return i&&a.push(0,i),a}(s,bt,Ot,kt,i.dashLength,i.gapLength);n&&(this._drawLine(i.pos1,k,R,i.pos2),this._stroke(i.strokeColor,bt+2*i.strokeWidth,Vt)),a&&(this._drawLine(i.pos1,k,R,i.pos2),this._stroke(i.fillColor,bt,Vt))}else{var jt=Ot,Gt=s-kt;n&&(Z=this._makeTriangleEdgeBody(i.pos1,k,R,i.pos2,jt,Gt,bt+i.strokeWidth/2,i.strokeWidth/2),this._drawPoints(Z),this._stroke(i.strokeColor,i.strokeWidth)),a&&(Z=this._makeTriangleEdgeBody(i.pos1,k,R,i.pos2,jt,Gt,bt,0),this._drawPoints(Z),this._fill(i.fillColor))}}}}}},bs.prototype._makeTriangleEdgeBody=function(t,e,r,i,n,o,a,s){return e?r?this._makeSelfLoopTriangleEdge(t,e,r,i,n,o,a,s):this._makeCurveTriangleEdge(t,e,i,n,o,a,s):this._makeStraightTriangleEdge(t,i,n,o,a,s)},bs.prototype._makeCurveTriangleEdge=function(t,e,r,i,n,o,a){for(var s=this._pointArray(84),u=this._getTFromLengthOnQuadraticCurve(t,e,r,i),l=(this._getTFromLengthOnQuadraticCurve(t,e,r,n)-u)/41,d=(a-o)/41/2,h=o/2,c=u,f=0;f<=41;++f){var g=this._getPointOnQuadraticCurve(t,e,r,c),p=this._getTangentOnQuadraticCurve(t,e,r,c),_=this._getOrthogonal(p),v=_.x*h,m=_.y*h,y=s[f],b=s[83-f];y.x=g.x+v,y.y=g.y+m,b.x=g.x-v,b.y=g.y-m,c+=l,h+=d}return s},bs.prototype._makeSelfLoopTriangleEdge=function(t,e,r,i,n,o,a,s){for(var u=this._pointArray(84),l=this._getTFromLengthOnCubicCurve(t,e,r,i,n),d=(this._getTFromLengthOnCubicCurve(t,e,r,i,o)-l)/41,h=(s-a)/41/2,c=a/2,f=l,g=0;g<=41;++g){var p=this._getPointOnCubicCurve(t,e,r,i,f),_=this._getTangentOnCubicCurve(t,e,r,i,f),v=this._getOrthogonal(_),m=v.x*c,y=v.y*c,b=u[g],x=u[83-g];b.x=p.x+m,b.y=p.y+y,x.x=p.x-m,x.y=p.y-y,f+=d,c+=h}return u},bs.prototype._makeStraightTriangleEdge=function(t,e,r,i,n,o){var a=e.x-t.x,s=e.y-t.y,u=Math.sqrt(a*a+s*s),l=this._point(a/u,s/u),d=this._getOrthogonal(l),h=n/2,c=o/2,f=this._pointArray(4),g=f[0],p=f[1],_=f[2],v=f[3],m=t.x+l.x*r,y=t.y+l.y*r,b=t.x+l.x*i,x=t.y+l.y*i,E=d.x*h,A=d.y*h,S=d.x*c,w=d.y*c;return g.x=m+E,g.y=y+A,p.x=m-E,p.y=y-A,_.x=b-S,_.y=x-w,v.x=b+S,v.y=x+w,f},bs.prototype._makeEdgeExtremityPoints=function(t,e,r,i){for(var n=this._pointArray(i.length),o=r/2,a=t.x+e.x*o,s=t.y+e.y*o,u=e.x,l=e.y,d=0;d<i.length;++d){var h=i[d],c=n[d],f=(u*h.x-l*h.y)*o,g=(l*h.x+u*h.y)*o;c.x=a+f,c.y=s+g,c.r=h.r*o}return n},bs.prototype._drawLine=function(t,e,r,i){e?r?this._drawCubicCurve(t,e,r,i):this._drawQuadraticCurve(t,e,i):this._drawStraightLine(t,i)},bs.prototype._getSelfLoopControlPoints=function(t,e,r){return vs(t.x,t.y,e,r,this._viewAngle,this._tmp)},bs.prototype._getQuadraticCurveControlPoint=function(t){return _s(t.pos1.x,t.pos1.y,t.pos2.x,t.pos2.y,t.curvature,this._point(0,0))},bs.prototype._graphToScreenCoordinates=function(t){var e=this._width/2,r=this._height/2,i=(t.x-this._viewX)*this._viewZoom,n=(t.y-this._viewY)*this._viewZoom,o=this._viewAngleCos,a=this._viewAngleSin,s=o*i+a*n+e,u=-a*i+o*n+r;return this._point(s,u)},bs.prototype._blendColor=function(t,e){return t&&this._backgroundColor?this._mixColor(this._backgroundColor,t,e,1):null},bs.prototype._getTangentOnLine=function(t,e,r,i,n){return e?r?this._getTangentOnCubicCurve(t,e,r,i,n):this._getTangentOnQuadraticCurve(t,e,i,n):this._getTangentOnStraightLine(t,i)},bs.prototype._getTangentOnStraightLine=function(t,e){var r=e.x-t.x,i=e.y-t.y,n=Math.sqrt(r*r+i*i);return this._point(r/n,i/n)},bs.prototype._getTangentOnQuadraticCurve=function(t,e,r,i){var n=1-i,o=n*e.x+i*r.x-(n*t.x+i*e.x),a=n*e.y+i*r.y-(n*t.y+i*e.y),s=Math.sqrt(o*o+a*a);return this._point(o/s,a/s)},bs.prototype._getTangentOnCubicCurve=function(t,e,r,i,n){var o=1-n,a=o*o,s=n*n,u=a*(e.x-t.x)+2*o*n*(r.x-e.x)+s*(i.x-r.x),l=a*(e.y-t.y)+2*o*n*(r.y-e.y)+s*(i.y-r.y),d=Math.sqrt(u*u+l*l);return this._point(u/d,l/d)},bs.prototype._mixPoints=function(t,e,r){var i=Ze(t.x,e.x,r),n=Ze(t.y,e.y,r);return this._point(i,n)},bs.prototype._getOrthogonal=function(t){return this._point(-t.y,t.x)},bs.prototype._getPointOnLine=function(t,e,r,i,n){return e?r?this._getPointOnCubicCurve(t,e,r,i,n):this._getPointOnQuadraticCurve(t,e,i,n):this._mixPoints(t,i,n)},bs.prototype._getPointOnQuadraticCurve=function(t,e,r,i){var n=ps(t.x,e.x,r.x,i),o=ps(t.y,e.y,r.y,i);return this._point(n,o)},bs.prototype._getPointOnCubicCurve=function(t,e,r,i,n){var o=gs(t.x,e.x,r.x,i.x,n),a=gs(t.y,e.y,r.y,i.y,n);return this._point(o,a)},bs.prototype._getTFromLengthOnCubicCurve=function(t,e,r,i,n){for(var o=t.x,a=t.y,s=0,u=0,l=0;l<41;++l){s+=1/41;var d=gs(t.x,e.x,r.x,i.x,s),h=gs(t.y,e.y,r.y,i.y,s),c=d-o,f=h-a,g=Math.sqrt(c*c+f*f),p=u+g;if(n<p)return s-1/41*((p-n)/g);u=p,o=d,a=h}return 1},bs.prototype._getTFromLengthOnQuadraticCurve=function(t,e,r,i){for(var n=t.x,o=t.y,a=0,s=0,u=0;u<41;++u){a+=1/41;var l=ps(t.x,e.x,r.x,a),d=ps(t.y,e.y,r.y,a),h=l-n,c=d-o,f=Math.sqrt(h*h+c*c),g=s+f;if(i<g)return a-1/41*((g-i)/f);s=g,n=l,o=d}return 1},bs);function bs(t){var e=ms.call(this,t)||this;return e._cachePoints=[],e._nextCachePoint=0,e._tmp={x1:0,y1:0,x2:0,y2:0},e._pointCopies=Array(128),e._clipViewport=!0,e}var xs,Es=!En().__dummy,As=(b(Ss,xs=ys),Ss.getName=function(){return"Canvas"},Ss.isAvailable=function(){return Es},Ss.prototype.getDomElement=function(){return this._canvas},Ss.prototype._render=function(t){t.dimensionsChanged&&Ln(this._canvas,this._width,this._height,this._pixelRatio);var e=this._ctx,r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;e.clearRect(0,0,r,i),this._backgroundColor&&this._renderBackground&&(e.fillStyle=this._backgroundColor,e.fillRect(0,0,r,i));for(var n=this._bufferList.getBuffersByAscendingDepth(),o=0;o<n.length;++o){var a=n[o];this._isBufferDisplayable(a)&&this._displayBuffer(a)}},Ss.prototype._drawCircle=function(t,e){var r=this._ctx,i=this._pixelRatio,n=t.x*i,o=t.y*i,a=e*i;r.beginPath(),r.arc(n,o,a,0,2*Math.PI)},Ss.prototype._drawPolygon=function(t){var e=this._ctx,r=this._pixelRatio;e.beginPath();var i=t[0];e.moveTo(i.x*r,i.y*r);for(var n=1;n<t.length;++n){var o=t[n];e.lineTo(o.x*r,o.y*r)}e.closePath()},Ss.prototype._drawStraightLine=function(t,e){var r=this._ctx,i=this._pixelRatio;r.beginPath(),r.moveTo(t.x*i,t.y*i),r.lineTo(e.x*i,e.y*i)},Ss.prototype._drawQuadraticCurve=function(t,e,r){var i=this._ctx,n=this._pixelRatio;i.beginPath(),i.moveTo(t.x*n,t.y*n),i.quadraticCurveTo(e.x*n,e.y*n,r.x*n,r.y*n)},Ss.prototype._drawCubicCurve=function(t,e,r,i){var n=this._ctx,o=this._pixelRatio;n.beginPath(),n.moveTo(t.x*o,t.y*o),n.bezierCurveTo(e.x*o,e.y*o,r.x*o,r.y*o,i.x*o,i.y*o)},Ss.prototype._fill=function(t){var e=this._ctx;e.fillStyle=t,e.fill()},Ss.prototype._stroke=function(t,e,r){var i=this;void 0===r&&(r=[]);var n=this._ctx,o=this._pixelRatio;n.setLineDash(r.map(function(t){return t*i._pixelRatio})),n.lineWidth=e*o,n.strokeStyle=t,n.stroke()},Ss.prototype._startClip=function(){this._ctx.save(),this._ctx.clip()},Ss.prototype._endClip=function(){this._ctx.restore()},Ss.prototype._startReverseClip=function(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")},Ss.prototype._endReverseClip=function(){this._ctx.restore()},Ss.prototype._displayText=function(t,e,r,i,n,o,a,s,u,l,d){void 0===l&&(l=0),void 0===d&&(d=0);var h=this._ctx,c=this._pixelRatio,f=t.x*c,g=t.y*c,p=o*c,_="center"===s?0:-u/2;if(d=d*this._viewZoom*this._pixelRatio,l=l*this._viewZoom*this._pixelRatio,h.save(),h.translate(f,g),h.rotate(-e),h.textBaseline="middle",h.textAlign=s,Sn(h,n,p,a),h.fillStyle=i,-1!==r.indexOf("\n"))for(var v=r.split("\n"),m=v.length,y=(1-m)/2*p,b=0;b<m;++b)h.fillText(v[b],l+_,d+y),y+=p;else h.fillText(r,l+_,d-1);h.restore()},Ss.prototype._displayImage=function(t,e,r,i,n,o,a){if(!(this._hideImages||"isDummy"in i)){var s=i;1!==a&&(s=this._blendImageOnBackground(i,a));var u=this._ctx,l=this._pixelRatio,d=t.x*l,h=t.y*l,c=e*l,f=r*l,g=s.width*l,p=s.height*l;if(n)u.drawImage(s,d-c/2,h-f/2,c,f);else if(o){for(var _=d-c/2,v=h-f/2,m=d+c/2,y=h+f/2,b=d-g/2,x=h-p/2;_<b;)b-=g;for(;v<x;)x-=p;for(var E=x;b<m;){for(;x<y;)u.drawImage(s,b,x,g,p),x+=p;b+=g,x=E}}else u.drawImage(s,d-g/2,h-p/2,g,p)}},Ss.prototype._displayPieChart=function(t,e,r){var i=this._ctx,n=this._pixelRatio,o=t.x*n,a=t.y*n,s=e*n*2,u=2*s;1===r.length&&(i.fillStyle=r[0],i.fillRect(o-s,a-s,u,u)),1<r.length&&io(i,r,o,a,s)},Ss.prototype._blendImageOnBackground=function(t,e){var r=this._backgroundRgba,i="rgb("+Math.round(255*r[0])+","+Math.round(255*r[1])+","+Math.round(255*r[2])+")";return this._imgCanvas.width=t.width,this._imgCanvas.height=t.height,this._imgCtx.clearRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=i,this._imgCtx.fillRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=e,this._imgCtx.drawImage(t,0,0),this._imgCanvas},Ss.prototype.getImageData=function(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)},Ss);function Ss(t){var e=xs.call(this,t)||this;return e._canvas=En(),e._imgCanvas=En(),e._initCanvas(e._canvas),e._ctx=e._canvas.getContext("2d"),e._imgCtx=e._imgCanvas.getContext("2d"),e}var ws=[1/0,1/0,-1/0,-1/0];function Ts(t,e,r,i,n,o){void 0===o&&(o={x:0,y:0});var a=Math.cos(n),s=Math.sin(n),u=t-r,l=e-i;return o.x=a*u-s*l+r,o.y=s*u+a*l+i,o}function distance(t,e,r,i){return Math.sqrt((t-r)*(t-r)+(e-i)*(e-i))}function Cs(t,e,r,i){var n=t-r,o=e-i;return n*n+o*o}function Ms(t){return 180*t/Math.PI}function Is(t,e){return t.minX-=e,t.minY-=e,t.maxX+=e,t.maxY+=e,void 0===t.width&&(t.width=t.maxX-t.minX),void 0===t.height&&(t.height=t.maxY-t.minY),t.width+=2*e,t.height+=2*e,t}var Ls=!1;try{Ls=!!Rt("svg")}catch(t){}var Ns="none",Os={left:"start",center:"middle",right:"end"},ks="data-element-id";function Rs(t){return Math.round(1e3*t)/1e3}function Fs(t,e,r,i,n,o){var a=Rt("image");return a.setAttribute("width",Rs(i)),a.setAttribute("height",Rs(n)),a.setAttribute("x",Rs(e)),a.setAttribute("y",Rs(r)),a.setAttribute("href",t),o&&o.appendChild(a),a}var Ds,Ps=(b(zs,Ds=ys),zs.getName=function(){return"SVG"},zs.isAvailable=function(){return Ls},zs.prototype.getDomElement=function(){return this._svg},zs.prototype._render=function(t){if(t.dimensionsChanged&&Lt(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){var e=this._colorManager.rgbaToRgb(this._backgroundColor);this._background.setAttribute("fill",e.color),this._background.setAttribute("fill-opacity",e.opacity)}var r=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(var i=0;i<r.length;++i){var n=r[i];this._isBufferDisplayable(n)&&this._displayBuffer(n)}this._svg.appendChild(this._container)},zs.prototype._clear=function(){this._container&&this._svg.removeChild(this._container),this._container=Rt("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=Rt("g"),this._defs.appendChild(this._clipPaths),this._filters&&this._defs.removeChild(this._filters),this._filters=Rt("g"),this._defs.appendChild(this._filters)},zs.prototype._displayElement=function(t,e){this._currentElementId=0<=t.id?"n"+t.id:"e"+-t.id,Ds.prototype._displayElement.call(this,t,e)},zs.prototype._addBackgroundBlendingFilter=function(t){var e=this._colorManager.parseColor(this._backgroundColor),r=1-t,i=[t,0,0,0,e[0]*r,0,t,0,0,e[1]*r,0,0,t,0,e[2]*r,0,0,0,1,0].join(" "),n="filter-"+this._currentElementId,o=Rt("filter",{id:n}),a=Rt("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:i});return o.appendChild(a),this._filters.appendChild(o),n},zs.prototype._drawCircle=function(t,e){var r="M "+(t.x-e)+", "+t.y+" a "+e+","+e+" 0 1,0 "+2*e+",0 a "+e+","+e+" 0 1,0 -"+2*e+",0",i=Rt("path");i.setAttribute("d",r),i.setAttribute("fill",Ns),i.setAttribute(ks,this._currentElementId),this._container.appendChild(i),this._element=i},zs.prototype._drawPolygon=function(t){for(var e=Rt("path"),r="",i=0;i<t.length;i++){var n=t[i];r+=(0===i?"M":"L")+n.x+","+n.y+" "}r+="Z",e.setAttribute("d",r),e.setAttribute(ks,this._currentElementId),e.setAttribute("fill",Ns),this._container.appendChild(e),this._element=e},zs.prototype._drawStraightLine=function(t,e){var r=Rt("path"),i="M "+t.x+","+t.y+" L"+e.x+","+e.y;r.setAttribute("d",i),r.setAttribute(ks,this._currentElementId),this._container.appendChild(r),this._element=r},zs.prototype._drawQuadraticCurve=function(t,e,r){var i=Rt("path"),n="M "+t.x+","+t.y+" Q"+e.x+","+e.y+" "+r.x+","+r.y;i.setAttribute("d",n),i.setAttribute("fill",Ns),i.setAttribute(ks,this._currentElementId),this._container.appendChild(i),this._element=i},zs.prototype._drawCubicCurve=function(t,e,r,i){var n=Rt("path"),o="M "+t.x+","+t.y+" C"+e.x+","+e.y+" "+r.x+","+r.y+" "+i.x+","+i.y;n.setAttribute("d",o),n.setAttribute("fill",Ns),n.setAttribute(ks,this._currentElementId),this._container.appendChild(n),this._element=n},zs.prototype._fill=function(t){var e=this._colorManager.rgbaToRgb(t);this._element.setAttribute("fill",e.color),this._element.setAttribute("fill-opacity",e.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path","url(#"+this._currentClipPathId+")")},zs.prototype._stroke=function(t,e,r){void 0===r&&(r=[]);var i=this._element;i.setAttribute("stroke-width",e);var n=this._colorManager.rgbaToRgb(t);i.setAttribute("stroke",n.color),i.setAttribute("stroke-opacity",n.opacity),0<r.length&&i.setAttribute("stroke-dasharray",r.map(Rs).toString())},zs.prototype._startClip=function(){var t=Rt("clipPath"),e=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+this._clipPathCounter++,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)},zs.prototype._endClip=function(){this._currentClipPathId=null},zs.prototype._startReverseClip=function(){var t=Rt("clipPath"),e=this._element.cloneNode(!1),r=e.getAttribute("d");e.setAttribute("clip-rule","evenodd"),e.setAttribute("d",r+" M 0 0 L "+this._width+" 0 L "+this._width+" "+this._height+" L 0 "+this._height),this._currentClipPathId="clip-path-"+this._clipPathCounter++,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)},zs.prototype._endReverseClip=function(){this._currentClipPathId=null},zs.prototype._displayText=function(t,e,r,i,n,o,a,s,u,l,d){void 0===l&&(l=0),void 0===d&&(d=0);var h=Rt("g");h.setAttribute(ks,this._currentElementId);var c=this._colorManager.rgbaToRgb(i),f=c.opacity,g=this._colorManager.rgbaToRgb(c.color),p=t.x+l*this._viewZoom,_=t.y+d*this._viewZoom;a=a||"normal";var v=Rs(p);h.setAttribute("font-family",n),h.setAttribute("font-size",o),"bold"===a?h.setAttribute("font-weight",a):h.setAttribute("font-style",a),h.setAttribute("fill",g.color),h.setAttribute("fill-opacity",f),e&&h.setAttribute("transform","rotate("+Ms(-e)+" "+p+", "+_+")"),h.setAttribute("text-anchor",Os[s]||"middle");for(var m=r.split("\n"),y=m.length,b=Rs(_-((y+1)/2-1/3)*o),x="center"===s?0:-u/2,E=0;E<y;E++){var A=Rt("text");A.appendChild(Ft(m[E])),A.setAttribute("x",v+x),A.setAttribute("y",b+(E+1)*o),h.appendChild(A)}this._currentClipPathId&&h.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(h)},zs.prototype._displayImage=function(t,e,r,i,n,o,a){var s=t.x,u=t.y;if(!this._hideImages&&("isDummy"in i||i.width&&i.height)){var l,d=i.width,h=i.height;if(n&&(d=e,h=r),o){var c=s-e/2,f=u-r/2,g=s+e/2,p=u+r/2,_=s-d/2,v=u-h/2;for((l=Rt("g")).setAttribute(ks,this._currentElementId);c<_;)_-=d;for(;f<v;)v-=h;for(var m=v;_<g;){for(;v<p;)Fs(i.src,_,v,d,h,l),v+=h;v=m,_+=d}}else(l=Fs(i.src,s-d/2,u-h/2,d,h)).setAttribute(ks,this._currentElementId);if(this._currentClipPathId&&l.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),1!==a){var y=this._addBackgroundBlendingFilter(a);l.setAttribute("filter","url(#"+y+")")}this._container.appendChild(l)}},zs.prototype._displayPieChart=function(t,l,e){var d,r=2*l,i=2*r,h=t.x,c=t.y,f=Rt("g");f.setAttribute(ks,this._currentElementId),1===e.length&&(d=function(t,e,r,i,n,o,a){void 0===o&&(o=1);var s=Rt("rect");return s.setAttribute("x",t),s.setAttribute("y",e),s.setAttribute("width",r),s.setAttribute("height",i),s.setAttribute("fill",n),s.setAttribute("fill-opacity",o),a&&a.appendChild(s),s}(h-r,c-r,i,i,e[0],1,f)),1<e.length&&ro(e,function(t,e,r){var i=h+l*Math.cos(r),n=c+l*Math.sin(r),o=h+l*Math.cos(e),a=c+l*Math.sin(e),s=r-e<=Math.PI?0:1,u="M "+i+","+n+" A "+l+","+l+" 0 "+s+" 0 "+o+","+a+" L "+h+","+c+" L "+i+","+n;(d=Rt("path")).setAttribute("d",u),d.setAttribute("fill",t),d.setAttribute("stroke-width",0),f.appendChild(d)}),this._currentClipPathId&&f.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(f)},zs);function zs(t){var e=Ds.call(this,t)||this;return e._svg=Rt("svg"),e._defs=Rt("defs"),e._styles=Rt("g",{class:"styles"}),e._background=Rt("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),e._currentElementId="0",e._currentClipPathId=null,e._clipPathCounter=1,e._defs.appendChild(e._styles),e._svg.setAttribute("pointer-events","none"),e._svg.style.userSelect="none",e._svg.appendChild(e._defs),e._svg.appendChild(e._background),e._clear(),e}var Bs=(Us.prototype.reset=function(){this._initialize()},Us.prototype._initialize=function(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0},Us.prototype.set=function(t){var e=t.maxCoord,r=t.maxScaledSize,i=t.maxMinVisibleSize,n=t.maxSymbolicSize,o=t.maxDashLength,a=t.maxGapLength,s=t.maxPatternScale,u=this.maxCoord<e||this.maxScaledSize<r||this.maxMinVisibleSize<i||this.maxSymbolicSize<n||this.maxDashLength<o||this.maxGapLength<a||this.maxPatternScale<s;return u&&(this.maxCoord=e,this.maxScaledSize=r,this.maxMinVisibleSize=i,this.maxSymbolicSize=n,this.maxDashLength=o,this.maxGapLength=a,this.maxPatternScale=s,this._mustUpdate=!0),u},Us.prototype.update=function(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this},Us.prototype.getVersion=function(){return this._version},Us);function Us(){this._version=0,this._initialize()}var Vs={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},js=(Gs.prototype.add=function(i){var n=this;Object.keys(i).forEach(function(t){var e=i[t].slice();e.length<8&&(e[4]=e[0],e[5]=e[1],e[6]=e[2],e[7]=e[3]);var r=z(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);n._nameToPolygon[t]=e,n._polygonToName[r]=t})},Gs.prototype.getCoefficients=function(t){return this._nameToPolygon[t]||this._linearEasing},Gs.prototype.getName=function(t,e,r,i,n,o,a,s){var u=z(t,e,r,i,n,o,a,s);return this._polygonToName[u]||"linear"},Gs);function Gs(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(Vs)}var Hs=(qs.prototype.resizeBoundaries=function(t,e,r,i,n,o){this._maxScaledSize=t,this._maxMinVisibleSize=e,this._maxSymbolicSize=r,this._maxDashLength=i,this._maxGapLength=n,this._maxPatternScale=o,this._actualScaledSizeToBytes=65535/t,this._actualMinVisibleSizeToBytes=15/e,this._actualSymbolicSizeToBytes=255/r,this._actualDashLengthToBytes=3/i,this._actualGapLengthToBytes=3/n,this._actualPatternScaleToBytes=255/o},qs.prototype.storeGenericObject=function(t,e,r){var i=this,n=this._shapeManager.getIdFromName(r.shape),o=r.pieceId,a=this._dashLengthToBytes(r.dashLength),s=this._gapLengthToBytes(r.gapLength),u=+r.hasHead,l=+r.hasTail,d=+r.isBodyTriangle,h=+r.isSelfLoop,c=this._patternScaleToBytes(r.patternScale),f=this._offsetAngleToBytes(r.offsetAngle),g=+r.isText,p=+r.adjustTextAngle,_=+r.isBadge,v=+r.unusedFlag2,m=+r.unusedFlag3,y=this._opacityToBytes(r.opacity),b=this._minVisibleSizeToBytes(r.globalMinVisibleSize),x=this._minVisibleSizeToBytes(r.strokeMinVisibleSize),E=this._minVisibleSizeToBytes(r.patternMinVisibleSize),A=this._symbolicSizeToBytes(r.symbolicSize),S=this._curvatureToBytes(r.curvature),w=r.pattern.attributes.colors;w&&(r.pattern.attributes.colors=w.split(";").map(function(t){return Ks(i._colorToBytes(t.trim()))}).join(";"));var T=this._patternManager.getIdFromDefinition(r.pattern),C=this._colorToBytes(r.fillColor),M=this._colorToBytes(r.strokeColor),I=this._colorToBytes(r.patternColor),L=this._coordToBytes(r.x1),N=this._coordToBytes(r.y1),O=this._coordToBytes(r.x2),k=this._coordToBytes(r.y2),R=this._scaledSizeToBytes(r.rectWidthOrSourceRadiusScaled),F=this._fixedSizeToBytes(r.rectWidthOrSourceRadiusFixed),D=this._scaledSizeToBytes(r.rectHeightOrTargetRadiusScaled),P=this._fixedSizeToBytes(r.rectHeightOrTargetRadiusFixed),z=this._scaledSizeToBytes(r.thicknessOrFontSizeScaled),B=this._fixedSizeToBytes(r.thicknessOrFontSizeFixed),U=this._scaledSizeToBytes(r.strokeWidthScaled),V=this._fixedSizeToBytes(r.strokeWidthFixed),j=this._scaledSizeToBytes(r.offsetScaled),G=this._fixedSizeToBytes(r.offsetFixed),H=this._fixedSizeToBytes(r.pattern.attributes.paddingTop||0),q=this._fixedSizeToBytes(r.pattern.attributes.paddingLeft||0),W=n+(o<<4)+(a<<8)+(s<<10)+(u<<12)+(l<<13)+(d<<14)+(h<<15),X=c+(f<<8)+(g<<11)+(p<<12)+(_<<13)+(v<<14)+(m<<15),Y=y+(b<<4)+(x<<8)+(E<<12),Z=A+(S<<8);this._setUint16(t,e+0,W),this._setUint16(t,e+2,X),this._setUint16(t,e+4,Y),this._setUint16(t,e+6,Z),this._setUint16(t,e+8,T),this._setUint16(t,e+10,C),this._setUint16(t,e+12,M),this._setUint16(t,e+14,I),this._setFloat32(t,e+16,L),this._setFloat32(t,e+20,N),this._setFloat32(t,e+24,O),this._setFloat32(t,e+28,k),this._setUint16(t,e+32,R),this._setUint16(t,e+34,F),this._setUint16(t,e+36,D),this._setUint16(t,e+38,P),this._setUint16(t,e+40,z),this._setUint16(t,e+42,B),this._setUint16(t,e+44,U),this._setUint16(t,e+46,V),this._setUint16(t,e+48,j),this._setUint16(t,e+50,G),this._setInt16(t,e+52,H),this._setInt16(t,e+54,q)},qs.prototype._setUint16=function(t,e,value){t.setUint16(e,value,this._littleEndian)},qs.prototype._setInt16=function(t,e,value){t.setUint16(e,this._signedToUnsignedInt16(value),this._littleEndian)},qs.prototype._setFloat32=function(t,e,value){t.setFloat32(e,value,this._littleEndian)},qs.prototype._colorToBytes=function(t){var e=this._colorParser(t);return Math.round(15*e[0])+(Math.round(15*e[1])<<4)+(Math.round(15*e[2])<<8)+(Math.round(15*e[3])<<12)},qs.prototype._coordToBytes=function(value){return value},qs.prototype._scaledSizeToBytes=function(value){return Math.ceil(Math.min(value,this._maxScaledSize)*this._actualScaledSizeToBytes)},qs.prototype._fixedSizeToBytes=function(value){return value},qs.prototype._minVisibleSizeToBytes=function(value){return Math.round(Math.min(value,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)},qs.prototype._symbolicSizeToBytes=function(value){return Math.round(Math.min(value,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)},qs.prototype._dashLengthToBytes=function(value){return Math.round(Math.min(value,this._maxDashLength)*this._actualDashLengthToBytes)},qs.prototype._gapLengthToBytes=function(value){return Math.round(Math.min(value,this._maxGapLength)*this._actualGapLengthToBytes)},qs.prototype._patternScaleToBytes=function(value){return Math.round(Math.min(value,this._maxPatternScale)*this._actualPatternScaleToBytes)},qs.prototype._offsetAngleToBytes=function(value){return Math.round((value+Qa)%Qa*(8/Qa))},qs.prototype._opacityToBytes=function(value){return Math.round(15*Math.min(value,1))},qs.prototype._curvatureToBytes=function(value){return this._signedToUnsignedByte(value)},qs.prototype._signedToUnsignedByte=function(value){return Xe(value,-128,127)+128},qs.prototype._signedToUnsignedInt16=function(value){return Xe(value,-32768,32767)+32768},qs.prototype.storeAnimationInformation=function(t,e,r,i){var n=r.beginTime,o=r.duration;this._setAnimationBeginTime(t,e,n),this._setAnimationDuration(t,e,o),this._setAnimationEasing(t,e,i)},qs.prototype._setAnimationBeginTime=function(t,e,r){this._setFloat32(t,e,r)},qs.prototype._setAnimationDuration=function(t,e,r){this._setFloat32(t,e+4,r)},qs.prototype._setAnimationEasing=function(t,e,r){this._setUint16(t,e+8,(r[0]+128<<8)+(r[4]+128)),this._setUint16(t,e+10,(r[1]+128<<8)+(r[5]+128)),this._setUint16(t,e+12,(r[2]+128<<8)+(r[6]+128)),this._setUint16(t,e+14,(r[3]+128<<8)+(r[7]+128))},qs.prototype.extractGenericElement=function(t,e,r){var i=t.type,n=t.animated,o=t.getDataView(),a=e*t.elementSize,s=this._genericObject;if(s.valid=!1,o.getUint16(a)&&(s.valid=!0,this._extractGenericObject(s.end,o,a,r),n&&(this._extractGenericObject(s.start,o,56+a,r),this._extractAnimationInformation(s.animation,o,112+a)),s.id=this._bufferOfsetToId.get(t.getId(),e),2===i)){var u=t.getSideDataView(),l=e*t.getTotalSideElementsSize(),d=l+t.getTotalSideElementsSize();s.end.pattern=this._textManager.extractTextFromDataView(u,l,d)}return s},qs.prototype._extractGenericObject=function(t,e,r,i){var n=i.bytesToActualCoord,o=i.bytesToActualScaledSize,a=i.bytesToActualMinVisibleSize,s=i.bytesToActualPatternScale,u=i.bytesToActualSymbolicSize,l=i.bytesToActualDashLength,d=i.bytesToActualGapLength,h=e,c=r,f=this._littleEndian,g=h.getUint16(c,f),p=Ws(g,0,4),_=Ws(g,4,8),v=Ws(g,8,10),m=Ws(g,10,12),y=Ws(g,12,13),b=Ws(g,13,14),x=Ws(g,14,15),E=Ws(g,15,16),A=h.getUint16(c+2,f),S=Ws(A,0,8),w=Ws(A,8,11),T=Ws(A,11,12),C=Ws(A,12,13),M=Ws(A,13,14),I=Ws(A,14,15),L=Ws(A,15,16),N=h.getUint16(c+4,f),O=Ws(N,0,4),k=Ws(N,4,8),R=Ws(N,8,12),F=Ws(N,12,16),D=h.getUint16(c+6,f),P=Ws(D,0,8),z=Ws(D,8,16),B=h.getUint16(c+8,f),U=h.getUint16(c+10,f),V=h.getUint16(c+12,f),j=h.getUint16(c+14,f),G=h.getFloat32(c+16,f),H=h.getFloat32(c+20,f),q=h.getFloat32(c+24,f),W=h.getFloat32(c+28,f),X=h.getUint16(c+32,f),Y=h.getUint16(c+34,f),Z=h.getUint16(c+36,f),K=h.getUint16(c+38,f),Q=h.getUint16(c+40,f),J=h.getUint16(c+42,f),$=h.getUint16(c+44,f),tt=h.getUint16(c+46,f),et=h.getUint16(c+48,f),rt=h.getUint16(c+50,f),it=Xs(h.getUint16(c+52,f)),nt=Xs(h.getUint16(c+54,f));t.pieceId=_,t.shape=this._shapeManager.getNameFromId(p),t.x1=Ys(G,n),t.y1=Ys(H,n),t.x2=Ys(q,n),t.y2=Ys(W,n),t.rectWidthOrSourceRadiusScaled=Ys(X,o),t.rectWidthOrSourceRadiusFixed=Y,t.rectHeightOrTargetRadiusScaled=Ys(Z,o),t.rectHeightOrTargetRadiusFixed=K,t.thicknessOrFontSizeScaled=Ys(Q,o),t.thicknessOrFontSizeFixed=J,t.strokeWidthScaled=Ys($,o),t.strokeWidthFixed=tt,t.offsetScaled=Ys(et,o),t.offsetFixed=rt,t.pattern=this._patternManager.getDefinitionFromId(B),t.pattern.attributes.paddingTop=it,t.pattern.attributes.paddingLeft=nt,t.opacity=O/15,t.fillColor=Ks(U),t.strokeColor=Ks(V),t.patternColor=Ks(j),t.globalMinVisibleSize=Ys(k,a),t.strokeMinVisibleSize=Ys(R,a),t.patternMinVisibleSize=Ys(F,a),t.offsetAngle=w*(2*Math.PI/8),t.patternScale=S*s,t.symbolicSize=P*u,t.curvature=z-128,t.dashLength=v*l,t.gapLength=m*d,t.hasHead=!!y,t.hasTail=!!b,t.isBodyTriangle=!!x,t.isSelfLoop=!!E,t.isText=!!T,t.adjustTextAngle=!!C,t.isBadge=!!M,t.unusedFlag2=!!I,t.unusedFlag3=!!L},qs.prototype._extractAnimationInformation=function(t,e,r){var i=this._littleEndian,n=e.getFloat32(r,i),o=e.getFloat32(r+4,i),a=e.getUint16(r+8,i),s=e.getUint16(r+10,i),u=e.getUint16(r+12,i),l=e.getUint16(r+14,i),d=(a>>8)-128,h=(s>>8)-128,c=(u>>8)-128,f=(l>>8)-128,g=a%256-128,p=s%256-128,_=u%256-128,v=l%256-128;t.beginTime=n,t.duration=o,t.easing=this._easingManager.getName(d,h,c,f,g,p,_,v)},qs);function qs(t,e,r,i,n,o){this._littleEndian=D(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=32767,this._actualMinVisibleSizeToBytes=15,this._actualSymbolicSizeToBytes=255,this._actualDashLengthToBytes=3,this._actualGapLengthToBytes=3,this._actualPatternScaleToBytes=255,this._genericObject=In(),this._shapeManager=e,this._patternManager=t,this._textManager=r,this._bufferOfsetToId=i,this._easingManager=n,this._colorParser=o}function Ws(value,t,e){return value%(1<<e)>>t}function Xs(value){return value-32768}function Ys(value,t){return value*t}var Zs=new Array(65535);function Ks(value){var t=Zs[value];if(!t){var e=Ws(value,0,4)/15,r=Ws(value,4,8)/15,i=Ws(value,8,12)/15,n=Ws(value,12,16)/15;t="rgba("+(255*e|0)+", "+(255*r|0)+", "+(255*i|0)+", "+n+")",e+r+i+n==0&&(t=null),Zs[value]=t}return t}var Qs=(Js.prototype.reset=function(t,e,r,i){return this.type=t,this.animated=e,this.depth=r,void 0!==i&&(this._id=i),this.stencilUsage=1,this.size=0,this},Js.prototype.next=function(){if(this.size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this.size++]},Js.prototype.nextAndReset=function(){var t,e=this.next();return e.end=Mn(e.end),e.start=Mn(e.start),e.animation=(void 0===(t=e.animation)&&(t={}),t.duration=0,t.beginTime=-1,t.easing="linear",t),e},Js.prototype.forEach=function(t){this._list.forEach(t)},Js.prototype.getElement=function(t){return this._list[t]},Js.prototype.getCurrentElement=function(){return this._list[this.size-1]},Js.prototype.getElements=function(){return this._list},Js.prototype.getId=function(){return this._id},Js.prototype.setGlobalAnimation=function(t,e,r){for(var i=0;i<this.size;++i){var n=this._list[i].animation;n.duration=t,n.beginTime=e,n.easing=r}},Js);function Js(){this._capacity=128,this._id=0,this.size=0,this.depth=0,this.animated=!1,this.stencilUsage=1,this.type=1,this._list=Array(this._capacity);for(var t=0;t<this._capacity;++t)this._list[t]=In()}var $s={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:function(){return!0},hideImages:!1,renderBackground:!1},tu={webgl:Fa,canvas:As,svg:Ps},eu=[0,0,0,0],ru={webgl:null,svg:null,canvas:null},iu=(nu.createInitData=function(){var t={};for(var e in tu)t[e]=tu[e].createInitData();return t},nu.cacheInitData=function(t){ru=t},nu.getCachedInitData=function(){return ru},nu.clearCachedInitData=function(){ru={webgl:null,svg:null,canvas:null}},nu.prototype.freeBlock=function(t){this._checkBlockId(t);var e=this._blockIdToAddress[t],r=this._bufferList.freeBlock(e);return this._blockIdToAddress[t]=r},nu.prototype.addCanvas=function(t){t.style.touchAction="none",t.style.msContentZooming="none",this._resizeCanvas(t),this._additionalCanvases.push(t),this._updateDomElement()},nu.prototype.removeCanvas=function(t){t.style.touchAction="",t.style.msContentZooming="",O(this._additionalCanvases,t),this._updateDomElement()},nu.prototype._ensureDomElementsFitParent=function(){if(this._domElement.offsetWidth!==this._view.width||this._domElement.offsetHeight!==this._view.height){this._domElement.style.width=this._view.width+"px",this._domElement.style.height=this._view.height+"px";for(var t=0;t<this._additionalCanvases.length;++t)this._resizeCanvas(this._additionalCanvases[t])}},nu.prototype._ensureCorrectBackgroundColor=function(){this._backgroundColor!==this._view.backgroundColor&&(this._domElement.style.backgroundColor=this._view.backgroundColor||"",this._backgroundColor=this._view.backgroundColor)},nu.prototype.createGroup=function(){return new Qs},nu.prototype.parseColor=function(t){return this._colorManager.parseColor(t)},nu.prototype.clear=function(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._bufferOfsetToId.reset()},nu.prototype.notifyFontsReloaded=function(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0},nu.prototype.notifyPatternUpdate=function(){this._patternManager.notifyUpdate()},nu.prototype.getShapePoints=function(t){return this._shapeManager.getDefinitionFromName(t).points},nu.prototype.checkShapeHit=function(t,e,r){var i=this._shapeManager.getDefinitionFromName(t),n=i.getDistanceFromStrokeVertically,o=i.getDistanceFromStrokeHorizontally;return 0<=Math.min(n(e,r),o(e,r))},nu.prototype.setGlobalBoundaries=function(t){var e=t.maxBlockId,r=void 0===e?0:e,i=t.maxScaledSize,n=t.maxMinVisibleSize,o=t.maxSymbolicSize,a=t.maxDashLength,s=t.maxGapLength,u=t.maxPatternScale;return r>this._blockIdToAddress.length&&this._resizeBlockArray(r),!!this._boundariesManager.set(t)&&(this._memoryManager.resizeBoundaries(i,n,o,a,s,u),!0)},nu.prototype._resizeBlockArray=function(t){var e=new Uint32Array(t);e.set(this._blockIdToAddress),this._blockIdToAddress=e},nu.prototype.registerShape=function(t,e){this._shapeManager.register(t,e)},nu.prototype._bindBlock=function(t,e,r,i,n,o,a){this._checkBlockId(t);var s=this._blockIdToAddress[t],u=this._bufferList.allocateBlock(s,e,r,i,n,o,a);return this._blockIdToAddress[t]=u.address,this._currentDataView=u.buffer.getDataView(),this._currentElementSize=u.buffer.elementSize,this._currentBlockOffset=u.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=u.buffer.getSideDataView(),this._currentSideElementSize=u.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,u},nu.prototype._setItemIndex=function(t){var e=this._currentBlockOffset+t;this._currentByteOffset=e*this._currentElementSize,this._currentSideByteOffset=e*this._currentSideElementSize},nu.prototype._checkBlockId=function(t){t>=this._blockIdToAddress.length&&this._resizeBlockArray(qe(t+1))},nu.prototype._setTextCharacters=function(t){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,t)},nu.prototype._storeElement=function(t,e){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,t.end),e&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+56,t.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+112,t.animation,this._easingManager.getCoefficients(t.animation.easing)))},nu.prototype.storeGroup=function(t,e){if(!e||0===e.size)return this.freeBlock(t);var r=e.type,i=e.depth,n=e.size,o=e.getElements(),a=e.animated,s=e.stencilUsage,u=e.getId(),l=0;if(2===r)for(var d=0;d<n;++d){var h=(_=o[d]).start,c=_.end;if(c.pattern.type===Vi){var f=c.pattern.attributes.text;l=Math.max(l,f.length)}a&&h.pattern.type===Vi&&(f=h.pattern.attributes.text,l=Math.max(l,f.length))}var g=this._bindBlock(t,r,a,i,n,l,s);for(d=0;d<n;++d){var p=o[d];this._setItemIndex(d),this._storeElement(p,a),this._bufferOfsetToId.set(g.buffer.getId(),g.offset+d,u)}if(2===r)for(d=0;d<n;++d){var _=o[d];this._setItemIndex(d),this._setTextCharacters(_.end.pattern)}return g.address},nu.prototype._refreshTextElements=function(){for(var t=0,e=this._bufferList.getBuffers();t<e.length;t++){var r=e[t];if(r&&2===r.type){for(var i=r.getSideDataView(),n=r.getTotalSideElementsSize(),o=r.getSize(),a=0,s=n,u=0;u<o;++u){var l=this._textManager.extractTextFromDataView(i,a,s);this._textManager.storeTextInDataView(i,a,s,l),a=s,s+=n}r.triggerUpdate()}}},nu.prototype.extractElement=function(t,e){if(void 0===e&&(e=0),!t)return null;var r=this._bufferList.getBlockInfo(t);return this._renderer.extractElement(r.buffer,r.offset+e)},nu.prototype.getDomElement=function(){return this._domElement},nu.prototype.measureText=function(t,e,r,i){return void 0===i&&(i=1),this._textManager.measureText(t,e,r,i)},nu.prototype.setRenderType=function(t){this._renderType!==t&&(this._renderType=t,this._switchMainRenderer=!0)},nu.prototype._ensureMainRendererReady=function(){if(this._switchMainRenderer){null===this._renderType&&(this._renderType="canvas");var t=tu[this._renderType];t&&t.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}},nu.prototype._updateDomElement=function(){for(var t=this._renderer&&this._renderer.getDomElement(),e=this._domElement;e.firstChild;)e.removeChild(e.firstChild);t&&this._appendDomChild(t);for(var r=0;r<this._additionalCanvases.length;++r)this._appendDomChild(this._additionalCanvases[r])},nu.prototype._appendDomChild=function(t){t.style.position="absolute",t.style.left="0",t.style.top="0",this._domElement.appendChild(t)},nu.prototype._instanciateRenderer=function(t){return new(null===t?Nn:tu[t])({initData:null===t?null:this._initData[t],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,colorManager:this._colorManager,easingManager:this._easingManager,memoryManager:this._memoryManager})},nu.prototype.setView=function(t){this._view=I(I({},this._view),t)},nu.prototype._updateManagers=function(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())},nu.prototype._resizeCanvas=function(t){Ln(t,this._view.width,this._view.height,this._view.pixelRatio)},nu.prototype.render=function(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)},nu.prototype.ensureAnimationsReady=function(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()},nu.prototype.export=function(t,e,r){var i=this._instanciateRenderer(t),n=I(I({},this._view),e);return"setViewportClipping"in i&&i.setViewportClipping(!1),n.renderBackground=!0,this._updateManagers(),i.renderFrame(n),i.export(r).then(function(){return i.getDomElement()})},nu.prototype.getCurrentTime=function(){return Zt()},nu.prototype.getImageData=function(){return this._renderer&&this._renderer.getImageData()},nu.prototype.destroy=function(){for(var t=0,e=Object.keys(this._renderersByType);t<e.length;t++){var r=e[t],i=this._renderersByType[r];i&&i.destroy()}},nu.prototype.transparentify=function(t){var e=this.parseColor(t)||eu;return"rgba("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+",0)"},nu.prototype.initDebugRenderingLoop=function(t){var e=this,r=void 0===t?{}:t,i=r.triggerKey,n=void 0===i?"r":i,o=r.start,a=void 0===o||o;document.addEventListener("keydown",function(t){t.key===n&&(a=!a)});var s=function(force){(a||force)&&(e.setView({currentTime:Zt()}),e.render()),window.requestAnimationFrame(function(){s()})};window.requestAnimationFrame(function(){document.body.appendChild(e.getDomElement()),s(!0)})},nu);function nu(t){var e=this;this._view=j($s),this._domElement=ht?document.createElement("div"):At(),this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._additionalCanvases=[],this._refreshTexts=!1,this._backgroundColor=null,this._initData=t||{},this._colorManager=new Ri,this._easingManager=new js,this._patternManager=new Yi,this._shapeManager=new ln,this._boundariesManager=new Bs,this._textManager=new wa(this._patternManager),this._bufferOfsetToId=new To,this._memoryManager=new Hs(this._patternManager,this._shapeManager,this._textManager,this._bufferOfsetToId,this._easingManager,function(t){return e.parseColor(t)||eu}),this._bufferList=new fn}var ou,au=(b(su,ou=ua),Object.defineProperty(su.prototype,"src",{get:function(){return this._src},set:function(t){var e=this;t&&(this._src=t,setTimeout(function(){e.onload&&e.onload.call(e),e.width=1,e.height=1,e.fire("load")},10))},enumerable:!0,configurable:!0}),su.prototype.addEventListener=function(t,e){this.on(t,e)},su);function su(t,e){var r=ou.call(this)||this;return r.isDummy=!0,r.width=0,r.height=0,r}var uu=(lu.prototype.setImgCrossOrigin=function(t){this._crossOrigin=t},lu.prototype.clear=function(){this._images={},this._nbLoaded=0,this._nbToLoad=0},lu.prototype.getImage=function(t){var e,r,i=this,n=this._images[t];return void 0===n&&(this._nbToLoad+=1,(n=new("undefined"!=typeof Image?Image:au)(e,r)).crossOrigin=this._crossOrigin,n.onload=function(){return i._onImgLoad(t)},n.onerror=function(){i._onImgLoad(t),i._images[t]=null},n.src=t,this._images[t]=n),n},lu.prototype._onImgLoad=function(e){this._nbLoaded+=1,this._onFetch.forEach(function(t){return t(e)}),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach(function(t){return t()}),this._whenReady=[])},lu.prototype.onFetch=function(t){this._onFetch.push(t)},lu.prototype.whenReady=function(){var e=this;return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise(function(t){return e._whenReady.push(t)})},lu.prototype.destroy=function(){this._whenReady=[],this._onFetch=[]},lu);function lu(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}function du(t,e,r,i,n,o,a,s,u){void 0===s&&(s=0),void 0===u&&(u=!1);var l=distance(r,i,n,o),d=(a/2*(u?distance(t,e,n,o)/l:1)+s)/l,h=(n-r)*d,c=(o-i)*d,f=r+c,g=i-h,p=t-f,_=e-g,v=r-c-f,m=i+h-g,y=n+c-f,b=o-h-g,x=p*v+_*m,E=p*y+_*b;return 0<x&&x<v*v+m*m&&0<E&&E<y*y+b*b}function hu(t,e){return t.x===e.x&&t.y===e.y}function cu(t,e,r,i){return Math.atan2(i-e,r-t)}function fu(t,e,r,i,n,o,a,s){var u=t-r,l=e-i,d=n-a,h=o-s,c=u*h-d*l,f=(l*(t-n)-u*(e-o))/c;if(f<0||1<f)return null;var g=(d*(o-e)+h*(t-n))/c;return 0<=g&&g<=1?{x:t-g*u,y:e-g*l}:null}function gu(t,e,r,i,n,o,a,s){var u,l=[];return(u=fu(t,e,r,i,n,o,n,s))&&l.push(u),(u=fu(t,e,r,i,n,s,a,s))&&l.push(u),(u=fu(t,e,r,i,a,s,a,o))&&l.push(u),(u=fu(t,e,r,i,a,o,n,o))&&l.push(u),l}function pu(t,e,r,i,n,o,a,s){var u=((a-n)*(e-o)-(s-o)*(t-n))/((s-o)*(r-t)-(a-n)*(i-e)),l=((r-t)*(e-o)-(i-e)*(t-n))/((s-o)*(r-t)-(a-n)*(i-e));return 0<=u&&u<=1&&0<=l&&l<=1}function _u(t,e,r,i,n,o,a,s){return n<=t&&o<=e&&t<=a&&e<=s||(n<=r&&o<=i&&r<=a&&i<=s||(!!pu(t,e,r,i,n,o,n,s)||(!!pu(t,e,r,i,a,o,a,s)||(!!pu(t,e,r,i,n,o,a,o)||!!pu(t,e,r,i,n,s,a,s)))))}function vu(t,e,r){return Math.sqrt(mu(t.x,t.y,e.x,e.y,r.x,r.y))}function mu(t,e,r,i,n,o){var a=Cs(r,i,n,o);if(0===a)return Cs(t,e,r,i);var s=((t-r)*(n-r)+(e-i)*(o-i))/a;return Cs(t,e,r+(s=Math.max(0,Math.min(1,s)))*(n-r),i+s*(o-i))}function yu(t,e,r,i,n,o){var a=n-r,s=o-i;if(0==a&&0==s)return{x:r,y:i};var u=((t-r)*a+(e-i)*s)/(a*a+s*s);return u<0?{x:r,y:i}:1<u?{x:n,y:o}:{x:r+u*a,y:i+u*s}}var bu=1e-6,xu=1e-12;function Eu(){for(var t=arguments,e=t.length-1,r=e,i=[],n=0;n<=e&&Math.abs(t[n])<=xu;n++)e--;switch(e){case 1:!function(t,e,r){void 0===r&&(r=[]);0!==e&&r.push(-t/e)}(t[r],t[r-1],i);break;case 2:!function(t,e,r,i){void 0===i&&(i=[]);var n=e/r,o=n*n-t/r*4;if(0<o){var a=Math.sqrt(o);i.push(.5*(-n+a)),i.push(.5*(-n-a))}else 0==o&&i.push(.5*-n)}(t[r],t[r-1],t[r-2],i);break;case 3:!function(t,e,r,i,n){void 0===n&&(n=[]);var o,a,s=r/i,u=e/i,l=(3*u-s*s)/3,d=(2*s*s*s-9*u*s+t/i*27)/27,h=s/3,c=d*d/4+l*l*l/27,f=d/2;Math.abs(c)<=bu&&(c=0);if(0<c){var g=Math.sqrt(c);a=0<=(o=-f+g)?Math.pow(o,1/3):-Math.pow(-o,1/3),0<=(o=-f-g)?a+=Math.pow(o,1/3):a-=Math.pow(-o,1/3),n.push(a-h)}else if(c<0){var distance=Math.sqrt(-l/3),p=Math.atan2(Math.sqrt(-c),-f)/3,_=Math.cos(p),v=Math.sin(p),m=Math.sqrt(3);n.push(2*distance*_-h),n.push(-distance*(_+m*v)-h),n.push(-distance*(_-m*v)-h)}else o=0<=f?-Math.pow(f,1/3):Math.pow(-f,1/3),n.push(2*o-h),n.push(-o-h)}(t[r],t[r-1],t[r-2],t[r-3],i)}return i}function Au(t,e,r,i,n,o,a,s,u,l,d){var h,c,f=Math.min(a,u),g=Math.min(s,l),p=Math.max(a,u),_=Math.max(s,l);for(var v=Eu((h=s-l)*(t+-2*r+n)+(c=u-a)*(e+-2*i+o),h*(-2*t+2*r)+c*(-2*e+2*i),h*t+c*e+(a*l-u*s)),m=0;m<v.length;m++){var y=v[m];if(0<=y&&y<=1){var b=t+(r-t)*y,x=e+(i-e)*y,E=b+(r+(n-r)*y-b)*y,A=x+(i+(o-i)*y-x)*y;if(a===u){if(g<=A&&A<=_){if(!d)return 1;d.push(E,A)}}else if(s===l){if(f<=E&&E<=p){if(!d)return 1;d.push(E,A)}}else if(f<=E&&g<=A&&E<=p&&A<=_){if(!d)return 1;d.push(E,A)}}}return d&&d.length/2}function Su(t,e,r,i,n,o,a,s,u,l,d){return d?(Au(t,e,r,i,n,o,a,s,u,s,d),Au(t,e,r,i,n,o,u,s,u,l,d),Au(t,e,r,i,n,o,a,l,u,l,d),Au(t,e,r,i,n,o,a,s,a,l,d),d.length/2):a<=t&&t<=u&&s<=e&&e<=l||a<=n&&n<=u&&s<=o&&o<=l||Au(t,e,r,i,n,o,a,s,u,s)||Au(t,e,r,i,n,o,u,s,u,l)||Au(t,e,r,i,n,o,a,l,u,l)||Au(t,e,r,i,n,o,a,s,a,l)?1:0}function wu(t,e,r,i,n,o,a,s,u,l,d,h,c){var f,g,p=Math.min(u,d),_=Math.min(l,h),v=Math.max(u,d),m=Math.max(l,h);for(var y=Eu((f=l-h)*(-1*t+3*r+-3*n+a)+(g=d-u)*(-1*e+3*i+-3*o+s),f*(3*t+-6*r+3*n)+g*(3*e+-6*i+3*o),f*(-3*t+3*r)+g*(-3*e+3*i),f*t+g*e+(u*h-d*l)),b=0;b<y.length;b++){var x=y[b];if(0<=x&&x<=1){var E=t+(r-t)*x,A=e+(i-e)*x,S=r+(n-r)*x,w=i+(o-i)*x,T=E+(S-E)*x,C=A+(w-A)*x,M=T+(S+(n+(a-n)*x-S)*x-T)*x,I=C+(w+(o+(s-o)*x-w)*x-C)*x;if(u===d){if(_<=I&&I<=m){if(!c)return 1;c.push(M,I)}}else if(l===h){if(p<=M&&M<=v){if(!c)return 1;c.push(M,I)}}else if(p<=M&&_<=I&&M<=v&&I<=m){if(!c)return 1;c.push(M,I)}}}return c&&c.length/2}function Tu(t,e,r,i,n,o,a,s,u,l,d,h,c){return c?(wu(t,e,r,i,n,o,a,s,u,l,d,l,c),wu(t,e,r,i,n,o,a,s,d,l,d,h,c),wu(t,e,r,i,n,o,a,s,u,h,d,h,c),wu(t,e,r,i,n,o,a,s,u,l,u,h,c),c.length/2):u<=t&&t<=d&&l<=e&&e<=h||u<=a&&a<=d&&l<=s&&s<=h||wu(t,e,r,i,n,o,a,s,u,l,d,l)||wu(t,e,r,i,n,o,a,s,d,l,d,h)||wu(t,e,r,i,n,o,a,s,u,h,d,h)||wu(t,e,r,i,n,o,a,s,u,l,u,h)?1:0}function Cu(t,e,r,i,n,o,a,s){return void 0===s&&(s={x:0,y:0}),s.x=(1-t)*(1-t)*e+2*(1-t)*t*o+t*t*i,s.y=(1-t)*(1-t)*r+2*(1-t)*t*a+t*t*n,s}function Mu(t,e,r,i,n,o,a,s,u,l,d){void 0===l&&(l=0),void 0===d&&(d=!1);var h=r-2*a+n,c=i-2*s+o,f=-((r-t)*c-(i-e)*h)/((2*a-2*r)*c-(2*s-2*i)*h);if(f<0||1<f)return!1;var g=u/2;return d&&(g*=1-f),g+=l,distance(ps(r,a,n,f),ps(i,s,o,f),t,e)<=g}function Iu(t,e,r,i,n,o,a,s,u,l){void 0===l&&(l={x:0,y:0});var d=(1-t)*(1-t)*(1-t),h=3*t*(1-t)*(1-t),c=3*t*t*(1-t),f=t*t*t;return l.x=d*e+h*o+c*s+f*i,l.y=d*r+h*a+c*u+f*n,l}function Lu(t,e,r,i,n,o,a,s,u,l,d,h){var c=distance(r,i,a,s);if(Math.abs(t-r)>c||Math.abs(e-i)>c)return!1;for(var f,g=.5,p=distance(t,e,r,i)<distance(t,e,n,o)?-.01:.01,_=100,v=Iu(g,r,i,n,o,a,s,u,l),m=distance(t,e,v.x,v.y),y=d/2+h;0<_--&&0<=g&&g<=1&&y<m&&(.001<p||p<-.001);)f=m,Iu(g,r,i,n,o,a,s,u,l,v),f<(m=distance(t,e,v.x,v.y))?g+=p=-p/2:g+p<0||1<g+p?(p/=2,m=f):g+=p;return m<y}function Nu(t,e,r,i,n,o,a){void 0===a&&(a=oa());var s=t+2/3*(r-t),u=e+2/3*(i-e);return Ou(t,e,s,u,s+1/3*(n-t),u+1/3*(o-e),n,o,a)}function Ou(t,e,r,i,n,o,a,s,u){void 0===u&&(u=oa());var l,d,h,c,f,g=Math.min,p=Math.max,_=Math.sqrt;u.minX=g(t,a),u.maxX=p(t,a),u.minY=g(e,s),u.maxY=p(e,s);for(var v=void 0,m=void 0,y=void 0,b=void 0,x=void 0,E=void 0,A=void 0,S=0;S<2;++S)if(f=0===S?(d=t,h=r,c=n,a):(d=e,h=i,c=o,s),m=6*d-12*h+6*c,v=-3*d+9*h-9*c+3*f,y=3*h-3*d,m|=0,y|=0,0!==(v|=0))(x=m*m-4*y*v)<0||(0<(E=(-m+_(x))/(2*v))&&E<1&&(l=ku(E,d,h,c,f),0===S?(u.minX=g(u.minX,l),u.maxX=p(u.maxX,l)):(u.minY=g(u.minY,l),u.maxY=p(u.maxY,l))),0<(A=(-m-_(x))/(2*v))&&A<1&&(l=ku(A,d,h,c,f),0===S?(u.minX=g(u.minX,l),u.maxX=p(u.maxX,l)):(u.minY=g(u.minY,l),u.maxY=p(u.maxY,l))));else{if(0===m)continue;0<(b=-y/m)&&b<1&&(l=ku(b,d,h,c,f),0===S?(u.minX=g(u.minX,l),u.maxX=p(u.maxX,l)):(u.minY=g(u.minY,l),u.maxY=p(u.maxY,l)))}return u}function ku(t,e,r,i,n){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*r+3*(1-t)*Math.pow(t,2)*i+Math.pow(t,3)*n}var Ru={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}};var Fu=(Du.prototype.getDefinition=function(){return this._attributesManager.getAttributeLayerDefinition(this._id)},Du.prototype.update=function(t){this._attributesManager.updateAttributeLayer(this._id,t)},Du.prototype.destroy=function(){this._attributesManager.destroyAttributeLayer(this._id)},Du.prototype.updateElements=function(t){this._attributesManager.updateElementsForAttributeLayer(this._id,t)},Du.prototype.updateAll=function(){this._attributesManager.updateAllForAttributeLayer(this._id)},Du.prototype.setAttributeValues=function(t,e,r){this._attributesManager.setAttributeLayerValues(this._id,t,e,r)},Du.prototype.getUsedAttributeNames=function(t){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,t)},Du.prototype.getFlexArrays=function(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)},Du);function Du(t,e){this._attributesManager=t,this._id=e}function Pu(t){return"string"==typeof t}function zu(t,e){return t?t+"."+e:e}var Bu={storage:1,default:0},Uu=(Vu.prototype._getAllIndexes=function(){for(var t=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),e=new Uint32Array(t),r=1;r<=t;++r)e[r-1]=r;return e},Vu.prototype.addAll=function(){this._all=!0},Vu.prototype.add=function(t){if(!this._all)for(var e=0;e<t._indexes.length;e++){var r=t._indexes[e];this.addIndex(r)}},Vu.prototype.addIndex=function(t){0===this._flexArray.get(t)&&(this._flexArray.set(t,1),this._indexList.push(t))},Vu.prototype.isEmpty=function(){return!this._all&&this._indexList.isEmpty()},Vu.prototype.isFull=function(){return this._all},Vu.prototype.getListAndClear=function(){var t=this.getList();return this.clear(),t},Vu.prototype.getList=function(){var t;if(this._all&&!this._includeRemovedElements)t=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{var e=this._all?this._getAllIndexes():this._indexList.slice();t=this._eltList(e)}return t},Vu.prototype.clear=function(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())},Vu.prototype.addSet=function(t){if(t._all)this.addAll();else for(var e=t._indexList.getBuffer(),r=t._indexList.getLength(),i=0;i<r;++i)this.addIndex(e[i])},Vu);function Vu(t){var e=t.graph,r=t.isNode,i=t.includeRemovedElements;this._all=!1,this._isNode=r,this._graph=e,this._includeRemovedElements=i,this._eltList=r?this._graph.nodeList:this._graph.edgeList,this._flexArray=r?this._graph.createNodeAttribute(Bu):this._graph.createEdgeAttribute(Bu),this._all=!1,this._indexList=this._graph.createIndexList(r)}function ju(t){return"boolean"==typeof t||0===t||1===t?t:void 0}function Gu(t){return"number"==typeof t&&isFinite(t)?t:void 0}function Hu(t){return"number"==typeof t&&isFinite(t)&&0<=t?t:void 0}var qu=-100,Wu=new Function("x","return (typeof x === 'number' && isFinite(x)\n    && x >= "+qu+"\n    && x <= 400)\n    ? x : undefined;");function Xu(t){return null===t||"string"==typeof t||"number"==typeof t?t:void 0}function Yu(t){return"fixed"===t||"scaled"===t?t:void 0}function Zu(t,e){return e.parseColor(t)?t:void 0}function Ku(t,e){return"inherit"===t||e.parseColor(t)?t:void 0}function Qu(t){return null===t?null:"string"==typeof t?t.split(",").map(function(t){var e=t.trim(),r=-1!==e.indexOf(" "),i=e[0];return r&&'"'!==i&&"'"!==i?'"'+e+'"':e}).join(","):void 0}function Ju(t){return"none"===t?"normal":"normal"===t||"italic"===t||"bold"===t||"italic bold"===t||"bold italic"===t?t:void 0}function $u(t){return"left"===t||"center"===t?t:void 0}function tl(t){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(t)?t:void 0}function el(r){return function(t){if("number"==typeof t)return isFinite(t)&&0<=t?t:void 0;if("string"==typeof t&&"%"===t.charAt(t.length-1)){var e=parseFloat(t);return isNaN(e)?void 0:r*e/100}}}var rl=el(5),il=el(12),nl=el(10),ol=el(2),al=el(5),sl=el(10),ul=el(2),ll=el(5),dl=el(50),hl=el(1);function cl(r){return{_check:Xu,_set:function(t,e,value){t.badges[r].text.content.set(e,value),null==value&&t.badges[r].image.url.set(e,value)},_get:function(t,e){return t.badges[r].text.content.get(e)},color:{_flexArray:"white",_check:Ku},scale:{_flexArray:.45,_check:el(.45)},positionScale:{_flexArray:1,_check:Hu},minVisibleSize:{_flexArray:12,_check:el(12)},image:{_alias:"badges."+r+".image.url",url:{_flexArray:null,_check:Xu},scale:{_flexArray:1,_check:el(1)}},stroke:{color:{_flexArray:"black",_check:Ku},width:{_flexArray:2,_check:el(2)},scalingMethod:{_flexArray:"fixed",_check:Yu}},text:{_alias:"badges."+r+".text.content",content:{_flexArray:null,_check:Xu},color:{_flexArray:"black",_check:Ku},font:{_flexArray:"Arial",_check:Qu},style:{_flexArray:"normal",_check:Ju},scale:{_flexArray:.5,_check:el(.5)},paddingLeft:{_flexArray:0,_check:Gu},paddingTop:{_flexArray:0,_check:Gu}}}}var fl={x:{_flexArray:0,_check:Gu,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:Gu,_disableMemoryOptimization:!0},radius:{_flexArray:5,_check:rl},scalingMethod:{_flexArray:"scaled",_check:Yu},color:{_flexArray:"grey",_check:function(t,e){if(e.parseColor(t))return t;if(Array.isArray(t)){if(t.length<1)return;for(var r=0;r<t.length;++r)if(!e.parseColor(t[r]))return;return t}}},opacity:{_flexArray:1,_check:Hu},shape:{_flexArray:"circle",_check:function(t){return"equilateral"===t?"pentagon":"circle"===t||"square"===t||"cross"===t||"diamond"===t||"pentagon"===t||"star"===t?t:void 0}},layer:{_flexArray:0,_check:Wu},detectable:{_flexArray:!0,_check:ju},draggable:{_flexArray:!0,_check:ju},layoutable:{_flexArray:!0,_check:ju},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:2,_check:ol},scalingMethod:{_flexArray:"fixed",_check:Yu},color:{_flexArray:"white",_check:Ku},minVisibleSize:{_flexArray:12,_check:el(12)}},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:5,_check:al},scalingMethod:{_flexArray:"fixed",_check:Yu},color:{_flexArray:null,_check:Ku},minVisibleSize:{_flexArray:0,_check:el(0)}},badges:{_check:function(t){return null===t?t:void 0},_set:function(t,e,value){t.badges.topLeft.text.content.set(e,value),t.badges.topLeft.image.url.set(e,value),t.badges.topRight.text.content.set(e,value),t.badges.topRight.image.url.set(e,value),t.badges.bottomLeft.text.content.set(e,value),t.badges.bottomLeft.image.url.set(e,value),t.badges.bottomRight.text.content.set(e,value),t.badges.bottomRight.image.url.set(e,value)},topLeft:cl("topLeft"),topRight:cl("topRight"),bottomLeft:cl("bottomLeft"),bottomRight:cl("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:null,_check:Zu},width:{_flexArray:50,_check:dl},scalingMethod:{_flexArray:"fixed",_check:Yu},strokeColor:{_flexArray:null,_check:Zu},strokeWidth:{_flexArray:1,_check:hl},clustering:{_flexArray:!1,_check:ju},hideNonAdjacentEdges:{_flexArray:!1,_check:ju}},pulse:{enabled:{_flexArray:!1,_check:ju},duration:{_flexArray:1e3,_check:Hu},interval:{_flexArray:800,_check:Hu},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:Ku},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:Ku},width:{_flexArray:50,_check:Hu},startRatio:{_flexArray:1,_check:Hu},endRatio:{_flexArray:2,_check:Hu}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Xu},font:{_flexArray:"Arial",_check:Qu},color:{_flexArray:"black",_check:Zu},scale:{_flexArray:.7,_check:el(.7)},style:{_flexArray:"normal",_check:Ju},minVisibleSize:{_flexArray:12,_check:el(12)}},image:{_alias:"image.url",url:{_flexArray:null,_check:Xu},scale:{_flexArray:1,_check:el(1)},fit:{_flexArray:!0,_check:ju},tile:{_flexArray:!1,_check:ju},minVisibleSize:{_flexArray:12,_check:el(12)}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:ju},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:Zu},minVisibleSize:{_flexArray:12,_check:el(12)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Xu},font:{_flexArray:"Arial",_check:Qu},color:{_flexArray:"black",_check:Ku},size:{_flexArray:12,_check:il},scale:{_flexArray:.1,_check:Hu},style:{_flexArray:"normal",_check:Ju},align:{_flexArray:"center",_check:$u},margin:{_flexArray:10,_check:sl},padding:{_flexArray:2,_check:ul},backgroundColor:{_flexArray:null,_check:Ku},tip:{_flexArray:!0,_check:ju},minVisibleSize:{_flexArray:24,_check:el(24)},scaling:{_flexArray:!1,_check:ju},position:{_flexArray:"bottom",_check:function(t){return"top"===t||"bottom"===t||"left"===t||"right"===t||"center"===t?t:void 0}},maxLineLength:{_flexArray:0,_check:Hu},truncateLength:{_flexArray:0,_check:Hu},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Xu},font:{_flexArray:"Arial",_check:Qu},color:{_flexArray:"black",_check:Ku},size:{_flexArray:10,_check:nl},scale:{_flexArray:.08,_check:Hu},style:{_flexArray:"normal",_check:Ju},align:{_flexArray:"center",_check:$u},margin:{_flexArray:5,_check:ll},padding:{_flexArray:2,_check:ul},backgroundColor:{_flexArray:null,_check:Ku},minVisibleSize:{_flexArray:24,_check:el(24)}}}};var gl={width:{_flexArray:1,_check:el(1)},scalingMethod:{_flexArray:"scaled",_check:Yu},color:{_flexArray:"grey",_check:function(t,e){return"source"===t||"target"===t||e.parseColor(t)?t:void 0}},opacity:{_flexArray:1,_check:Hu},minVisibleSize:{_flexArray:0,_check:Hu},layer:{_flexArray:0,_check:Wu},detectable:{_flexArray:!0,_check:ju},curvature:{_flexArray:0,_check:Gu},adjustAnchors:{_flexArray:!0,_check:ju},shape:{_check:function(t){return["line","tapered","arrow","dashed","dotted"].includes(t)?t:void 0},_set:function(t,e,value){var r=void 0,i=void 0,n=void 0,o=void 0;"line"===value?(r="line",i="plain",o=n=null):"arrow"===value?(r="line",i="plain",n="arrow",o=null):"tapered"===value?(r="triangle",i="plain",o=n=null):"dashed"===value?(r="line",i="dashed",o=n=null):"dotted"===value&&(r="line",i="dotted",o=n=null),t.shape.body.set(e,r),t.shape.style.set(e,i),t.shape.head.set(e,n),t.shape.tail.set(e,o)},type:"shape.body",body:{_flexArray:"line",_check:function(t){return"line"===t||"triangle"===t?t:void 0}},head:{_flexArray:null,_check:tl},tail:{_flexArray:null,_check:tl},style:{_flexArray:"plain",_check:function(t){return"plain"===t||"dashed"===t||"dotted"===t?t:void 0}}},stroke:{color:{_flexArray:"inherit",_check:Ku},width:{_flexArray:0,_check:el(0)},scalingMethod:{_flexArray:"fixed",_check:Yu},minVisibleSize:{_flexArray:0,_check:Hu}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:null,_check:Zu},width:{_flexArray:10,_check:el(10)},scalingMethod:{_flexArray:"fixed",_check:Yu},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:ju},duration:{_flexArray:1e3,_check:Hu},interval:{_flexArray:800,_check:Hu},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:Ku},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:Ku},width:{_flexArray:10,_check:Hu},startRatio:{_flexArray:1,_check:Hu},endRatio:{_flexArray:2,_check:Hu}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:ju},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:Zu},minVisibleSize:{_flexArray:0,_check:Hu}},text:{_alias:"text.content",content:{_flexArray:null,_check:Xu},font:{_flexArray:"Arial",_check:Qu},color:{_flexArray:"black",_check:Zu},size:{_flexArray:12,_check:el(12)},scale:{_flexArray:1,_check:Hu},style:{_flexArray:"normal",_check:Ju},align:{_flexArray:"center",_check:$u},margin:{_flexArray:2,_check:Gu},padding:{_flexArray:2,_check:el(2)},backgroundColor:{_flexArray:null,_check:Ku},minVisibleSize:{_flexArray:4,_check:Hu},adjustAngle:{_flexArray:!0,_check:ju},scaling:{_flexArray:!1,_check:ju},maxLineLength:{_flexArray:0,_check:Hu},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Xu},font:{_flexArray:"Arial",_check:Qu},color:{_flexArray:"black",_check:Zu},size:{_flexArray:12,_check:el(12)},scale:{_flexArray:.8,_check:Hu},style:{_flexArray:"normal",_check:Ju},align:{_flexArray:"center",_check:$u},margin:{_flexArray:2,_check:Gu},padding:{_flexArray:2,_check:el(2)},backgroundColor:{_flexArray:null,_check:Ku},minVisibleSize:{_flexArray:4,_check:Hu}}}};function pl(){}function _l(){}function vl(t,e){if(!t._check)throw new Error("error somewhere for "+e);return{check:t._check,set:new Function("flexArrays","index","value","flexArrays."+e+".set(index, value);"),get:new Function("flexArrays","index","return flexArrays."+e+".get(index);"),nested:{}}}function ml(t,e,r){if(void 0!==(e=e||t)._flexArray)return vl(e,r);var i={check:null,get:null,set:null,nested:{}};if(Pu(e)||e._alias){var n=Pu(e)?e:e._alias;i=vl(l=H(t,n),n)}else{if(e._set?(i.set=e._set,i.check=e._check):(i.set=pl,i.check=_l),e._get)i.get=e._get;else{var o="return "+function t(e,r){if(void 0!==e._flexArray)return"flexArrays."+r+".get(index)";for(var i=[],n=0,o=Object.keys(e);n<o.length;n++){var a=o[n],s=e[a];if(!a.startsWith("_")&&J(s)){var u=t(e[a],zu(r,a));u&&i.push(a+": "+u)}}return i.length?"{\n"+i.join(",\n").split("\n").map(function(t){return"  "+t}).join("\n")+"\n}":""}(e,r)+";";i.get=new Function("flexArrays","index",o)}i.nested={}}if(!Pu(e))for(var a=0,s=Object.keys(e);a<s.length;a++){var u=s[a],l=e[u];u.startsWith("_")||(i.nested[u]=ml(t,l,zu(r,u)))}return i}function yl(t){return t}function bl(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}var xl=ml(fl),El=ml(gl),Al={name:"animationStart",storage:32,default:0},Sl={name:"animationDuration",storage:16,default:0},wl={name:"animationEasing",storage:"resource",default:"linear"},Tl={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},Cl={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},Ml={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1},Il=Object.freeze({__proto__:null,linear:yl,quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:bl,cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}}),Ll=[];function Nl(t){var e=Ll;return void 0===t.output?("function"==typeof t.attributes&&(e="all"),J(t.attributes)&&(e=Y(t.attributes))):t.output&&(e=t.output.attributes),Fl(e,t.allAttributePaths)}function Ol(t,e,r,i,n,o){!function(t,e,r,i){if(r<i)for(var n=0,o=e.attributes;n<o.length;n++)for(var a=o[n],s=0,u=t.attributes;s<u.length;s++){if(u[s]===a)return 1}for(var l=0,d=e.tags;l<d.length;l++)for(var h=d[l],c=0,f=t.tags;c<f.length;c++){if(h===f[c])return 1}}(r,i,n,o)||t.push(e)}function kl(t,e,r){if(!e)return{attributes:[],tags:[]};if(!0===t)return{attributes:[],tags:[ar]};var value,i={attributes:Fl((t=t||{}).attributes,r),tags:(value=t.tags,Array.isArray(value)?value.filter(Pu):[])};return t.data&&i.tags.push(sr),t.selection&&i.tags.push(dr),t.hover&&i.tags.push(ur),i}function Rl(t){return Array.isArray(t)?t.join("."):t}function Fl(value,t){if("all"===value)return t.slice();if(!Array.isArray(value))return[];var r=function(value){return value.map(Rl).filter(Pu)}(value);return t?t.filter(function(e){return r.some(function(t){return e.startsWith(t)})}):r}var Dl=(Pl.prototype.clear=function(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()},Pl.prototype.getAttributeFlexArrays=function(){return this._finalFlexArraysWrapped},Pl.prototype.getPrevAttributeFlexArrays=function(){return this._prevFlexArrays},Pl.prototype.getAnimationInformation=function(t){for(var e=t._indexes,r=Array(e.length),i=0;i<e.length;i++){var n=e[i];r[i]={duration:this._finalFlexArraysWrapped.animationDuration.get(n),start:this._finalFlexArraysWrapped.animationStart.get(n),easing:this._finalFlexArraysWrapped.animationEasing.get(n)}}return r},Pl.prototype.startUpdate=function(){},Pl.prototype.prepareFlexArraysUpdate=function(t){this._currentFlexArrays=t.inputFlexArrays},Pl.prototype.setLastFlexArrays=function(t){this._lastFlexArrays=t},Pl.prototype.updateFlexArrays=function(t){var e=t.attributes,r=t.selector,i=t.context,n=t.outputFlexArrays,o=t.toUpdate,a=t.formattedOutput;this._elementsUpdated.addSet(o),this._elementsToRedraw.addSet(o);var s=o.getListAndClear();if(e&&s.size){for(var u=zr(this._graph,s,r,i),l=u.valid,d=u.invalid,h=0,c=a.attributes;h<c.length;h++)for(var f=H(n,c[h]),g=0;g<d._indexes.length;g++){var p=d._indexes[g];f.set(p,void 0)}this._assignAttributesToFlexArrays(this._accessors,n,l,e,i),this._addUpdatedAttributes(t)}},Pl.prototype.endUpdate=function(){for(var t=this._elementsUpdated.getList(),e=0,r=Fo(this._updatedAttributesTmp);e<r.length;e++)for(var i=r[e],n=H(this._lastFlexArrays,i),o=H(this._finalFlexArrays,i),a=0;a<t._indexes.length;a++){var s=t._indexes[a];o.set(s,n.get(s))}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays},Pl.prototype.setAttributeValues=function(t,e,r,i,n){var o=t.outputFlexArrays,a=this._accessors;this._assignAttributesToFlexArrays(a,o,e,r,null),this._addUpdatedAttributes(t,i),this._elementsUpdated.add(e),this._elementsToRedraw.add(e)},Pl.prototype.notifyLayerDestroyed=function(t){this._addUpdatedAttributes(t)},Pl.prototype._addUpdatedAttributes=function(t,e){for(var r=t.outputFlexArrays,i=t.formattedOutput,n=0,o=Array.isArray(e)?Fl(e):i.attributes;n<o.length;n++){var a=o[n];H(r,a).isInitialized()&&(this._updatedAttributes.add(a),this._updatedAttributesTmp.add(a),this._allUsedAttributes.add(a))}},Pl.prototype.addUpdatedAttribute=function(t){this._updatedAttributes.add(t),this._updatedAttributesTmp.add(t),this._allUsedAttributes.add(t)},Pl.prototype.getUsedAttributeNames=function(t){return function e(r,i,n){return void 0===i&&(i=[]),void 0===n&&(n=""),r.constructor===Ve?r.isInitialized()&&i.push(n):r.constructor===Object&&Object.keys(r).forEach(function(t){e(r[t],i,zu(n,t))}),i}(t.outputFlexArrays)},Pl.prototype.redrawElements=function(t){this._elementsToRedraw.add(t)},Pl.prototype.redrawAll=function(){this._elementsToRedraw.addAll()},Pl.prototype.getAndResetElementsToRedraw=function(){return this._elementsToRedraw.getListAndClear()},Pl.prototype.getAndResetElementsUpdated=function(){return this._elementsUpdated.getListAndClear()},Pl.prototype.getAndResetAttributesUpdated=function(){var t=Fo(this._updatedAttributes);return this._updatedAttributes.clear(),t},Pl.prototype.getUpdatedAttributes=function(){return this._updatedAttributes},Pl.prototype.getUpdatedElementsList=function(){return this._elementsUpdated.getList()},Pl.prototype.getUpdatedAttributesSet=function(){return new Set(this._updatedAttributes)},Pl.prototype.createFlexArrays=function(){return this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!1})},Pl.prototype.getAttributeValues=function(t,e,r,i){var n=i?this._prevFlexArrays:this._currentFlexArrays;return r?this._getMultipleAttributeValues(t,e,n):this._getSingleAttributeValues(t,e,n)},Pl.prototype._getAccessor=function(t){void 0===t&&(t="");for(var e=this._accessors,r=R(t),i=0,n=r;i<n.length;i++){var o=n[i];if(!(e=e.nested[o]))throw new Error(this._eltName+' attribute "'+r.join("")+'" does not exist')}return e},Pl.prototype._getSingleAttributeValues=function(t,e,r){for(var i=this._getAccessor(e),n=t._indexes,o=Array(n.length),a=0;a<n.length;a++)o[a]=i.get(r,n[a]);return o},Pl.prototype._getMultipleAttributeValues=function(t,e,r){if(!e||"all"===e)return this._getSingleAttributeValues(t,"",r);for(var i=Array(t.size),n=0;n<i.length;++n)i[n]={};for(n=0;n<e.length;n++)for(var o=e[n],a=this._getSingleAttributeValues(t,o,r),s=0;s<i.length;++s)G(i[s],o,a[s]);return i},Pl.prototype.setAnimationAttributes=function(t,e){var r=e.duration,i=e.startTime,n=e.easing,o=t._indexes,a=this._finalFlexArraysWrapped.animationDuration,s=this._finalFlexArraysWrapped.animationStart,u=this._finalFlexArraysWrapped.animationEasing,l=Fo(this._allUsedAttributes);if(r){for(var d=!1,h=0,c=l;h<c.length;h++){var f=c[h];if("x"!==f&&"y"!==f)for(var g=H(this._finalFlexArrays,f),p=H(this._prevFlexArrays,f),_=0;_<o.length;_++){var v=o[_];p.set(v,g.get(v))}else d=!0}if(d){var m=Zt(),y=this._finalFlexArrays.x,b=this._finalFlexArrays.y,x=this._prevFlexArrays.x,E=this._prevFlexArrays.y;for(_=0;_<o.length;_++){v=o[_];var A=a.get(v);if(A){var S=s.get(v),w=u.get(v),T=(Il[w]||yl)(Math.min((m-S)/A,1)),C=Ye(x.get(v),y.get(v),T),M=Ye(E.get(v),b.get(v),T);x.set(v,C),E.set(v,M)}else x.set(v,y.get(v)),E.set(v,b.get(v))}}}a.fill(o,r),s.fill(o,i),u.fill(o,n)},Pl.prototype.resetAnimationAttributes=function(t){this._finalFlexArraysWrapped.animationDuration.fill(t._indexes,0)},Pl.prototype.getUsedAttributes=function(){return Fo(this._allUsedAttributes)},Pl.prototype.getDefaultFlexArrays=function(){return this._defaultFlexArrays},Pl.prototype._assignAttributesToFlexArrays=function(t,e,r,i,n,o){if(void 0===o&&(o=[]),"function"==typeof i){for(var a=o.join("."),s=0;s<r.size;++s)if(p=r.get(s)){var u=i(p,n,a);this._assignSingleValueToFlexArray(e,p,t,u,o)}}else if(J(i)){var l=Object.keys(i);for(s=0;s<l.length;++s){var d=l[s];o.push(d);var h=this._getNestedAccessor(t,d,o),c=i[d];this._assignAttributesToFlexArrays(h,e,r,c,n,o),o.pop()}}else if((Array.isArray(i)||ArrayBuffer.isView(i))&&"color"!==o[0])if(o.length)for(s=0;s<r.size;++s){var f=r._indexes[s],g=t.check(i[s],this._colorManager);t.set(e,f,g)}else for(var s=0;s<r.size;++s)this._assignSingleValueToFlexArray(e,r.get(s),t,i[s],o);else for(g=t.check(i,this._colorManager),s=0;s<r.size;++s){var p=r.get(s);t.set(e,p._index,g)}},Pl.prototype._getNestedAccessor=function(t,e,r){var i=t.nested[e];if(!i)throw new Error(this._eltName+' attribute "'+r.join(".")+'" does not exist');return i},Pl.prototype._assignSingleValueToFlexArray=function(t,e,r,value,i){if(J(value))for(var n=0,o=Object.keys(value);n<o.length;n++){var a=o[n];i.push(a);var s=value[a],u=this._getNestedAccessor(r,a,i);this._assignSingleValueToFlexArray(t,e,u,s,i),i.pop()}else{var l=r.check(value,this._colorManager);r.set(t,e._index,l)}},Pl);function Pl(t,e,r,i){this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._colorManager=e,this._graph=t,this._eltName=r?"node":"edge",this._accessors=r?xl:El,this._createFlexArrays=i,this._finalFlexArrays=this._createFlexArrays(t,{named:!0,useDefaultValues:!0}),this._prevFlexArrays=this._createFlexArrays(t,{named:!1,useDefaultValues:!0}),this._defaultFlexArrays=this._createFlexArrays(t,{named:!1,useDefaultValues:!0}),this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new Uu({graph:t,isNode:r,includeRemovedElements:!0}),this._elementsUpdated=new Uu({graph:t,isNode:r,includeRemovedElements:!1}),this._finalFlexArraysWrapped=I(I(I({},this._finalFlexArrays),{excluded:t.getAttribute(r,"excluded"),textHidden:t.getAttribute(r,"textHidden"),animationStart:t.createAttribute(r,Al),animationDuration:t.createAttribute(r,Sl),animationEasing:t.createAttribute(r,wl),id:this._graph.getAttribute(r,"id")}),!r&&{source:t.getEdgeAttribute("source"),target:t.getEdgeAttribute("target")})}function zl(t,e){var r=e.named,i=e.useDefaultValues,n="resource";return{x:t.createAttribute(!0,{storage:"any",default:i?0:void 0,name:r?"x":void 0}),y:t.createAttribute(!0,{storage:"any",default:i?0:void 0,name:r?"y":void 0}),radius:t.createAttribute(!0,{storage:n,default:i?5:void 0,name:r?"radius":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:i?"scaled":void 0,name:r?"scalingMethod":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"grey":void 0,name:r?"color":void 0}),opacity:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"opacity":void 0}),shape:t.createAttribute(!0,{storage:n,default:i?"circle":void 0,name:r?"shape":void 0}),layer:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"layer":void 0}),detectable:t.createAttribute(!0,{storage:n,default:!!i||void 0,name:r?"detectable":void 0}),draggable:t.createAttribute(!0,{storage:n,default:!!i||void 0,name:r?"draggable":void 0}),layoutable:t.createAttribute(!0,{storage:n,default:!!i||void 0,name:r?"layoutable":void 0}),innerStroke:{width:t.createAttribute(!0,{storage:n,default:i?2:void 0,name:r?"innerStroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:i?"fixed":void 0,name:r?"innerStroke.scalingMethod":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"white":void 0,name:r?"innerStroke.color":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?12:void 0,name:r?"innerStroke.minVisibleSize":void 0})},outerStroke:{width:t.createAttribute(!0,{storage:n,default:i?5:void 0,name:r?"outerStroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:i?"fixed":void 0,name:r?"outerStroke.scalingMethod":void 0}),color:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"outerStroke.color":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"outerStroke.minVisibleSize":void 0})},badges:{topLeft:{color:t.createAttribute(!0,{storage:n,default:i?"white":void 0,name:r?"badges.topLeft.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.45:void 0,name:r?"badges.topLeft.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"badges.topLeft.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?12:void 0,name:r?"badges.topLeft.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"badges.topLeft.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"badges.topLeft.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"badges.topLeft.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:i?2:void 0,name:r?"badges.topLeft.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:i?"fixed":void 0,name:r?"badges.topLeft.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"badges.topLeft.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"badges.topLeft.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:i?"Arial":void 0,name:r?"badges.topLeft.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:i?"normal":void 0,name:r?"badges.topLeft.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.5:void 0,name:r?"badges.topLeft.text.scale":void 0}),paddingLeft:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"badges.topLeft.text.paddging.left":void 0}),paddingTop:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"badges.topLeft.text.paddging.top":void 0})}},topRight:{color:t.createAttribute(!0,{storage:n,default:i?"white":void 0,name:r?"badges.topRight.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.45:void 0,name:r?"badges.topRight.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"badges.topRight.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?12:void 0,name:r?"badges.topRight.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"badges.topRight.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"badges.topRight.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"badges.topRight.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:i?2:void 0,name:r?"badges.topRight.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:i?"fixed":void 0,name:r?"badges.topRight.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"badges.topRight.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"badges.topRight.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:i?"Arial":void 0,name:r?"badges.topRight.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:i?"normal":void 0,name:r?"badges.topRight.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.5:void 0,name:r?"badges.topRight.text.scale":void 0}),paddingTop:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"badges.topRight.text.paddging.left":void 0}),paddingLeft:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"badges.topRight.text.paddging.top":void 0})}},bottomLeft:{color:t.createAttribute(!0,{storage:n,default:i?"white":void 0,name:r?"badges.bottomLeft.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.45:void 0,name:r?"badges.bottomLeft.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"badges.bottomLeft.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?12:void 0,name:r?"badges.bottomLeft.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"badges.bottomLeft.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"badges.bottomLeft.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"badges.bottomLeft.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:i?2:void 0,name:r?"badges.bottomLeft.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:i?"fixed":void 0,name:r?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"badges.bottomLeft.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"badges.bottomLeft.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:i?"Arial":void 0,name:r?"badges.bottomLeft.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:i?"normal":void 0,name:r?"badges.bottomLeft.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.5:void 0,name:r?"badges.bottomLeft.text.scale":void 0}),paddingLeft:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"badges.bottomLeft.text.paddging.left":void 0}),paddingTop:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"badges.bottomLeft.text.paddging.top":void 0})}},bottomRight:{color:t.createAttribute(!0,{storage:n,default:i?"white":void 0,name:r?"badges.bottomRight.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.45:void 0,name:r?"badges.bottomRight.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"badges.bottomRight.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?12:void 0,name:r?"badges.bottomRight.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"badges.bottomRight.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"badges.bottomRight.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"badges.bottomRight.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:i?2:void 0,name:r?"badges.bottomRight.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:i?"fixed":void 0,name:r?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"badges.bottomRight.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"badges.bottomRight.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:i?"Arial":void 0,name:r?"badges.bottomRight.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:i?"normal":void 0,name:r?"badges.bottomRight.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.5:void 0,name:r?"badges.bottomRight.text.scale":void 0}),paddingLeft:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"badges.bottomRight.text.paddging.left":void 0}),paddingTop:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"badges.bottomRight.text.paddging.top":void 0})}}},halo:{color:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"halo.color":void 0}),width:t.createAttribute(!0,{storage:n,default:i?50:void 0,name:r?"halo.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:i?"fixed":void 0,name:r?"halo.scalingMethod":void 0}),strokeColor:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"halo.strokeColor":void 0}),strokeWidth:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"halo.strokeWidth":void 0}),clustering:t.createAttribute(!0,{storage:n,default:!i&&void 0,name:r?"halo.clustering":void 0}),hideNonAdjacentEdges:t.createAttribute(!0,{storage:n,default:!i&&void 0,name:r?"halo.hideNonAdjacentEdges":void 0})},pulse:{enabled:t.createAttribute(!0,{storage:n,default:!i&&void 0,name:r?"pulse.enabled":void 0}),duration:t.createAttribute(!0,{storage:n,default:i?1e3:void 0,name:r?"pulse.duration":void 0}),interval:t.createAttribute(!0,{storage:n,default:i?800:void 0,name:r?"pulse.interval":void 0}),startColor:t.createAttribute(!0,{storage:n,default:i?"rgba(0, 0, 0, 0.6)":void 0,name:r?"pulse.startColor":void 0}),endColor:t.createAttribute(!0,{storage:n,default:i?"rgba(0, 0, 0, 0)":void 0,name:r?"pulse.endColor":void 0}),width:t.createAttribute(!0,{storage:n,default:i?50:void 0,name:r?"pulse.width":void 0}),startRatio:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"pulse.startRatio":void 0}),endRatio:t.createAttribute(!0,{storage:n,default:i?2:void 0,name:r?"pulse.endRatio":void 0})},icon:{content:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"icon.content":void 0}),font:t.createAttribute(!0,{storage:n,default:i?"Arial":void 0,name:r?"icon.font":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"icon.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.7:void 0,name:r?"icon.scale":void 0}),style:t.createAttribute(!0,{storage:n,default:i?"normal":void 0,name:r?"icon.style":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?12:void 0,name:r?"icon.minVisibleSize":void 0})},image:{url:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?1:void 0,name:r?"image.scale":void 0}),fit:t.createAttribute(!0,{storage:n,default:!!i||void 0,name:r?"image.fit":void 0}),tile:t.createAttribute(!0,{storage:n,default:!i&&void 0,name:r?"image.tile":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?12:void 0,name:r?"image.minVisibleSize":void 0})},outline:{enabled:t.createAttribute(!0,{storage:n,default:!i&&void 0,name:r?"outline.enabled":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"rgba(0, 0, 0, 0.36)":void 0,name:r?"outline.color":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?12:void 0,name:r?"outline.minVisibleSize":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"text.content":void 0}),font:t.createAttribute(!0,{storage:n,default:i?"Arial":void 0,name:r?"text.font":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"text.color":void 0}),size:t.createAttribute(!0,{storage:n,default:i?12:void 0,name:r?"text.size":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.1:void 0,name:r?"text.scale":void 0}),style:t.createAttribute(!0,{storage:n,default:i?"normal":void 0,name:r?"text.style":void 0}),align:t.createAttribute(!0,{storage:n,default:i?"center":void 0,name:r?"text.align":void 0}),margin:t.createAttribute(!0,{storage:n,default:i?10:void 0,name:r?"text.margin":void 0}),padding:t.createAttribute(!0,{storage:n,default:i?2:void 0,name:r?"text.padding":void 0}),backgroundColor:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"text.backgroundColor":void 0}),tip:t.createAttribute(!0,{storage:n,default:!!i||void 0,name:r?"text.tip":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?24:void 0,name:r?"text.minVisibleSize":void 0}),scaling:t.createAttribute(!0,{storage:n,default:!i&&void 0,name:r?"text.scaling":void 0}),position:t.createAttribute(!0,{storage:n,default:i?"bottom":void 0,name:r?"text.position":void 0}),maxLineLength:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"text.maxLineLength":void 0}),truncateLength:t.createAttribute(!0,{storage:n,default:i?0:void 0,name:r?"text.truncateLength":void 0}),secondary:{content:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"text.secondary.content":void 0}),font:t.createAttribute(!0,{storage:n,default:i?"Arial":void 0,name:r?"text.secondary.font":void 0}),color:t.createAttribute(!0,{storage:n,default:i?"black":void 0,name:r?"text.secondary.color":void 0}),size:t.createAttribute(!0,{storage:n,default:i?10:void 0,name:r?"text.secondary.size":void 0}),scale:t.createAttribute(!0,{storage:n,default:i?.08:void 0,name:r?"text.secondary.scale":void 0}),style:t.createAttribute(!0,{storage:n,default:i?"normal":void 0,name:r?"text.secondary.style":void 0}),align:t.createAttribute(!0,{storage:n,default:i?"center":void 0,name:r?"text.secondary.align":void 0}),margin:t.createAttribute(!0,{storage:n,default:i?5:void 0,name:r?"text.secondary.margin":void 0}),padding:t.createAttribute(!0,{storage:n,default:i?2:void 0,name:r?"text.secondary.padding":void 0}),backgroundColor:t.createAttribute(!0,{storage:n,default:i?null:void 0,name:r?"text.secondary.backgroundColor":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:i?24:void 0,name:r?"text.secondary.minVisibleSize":void 0})}}}}function Bl(t,e){var r=e.named,i=e.useDefaultValues,n="resource";return{width:t.createAttribute(!1,{storage:n,default:i?1:void 0,name:r?"width":void 0}),scalingMethod:t.createAttribute(!1,{storage:n,default:i?"scaled":void 0,name:r?"scalingMethod":void 0}),color:t.createAttribute(!1,{storage:n,default:i?"grey":void 0,name:r?"color":void 0}),opacity:t.createAttribute(!1,{storage:n,default:i?1:void 0,name:r?"opacity":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:i?0:void 0,name:r?"minVisibleSize":void 0}),layer:t.createAttribute(!1,{storage:n,default:i?0:void 0,name:r?"layer":void 0}),detectable:t.createAttribute(!1,{storage:n,default:!!i||void 0,name:r?"detectable":void 0}),curvature:t.createAttribute(!1,{storage:n,default:i?0:void 0,name:r?"curvature":void 0}),adjustAnchors:t.createAttribute(!1,{storage:n,default:!!i||void 0,name:r?"adjustAnchors":void 0}),shape:{body:t.createAttribute(!1,{storage:n,default:i?"line":void 0,name:r?"shape.body":void 0}),head:t.createAttribute(!1,{storage:n,default:i?null:void 0,name:r?"shape.head":void 0}),tail:t.createAttribute(!1,{storage:n,default:i?null:void 0,name:r?"shape.tail":void 0}),style:t.createAttribute(!1,{storage:n,default:i?"plain":void 0,name:r?"shape.style":void 0})},stroke:{color:t.createAttribute(!1,{storage:n,default:i?"inherit":void 0,name:r?"stroke.color":void 0}),width:t.createAttribute(!1,{storage:n,default:i?0:void 0,name:r?"stroke.width":void 0}),scalingMethod:t.createAttribute(!1,{storage:n,default:i?"fixed":void 0,name:r?"stroke.scalingMethod":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:i?0:void 0,name:r?"stroke.minVisibleSize":void 0})},halo:{color:t.createAttribute(!1,{storage:n,default:i?null:void 0,name:r?"halo.color":void 0}),width:t.createAttribute(!1,{storage:n,default:i?10:void 0,name:r?"halo.width":void 0}),scalingMethod:t.createAttribute(!1,{storage:n,default:i?"fixed":void 0,name:r?"halo.scalingMethod":void 0})},pulse:{enabled:t.createAttribute(!1,{storage:n,default:!i&&void 0,name:r?"pulse.enabled":void 0}),duration:t.createAttribute(!1,{storage:n,default:i?1e3:void 0,name:r?"pulse.duration":void 0}),interval:t.createAttribute(!1,{storage:n,default:i?800:void 0,name:r?"pulse.interval":void 0}),startColor:t.createAttribute(!1,{storage:n,default:i?"rgba(0, 0, 0, 0.6)":void 0,name:r?"pulse.startColor":void 0}),endColor:t.createAttribute(!1,{storage:n,default:i?"rgba(0, 0, 0, 0)":void 0,name:r?"pulse.endColor":void 0}),width:t.createAttribute(!1,{storage:n,default:i?10:void 0,name:r?"pulse.width":void 0}),startRatio:t.createAttribute(!1,{storage:n,default:i?1:void 0,name:r?"pulse.startRatio":void 0}),endRatio:t.createAttribute(!1,{storage:n,default:i?2:void 0,name:r?"pulse.endRatio":void 0})},outline:{enabled:t.createAttribute(!1,{storage:n,default:!i&&void 0,name:r?"outline.enabled":void 0}),color:t.createAttribute(!1,{storage:n,default:i?"rgba(0, 0, 0, 0.36)":void 0,name:r?"outline.color":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:i?0:void 0,name:r?"outline.minVisibleSize":void 0})},text:{content:t.createAttribute(!1,{storage:n,default:i?null:void 0,name:r?"text.content":void 0}),font:t.createAttribute(!1,{storage:n,default:i?"Arial":void 0,name:r?"text.font":void 0}),color:t.createAttribute(!1,{storage:n,default:i?"black":void 0,name:r?"text.color":void 0}),size:t.createAttribute(!1,{storage:n,default:i?12:void 0,name:r?"text.size":void 0}),scale:t.createAttribute(!1,{storage:n,default:i?1:void 0,name:r?"text.scale":void 0}),style:t.createAttribute(!1,{storage:n,default:i?"normal":void 0,name:r?"text.style":void 0}),align:t.createAttribute(!1,{storage:n,default:i?"center":void 0,name:r?"text.align":void 0}),margin:t.createAttribute(!1,{storage:n,default:i?2:void 0,name:r?"text.margin":void 0}),padding:t.createAttribute(!1,{storage:n,default:i?2:void 0,name:r?"text.padding":void 0}),backgroundColor:t.createAttribute(!1,{storage:n,default:i?null:void 0,name:r?"text.backgroundColor":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:i?4:void 0,name:r?"text.minVisibleSize":void 0}),adjustAngle:t.createAttribute(!1,{storage:n,default:!!i||void 0,name:r?"text.adjustAngle":void 0}),scaling:t.createAttribute(!1,{storage:n,default:!i&&void 0,name:r?"text.scaling":void 0}),maxLineLength:t.createAttribute(!1,{storage:n,default:i?0:void 0,name:r?"text.maxLineLength":void 0}),secondary:{content:t.createAttribute(!1,{storage:n,default:i?null:void 0,name:r?"text.secondary.content":void 0}),font:t.createAttribute(!1,{storage:n,default:i?"Arial":void 0,name:r?"text.secondary.font":void 0}),color:t.createAttribute(!1,{storage:n,default:i?"black":void 0,name:r?"text.secondary.color":void 0}),size:t.createAttribute(!1,{storage:n,default:i?12:void 0,name:r?"text.secondary.size":void 0}),scale:t.createAttribute(!1,{storage:n,default:i?.8:void 0,name:r?"text.secondary.scale":void 0}),style:t.createAttribute(!1,{storage:n,default:i?"normal":void 0,name:r?"text.secondary.style":void 0}),align:t.createAttribute(!1,{storage:n,default:i?"center":void 0,name:r?"text.secondary.align":void 0}),margin:t.createAttribute(!1,{storage:n,default:i?2:void 0,name:r?"text.secondary.margin":void 0}),padding:t.createAttribute(!1,{storage:n,default:i?2:void 0,name:r?"text.secondary.padding":void 0}),backgroundColor:t.createAttribute(!1,{storage:n,default:i?null:void 0,name:r?"text.secondary.backgroundColor":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:i?4:void 0,name:r?"text.secondary.minVisibleSize":void 0})}}}}var Ul=(Vl.prototype.getFlexArrays=function(){return{nodes:{current:this.nodes.getAttributeFlexArrays(),previous:this.nodes.getPrevAttributeFlexArrays()},edges:{current:this.edges.getAttributeFlexArrays(),previous:this.edges.getPrevAttributeFlexArrays()}}},Vl.prototype.redrawAll=function(){this.nodes.redrawAll(),this.edges.redrawAll()},Vl.prototype.clear=function(){this.nodes.clear(),this.edges.clear()},Vl.prototype.redrawElements=function(t){this._fetch(t).redrawElements(t)},Vl.prototype.getAnimationInformation=function(t){return this._fetch(t).getAnimationInformation(t)},Vl.prototype.redrawNodes=function(t){this.nodes.redrawElements(t)},Vl.prototype.getUsedAttributes=function(t,e){return this._fetch(e).getUsedAttributeNames(e.isNode?t.nodes:t.edges)},Vl.prototype.createFlexArrays=function(){return{nodes:this.nodes.createFlexArrays(),edges:this.edges.createFlexArrays()}},Vl.prototype.startUpdate=function(){this.nodes.startUpdate(),this.edges.startUpdate()},Vl.prototype.notifyDestroyed=function(t){this.nodes.notifyLayerDestroyed(t.nodes),this.edges.notifyLayerDestroyed(t.edges)},Vl.prototype.prepareUpdate=function(t){this.nodes.prepareFlexArraysUpdate(t.nodes),this.edges.prepareFlexArraysUpdate(t.edges)},Vl.prototype.onUpdate=function(t){this.nodes.updateFlexArrays(t.nodes),this.edges.updateFlexArrays(t.edges)},Vl.prototype.afterLayersUpdate=function(){this.nodes.endUpdate(),this.edges.endUpdate()},Vl.prototype.getAndResetElementsToRedraw=function(){return{nodes:this.nodes.getAndResetElementsToRedraw(),edges:this.edges.getAndResetElementsToRedraw()}},Vl.prototype.getAndResetElementsUpdated=function(){var t=this.nodes,e=this.edges;return{nodes:t.getAndResetElementsUpdated(),edges:e.getAndResetElementsUpdated(),nodeAttributesSet:t.getUpdatedAttributesSet(),nodeAttributes:t.getAndResetAttributesUpdated(),edgeAttributes:e.getAndResetAttributesUpdated()}},Vl.prototype.setAnimationAttributes=function(t,e){var r=t.nodes,i=t.edges;this.nodes.setAnimationAttributes(r,e),this.edges.setAnimationAttributes(i,e)},Vl.prototype.resetAnimationAttributes=function(t){var e=t.nodes,r=t.edges;this.nodes.resetAnimationAttributes(e),this.edges.resetAnimationAttributes(r)},Vl.prototype.setLastOutput=function(t,e){this.nodes.setLastFlexArrays(t),this.edges.setLastFlexArrays(e)},Vl.prototype.getCurrentInput=function(){var t=j(this.nodes.getDefaultFlexArrays()),e=j(this.edges.getDefaultFlexArrays());return{currentNodeFlexArrays:t,currentEdgeFlexArrays:e,allNodeAttributePaths:Y(t),allEdgeAttributePaths:Y(e)}},Vl.prototype.initializeLayer=function(t,e,r){t.nodes.allAttributePaths=e,t.edges.allAttributePaths=r,t.nodes.formattedDependencies=function(t){var e=t.dependencies;void 0===e?e=Tl:J(e)||(e={});var r=Z(t.attributes).some(function(value){return"function"==typeof value}),i=t.selector&&!t.standaloneSelector,n=!(!r&&!i),o=e.adjacentEdges;return!o&&e.adjacentNodes&&(o=!0),{self:kl(e.self,n,t.allAttributePaths),adjacentNodes:kl(e.adjacentNodes,n,t.allAttributePaths),adjacentEdges:kl(o,n,t.allAttributePaths),allNodes:kl(e.allNodes,n,t.allAttributePaths),allEdges:kl(e.allEdges,n,t.allAttributePaths)}}(t.nodes),t.edges.formattedDependencies=function(t){var e=t.dependencies;void 0===e?e=Cl:J(e)||(e={});var r=Z(t.attributes).some(function(value){return"function"==typeof value}),i=t.selector&&!t.standaloneSelector,n=!(!r&&!i);return{self:kl(e.self,n,t.allAttributePaths),extremities:kl(e.extremities,n,t.allAttributePaths),parallelEdges:kl(e.parallelEdges,n,t.allAttributePaths),allNodes:kl(e.allNodes,n,t.allAttributePaths),allEdges:kl(e.allEdges,n,t.allAttributePaths)}}(t.edges),t.nodes.formattedOutput={attributes:Nl(t.nodes),tags:t.tag?[t.tag]:[]},t.edges.formattedOutput={attributes:Nl(t.edges),tags:t.tag?[t.tag]:[]},t.nodes.redrawAdjacentEdges=t.nodes.formattedOutput.attributes.some(function(t){return Ml[t]}),t.initialized=!0},Vl.prototype.connectLayerInputOutput=function(t,e,r){for(var i=t.nodes.formattedOutput,n=t.edges.formattedOutput,o=0,a=i.attributes;o<a.length;o++){var s=H(e,d=a[o]);(h=H(t.nodes.outputFlexArrays,d)).setFallback(s),G(e,d,h)}for(var u=0,l=n.attributes;u<l.length;u++){var d,h;s=H(r,d=l[u]),(h=H(t.edges.outputFlexArrays,d)).setFallback(s),G(r,d,h)}},Vl.prototype.setupLayerDependencies=function(t,e){if(t!==e){var r=t.priority,i=e.priority,n=t.nodes.formattedOutput,o=t.edges.formattedOutput,a=e.nodes.formattedDependencies,s=e.edges.formattedDependencies;Ol(t.depsNodeSelf,e,n,a.self,r,i),Ol(t.depsNodeAdjacentNodes,e,n,a.adjacentNodes,r,i),Ol(t.depsNodeAdjacentEdges,e,o,s.extremities,r,i),Ol(t.depsNodeAllNodes,e,n,a.allNodes,r,i),Ol(t.depsNodeAllEdges,e,o,s.allNodes,r,i),Ol(t.depsEdgeSelf,e,o,s.self,r,i),Ol(t.depsEdgeExtremities,e,n,a.adjacentEdges,r,i),Ol(t.depsEdgeParallelEdges,e,o,s.parallelEdges,r,i),Ol(t.depsEdgeAllNodes,e,n,a.allEdges,r,i),Ol(t.depsEdgeAllEdges,e,o,s.allEdges,r,i)}},Vl.prototype.createAttributeLayerData=function(t,e,r,i){var n=i.tag,o=i.onBeforeUpdate,a=!!i.standaloneSelectors;return{index:-1,id:e,name:t,tag:n||null,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,onBeforeUpdate:o,nodes:{type:"node",name:t,standaloneSelector:a,toUpdate:new Uu({graph:r,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this.nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:t,standaloneSelector:a,toUpdate:new Uu({graph:r,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this.edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}}},Vl.prototype.setAttributeValues=function(t,e,r,i,n){this._fetch(e).setAttributeValues(t,e,r,i,n)},Vl.prototype.getAttributeValues=function(t,e,r,i){return this._fetch(t).getAttributeValues(t,e,r,i)},Vl.prototype._fetch=function(t){return t.isNode?this.nodes:this.edges},Vl);function Vl(t,e){this.nodes=new Dl(t,e,!0,zl),this.edges=new Dl(t,e,!1,Bl)}function jl(t,e){return new Fu(t,e)}var Gl=(Hl.prototype._getLayerById=function(t){for(var e=0;e<this._layers.length;++e){var r=this._layers[e];if(r.id===t)return r.index=e,r}throw new Error("usage of a destroyed style rule or class")},Hl.prototype.getFlexArrays=function(){return this._layerController.getFlexArrays()},Hl.prototype.createFlexArrays=function(){return this._layerController.createFlexArrays()},Hl.prototype.clear=function(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._layerController.clear(),this.updateAllForAllAttributeLayers()},Hl.prototype.redrawElements=function(t){t.size&&(this._layerController.redrawElements(t),this._dom.refresh())},Hl.prototype.redrawAll=function(){this._layerController.redrawAll(),this._dom.refresh()},Hl.prototype._triggerUpdate=function(){this._needUpdate=!0,this._dom.refresh()},Hl.prototype._reconstructAttributeLayersIfNecessary=function(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)},Hl.prototype.getAnimationInformation=function(t){return this._layerController.getAnimationInformation(t)},Hl.prototype.update=function(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._layerController.startUpdate();for(var t=0,e=this._destroyedLayers;t<e.length;t++)(n=e[t]).initialized&&this._layerController.notifyDestroyed(n);for(var r=0,i=this._layers;r<i.length;r++){var n=i[r];this._layerController.prepareUpdate(n),"function"==typeof n.onBeforeUpdate&&n.onBeforeUpdate(n,this,this._layerController),this._layerController.onUpdate(n)}return this._layerController.afterLayersUpdate(),this._updateOngoing=!1,!(this._needUpdate=!1)},Hl.prototype.setAttributeLayerValues=function(t,e,r,i){var n=this._getLayerById(t),o=e.isNode?n.nodes:n.edges;this._reconstructAttributeLayersIfNecessary(),this._layerController.setAttributeValues(o,e,r,i,n),this._updateElementsForAttributeLayers([n],e)},Hl.prototype.getAttributeLayerFlexArrays=function(t){var e=this._getLayerById(t);return{nodes:e.nodes.outputFlexArrays,edges:e.edges.outputFlexArrays}},Hl.prototype.getUsedAttributeLayerAttributes=function(t,e){var r=this._getLayerById(t);return this._layerController.getUsedAttributes(r,e)},Hl.prototype.getUpdatedElements=function(){return{elementsToRedraw:this._layerController.getAndResetElementsToRedraw(),elementsUpdated:this._layerController.getAndResetElementsUpdated()}},Hl.prototype.addAttributeLayer=function(t){var e=t.name,r=t.layerFactory,i=void 0===r?jl:r;if(!e)throw new Error("Attribute layer must have a name");if(e&&this._layers.find(function(t){return t.name===e}))throw new Error('attribute layer with name "'+t.name+'" already exists');var n=this._layerController.createAttributeLayerData(e,++this._layerIdCounter,this._graph,t);return this._layers.push(n),this._updateLayer(n,t),i(this,this._layerIdCounter)},Hl.prototype._reconstructAttributeLayers=function(){this._layers.sort(function(t,e){return t.priority-e.priority});for(var t=this._layerController.getCurrentInput(),e=t.currentNodeFlexArrays,r=t.currentEdgeFlexArrays,i=t.allNodeAttributePaths,n=t.allEdgeAttributePaths,o=0,a=this._layers;o<a.length;o++){var s=a[o];this._layerController.initializeLayer(s,i,n)}for(var u=0,l=this._layers;u<l.length;u++){(s=l[u]).nodes.inputFlexArrays=j(e),s.edges.inputFlexArrays=j(r),s.depsNodeSelf=[],s.depsNodeAdjacentNodes=[],s.depsNodeAdjacentEdges=[],s.depsNodeAllNodes=[],s.depsNodeAllEdges=[],s.depsEdgeSelf=[],s.depsEdgeExtremities=[],s.depsEdgeParallelEdges=[],s.depsEdgeAllNodes=[],s.depsEdgeAllEdges=[],s.nodes.toUpdate.addAll(),s.edges.toUpdate.addAll(),this._layerController.connectLayerInputOutput(s,e,r);for(var d=0,h=this._layers;d<h.length;d++){var c=h[d];this._layerController.setupLayerDependencies(s,c)}}this._layerController.setLastOutput(e,r);for(var f=0,g=this._layers;f<g.length;f++)(s=g[f]).nodes.needAdjacentElements=s.nodes.redrawAdjacentEdges||0<s.depsNodeAdjacentNodes.length||0<s.depsNodeAdjacentEdges.length,s.edges.needAdjacentElements=0<s.depsEdgeExtremities.length||0<s.depsEdgeParallelEdges.length},Hl.prototype._updateLayer=function(t,e){var r=void 0===e?{}:e,i=r.priority,n=r.fullOverwrite,o=r.nodeAttributes,a=r.nodeSelector,s=r.nodeContext,u=r.nodeDependencies,l=r.nodeOutput,d=r.edgeAttributes,h=r.edgeSelector,c=r.edgeContext,f=r.edgeDependencies,g=r.edgeOutput;void 0!==o&&(t.nodes.attributes=n?o:$(t.nodes.attributes,o)),void 0!==a&&(t.nodes.selector=a),void 0!==s&&(t.nodes.context=s),void 0!==u&&(t.nodes.dependencies=u),void 0!==l&&(t.nodes.output=l),void 0!==d&&(t.edges.attributes=n?d:$(t.edges.attributes,d)),void 0!==h&&(t.edges.selector=h),void 0!==c&&(t.edges.context=c),void 0!==f&&(t.edges.dependencies=f),void 0!==g&&(t.edges.output=g),void 0!==i&&(t.priority=i),this._triggerLayerUpdate()},Hl.prototype._triggerLayerUpdate=function(){this._layersNeedUpdate=!0,this._triggerUpdate()},Hl.prototype.updateAllForAttributeLayer=function(t){var e=this._getLayerById(t);this._updateAllForAttributeLayer(e)},Hl.prototype.updateAllForAllAttributeLayers=function(){for(var t=0,e=this._layers;t<e.length;t++){var r=e[t];this._updateAllForAttributeLayer(r)}},Hl.prototype._updateAllForAttributeLayer=function(t,e,r){if(void 0===e&&(e=!0),void 0===r&&(r=!0),e&&!t.nodes.toUpdate.isFull()){t.nodes.toUpdate.addAll();for(var i=0,n=t.depsNodeSelf;i<n.length;i++){var o=n[i];this._updateAllForAttributeLayer(o,!0,!1)}for(var a=0,s=t.depsNodeAdjacentNodes;a<s.length;a++)o=s[a],this._updateAllForAttributeLayer(o,!0,!1);for(var u=0,l=t.depsNodeAdjacentEdges;u<l.length;u++)o=l[u],this._updateAllForAttributeLayer(o,!1,!0);for(var d=0,h=t.depsNodeAllNodes;d<h.length;d++)o=h[d],this._updateAllForAttributeLayer(o,!0,!1);for(var c=0,f=t.depsNodeAllEdges;c<f.length;c++)o=f[c],this._updateAllForAttributeLayer(o,!1,!0)}if(r&&!t.edges.toUpdate.isFull()){t.edges.toUpdate.addAll();for(var g=0,p=t.depsEdgeSelf;g<p.length;g++)o=p[g],this._updateAllForAttributeLayer(o,!1,!0);for(var _=0,v=t.depsEdgeExtremities;_<v.length;_++)o=v[_],this._updateAllForAttributeLayer(o,!0,!1);for(var m=0,y=t.depsEdgeParallelEdges;m<y.length;m++)o=y[m],this._updateAllForAttributeLayer(o,!1,!0);for(var b=0,x=t.depsEdgeAllNodes;b<x.length;b++)o=x[b],this._updateAllForAttributeLayer(o,!0,!1);for(var E=0,A=t.depsEdgeAllEdges;E<A.length;E++)o=A[E],this._updateAllForAttributeLayer(o,!1,!0)}this._triggerUpdate()},Hl.prototype.updateElementsForAttributeLayer=function(t,e){var r=this._getLayerById(t);this._updateElementsForAttributeLayers([r],e)},Hl.prototype.updateForAllAttributeLayers=function(t){this._updateElementsForAttributeLayers(this._layers,t)},Hl.prototype._updateElementsForAttributeLayers=function(t,e){var r=this._emptySubgraph;if(e.isNode){for(var i=0,n=t;i<n.length;i++)if(!(m=n[i]).nodes.toUpdate.isFull()){m.nodes.needAdjacentElements&&(r=r===this._emptySubgraph?e.fastGetAdjacentElements():r),m.nodes.toUpdate.add(e);for(var o=0,a=m.depsNodeSelf;o<a.length;o++)(f=a[o]).nodes.toUpdate.add(e);for(var s=0,u=m.depsNodeAdjacentNodes;s<u.length;s++)(f=u[s]).nodes.toUpdate.add(r.nodes);for(var l=0,d=m.depsNodeAdjacentEdges;l<d.length;l++)(f=d[l]).edges.toUpdate.add(r.edges);for(var h=0,c=m.depsNodeAllNodes;h<c.length;h++){var f=c[h];this._updateAllForAttributeLayer(f,!0,!1)}for(var g=0,p=m.depsNodeAllEdges;g<p.length;g++)f=p[g],this._updateAllForAttributeLayer(f,!1,!0);m.nodes.redrawAdjacentEdges&&this._layerController.redrawElements(r.edges)}}else for(var _=0,v=t;_<v.length;_++){var m;if(!(m=v[_]).edges.toUpdate.isFull()){m.edges.needAdjacentElements&&(r=r===this._emptySubgraph?e.fastGetAdjacentElements():r),m.edges.toUpdate.add(e);for(var y=0,b=m.depsEdgeSelf;y<b.length;y++)(f=b[y]).edges.toUpdate.add(e);for(var x=0,E=m.depsEdgeExtremities;x<E.length;x++)(f=E[x]).nodes.toUpdate.add(r.nodes);for(var A=0,S=m.depsEdgeParallelEdges;A<S.length;A++)(f=S[A]).edges.toUpdate.add(r.edges);for(var w=0,T=m.depsEdgeAllNodes;w<T.length;w++)f=T[w],this._updateAllForAttributeLayer(f,!0,!1);for(var C=0,M=m.depsEdgeAllEdges;C<M.length;C++)f=M[C],this._updateAllForAttributeLayer(f,!1,!0)}}this._triggerUpdate()},Hl.prototype.destroyAttributeLayer=function(t){var e=this._getLayerById(t);this._destroyedLayers.push(e),this._layers.splice(e.index,1),this._triggerLayerUpdate()},Hl.prototype.updateAttributeLayer=function(t,e){var r=this._getLayerById(t);this._updateLayer(r,e)},Hl.prototype.getAttributeLayerDefinition=function(t){var e=this._getLayerById(t),r=e.priority,i=e.nodes,n=e.edges;return{priority:r,nodeAttributes:i.attributes,nodeSelector:i.selector,nodeContext:i.context,nodeDependencies:i.dependencies,nodeOutput:i.output,edgeAttributes:n.attributes,edgeSelector:n.selector,edgeContext:n.context,edgeDependencies:n.dependencies,edgeOutput:n.output}},Hl.prototype.getAttributeValues=function(t,e,r,i){return this.update(),this._layerController.getAttributeValues(t,e,r,i)},Hl.prototype.setAnimationAttributes=function(t,e){return this._layerController.setAnimationAttributes(t,e)},Hl.prototype.resetAnimationAttributes=function(t){return this._layerController.resetAnimationAttributes(t)},Hl.prototype.setTextHidden=function(t,value){var e=this._textHiddenSet.addOrRemoveElements(t,value);this.redrawElements(e)},Hl.prototype.resetTextHidden=function(){var t=this._textHiddenSet.getElements(),e=t.nodes,r=t.edges;this._textHiddenSet.clear(),this._layerController.redrawElements(e),this._layerController.redrawElements(r)},Hl.prototype.getUsedNodeAttributes=function(){return this._layerController.nodes.getUsedAttributes()},Hl.prototype.getUsedEdgeAttributes=function(){return this._layerController.edges.getUsedAttributes()},Hl);function Hl(t,e,r){this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=r,this._graph=t,this._dom=e,this._emptySubgraph={nodes:r.nodeList(),edges:r.edgeList()},this._textHiddenSet=new ia(t,"textHidden"),this._layerController=new Ul(t,new Ri)}function ql(t,e,r){return void 0===r&&(r=0),"inherit"===t?Array.isArray(e)?e[(1+(r/(2*Math.PI)*e.length|0))%e.length]:e:t}function Wl(t,e){var r=t(),i=Y(r).map(function(t){var value=H(r,t);return Array.isArray(value)?"for (var i = 0; i < "+value.length+"; ++i) {\n        target."+t+"[i] = source."+t+"[i]."+e+";\n      }\n      return target;":"target."+t+" = source."+t+"."+e+";"}).join("\n");return new Function("source, target",i)}function Xl(t){var e=t(),r=Y(e).map(function(t){var value=H(e,t);return Array.isArray(value)?"for (var i = 0; i < "+value.length+"; ++i) {\n        target."+t+"[i] = target."+t+"[i] || source."+t+"[i];\n      }":"target."+t+" = target."+t+" || source."+t+";"}).join("\n");return new Function("target","source",r)}function Yl(t){var e=(t.depth-ja)%Za;return 0<=e&&e!==Ga&&e!==Wa}function Zl(t,e,r,i){var n,o,a,s,u,l,d,h,c,f;n=t,o=e,s=i,u=+("scaled"===(a=r).scalingMethod.get(s)),l=2*a.radius.get(s),d=a.innerStroke.width.get(s),h=+("scaled"===a.innerStroke.scalingMethod.get(s)),c=a.outerStroke.width.get(s),f=+("scaled"===a.outerStroke.scalingMethod.get(s)),o.x=a.x.get(s),o.y=a.y.get(s),o.shape=a.shape.get(s),o.color=a.color.get(s),o.opacity=a.opacity.get(s),o.diameterScaled=l*u,o.diameterFixed=l*(1-u),o.innerStroke.color=ql(a.innerStroke.color.get(s),o.color),o.innerStroke.widthScaled=d*h,o.innerStroke.widthFixed=d*(1-h),o.innerStroke.minVisibleSize=a.innerStroke.minVisibleSize.get(s),o.outerStroke.color=ql(a.outerStroke.color.get(s),o.color),o.outerStroke.widthScaled=c*f,o.outerStroke.widthFixed=c*(1-f),o.halo.color=a.halo.color.get(s),o.halo.strokeColor=a.halo.strokeColor.get(s),o.icon.content=n.formatText(a.icon.content.get(s)),o.image.url=a.image.url.get(s),o.outline.enabled=a.outline.enabled.get(s),o.textHidden=!!a.textHidden.get(s),Kl(t,e.texts.primary,r.text,i,e),Kl(t,e.texts.secondary,r.text.secondary,i,e),Ql(t,e.badges.topLeft,r.badges.topLeft,i),Ql(t,e.badges.topRight,r.badges.topRight,i),Ql(t,e.badges.bottomLeft,r.badges.bottomLeft,i),Ql(t,e.badges.bottomRight,r.badges.bottomRight,i)}function Kl(t,e,r,i,n){if(e.hidden=n.textHidden,e.content=t.formatText(r.content.get(i)),e.backgroundColor=ql(r.backgroundColor.get(i),n.color),e===n.texts.primary){var o=r;e.tip=o.tip.get(i),e.position=o.position.get(i)}else e.position="bottom"}function Ql(t,e,r,i){var n=r.text.content.get(i);e.textContent=t.formatText(n),e.imageUrl=r.image.url.get(i)}function Jl(){return{x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:$l(Ja),topRight:$l($a),bottomLeft:$l(ts),bottomRight:$l(es)},textHidden:!1,texts:{primary:td(),secondary:td()}}}function $l(t){return{angle:t,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0,textPaddingLeft:0,textPaddingTop:0}}function td(){return{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}}function ed(){return{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0}}function rd(t,e){void 0===e&&(e=ed());var r=(t-qu)*Za+ja;return e.edgeHalo=Ba,e.nodeHaloStroke=Ua,e.nodeHalo=Va,e.edgeBody=r+Ga,e.edgeTextBackground=r+Ha,e.edgeText=r+qa,e.nodeBody=r+Wa,e.nodeTextBackground=r+Xa,e.nodeText=r+Ya,e}function id(t,e){var r,i;i=e,(r=t).body=!0,r.icon=!!i.icon.content,r.image=!!i.image.url,r.pieChart=Array.isArray(i.color),r.outerStroke=!!i.outerStroke.color,r.outline=!!i.outline.enabled,r.halo=!!i.halo.color,r.haloStroke=r.halo&&!!i.halo.strokeColor,nd(t.texts.primary,e.texts.primary),nd(t.texts.secondary,e.texts.secondary),od(t.badges.topLeft,e.badges.topLeft),od(t.badges.topRight,e.badges.topRight),od(t.badges.bottomLeft,e.badges.bottomLeft),od(t.badges.bottomRight,e.badges.bottomRight)}function nd(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor,t.tip=t.background&&e.tip&&"center"!==e.position}function od(t,e){t.text=!!e.textContent,t.image=!!e.imageUrl}function ad(t,e){t.pieceId=ji,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=e.diameterScaled,t.rectWidthOrSourceRadiusFixed=e.diameterFixed,t.rectHeightOrTargetRadiusScaled=e.diameterScaled,t.rectHeightOrTargetRadiusFixed=e.diameterFixed,t.shape=e.shape,t.opacity=e.opacity,t.symbolicSize=e.diameterScaled,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=null,t.strokeColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function sd(t,e,r){var i=r.diameterScaled*e.scale,n=r.diameterFixed*e.scale,o=r.diameterScaled*e.positionScale/2,a=r.diameterFixed*e.positionScale/2;t.pieceId=ji,t.shape="circle",t.x1=r.x,t.y1=r.y,t.x2=r.x,t.y2=r.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.strokeWidthScaled,t.strokeWidthFixed=e.strokeWidthFixed,t.offsetScaled=o,t.offsetFixed=a,t.pattern.type=0,t.opacity=r.opacity,t.fillColor=e.color,t.strokeColor=e.strokeColor,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.angle,t.patternScale=0,t.symbolicSize=r.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function ud(t,e,r){var i,n=0,o=0;if(e.isPositionCenter||(n+=r.innerStroke.widthScaled+r.outerStroke.widthScaled+r.diameterScaled/2,o+=r.innerStroke.widthFixed+r.outerStroke.widthFixed+r.diameterFixed/2+e.margin+e.padding),e.isPositionVertical){if(n+=e.heightScaled/2,o+=e.heightFixed/2,e===r.texts.secondary&&"bottom"===r.texts.primary.position){var a=r.texts.primary;n+=a.heightScaled,o+=a.heightFixed+a.margin+2*a.padding}}else e.isPositionHorizontal&&(n+=e.widthScaled/2,o+=e.widthFixed/2);i=vr,t.pieceId=ji,t.shape="square",t.x1=r.x,t.y1=r.y,t.x2=r.x,t.y2=r.y,t.rectWidthOrSourceRadiusScaled=e.widthScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.padding,t.rectHeightOrTargetRadiusScaled=e.heightScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.padding,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=n,t.offsetFixed=o,t.pattern.type=0,t.pattern.attributes.size=i,t.opacity=r.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.positionAngle,t.patternScale=1,t.symbolicSize=r.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function ld(t,e,r,i,n,o){var a=n.badges,s=i.badges,u=o.badges;!function(t,e,r,i,n){if(i.halo){var o=r.halo.width.get(e),a=+("scaled"===r.halo.scalingMethod.get(e));n.halo.widthScaled=o*a,n.halo.widthFixed=o*(1-a),function(t,e){var r=e.diameterScaled+2*e.halo.widthScaled,i=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=ji,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=r,t.rectWidthOrSourceRadiusFixed=i,t.rectHeightOrTargetRadiusScaled=r,t.rectHeightOrTargetRadiusFixed=i,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=e.halo.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(i.halo,n),i.haloStroke&&(n.halo.strokeWidthScaled=0,n.halo.strokeWidthFixed=r.halo.strokeWidth.get(e),function(t,e){var r=e.diameterScaled+2*e.halo.widthScaled,i=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=ji,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=r,t.rectWidthOrSourceRadiusFixed=i,t.rectHeightOrTargetRadiusScaled=r,t.rectHeightOrTargetRadiusFixed=i,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.halo.strokeWidthScaled,t.strokeWidthFixed=e.halo.strokeWidthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.halo.strokeColor,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(i.haloStroke,n))}i.outline&&(n.outline.color=r.outline.color.get(e),n.outline.minVisibleSize=r.outline.minVisibleSize.get(e),function(t,e){var r=e.diameterScaled*rs,i=e.diameterFixed*rs,n=e.diameterScaled*is,o=e.diameterFixed*is+ns;e.outerStroke.color&&(n+=e.outerStroke.widthScaled/2,o+=e.outerStroke.widthFixed/2),t.pieceId=ji,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=r,t.rectWidthOrSourceRadiusFixed=i,t.rectHeightOrTargetRadiusScaled=r,t.rectHeightOrTargetRadiusFixed=i,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=n,t.offsetFixed=o,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=e.outline.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.outline.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=1.5707963267948966,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(i.outline,n));i.outerStroke&&(n.outerStroke.minVisibleSize=r.outerStroke.minVisibleSize.get(e),function(t,e){var r=e.diameterScaled+2*e.innerStroke.widthScaled,i=e.diameterFixed+2*e.innerStroke.widthFixed;t.pieceId=ji,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=r,t.rectWidthOrSourceRadiusFixed=i,t.rectHeightOrTargetRadiusScaled=r,t.rectHeightOrTargetRadiusFixed=i,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.outerStroke.widthScaled,t.strokeWidthFixed=e.outerStroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.outerStroke.color,t.patternColor=null,t.globalMinVisibleSize=e.outerStroke.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(i.outerStroke,n));i.pieChart&&function(t,e){ad(t,e),Array.isArray(e.color)&&(t.pattern.type=zi,t.pattern.attributes.colors=e.color.join(";"),t.patternScale=1,t.patternMinVisibleSize=0,t.patternColor=null)}(i.pieChart,n);i.image&&(n.image.content=t.imageManager.getImage(n.image.url),n.image.fit=r.image.fit.get(e),n.image.tile=r.image.tile.get(e),n.image.scale=r.image.scale.get(e),n.image.minVisibleSize=r.image.minVisibleSize.get(e),function(t,e){var r=e.image.fit&&!e.image.tile;ad(t,e),t.pattern.type=Pi,t.pattern.attributes.image=e.image.content,t.pattern.attributes.scaled=r,t.pattern.attributes.duplicated=e.image.tile,t.patternScale=r?e.image.scale:0,t.patternMinVisibleSize=e.image.minVisibleSize,t.patternColor=null}(i.image,n));i.icon&&(n.icon.font=t.fontManager.getFont(r.icon.font.get(e)),n.icon.style=r.icon.style.get(e),n.icon.color=r.icon.color.get(e),n.icon.scale=r.icon.scale.get(e),n.icon.minVisibleSize=r.icon.minVisibleSize.get(e),function(t,e){ad(t,e),t.pattern.type=Bi,t.pattern.attributes.text=e.icon.content,t.pattern.attributes.font=e.icon.font,t.pattern.attributes.style=e.icon.style,t.pattern.attributes.size=vr,t.patternMinVisibleSize=e.icon.minVisibleSize,t.patternColor=e.icon.color,t.patternScale=e.icon.scale}(i.icon,n));if(i.body){var s=!i.pieChart&&!i.image&&!i.icon;!function(t,e,r){ad(t,e),t.fillColor=Array.isArray(e.color)?null:e.color,t.strokeColor=e.innerStroke.color,t.strokeMinVisibleSize=e.innerStroke.minVisibleSize,t.strokeWidthScaled=e.innerStroke.widthScaled,t.strokeWidthFixed=e.innerStroke.widthFixed,r&&(t.pattern.type=0)}(i.body,n,s)}}(e,r,i,n,o),hd(t,e,r,i.text,n.texts.primary,o.texts.primary,o),hd(t,e,r,i.text.secondary,n.texts.secondary,o.texts.secondary,o),dd(t,e,r,s.topLeft,a.topLeft,u.topLeft,o),dd(t,e,r,s.topRight,a.topRight,u.topRight,o),dd(t,e,r,s.bottomLeft,a.bottomLeft,u.bottomLeft,o),dd(t,e,r,s.bottomRight,a.bottomRight,u.bottomRight,o)}function dd(t,e,r,i,n,o,a){if(n.image||n.text){var s=i.stroke.width.get(r),u=+("scaled"===i.stroke.scalingMethod.get(r));o.color=ql(i.color.get(r),a.color,o.angle),o.strokeColor=i.stroke.color.get(r),o.strokeWidthScaled=s*u,o.strokeWidthFixed=s*(1-u),o.minVisibleSize=i.minVisibleSize.get(r),o.positionScale=i.positionScale.get(r),o.scale=i.scale.get(r)}var l,d,h,c;if(n.image&&(o.imageContent=e.imageManager.getImage(o.imageUrl),o.imageScale=i.image.scale.get(r),sd(l=n.image,d=o,a),null!==d.imageContent?(l.pattern.type=Pi,l.pattern.attributes.image=d.imageContent,l.pattern.attributes.scaled=!0,l.pattern.attributes.duplicated=!1,l.patternScale=d.imageScale,l.patternMinVisibleSize=0,l.patternColor=null):(l.fillColor=null,l.strokeColor=null)),n.text){if(o.textFont=e.fontManager.getFont(i.text.font.get(r)),o.textStyle=i.text.style.get(r),o.textColor=ql(i.text.color.get(r),a.color),o.textScale=i.text.scale.get(r),o.textPaddingTop=i.text.paddingTop.get(r),o.textPaddingLeft=i.text.paddingLeft.get(r),1<t.measureText(o.textContent,o.textFont,o.textStyle,o.textScale).width){for(var f=0,g=0;g<o.textContent.length&&f<1;)f+=t.measureText(o.textContent[g],o.textFont,o.textStyle,o.textScale).width,g+=1;g!==o.textContent.length&&(o.textContent=o.textContent.substring(0,g-1)+"")}sd(h=n.text,c=o,a),c.textContent&&(h.pattern.type=Ui,h.pattern.attributes.text=c.textContent,h.pattern.attributes.font=c.textFont,h.pattern.attributes.style=c.textStyle,h.pattern.attributes.paddingLeft=c.scale*c.textPaddingLeft*2,h.pattern.attributes.paddingTop=c.scale*c.textPaddingTop*2,h.pattern.attributes.size=vr,h.patternMinVisibleSize=0,h.patternColor=c.textColor,h.patternScale=c.textScale,h.isBadge=!0),!c.imageUrl&&c.textContent||(h.fillColor=null,h.strokeColor=null)}}function hd(t,e,r,i,n,o,a){if(n.text){var s=i,u=s.scaling.get(r);if(o.font=e.fontManager.getFont(s.font.get(r)),o.color=ql(s.color.get(r),a.color),o.style=s.style.get(r),o.align=s.align.get(r),o.minVisibleSize=s.minVisibleSize.get(r),o.margin=s.margin.get(r),o.padding=s.padding.get(r),o.maxLineLength=s.maxLineLength.get(r),o.content=ya(o.content,o.maxLineLength),u){var l=s.scale.get(r);o.sizeScaled=a.diameterScaled*l,o.sizeFixed=a.diameterFixed*l}else o.sizeFixed=s.size.get(r),o.sizeScaled=0;var d=t.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.positionAngle=cs[o.position],o.isPositionCenter="center"===o.position,o.isPositionVertical="top"===o.position||"bottom"===o.position,o.isPositionHorizontal="left"===o.position||"right"===o.position,ud(E=n.text,A=o,a),E.pattern.type=Vi,E.pattern.attributes.text=A.content,E.pattern.attributes.font=A.font,E.pattern.attributes.style=A.style,E.pattern.attributes.align=A.align,E.patternMinVisibleSize=0,E.patternColor=A.color,E.thicknessOrFontSizeScaled=A.sizeScaled,E.thicknessOrFontSizeFixed=A.sizeFixed,E.isText=!0,n.background&&(ud(b=n.background,x=o,a),b.fillColor=x.backgroundColor,n.tip&&(h=n.tip,c=o,f=a,g=Math.ceil(c.margin/2)+1,p=f.diameterScaled/2+f.innerStroke.widthScaled+f.outerStroke.widthScaled,_=f.diameterFixed/2+f.innerStroke.widthFixed+f.outerStroke.widthFixed+g,v=fs[c.position],m=Math.cos(v),y=Math.sin(v),h.pieceId=ji,h.shape="triangle",h.x1=f.x-m,h.y1=f.y-y,h.x2=f.x+m,h.y2=f.y+y,h.rectWidthOrSourceRadiusScaled=0,h.rectWidthOrSourceRadiusFixed=c.margin,h.rectHeightOrTargetRadiusScaled=0,h.rectHeightOrTargetRadiusFixed=c.margin*ds,h.thicknessOrFontSizeScaled=0,h.thicknessOrFontSizeFixed=0,h.strokeWidthScaled=0,h.strokeWidthFixed=0,h.offsetScaled=p,h.offsetFixed=_,h.pattern.type=0,h.opacity=f.opacity,h.fillColor=c.backgroundColor,h.strokeColor=null,h.patternColor=null,h.globalMinVisibleSize=c.minVisibleSize,h.strokeMinVisibleSize=0,h.patternMinVisibleSize=0,h.offsetAngle=c.positionAngle,h.patternScale=0,h.symbolicSize=f.diameterScaled,h.curvature=0,h.dashLength=0,h.gapLength=0,h.hasHead=!1,h.hasTail=!1,h.isSelfLoop=!1))}var h,c,f,g,p,_,v,m,y,b,x,E,A}var cd=Wl(md,"start"),fd=Wl(md,"end"),gd=Xl(md),pd=(_d.prototype.drawNode=function(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();var e=this._engine,r=this._helper,i=t,n=this._attributes,o=rd(n.layer.get(t)-(n.detectable.get(t)?0:1),this._depthInfo),a=n.animationDuration.get(t),s=0<a;if(this._prepareBlocks(s,o,i),Zl(r,this._endInput,n,t),id(this._endFlags,this._endInput),s&&(Zl(r,this._startInput,this._attributesPrev,t),id(this._startFlags,this._startInput),gd(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._layers),fd(this._fullComponents,this._endComponents),ld(e,r,t,n,this._endComponents,this._endInput),s&&(cd(this._fullComponents,this._startComponents),ld(e,r,t,this._attributesPrev,this._startComponents,this._startInput)),s){var u=this._attributes.animationStart.get(t),l=this._attributes.animationEasing.get(t);this._setBlocksAnimation(a,u,l)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(t)&&(this._layers.halo.stencilUsage=this._layers.haloStroke.stencilUsage=2),this._storeBlocks()},_d.prototype._computeBlockIds=function(t){var e=10*t,r=this._blockIds;r.body=0+e,r.text=1+e,r.textBg=2+e,r.halo=3+e,r.haloStroke=4+e},_d.prototype._prepareBlocks=function(t,e,r){var i=this._layers;i.body.reset(1,t,e.nodeBody,r),i.text.reset(2,t,e.nodeText,r),i.textBg.reset(1,t,e.nodeTextBackground,r),i.halo.reset(1,t,e.nodeHalo,r),i.haloStroke.reset(1,t,e.nodeHaloStroke,r)},_d.prototype._storeBlocks=function(){var t=this._engine,e=this._layers,r=this._blockIds;t.storeGroup(r.body,e.body),t.storeGroup(r.text,e.text),t.storeGroup(r.textBg,e.textBg),t.storeGroup(r.halo,e.halo),t.storeGroup(r.haloStroke,e.haloStroke)},_d.prototype._freeBlocks=function(){var t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.text),t.freeBlock(e.textBg),t.freeBlock(e.halo),t.freeBlock(e.haloStroke)},_d.prototype._setBlocksAnimation=function(t,e,r){var i=this._layers;i.body.setGlobalAnimation(t,e,r),i.text.setGlobalAnimation(t,e,r),i.textBg.setGlobalAnimation(t,e,r),i.halo.setGlobalAnimation(t,e,r),i.haloStroke.setGlobalAnimation(t,e,r)},_d.prototype._initComponents=function(t,e,r){this._nodePatternAssigned=!1,this._initBaseComponents(t,e,r),this._initBadgeComponents(t.badges.topLeft,e.badges.topLeft,r),this._initBadgeComponents(t.badges.topRight,e.badges.topRight,r),this._initBadgeComponents(t.badges.bottomLeft,e.badges.bottomLeft,r),this._initBadgeComponents(t.badges.bottomRight,e.badges.bottomRight,r),this._initTextComponents(t.texts.primary,e.texts.primary,r),this._initTextComponents(t.texts.secondary,e.texts.secondary,r)},_d.prototype._initBaseComponents=function(t,e,r){t.haloStroke=this._nextElement(e.haloStroke,r.haloStroke),t.halo=this._nextElement(e.halo,r.halo),t.outline=this._nextElement(e.outline,r.body),t.outerStroke=this._nextElement(e.outerStroke,r.body),t.body=this._nextElement(e.body,r.body),t.pieChart=this._getNodePatternElement(e.pieChart,r),t.image=this._getNodePatternElement(e.image,r),t.icon=this._getNodePatternElement(e.icon,r)},_d.prototype._initBadgeComponents=function(t,e,r){t.image=this._nextElement(e.image,r.body),t.text=this._nextElement(e.text,r.body)},_d.prototype._initTextComponents=function(t,e,r){t.background=this._nextElement(e.background,r.textBg),t.tip=this._nextElement(e.tip,r.textBg),t.text=this._nextElement(e.text,r.text)},_d.prototype._nextElement=function(t,e){return t?e.next():this._nullElt},_d.prototype._getNodePatternElement=function(t,e){return t?this._nodePatternAssigned?e.body.next():(this._nodePatternAssigned=!0,e.body.getCurrentElement()):this._nullElt},_d);function _d(t){var e=t.engine,r=t.imageManager,i=t.fontManager,n=t.formatText,o=t.attributes,a=t.attributesPrev;this._fullComponents=md(),this._startComponents=md(),this._endComponents=md(),this._startFlags=md(),this._endFlags=md(),this._startInput=Jl(),this._endInput=Jl(),this._depthInfo=ed(),this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0},this._engine=e,this._attributes=o,this._attributesPrev=a,this._helper={imageManager:r,fontManager:i,formatText:n},this._layers=vd(function(){return e.createGroup()}),this._blockIds=vd(function(){return 0})}function vd(t){return{body:t(),text:t(),textBg:t(),halo:t(),haloStroke:t()}}function md(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function circleCircleIntersection(t,e,r,i,n,o){var a,s,u,l,d,h,c,f,g;return s=i-t,u=n-e,r+o<(l=Math.sqrt(s*s+u*u))||l<Math.abs(r-o)?null:(g=e+u*(a=(r*r-o*o+l*l)/(2*l))/l,[[(f=t+s*a/l)+(h=(d=Math.sqrt(r*r-a*a))/l*-u),g+(c=d/l*s)],[f-h,g-c]])}function circleSortCompare(t,e,r,i,n,o){if(0<=t-n&&r-n<0)return 1;if(t-n<0&&0<=r-n)return-1;if(t-n==0&&r-n==0)return 0<=e-i||0<=i-o?e-i:i-e;var a=(t-n)*(i-o)-(r-n)*(e-o);return a<0?1:0<a?-1:(t-n)*(t-n)+(e-o)*(e-o)-((r-n)*(r-n)+(i-o)*(i-o))}function yd(t,e,r){var i=t[0],n=t[1],o=t[2],a=Math.abs(i-e),s=Math.abs(n-r);return a+s<=o||!(o<a||o<s)&&Math.sqrt(a*a+s*s)<o+1e-12}function bd(t,e,r,i){var n=t[0]-e,o=t[1]-r,a=t[2]-i;return n*n+o*o<a*a+1e-6}function xd(t,e,r,i,n,o,a){var s=t-Math.max(i,Math.min(o,t)),u=e-Math.max(n,Math.min(a,e));return s*s+u*u<r*r}function Ed(t,e,r,i,n,o,a,s){void 0===s&&(s={x:0,y:0});var u,l,d,h,c=s||{x:0,y:0};if(r===t){var f=t-n,g=a*a-f*f;if(g<0)return null;var p=Math.sqrt(g);d=u=t,l=o+p,h=o-p}else{var _=(i-e)/(r-t),v=e-_*t,m=v-o,y=_*_+1,b=2*(_*m-n),x=b*b-4*y*(n*n+m*m-a*a);if(x<0)return null;var E=-b,A=Math.sqrt(x),S=2*y;l=_*(u=(E+A)/S)+v,h=_*(d=(E-A)/S)+v}var w=t-u,T=e-l,C=t-d,M=e-h;return w*w+T*T<C*C+M*M?(c.x=u,c.y=l):(c.x=d,c.y=h),c}function Ad(t,e,r,i,n,o){!function(t,e,r,i,n){var o=i.source,a=i.target,s=e.source.get(r),u=e.target.get(r),l=o.x.get(s),d=o.y.get(s),h=o.radius.get(s),c=o.color.get(s),f=+("scaled"===o.scalingMethod.get(s)),g=a.x.get(u),p=a.y.get(u),_=a.radius.get(u),v=a.color.get(u),m=+("scaled"===a.scalingMethod.get(u)),y=function(t,e,r){return"source"===t?Array.isArray(e)?e[0]:e:"target"===t?Array.isArray(r)?r[0]:r:t}(e.color.get(r),c,v),b=e.width.get(r),x=+("scaled"===e.scalingMethod.get(r)),E=e.stroke.width.get(r),A=+("scaled"===e.stroke.scalingMethod.get(r)),S=hs[e.shape.style.get(r)],w=e.adjustAnchors.get(r);if(t.source=s,t.target=u,t.sourceX=l,t.sourceY=d,t.targetX=g,t.targetY=p,t.sourceRadiusScaled=h*f,t.sourceRadiusFixed=h*(1-f),t.targetRadiusScaled=_*m,t.targetRadiusFixed=_*(1-m),t.widthScaled=b*x,t.widthFixed=b*(1-x),t.curvature=e.curvature.get(r),t.isSelfLoop=s===u,t.color=y,t.opacity=e.opacity.get(r),t.minVisibleSize=e.minVisibleSize.get(r),t.shape.body=e.shape.body.get(r),t.shape.head=e.shape.head.get(r),t.shape.tail=e.shape.tail.get(r),t.shape.dashLength=S.dash,t.shape.gapLength=S.gap,t.shape.isBodyTriangle="triangle"===t.shape.body,t.stroke.color=ql(e.stroke.color.get(r),y),t.stroke.widthScaled=E*A,t.stroke.widthFixed=E*(1-A),t.stroke.minVisibleSize=e.stroke.minVisibleSize.get(r),t.halo.color=e.halo.color.get(r),t.outline.enabled=e.outline.enabled.get(r),t.textHidden=1===e.textHidden.get(r),w&&(t.shape.head||t.shape.tail||"triangle"===t.shape.body)){var T=t,C=T.curvature,M=T.sourceX,I=T.sourceY,L=T.targetX,N=T.targetY,O=1,k=1;if(C){if(!T.isSelfLoop){var R=_s(M,I,L,N,C/2);O=wd(T,n,o,s,M,I,R.x,R.y),k=wd(T,n,a,u,L,N,R.x,R.y)}}else O=wd(T,n,o,s,M,I,L,N),k=wd(T,n,a,u,L,N,M,I);t.sourceRadiusScaled*=O,t.sourceRadiusFixed*=O,t.targetRadiusScaled*=k,t.targetRadiusFixed*=k}}(e,r,i,n,o),Sd(t,e.texts.primary,r.text,i,e),Sd(t,e.texts.secondary,r.text.secondary,i,e)}function Sd(t,e,r,i,n){e.hidden=n.textHidden,e.content=t.formatText(r.content.get(i)),e.backgroundColor=ql(r.backgroundColor.get(i),n.color)}function wd(t,e,r,i,n,o,a,s){var u,l=e.angle||0,d=Math.atan2(s-o,a-n)-l,h=1,c=0;d<-Ka?d+=Qa:Ka<d&&(d-=Qa),u=d<-Ka/2?(c=Ja,r.badges.topLeft):d<0?(c=$a,r.badges.topRight):d<Ka/2?(c=es,r.badges.bottomRight):(c=ts,r.badges.bottomLeft),c+=l;var f,g=u.text.content&&u.text.content.get(i),p=u.image.url&&u.image.url.get(i);if((f=g)||0===f||p){var _=u.positionScale.get(i),v=u.scale.get(i),m=Ed(a,s,n,o,n+(x=Math.cos(c))*_,o+(E=Math.sin(c))*_,v);if(m){var y=m.x-n,b=m.y-o,distance=Math.sqrt(y*y+b*b);h=Math.max(h,distance)}}if("square"===r.shape.get(i)){var x=Math.abs(Math.cos(d)),E=Math.abs(Math.sin(d)),A=1/Math.max(x,E);h=Math.max(h,A)}return h}function Td(){return{source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{body:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:Cd(),secondary:Cd()}}}function Cd(){return{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}function Md(t,e){Id(t.body,e,!0,!0),Id(t.outline,e,e.outline.enabled,!0),Id(t.halo,e,!!e.halo.color,!1),Ld(t.texts.primary,e.texts.primary),Ld(t.texts.secondary,e.texts.secondary)}function Id(t,e,value,r){t.body=value,t.head=value&&r&&!!e.shape.head,t.tail=value&&r&&!!e.shape.tail}function Ld(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor}function Nd(t,e,r,i){Od(t,e,r,i),t.thicknessOrFontSizeScaled=e.widthScaled,t.thicknessOrFontSizeFixed=e.widthFixed,t.strokeWidthScaled=e.stroke.widthScaled,t.strokeWidthFixed=e.stroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.color,t.strokeColor=e.stroke.color,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=e.stroke.minVisibleSize,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function Od(t,e,r,i){t.pieceId=r,t.shape=i,t.x1=e.sourceX,t.y1=e.sourceY,t.x2=e.targetX,t.y2=e.targetY,t.rectWidthOrSourceRadiusScaled=e.sourceRadiusScaled,t.rectWidthOrSourceRadiusFixed=e.sourceRadiusFixed,t.rectHeightOrTargetRadiusScaled=e.targetRadiusScaled,t.rectHeightOrTargetRadiusFixed=e.targetRadiusFixed,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.widthScaled,t.curvature=e.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=e.isSelfLoop,t.isText=!1}function kd(t,e,r){var i=e.widthScaled+2*e.halo.widthScaled,n=e.widthFixed+2*e.halo.widthFixed;Od(t,e,r,"line"),t.thicknessOrFontSizeScaled=i,t.thicknessOrFontSizeFixed=n,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.halo.color,t.strokeColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1}function Rd(t,e,r,i){Od(t,e,r,i);var n=e.widthFixed*as+ss;t.thicknessOrFontSizeScaled=e.widthScaled*os,t.thicknessOrFontSizeFixed=e.widthFixed*os,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=e.widthScaled*as,t.offsetFixed=n,t.fillColor=e.outline.color,t.strokeColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,e.outline.minVisibleSize),t.strokeMinVisibleSize=0,t.offsetAngle=Math.PI/2,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function Fd(t,e,r){var i=(r.widthScaled+e.heightScaled)/2+r.stroke.widthScaled,n=(r.widthFixed+e.heightFixed)/2+r.stroke.widthFixed+e.padding+e.margin;t.pieceId=Wi,t.shape="square",t.x1=r.sourceX,t.y1=r.sourceY,t.x2=r.targetX,t.y2=r.targetY,t.rectWidthOrSourceRadiusScaled=e.widthScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.padding+1,t.rectHeightOrTargetRadiusScaled=e.heightScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.padding,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=r.sourceRadiusScaled+r.targetRadiusScaled,t.strokeWidthFixed=r.sourceRadiusFixed+r.targetRadiusFixed,t.offsetScaled=i,t.offsetFixed=n,t.pattern.type=0,t.opacity=r.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,r.minVisibleSize),t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.offsetAngle,t.patternScale=0,t.symbolicSize=r.widthScaled,t.curvature=r.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=r.isSelfLoop,t.isText=!1,t.adjustTextAngle=e.adjustAngle}function Dd(t,e,r,i,n,o){!function(t,e,r,i){if(Pd(r.body,i,Nd),r.halo.body){var n=e.halo.width.get(t),o=+("scaled"===e.halo.scalingMethod.get(t));i.halo.widthScaled=n*o,i.halo.widthFixed=n*(1-o),Pd(r.halo,i,kd)}r.outline.body&&(i.outline.color=e.outline.color.get(t),i.outline.minVisibleSize=e.outline.minVisibleSize.get(t),Pd(r.outline,i,Rd))}(r,i,n,o),zd(t,e,r,i.text,n.texts.primary,o.texts.primary,o),zd(t,e,r,i.text.secondary,n.texts.secondary,o.texts.secondary,o)}function Pd(t,e,r){r(t.body,e,Gi,e.shape.body),t.head&&r(t.head,e,Hi,e.shape.head),t.tail&&r(t.tail,e,qi,e.shape.tail)}function zd(t,e,r,i,n,o,a){if(n.text){var s=i,u=s.scaling.get(r);if(o.font=e.fontManager.getFont(s.font.get(r)),o.color=ql(s.color.get(r),a.color),o.style=s.style.get(r),o.minVisibleSize=s.minVisibleSize.get(r),o.margin=s.margin.get(r),o.padding=s.padding.get(r),o.maxLineLength=s.maxLineLength.get(r),o.content=ya(o.content,o.maxLineLength),o.adjustAngle=s.adjustAngle.get(r),o.align=s.align.get(r),u){var l=s.scale.get(r);o.sizeScaled=a.widthScaled*l,o.sizeFixed=a.widthFixed*l}else o.sizeFixed=s.size.get(r),o.sizeScaled=0;var d=t.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.offsetAngle=o===a.texts.primary?us:ls,Fd(f=n.text,g=o,a),f.pattern.type=Vi,f.pattern.attributes.text=g.content,f.pattern.attributes.size=vr,f.pattern.attributes.font=g.font,f.pattern.attributes.style=g.style,f.pattern.attributes.align=g.align,f.patternColor=g.color,f.patternScale=1,f.thicknessOrFontSizeScaled=g.sizeScaled,f.thicknessOrFontSizeFixed=g.sizeFixed,f.isText=!0,n.background&&(Fd(h=n.background,c=o,a),h.fillColor=c.backgroundColor)}var h,c,f,g}var Bd=Wl(qd,"start"),Ud=Wl(qd,"end"),Vd=Xl(qd),jd=(Gd.prototype.drawEdge=function(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();var e=this._engine,r=this._helper,i=-t,n=this._attributes,o=rd(n.layer.get(t)-(n.detectable.get(t)?0:1),this._depthInfo),a=n.source.get(t),s=n.target.get(t),u=n.curvature.get(t),l=this._attributesPrev.curvature.get(t),d=n.animationDuration.get(t),h=n.animationStart.get(t),c=n.animationEasing.get(t),f=0<d,g=0!==u||f&&0!==l;this._prepareBlocks(f,o,i,g);var p=this._extremitiesAttributes={source:this._nodeAttributes,target:this._nodeAttributes};if(Ad(r,this._endInput,n,t,p,this._view),Md(this._endFlags,this._endInput),f){var _=0<this._nodeAttributes.animationDuration.get(a),v=0<this._nodeAttributes.animationDuration.get(s);p.source=_?this._nodeAttributesPrev:this._nodeAttributes,p.target=v?this._nodeAttributesPrev:this._nodeAttributes,Ad(r,this._startInput,this._attributesPrev,t,p,this._view),Md(this._startFlags,this._startInput),Vd(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._layers),Ud(this._fullComponents,this._endComponents),Dd(e,r,t,this._attributes,this._endComponents,this._endInput),f&&(Bd(this._fullComponents,this._startComponents),Dd(e,r,t,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(d,h,c)),this._setupHaloMasking(a,s),this._storeBlocks()},Gd.prototype._setupHaloMasking=function(t,e){var r=this._nodeAttributes.halo,i=this._layers,n=r.color.get(t)&&r.hideNonAdjacentEdges.get(t),o=r.color.get(e)&&r.hideNonAdjacentEdges.get(e),a=n||o?1:3;i.body.stencilUsage=i.text.stencilUsage=i.textBg.stencilUsage=a},Gd.prototype._computeBlockIds=function(t){var e=10*t,r=this._blockIds;r.body=5+e,r.halo=8+e,r.text=6+e,r.textBg=7+e},Gd.prototype._prepareBlocks=function(t,e,r,i){var n=this._layers;n.body.reset(i?3:1,t,e.edgeBody,r),n.halo.reset(i?3:1,t,e.edgeHalo,r),n.text.reset(2,t,e.edgeText,r),n.textBg.reset(1,t,e.edgeTextBackground,r)},Gd.prototype._storeBlocks=function(){var t=this._engine,e=this._layers,r=this._blockIds;t.storeGroup(r.body,e.body),t.storeGroup(r.halo,e.halo),t.storeGroup(r.text,e.text),t.storeGroup(r.textBg,e.textBg)},Gd.prototype._freeBlocks=function(){var t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.halo),t.freeBlock(e.text),t.freeBlock(e.textBg)},Gd.prototype._setBlocksAnimation=function(t,e,r){var i=this._layers;i.body.setGlobalAnimation(t,e,r),i.halo.setGlobalAnimation(t,e,r),i.text.setGlobalAnimation(t,e,r),i.textBg.setGlobalAnimation(t,e,r)},Gd.prototype._initComponents=function(t,e,r){this._initEdgeComponents(t.halo,e.halo,r.halo),this._initEdgeComponents(t.outline,e.outline,r.body),this._initEdgeComponents(t.body,e.body,r.body),this._initTextComponents(t.texts.primary,e.texts.primary,r),this._initTextComponents(t.texts.secondary,e.texts.secondary,r)},Gd.prototype._initEdgeComponents=function(t,e,r){t.head=this._nextElement(e.head,r),t.tail=this._nextElement(e.tail,r),t.body=this._nextElement(e.body,r)},Gd.prototype._initTextComponents=function(t,e,r){t.background=this._nextElement(e.background,r.textBg),t.text=this._nextElement(e.text,r.text)},Gd.prototype._nextElement=function(t,e){return t?e.next():this._nullElt},Gd);function Gd(t){var e=t.engine,r=t.imageManager,i=t.fontManager,n=t.formatText,o=t.view,a=t.attributes,s=t.attributesPrev,u=t.nodeAttributes,l=t.nodeAttributesPrev;this._fullComponents=qd(),this._startComponents=qd(),this._endComponents=qd(),this._startFlags=qd(),this._endFlags=qd(),this._startInput=Td(),this._endInput=Td(),this._depthInfo=ed(),this._nullElt={id:-1,valid:!0},this._engine=e,this._view=o,this._helper={imageManager:r,fontManager:i,formatText:n},this._attributes=a,this._attributesPrev=s,this._nodeAttributes=u,this._nodeAttributesPrev=l,this._layers=Hd(function(){return e.createGroup()}),this._blockIds=Hd(function(){return 0})}function Hd(t){return{body:t(),halo:t(),text:t(),textBg:t()}}function qd(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}function Wd(t){var e,r,i,n,o,a=t.graph,s=t.elements,u=t.engine,l=t.imageManager,d=t.fontManager,h=t.view,c=t.attributes,f=t.boundaries,g=t.formatText,p=(r=$((e=c).nodes.current,{text:{secondary:{scaling:e.nodes.current.text.scaling,maxLineLength:e.nodes.current.text.maxLineLength}}}),i=$(e.nodes.previous,{textHidden:r.textHidden,text:{secondary:{scaling:e.nodes.previous.text.scaling,maxLineLength:e.nodes.previous.text.maxLineLength}}}),n=$(e.edges.current,{text:{secondary:{scaling:e.edges.current.text.scaling,maxLineLength:e.edges.current.text.maxLineLength,adjustAngle:e.edges.current.text.adjustAngle}}}),o=$(e.edges.previous,{source:e.edges.current.source,target:e.edges.current.target,textHidden:e.edges.current.textHidden,text:{secondary:{scaling:e.edges.previous.text.scaling,maxLineLength:e.edges.previous.text.maxLineLength,adjustAngle:e.edges.previous.text.adjustAngle}}}),{nodeAttributes:r,nodeAttributesPrev:i,edgeAttributes:n,edgeAttributesPrev:o}),_=p.nodeAttributes,v=p.nodeAttributesPrev,m=p.edgeAttributes,y=p.edgeAttributesPrev,b=s.nodes,x=s.edges,E=f.maxSize,A=f.maxMinVisibleSize;if(b.size||x.size){var S=10*(Math.max(a.getNodeMaxIndex(),a.getEdgeMaxIndex())+1),w=u.setGlobalBoundaries({maxBlockId:qe(S),maxScaledSize:qe(8*E),maxMinVisibleSize:qe(A),maxSymbolicSize:qe(E),maxDashLength:3,maxGapLength:1,maxPatternScale:2,maxCoord:-1/0}),T=(w?a.getNodes("_all"):b)._indexes,C=(w?a.getEdges("_all"):x)._indexes;if(T.length)for(var M=new pd({engine:u,imageManager:l,fontManager:d,formatText:g,attributes:_,attributesPrev:v}),I=0;I<T.length;++I)M.drawNode(T[I]);if(C.length){var L=new jd({engine:u,imageManager:l,fontManager:d,formatText:g,view:h,attributes:m,attributesPrev:y,nodeAttributes:_,nodeAttributesPrev:v});for(I=0;I<C.length;++I)L.drawEdge(C[I])}}}var Xd=gt&&document.fonts,Yd="/qwerty/ [HELLO] ",Zd=(Kd.prototype._measureText=function(t,e){return this._ctx.font="12px "+e,this._ctx.measureText(t).width},Kd.prototype.check=function(t){if(this._checkReliable)return this._fontFaceSet.check("12px "+t);var e=this._measureText(Yd,"serif");return this._measureText(Yd,t)!==e},Kd.prototype.load=function(t){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load("12px "+t):(this._ctx.font="12px "+t,this._ctx.fillText(Yd,10,50),Promise.resolve())},Kd);function Kd(){this._fontFaceSet=Xd?document.fonts:null,this._canvas=En(),this._ctx=this._canvas.getContext("2d"),this._checkReliable=!0===(this._fontFaceSet&&this._fontFaceSet.check&&!this._fontFaceSet.check("12px FontThatDoesNotExist")),this._ctx=this._canvas.getContext("2d")}var Qd=(Jd.prototype._setLoaded=function(){this._loaded=!0,this._value=this._fontName},Jd.prototype.getValue=function(){return this._value},Jd.prototype.isLoaded=function(){return this._loaded},Jd.prototype.destroy=function(){clearTimeout(this._timeout)},Jd.prototype.load=function(){var t=this;return this._tryLoad(200).then(function(){t._setLoaded()})},Jd.prototype._tryLoad=function(e){var r=this;return this._fontFaceSet.load(this._fontName).then(function(){if(!r._fontFaceSet.check(r._fontName)&&r._fontLoaderCounter<16)return new Promise(function(t){e<6e4&&(r._timeout=setTimeout(t,e))}).then(function(){return r._fontLoaderCounter++,r._tryLoad(1.5*e)})})},Jd);function Jd(t,e){this._fontLoaderCounter=0,this._loaded=!1,this._value=null,this._timeout=0,this._fontFaceSet=t,this._fontName=e,this._loaded=!1,this._value=null,this._timeout=0,gt&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}var $d=(th.prototype.setHideUntilFontsLoaded=function(value){this._hideUntilFontsLoaded=value},th.prototype.getFont=function(t){var e=this,r=this._fonts[t];return r||(r=new Qd(this._fontFaceSet,t),(this._fonts[t]=r).isLoaded()||r.load().then(function(){return e._triggerFontLoaded(t)})),!this._hideUntilFontsLoaded&&t||r.getValue()},th.prototype.onFontLoaded=function(t){this._onFontLoaded.push(t)},th.prototype.destroy=function(){var e=this;this._onFontLoaded=[],Object.keys(this._fonts).forEach(function(t){return e._fonts[t].destroy()})},th.prototype._triggerFontLoaded=function(e){this._onFontLoaded.forEach(function(t){return t(e)})},th);function th(){this._fontFaceSet=new Zd,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}function eh(t,e,r){for(var i=r.length,n=i-1,o=!1,a=0;a<i;++a)(r[a].y<e&&r[n].y>=e||r[n].y<e&&r[a].y>=e)&&(r[a].x<=t||r[n].x<=t)&&(o=o!==r[a].x+(e-r[a].y)/(r[n].y-r[a].y)*(r[n].x-r[a].x)<t),n=a;return o}function rh(t){var e=t.x*t.x+t.y*t.y;return{x:t.x/e,y:t.y/e}}function ih(t,e){for(var r=1/0,i=-1/0,n=0,o=t.length;n<o;n++){var a=t[n],s=a.x*e.x+a.y*e.y;s<r&&(r=s),i<s&&(i=s)}return{x:r,y:i}}function nh(t,e){for(var r=function(t,e){var r=t[1],i=t[0],n=rh({x:r.x-i.x,y:r.y-i.y}),o=n.x;n.x=-n.y,n.y=o;var a=n;r=t[2],i=t[1],o=(n=rh({x:r.x-i.x,y:r.y-i.y})).x,n.x=-n.y,n.y=o;var s=n;r=e[1],i=e[0],o=(n=rh({x:r.x-i.x,y:r.y-i.y})).x,n.x=-n.y,n.y=o;var u=n;return r=e[2],i=e[1],o=(n=rh({x:r.x-i.x,y:r.y-i.y})).x,n.x=-n.y,n.y=o,[a,s,u,n]}(t,e),i=0,n=r.length;i<n;i++){var o=r[i],a=ih(t,o),s=ih(e,o);if(0==(a.x<=s.y&&a.y>=s.x?Math.min(a.y,s.y)-Math.max(a.x,s.x):0))return!1}return!0}function oh(t){var e=0,r=0,i=t.length;if(0===i)throw new Error("Compute centroid: at least one point is required");for(var n=0;n<i;++n){var o=t[n];e+=o.x,r+=o.y}return{x:e/=i,y:r/=i}}var ah=mh(4),sh=mh(5),uh=mh(10,.4),lh=1/3,dh=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],hh={circle:{getDistanceFromStrokeVertically:function(t,e){return 1},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.sqrt(t*t+e*e)},points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:function(t,e){return 1-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],isSimple:!0},line:{getDistanceFromStrokeVertically:function(t,e){return 1-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1},points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:function(t,e){return(1-t)/2-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:function(t,e){return(1-t)/2-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:function(t,e){return Math.min(Math.sqrt((t+.4)*(t+.4)+e*e)-.27,(1-t)/2-Math.abs(e))},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:function(t,e){var r=Math.min((1-t)/2-Math.abs(e),1-Math.abs(t)),i=-vh(t,e,dh);return Math.min(r,i)},getDistanceFromStrokeHorizontally:function(t,e){return 1},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:dh,isSimple:!0},"short-arrow":yh([{x:-1,y:-lh},{x:0,y:-lh},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:lh},{x:-1,y:lh}],!1),"sharp-arrow":yh([{x:-1,y:-lh},{x:-.55,y:-lh},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:lh},{x:-1,y:lh}],!1),cross:{getDistanceFromStrokeVertically:function(t,e){return 1},getDistanceFromStrokeHorizontally:function(t,e){var r=Math.abs(t),i=Math.abs(e),n=.31-Math.min(r,i),o=1-Math.max(r,i);return Math.min(n,o)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],isSimple:!1},diamond:yh(ah),pentagon:yh(sh),star:yh(uh)},ch=["circle","square","triangle","line"],fh=["cross","diamond","pentagon","star"],gh=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function ph(t,e){for(var r=0,i=ch;r<i.length;r++){_h(t,i[r])}for(var n=e.nodes.current.shape.getValues(),o=e.edges.current.shape.head.getValues(),a=e.edges.current.shape.tail.getValues(),s=0,u=fh;s<u.length;s++){var l=u[s];n.includes(l)&&_h(t,l)}for(var d=0,h=gh;d<h.length;d++){var c=h[d];c&&(o.includes(c)||a.includes(c))&&_h(t,c)}}function _h(t,e){t.registerShape(e,hh[e])}function vh(t,e,r){for(var i=1/0,n={x:t,y:e},o=0;o<r.length;++o){var a=r[o],s=r[(o+1)%r.length];i=Math.min(i,vu(n,a,s))}return i*(eh(t,e,r)?1:-1)}function mh(t,e){void 0===e&&(e=1);for(var r=-Math.PI/2+1e-6,i=[],n=2*Math.PI/t,o=r,a=0;a<t;++a){var s=a%2==1?e:1;i.push({x:Math.cos(o)*s,y:Math.sin(o)*s}),o+=n}return i}function yh(r,t){return void 0===t&&(t=!1),{getDistanceFromStrokeVertically:function(){return 1},getDistanceFromStrokeHorizontally:function(t,e){return vh(t,e,r)},points:r,isSimple:t}}function bh(t){var e=t.graphWidth,r=t.graphHeight,i=t.viewWidth,n=t.viewHeight;return.2*Math.min(i/e,n/r)}function xh(t){var e=t.smallestNodeSize,r=t.viewWidth,i=t.viewHeight;return e===1/0?1/0:Math.min(r,i)/e*.5}var Eh,Ah;(Ah=Eh=Eh||{}).ROTATION="rotation",Ah.PAN="pan",Ah.ZOOM="zoom",Ah.GESTURE="gesture";var Sh,wh=(b(Th,Sh=Ee),Th.prototype._setupInteractions=function(){var s=this;this._interactions.onMouseWheel({priority:"zoom",check:function(){return!!s._settings.get("interactions.zoom.enabled")},handler:F(function(t){var e=t.x,r=t.y,i=t.delta;return s._smoothZoom(i,e,r)},50)}),this._interactions.onDoubleClick({priority:"zoom",check:function(){var t=s._settings.get("interactions.zoom.enabled"),e=s._settings.get("interactions.zoom.onDoubleClick");return!(!t||!e)},handler:function(t){var e=t.x,r=t.y;return s._smoothZoom(1,e,r)}}),this._interactions.onDrag({priority:"panning",disableDetection:!0,check:function(t){var e=t.button,r=!!s._settings.get("interactions.pan.enabled");return"left"===e&&r},onStart:function(){return s._updateVisibility(Eh.PAN,!0)},onProgress:function(t){var e=t.dx,r=t.dy;return s._camera.move({x:-e,y:-r})},onStop:function(){return s._updateVisibility(Eh.PAN,!1)}}),this._interactions.onDrag({priority:"rotation",disableDetection:!0,check:function(t){var e=t.button,r=t.domEvent;return("right"===e||r&&2===r.buttons)&&!!s._settings.get("interactions.rotation.enabled")},onStart:function(t){var e=t.x,r=t.y;s._rotationStart={x:e,y:r},s._updateVisibility(Eh.ROTATION,!0)},onProgress:function(t){var e=t.x,r=t.y;return s._rotate({x:e,y:r})},onStop:function(){return s._updateVisibility(Eh.ROTATION,!1)}}),this._interactions.onGesture({priority:"gesture",disableDetection:!0,check:function(){return!!s._settings.get("interactions.gesture.enabled")},onStart:function(){return s._updateVisibility(Eh.GESTURE,!0)},onProgress:function(t){var e=t.dx,r=t.dy,i=t.rotation,n=t.scale,o=t.x,a=t.y;s._settings.get("interactions.rotation.enabled")&&s._camera.rotate(-i),s._camera.zoomIn(n,void 0,{x:o,y:a}),s._camera.move({x:-e,y:-r})},onStop:function(){return s._updateVisibility(Eh.GESTURE,!0)}})},Th.prototype._rotate=function(t){var e=t.x,r=t.y,i=this._camera.getSize(),n=i.width/2,o=i.height/2,a=this._rotationStart.x-n,s=this._rotationStart.y-o,u=e-n,l=r-o,d=Math.atan2(s,a)-Math.atan2(l,u);this._rotationStart.x=e,this._rotationStart.y=r,this._camera.rotate(d)},Th.prototype._updateVisibility=function(t,e){var value=!e,r=this._settings,i=r.get("interactions."+t+".hideNodes"),n=r.get("interactions."+t+".hideEdges"),o=r.get("interactions."+t+".hideNodeTexts"),a=r.get("interactions."+t+".hideEdgeTexts");i&&this._graphics.setNodesVisibility(value),o&&this._graphics.setNodeTextsVisibility(value),n&&this._graphics.setEdgesVisibility(value),a&&this._graphics.setEdgeTextsVisibility(value)},Th.prototype._smoothZoom=function(t,e,r){var i=this,n=this._settings,o=n.get("interactions.zoom.modifier")||1.8,a=n.get("interactions.zoom.duration"),s=n.get("interactions.zoom.easing"),u=this._camera.getZoom()*(0<t?o:1/o),l={duration:a,easing:s};this._zooming||(this._zooming=!0,this._updateVisibility(Eh.ZOOM,!0)),this._camera.setZoom(u,l,{x:e,y:r}).then(function(){i._zooming&&(i._zooming=!1,i._updateVisibility(Eh.ZOOM,!1))})},Th);function Th(t,e){t.locate,t.dom;var r=t.camera,i=t.graphics,n=t.settings,o=t.interactions,a=Sh.call(this)||this;return a._zooming=!1,a._camera=r,a._settings=n,a._interactions=o,a._graphics=i,n.register("interactions.zoom.enabled",!0),n.register("interactions.zoom.onDoubleClick",!1),n.register("interactions.zoom.duration",150),n.register("interactions.zoom.modifier",1.8),n.register("interactions.zoom.easing","quadraticOut"),n.register("interactions.zoom.minValue",e?null:bh),n.register("interactions.zoom.maxValue",e?null:xh),n.register("interactions.zoom.hideNodes",!1),n.register("interactions.zoom.hideEdges",!1),n.register("interactions.zoom.hideNodeTexts",!1),n.register("interactions.zoom.hideEdgeTexts",!1),n.register("interactions.pan.enabled",!0),n.register("interactions.pan.hideNodes",!1),n.register("interactions.pan.hideEdges",!1),n.register("interactions.pan.hideNodeTexts",!1),n.register("interactions.pan.hideEdgeTexts",!1),n.register("interactions.rotation.enabled",!0),n.register("interactions.rotation.hideNodes",!1),n.register("interactions.rotation.hideEdges",!1),n.register("interactions.rotation.hideNodeTexts",!1),n.register("interactions.rotation.hideEdgeTexts",!1),n.register("interactions.gesture.enabled",!0),n.register("interactions.gesture.hideNodes",!1),n.register("interactions.gesture.hideEdges",!1),n.register("interactions.gesture.hideNodeTexts",!1),n.register("interactions.gesture.hideEdgeTexts",!1),a._setupInteractions(),a}function Ch(t){return((t=Math.exp(t))+1/t)/2}var Mh,Ih,Lh=function i(m,y,b){function t(t,e){var r,a,s=t[0],u=t[1],l=t[2],i=e[0],n=e[1],o=e[2],d=i-s,h=n-u,c=d*d+h*h;if(c<1e-12)a=Math.log(o/l)/m,r=function(t){return[s+t*d,u+t*h,l*Math.exp(m*t*a)]};else{var f=Math.sqrt(c),g=(o*o-l*l+b*c)/(2*l*y*f),p=(o*o-l*l-b*c)/(2*o*y*f),_=Math.log(Math.sqrt(g*g+1)-g),v=Math.log(Math.sqrt(p*p+1)-p);a=(v-_)/m,r=function(t){var e,r,i=t*a,n=Ch(_),o=l/(y*f)*(n*(r=m*i+_,((r=Math.exp(2*r))-1)/(r+1))-(e=_,((e=Math.exp(e))-1/e)/2));return[s+o*d,u+o*h,l*n/Ch(m*i+_)]}}return r.duration=1e3*a*m/Math.SQRT2,r}return t.rho=function(t){var e=Math.max(.001,+t),r=e*e;return i(e,r,r*r)},t}(Math.SQRT2,2,4);(Ih=Mh=Mh||{}).ZOOM="zoom",Ih.ROTATE="rotate";var Nh={duration:0,easing:"linear",startAfter:0,ignoreZoomLimits:!(Ih.PAN="pan"),callback:function(){}};function Oh(t){return Math.abs(t)<1e-9}var kh,Rh=(b(Fh,kh=Ee),Object.defineProperty(Fh.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(Fh.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(Fh.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),Object.defineProperty(Fh.prototype,"angle",{get:function(){return this._angle},enumerable:!0,configurable:!0}),Object.defineProperty(Fh.prototype,"width",{get:function(){return this._dimensions.width},enumerable:!0,configurable:!0}),Object.defineProperty(Fh.prototype,"height",{get:function(){return this._dimensions.height},enumerable:!0,configurable:!0}),Fh.prototype.moveEnd=function(t){var e=this;this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){e._timeout=0,e._events.fire(be.VIEW_CHANGED,{type:t})},80)},Fh.prototype.getSize=function(){return{width:this._dimensions.width,height:this._dimensions.height}},Fh.prototype.getCenter=function(){return{x:this._x,y:this._y}},Fh.prototype.setCenter=function(t,e){var r=this,i=t.x,n=t.y,o=I(I({},Nh),e),a=this._x,s=this._y,u=i-this._x,l=n-this._y;return Oh(u)&&Oh(l)?Promise.resolve():new Promise(function(t){o.callback=function(){r.moveEnd(Mh.PAN),t()},r._moveAnimation&&r._animations.end(r._moveAnimation,!1);var e=r._animations.play(function(t){r._x=a+u*t,r._y=s+l*t,r._events.fire(be.CAMERA_MOVE),r._events.fire(be.CAMERA_PAN)},o);e&&(r._moveAnimation=e)})},Fh.prototype.move=function(t,e){var r=Dh({x:t.x,y:t.y},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+r.x,y:this._y+r.y},e)},Fh.prototype.getZoom=function(){return this._zoom},Fh.prototype.setZoom=function(t,c,e){var f=this;void 0===e&&(e={x:void 0,y:void 0});var g=I(I({},Nh),c),p=e.x,_=e.y,v=Xe(t,this._minZoom,this._maxZoom);return g.ignoreZoomLimits||(v=this._applyZoomLimits(v)),Oh(this._zoom-v)?Promise.resolve():new Promise(function(t){var e=f._dimensions.width/2,r=f._dimensions.height/2,i=f._zoom,n=e/i-e/v;if(g.callback=function(){f.moveEnd(Mh.ZOOM),t()},void 0!==p&&void 0!==_){var o=(p-e)/i-(p-e)/v,a=(_-r)/i-(_-r)/v,s=f._cosAngle,u=f._sinAngle,l=s*o-u*a,d=u*o+s*a;f.setCenter({x:f._x+l,y:f._y+d},c)}f._zoomAnimation&&f._animations.end(f._zoomAnimation,!1),f._dom.setTimeout(function(){f._events.fire(be.START_ZOOM,{duration:g.duration,easing:g.easing,startZoom:i,endZoom:v})});var h=f._animations.play(function(t){f._zoom=e/(e/i-n*t),f._events.fire(be.CAMERA_MOVE),f._events.fire(be.CAMERA_ZOOM)},g);h&&(f._zoomAnimation=h)})},Fh.prototype._applyZoomLimits=function(t){var e=this._settings.get("interactions.zoom.minValue"),r=this._settings.get("interactions.zoom.maxValue"),i=this._modules.locate.getGraphBoundingBox(),n=i.minScaledSize,o=i.maxScaledSize,a=i.width,s=i.height,u=i.cx,l=this._zoom,d=this.getSize(),h=t;if(!isNaN(u)){var c={smallestNodeSize:n,biggestNodeSize:o,graphWidth:a+o,graphHeight:s+o,viewWidth:d.width,viewHeight:d.height},f=e&&e(c),g=r&&r(c);Ph(f)&&h<f?h<l&&(h=Math.min(l,f)):Ph(g)&&g<h&&l<h&&(h=Math.max(l,g))}return h},Fh.prototype.zoomIn=function(t,e,r){void 0===r&&(r={x:void 0,y:void 0});var i=1;return i="number"!=typeof t?(r=e,e=t,this._settings.get("interactions.zoom.modifier")||1.8):t,this.setZoom(this._zoom*i,e,r)},Fh.prototype.moveToBounds=function(t,e){void 0===e&&(e={});var r=this._modules.locate.computeConfigForBounds(t,{ignoreZoomLimits:!0});return this.moveTo(r,e)},Fh.prototype.moveTo=function(n,s){var u=this;void 0===s&&(s={});var l=this.getZoom(),d=this.getCenter(),h=n.zoom||this._zoom;return 0===s.duration?this.setView(n):new Promise(function(t){var o=Math.min(u.width,u.height),a=Lh([d.x,d.y,o/l],[n.x,n.y,o/h]),e=a.duration,r=s.duration||e;u._moveAnimation&&u._animations.end(u._moveAnimation,!1);var i=u._animations.play(function(t){var e=a(t),r=e[0],i=e[1],n=e[2];u._x=r,u._y=i,u._zoom=o/n,u._events.fire(be.CAMERA_MOVE),u._events.fire(be.CAMERA_PAN)},{duration:r,easing:s.easing,callback:function(){u.moveEnd(Mh.PAN),t()}});i&&(u._moveAnimation=i)})},Fh.prototype.zoomOut=function(t,e,r){void 0===r&&(r={x:void 0,y:void 0});var i=1;return i="number"!=typeof t?(r=e,e=t,this._settings.get("interactions.zoom.modifier")||1.8):t,this.setZoom(this._zoom/i,e,r)},Fh.prototype.getAngle=function(){return this._angle},Fh.prototype.setAngle=function(t,e){var r=this,i=I(I({},Nh),e),n=this._angle,o=t-n;return Oh(o)?Promise.resolve():new Promise(function(t){i.callback=function(){r.moveEnd(Mh.ROTATE),t()},r._rotateAnimation&&r._animations.end(r._rotateAnimation,!1);var e=r._animations.play(function(t){for(r._angle=n+o*t;r._angle>Math.PI;)r._angle-=2*Math.PI;for(;r._angle<-Math.PI;)r._angle+=2*Math.PI;r._sinAngle=Math.sin(r._angle),r._cosAngle=Math.cos(r._angle),r._events.fire(be.CAMERA_MOVE),r._events.fire(be.CAMERA_ROTATE)},i);e&&(r._rotateAnimation=e)})},Fh.prototype.rotate=function(t,e){return this.setAngle(this._angle+t,e)},Fh.prototype.getScreenCenter=function(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}},Fh.prototype.graphToScreenCoordinates=function(t,e){var r=t.x,i=t.y;void 0===e&&(e={x:0,y:0});var n=this._dimensions.width/2,o=this._dimensions.height/2;return Ts((r-this._x)*this._zoom+n,(i-this._y)*this._zoom+o,n,o,-this._angle,e)},Fh.prototype.screenToGraphCoordinates=function(t,e){var r=t.x,i=t.y;return void 0===e&&(e={x:0,y:0}),Ts(this._x+(r-this._dimensions.width/2)/this._zoom,this._y+(i-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,e)},Fh.prototype.projectBounds=function(t,e){void 0===e&&(e=t);for(var r=t[0],i=t[1],n=t[2],o=t[3],a=this._x,s=this._y,u=this._dimensions.width/2,l=this._dimensions.height/2,d=this._sinAngle,h=this._cosAngle,c=1/this._zoom,f=1/0,g=1/0,p=-1/0,_=-1/0,v=[r,i,r,o,n,o,n,i],m=0;m<v.length;m+=2){var y=v[m],b=v[m+1],x=(y=a+(y-u)*c)-a,E=(b=s+(b-l)*c)-s;(y=h*x-d*E+a)<f&&(f=y),p<y&&(p=y),(b=d*x+h*E+s)<g&&(g=b),_<b&&(_=b)}return e[0]=f,e[1]=g,e[2]=p,e[3]=_,e},Fh.prototype.screenToGraphVector=function(t){return Dh({x:t.x,y:t.y},this._zoom,this._sinAngle,this._cosAngle)},Fh.prototype.getView=function(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}},Fh.prototype.setView=function(t,e){var r=I({x:this._x,y:this._y,zoom:this._zoom,angle:this._angle},t),i=r.x,n=r.y,o=r.zoom,a=r.angle;return Promise.all([this.setCenter({x:i,y:n},e),this.setZoom(o,e),this.setAngle(a,e)]).then(function(){})},Fh.prototype._reloadDimensions=function(){this._dimensions=this._dom.getDimensions()},Fh.prototype.animationInProgress=function(){var t=this._moveAnimation,e=this._zoomAnimation;return t&&!t.done||e&&!e.done},Fh.prototype.getProjectedScreenBounds=function(t){void 0===t&&(t=0);var e=this._dimensions,r=e.width,i=e.height,n=Math.max(r,i)*t;return this.projectBounds([0-n,0-n,r+n,i+n])},Fh.prototype._reset=function(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this._sinAngle=0,this._cosAngle=1,this._dimensions=this._dom.getDimensions()},Fh);function Fh(t){var e,r=kh.call(this)||this;r._minZoom=1e-8,r._maxZoom=1e8,r._timeout=0;var i=t.events,n=t.settings;return r._modules=t,r._events=i,r._dom=t.dom,r._animations=t.animations,r._settings=n,r._reset(),n.register("minZoom",1e-8,function(t){r._minZoom=t,r._zoom<t&&(r._zoom=t,r._events.fire(be.CAMERA_MOVE))}),n.register("maxZoom",1e8,function(t){r._maxZoom=t,r._zoom>t&&(r._zoom=t,r._events.fire(be.CAMERA_MOVE))}),i.on(((e={})[be.SET_CONTAINER]=function(){r._reset(),r._events.fire(be.CAMERA_MOVE)},e[be.RESIZE]=function(){r._reloadDimensions(),r._events.fire(be.CAMERA_MOVE)},e)),r}function Dh(t,e,r,i){var n=t.x,o=t.y;return{x:i*(n/=e)-r*(o/=e),y:r*n+i*o}}function Ph(value){return"number"==typeof value&&isFinite(value)}function zh(){}var Bh,Uh={maxBlockId:1024,maxCoord:-1/0,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},Vh=ft?"webgl":null,jh=(b(Gh,Bh=Ee),Gh.prototype.onMounted=function(t,e){var r=this;void 0!==e.renderer&&t.setOptions({renderer:e.renderer}),void 0!==e.imgCrossOrigin&&t.setOptions({imgCrossOrigin:e.imgCrossOrigin}),this._dom.addWindowEventListener("unload",function(){r.destroy()})},Gh.prototype.getTransparentBackgroundColor=function(){var t=this._settings.get("backgroundColor");return t?this._engine.transparentify(t):null},Gh.prototype._render=function(){var t=this._dom.getDimensions(),e=this._camera.getView(),r=St(),i=Zt(),n=this._settings.get("backgroundColor"),o=this._isBufferDisplayable;this._engine.setView({x:e.x,y:e.y,zoom:e.zoom,angle:e.angle,width:t.width,height:t.height,pixelRatio:r,currentTime:i,backgroundColor:n,isBufferDisplayable:o});try{this._engine.render(),"requested"===this._rendererState.state&&this._updateRendererState({state:"ok"})}catch(t){if(this._debug)throw t;var a=t.message,s=t.code,u=void 0===s?"OTHER":s,l=this._rendererState.type,d=function(t){return null===t?"none":"webgl"===t?"WebGL":"svg"===t?"SVG":"canvas"===t?"Canvas":t}(l),h="requested"===this._rendererState.state?"Error while initializing the "+d+" renderer":"The "+d+" renderer encountered an unexpected runtime error",c=null;"webgl"===l&&(h+="; fallbacking on canvas renderer",c="canvas"),Tr(a||""),Tr(h),this._updateRendererState({state:"error",code:u,message:a}),this._settings.set("renderer",c)}},Gh.prototype._fireRendererStateChangeEvent=function(){var t=this._rendererState;this._events.fire(be.RENDERER_STATE_CHANGE,{type:t.type,state:t.state,code:t.code,message:t.message})},Gh.prototype._updateRendererState=function(t){var e=t.type,r=t.state,i=t.code,n=t.message,o=!1;void 0!==e&&this._rendererState.type!==e&&(this._rendererState.type=e,o=!0),void 0!==r&&this._rendererState.state!==r&&(this._rendererState.state=r,o=!0),void 0!==i&&this._rendererState.code!==i&&(this._rendererState.code=i,o=!0),void 0!==n&&this._rendererState.message!==n&&(this._rendererState.message=n,o=!0),o&&this._initDone&&this._fireRendererStateChangeEvent()},Gh.prototype.getImageData=function(){var t=this;return this._dom.afterNextFrame().then(function(){return t._engine.getImageData()})},Gh.prototype.addCanvas=function(t){this._engine.addCanvas(t)},Gh.prototype.removeCanvas=function(t){this._engine.removeCanvas(t)},Gh.prototype.getNodeAttributes=function(){return this._attributesManager.getFlexArrays().nodes.current},Gh.prototype.getEdgeAttributes=function(){return this._attributesManager.getFlexArrays().edges.current},Gh.prototype.getGraphicsEngine=function(){return this._engine},Gh.prototype.getImageManager=function(){return this._imageManager},Gh.prototype.getFontManager=function(){return this._fontManager},Gh.prototype.allocateGraphicsEngineBlockId=function(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():10*this._nextGeIndex+++9},Gh.prototype.releaseGraphicsEngineBlockId=function(t){this._engine.freeBlock(t),this._availableGeIndexes.push(t),this._dom.refresh()},Gh.prototype.addCursorStyle=function(t){t&&(this._cursorStyle.push(t),this._applyCursorStyle())},Gh.prototype.removeCursorStyle=function(t){if(t){var e=this._cursorStyle.lastIndexOf(t);-1!==e&&(this._cursorStyle.splice(e,1),this._applyCursorStyle())}},Gh.prototype.reloadFonts=function(){this._events.fire(be.RELOAD_FONTS),this._engine.notifyFontsReloaded(),this._dom.refresh()},Gh.prototype.getDomElement=function(){return this._domElement},Gh.prototype.setTextHidden=function(t,e){this._attributesManager.setTextHidden(t,e)},Gh.prototype.resetTextHidden=function(){this._attributesManager.resetTextHidden(),this._dom.refresh()},Gh.prototype.getAttributesManager=function(){return this._attributesManager},Gh.prototype._checkFontsNewlyLoaded=function(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)},Gh.prototype._loadGraphInGraphicsEngine=function(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll();var t=this._attributesManager.getUpdatedElements(),e=t.elementsToRedraw,r=t.elementsUpdated,i=0<r.nodes.size||0<r.edges.size;(r.nodeAttributesSet.has("radius")||r.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=function(t){for(var e=t.getNodeAttribute("radius"),r=t.getEdgeAttribute("width"),i=t.getNodes(),n=t.getEdges(),o=0,a=0,s=0;s<i._indexes.length;s++){var u=i._indexes[s],l=e.get(u);o<l&&(o=l)}for(s=0;s<n._indexes.length;s++){u=n._indexes[s];var d=r.get(u);a<d&&(a=d)}return Math.max(2*o,a)}(this._graph)),(r.nodeAttributesSet.has("shape")||r.edgeAttributes.includes("shape.head")||r.edgeAttributes.includes("shape.tail"))&&ph(this._engine,this._attributesManager.getFlexArrays()),Wd({graph:this._graph,elements:e,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),i&&this._events.fire(be.UPDATE_ATTRIBUTES,r)},Gh.prototype._forceCompleteGraphRefresh=function(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()},Gh.prototype.export=function(e,r,n,i){var o,a=this;return Promise.all([this._graph.getNodes().addClass(gr),this._graph.getEdges().addClass(gr)]).then(function(){return a.resolveAtNextFrame()}).then(function(){return a._imageManager.whenReady()}).then(function(){var t;return"all"===n?(t=a._graph,o={nodes:Hh(t,!0),edges:Hh(t,!1)},a._forceCompleteGraphRefresh()):a._loadGraphInGraphicsEngine(),a._engine.export(e,r,i)}).then(function(t){return Promise.all([a._graph.getNodes().removeClass(gr),a._graph.getEdges().removeClass(gr)]).then(function(){return t})}).then(function(t){var e,r,i;return"all"===n&&(r=(e=o).nodes,i=e.edges,qh(r),qh(i),a._forceCompleteGraphRefresh()),t})},Gh.prototype.addAttributeLayer=function(t){return this._attributesManager.addAttributeLayer(t)},Gh.prototype.createFlexArrays=function(){return this._attributesManager.createFlexArrays()},Gh.prototype.getAttributeValues=function(t,e,r,i){return this._attributesManager.getAttributeValues(t,e,r,i)},Gh.prototype.forceAttributesComputation=function(){this._attributesManager.update()},Gh.prototype.resolveAtNextFrame=function(t){return this._dom.afterNextFrame().then(function(){return t})},Gh.prototype.animate=function(t,e,r){var i=function(t){return"number"==typeof t?t={duration:t}:"object"==typeof t&&null!==t||(t={duration:0}),{duration:function(t){return"number"!=typeof t||!isFinite(t)||t<0?0:t}(t.duration),easing:t.easing||"linear",chain:!!t.chain}}(r);return i.duration&&this._engine.ensureAnimationsReady(),this._animate(t,e,i)},Gh.prototype.isAnimating=function(){return 0<this._animations.length},Gh.prototype.getAnimationInformation=function(t){return this._attributesManager.getAnimationInformation(t)},Gh.prototype._toSubGraph=function(t){if(t instanceof yi||t instanceof vi)return{nodes:t.toList(),edges:t.getAdjacentEdges()};if(t instanceof $r||t instanceof Qr)return{nodes:this._graph.nodeList(),edges:t.toList()};var e=t,r={nodes:e.nodes||this._graph.nodeList(),edges:e.edges||this._graph.edgeList()};return r.nodes.size&&(r.edges.size?r.edges=r.edges.concat(r.nodes.getAdjacentEdges()).dedupe():r.edges=r.nodes.getAdjacentEdges()),r},Gh.prototype._animate=function(e,t,r){var i=r.duration,n=r.easing;if(!this._animations.length&&!i)return t(e),Promise.resolve(e);var o=this._toSubGraph(e),a=o.nodes,s=o.edges;if(0===a.size&&0===s.size)return Promise.resolve(e);a.size&&this._events.fire(be.ANIMATE,{elements:a,duration:i,easing:n}),s.size&&this._events.fire(be.ANIMATE,{elements:s,duration:i,easing:n});for(var u={id:this._nextAnimationId++,startTime:-1,finished:!1,func:function(){return t(e)},duration:i,easing:n,nodes:a,edges:s,resolve:zh},l=new Promise(function(t){return u.resolve=function(){return t(e)}}),d=0;d<a._indexes.length;d++)this._nodeAnimationList.set(a._indexes[d],u.id);for(d=0;d<s._indexes.length;d++)this._edgeAnimationList.set(s._indexes[d],u.id);return this._animations.push(u),this._dom.refresh(),i||this._processAnimations(),l},Gh.prototype._removeFinishedAnimations=function(){this._animations=this._animations.filter(function(t){return!t.finished})},Gh.prototype._getAnimationElements=function(t){for(var e=[],r=[],i=0;i<t.nodes._indexes.length;i++){var n=t.nodes._indexes[i];this._nodeAnimationList.get(n)===t.id&&e.push(n)}for(i=0;i<t.edges._indexes.length;i++)n=t.edges._indexes[i],this._edgeAnimationList.get(n)===t.id&&r.push(n);return{nodes:this._graph.nodeList(new Uint32Array(e)),edges:this._graph.edgeList(new Uint32Array(r))}},Gh.prototype._resetAnimationAttributes=function(t){var e=t.nodes,r=t.edges;this._attributesManager.resetAnimationAttributes({nodes:e,edges:r}),this._nodeAnimationList.fill(e._indexes,0),this._edgeAnimationList.fill(r._indexes,0)},Gh.prototype._processAnimations=function(){if(this._animations.length){var t=Zt(),e=[];this._attributesManager.update();for(var r=0,i=this._animations;r<i.length;r++)-1===(u=i[r]).startTime&&(u.startTime=t,e.push(u.func),0<u.duration&&this._attributesManager.setAnimationAttributes(this._getAnimationElements(u),u));for(var n=0,o=e;n<o.length;n++)(0,o[n])();for(var a=0,s=this._animations;a<s.length;a++){var u;t>=(u=s[a]).startTime+u.duration&&(this._resetAnimationAttributes(this._getAnimationElements(u)),u.resolve(u.elements),u.finished=!0)}this._removeFinishedAnimations(),this._animations.length&&this._dom.refresh()}},Gh.prototype.hideTexts=function(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)},Gh.prototype.showTexts=function(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)},Gh.prototype.setNodesVisibility=function(value){return this._updateVisibilityCounter("nodes",value)},Gh.prototype.setNodeTextsVisibility=function(value){return this._updateVisibilityCounter("nodeTexts",value)},Gh.prototype.setEdgesVisibility=function(value){return this._updateVisibilityCounter("edges",value)},Gh.prototype.setEdgeTextsVisibility=function(value){return this._updateVisibilityCounter("edgeTexts",value)},Gh.prototype._updateVisibilityCounter=function(t,value){this._visibility[t]+=value?-1:1,this._dom.refresh()},Gh.prototype.detectNode=function(t){return function(t,e,r,i,n,o){var a=t.x,s=t.y,u=t.margin,l=t.texts,d=t.indexes;d=d||e.getNodes()._indexes;var h=i.getZoom(),c=e.getObjectList(!0),f=r.getFlexArrays().nodes.current,g=1/0,p=0;r.update();for(var _=0;_<d.length;++_){var v=d[_];if(!f.excluded.get(v)&&f.detectable.get(v)&&0===f.animationDuration.get(v)){var m=f.x.get(v),y=f.y.get(v),b=i.graphToScreenCoordinates({x:m,y:y}),x=b.x,E=b.y,A=f.shape.get(v),S="scaled"===f.scalingMethod.get(v),w=f.radius.get(v)*(S?h:1),T=w+u,C=(a-x)/T,M=(s-E)/T;if(n.checkShapeHit(A,C,M))T<=g&&(g=T,p=v);else if(l){var I=o(f.text.content.get(v)||null),L=f.textHidden.get(v),N=f.text.minVisibleSize.get(v);if(!L&&I&&N<=(S?2*w:1/0)){var O=ya(I,f.text.maxLineLength.get(v)),k=f.innerStroke.width.get(v),R=f.outerStroke.width.get(v),F=f.text.margin.get(v),D=f.text.padding.get(v),P=f.text.size.get(v),z=f.text.scale.get(v),B=f.text.scaling.get(v),U=f.text.font.get(v),V=f.text.style.get(v),j=f.text.position.get(v),G=n.measureText(O,U,V,1),H=B?z*w:P,q=G.width*H/2+D,W=G.height*H/2+D,X=Ru[j],Y=k+R+F+w,Z=x+(Y+q)*X.x,K=E+(Y+W)*X.y;Z-q<a&&a<Z+q&&K-W<s&&s<K+W&&(p=v)}}}}return c.get(p)||null}(t,this._graph,this._attributesManager,this._camera,this._engine,this._formatText)},Gh.prototype.detectEdge=function(t){return function(t,e,r,i){var n=t.margin,o=(t.texts,t.indexes),a=void 0===o?e.getEdges()._indexes:o,s=e.getObjectList(!1),u=i.getFlexArrays(),l=u.edges.current,d=u.nodes.current,h=r.getZoom(),c=n/h,f=r.screenToGraphCoordinates(t),g=f.x,p=f.y,_=0;i.update();for(var v=0;v<a.length;++v){var m=a[v],y=l.source.get(m),b=l.target.get(m),x=l.excluded.get(m),E=l.detectable.get(m),A=0!==l.animationDuration.get(m),S=0!==d.animationDuration.get(y),w=0!==d.animationDuration.get(b);if(!x&&E&&!A&&!S&&!w){var T=y===b,C=l.curvature.get(m),M="triangle"===l.shape.body.get(m),I="scaled"===l.scalingMethod.get(m),L=l.width.get(m)/(I?1:h),N=d.x.get(y),O=d.y.get(y),k=d.x.get(b),R=d.y.get(b);if(T){var F="scaled"===d.scalingMethod.get(y);Lu(g,p,N,O,N,O,(D=vs(N,O,C,d.radius.get(y)/(F?1:h),0)).x1,D.y1,D.x2,D.y2,L,c)&&(_=m)}else if(0!==C){var D;Mu(g,p,N,O,k,R,(D=_s(N,O,k,R,C)).x,D.y,L,c,M)&&(_=m)}else du(g,p,N,O,k,R,L,c,M)&&(_=m)}}return s.get(_)||null}(t,this._graph,this._camera,this._attributesManager)},Gh.prototype.getVisibilityCounters=function(){return this._visibility},Gh.prototype.destroy=function(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()},Gh);function Gh(t,e){var r,i=t.dom,n=t.graph,o=t.camera,a=t.events,s=t.settings,u=Bh.call(this)||this;return u._debug=!1,u._initDone=!1,u._boundaries={maxSize:10,maxMinVisibleSize:64},u._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},u._nextAnimationId=1,u._animations=[],u._rendererState={type:null,code:null,state:"ok",message:""},u._cursorStyle=[],u._fontsNewlyLoaded=[],u._nextGeIndex=1,u._availableGeIndexes=[],u._isBufferDisplayable=function(t){var e,r=(e=t.depth)===Va||e===Ua||Wa<=(e-ja)%Za,i=Yl(t),n=r?u._visibility.nodes:u._visibility.edges,o=r?u._visibility.nodeTexts:u._visibility.edgeTexts;return 0===n&&(!i||0===o)},u._applyCursorStyle=function(){var t=u._cursorStyle[u._cursorStyle.length-1]||u._settings.get("cursor.default");Ut(u._domElement,t)},u._updateImageCrossOrigin=function(){u._imageManager.setImgCrossOrigin(u._settings.get("imgCrossOrigin")||null)},u._debug=e.isDebug(),u._events=a,u._dom=i,u._graph=n,u._camera=o,u._events=a,u._settings=s,u._formatText=Ea().applyArabicShaping,u._attributesManager=new Gl(n,i,e),u._imageManager=new uu,u._fontManager=new $d,u._engine=new iu(iu.getCachedInitData()),u._domElement=u._engine.getDomElement(),u._nodeAnimationList=u._graph.createNodeAttribute({storage:32,default:0}),u._edgeAnimationList=u._graph.createEdgeAttribute({storage:32,default:0}),u._events.register([be.RELOAD_FONTS,be.RENDERER_STATE_CHANGE,be.BEFORE_UPDATE_ATTRIBUTES,be.UPDATE_ATTRIBUTES,be.ANIMATE,be.CAMERA_MOVE,be.CAMERA_PAN,be.CAMERA_ZOOM,be.CAMERA_ROTATE,be.VIEW_CHANGED,be.START_ZOOM]),s.register("renderer",Vh,function(t){u._updateRendererState({type:t,state:"requested",code:null,message:void 0}),u._engine.setRenderType(t),u._dom.refresh()}),s.register("backgroundColor","white",function(t){u._engine.parseColor(t)?i.refresh():(Tr('Invalid background color "'+t+'" specified; will default to black.'),s.set("backgroundColor","black"))}),s.register("texts.hideUntilFontsLoaded",!0,function(t){u._fontManager.setHideUntilFontsLoaded(!!t)}),s.register("imgCrossOrigin","anonymous",u._updateImageCrossOrigin),s.register("cursor.default","default",u._applyCursorStyle),i.setLayer("graphics",u._domElement),u._engine.setGlobalBoundaries(Uh),i.beforeNextFrame().then(function(){u._initDone=!0,u._fireRendererStateChangeEvent()}),u._imageManager.onFetch(function(){u._engine.notifyPatternUpdate(),u._dom.refresh()}),u._fontManager.onFontLoaded(function(t){u._fontsNewlyLoaded.push(t),u._engine.notifyPatternUpdate(),u._engine.notifyFontsReloaded(),u._dom.refresh()}),i.addMediaListener("(min-resolution: 2dppx)",function(){return i.refresh()}),u._visibleAttributeLayer=u._attributesManager.addAttributeLayer({priority:0,name:"internal("+ar+")",tag:ar,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),u._dataAttributeLayer=u._attributesManager.addAttributeLayer({priority:0,name:"internal("+sr+")",tag:sr,nodeDependencies:void 0,edgeDependencies:void 0}),ph(u._engine,u._attributesManager.getFlexArrays()),a.on(((r={})[be.CAMERA_MOVE]=function(){return u._dom.refresh()},r[be.NEW_FRAME]=function(){u._processAnimations(),u._loadGraphInGraphicsEngine(),u._render()},r[be.CLEAR_GRAPH]=function(){u._nextGeIndex=1,u._availableGeIndexes=[],u._engine.clear(),u._attributesManager.clear(),u._dom.refresh()},r[be.VIEW_CHANGED]=function(t){if(t.type===Mh.ROTATE){var e=u._graph.getEdges().filter(function(t){return t.getAttribute("adjustAnchors")});u._attributesManager.redrawElements(e)}},r[be.ADD_NODES+" "+be.ADD_EDGES]=function(t){u._attributesManager.updateForAllAttributeLayers(t.nodes||t.edges)},r[be.EXCLUDED_STATE_CHANGE]=function(t){u._visibleAttributeLayer.updateElements(t.elements)},r[be.SET_DATA]=function(t){u._dataAttributeLayer.updateElements(t.elements)},r)),iu.clearCachedInitData(),u}function Hh(t,e){var r=e?t.getNodeAttribute("excluded"):t.getEdgeAttribute("excluded"),i=(e?t.getNodes("all"):t.getEdges("all"))._indexes,n=r.getMultiple(i);return r.fill(i,0),{excludedList:r,indexes:i,values:n}}function qh(t){var e=t.excludedList,r=t.indexes,i=t.values;e.setMultiple(r,i)}var Wh,Xh=(b(Yh,Wh=Ee),Yh.prototype.register=function(t,e){var r=this;void 0===e&&(e=[]),t.forEach(function(t){r._events[t]=new Zh(!1,t)}),e.forEach(function(t){if(r._events[t])throw new Error('event "'+t+'" already exists');r._events[t]=new Zh(!0,t)})},Yh.prototype.onAnyEvent=function(t){this._onAnyEvents.push(t)},Yh.prototype.on=function(t,e){var r=this;if("string"==typeof t){var i=e;t.split(" ").filter(function(t){return!!t}).forEach(function(t){return r._getEvent(t).on(i)})}else V(t,function(t,e){return r.on(e,t)});return this},Yh.prototype.removeListener=function(e){V(this._events,function(t){t.off(e)})},Yh.prototype.fire=function(e,r){void 0===r&&(r=null);var t=this._getEvent(e);return this._onAnyEvents.forEach(function(t){return t(e,r)}),t.trigger(r),this},Yh.prototype.once=function(t,e){var r=this,i=function(){e.apply(null,arguments),r.removeListener(i)};this.on(t,i)},Yh.prototype._getEvent=function(t){if(!(t in this._events))throw new Error("Event "+t+" does not exist");return this._events[t]},Yh);function Yh(){var t=null!==Wh&&Wh.apply(this,arguments)||this;return t._events={},t._onAnyEvents=[],t}var Zh=(Kh.prototype.trigger=function(t){for(var e=0,r=this._handlers;e<r.length;e++)(0,r[e])(t,this._name);return this},Kh.prototype.on=function(t){if("function"!=typeof t)throw new Error("handler is not a function");var e=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(e,0,t),this._subscribers.splice(e,0,t),this},Kh.prototype.off=function(t){for(var e;-1!==(e=this._subscribers.indexOf(t));)this._subscribers.splice(e,1),this._handlers.splice(e,1);return this},Kh);function Kh(t,e){this._subscribers=[],this._handlers=[],this._reverseOrder=t,this._name=e}var Qh,Jh=(b($h,Qh=Ee),$h.prototype.getOriginalAttributes=function(){return this._originalAttributesLayer.getFlexArrays()},$h.prototype.setMultipleAttributes=function(t,e,r,i){var n=this;return this._events.fire(be.SET_MULTIPLE_ATTRIBUTES,{elements:t,values:e,options:r,updatedAttributes:i}),this._graphics.animate(t,function(){n._individualAttributesLayer.setAttributeValues(t,e,i)},r)},$h.prototype.setSingleAttribute=function(t,e,r,i){var n={};return G(n,e,r),this.setMultipleAttributes(t,n,i)},$h.prototype.resetMultipleAttributes=function(t,e,r){for(var i=this,n=e||this._individualAttributesLayer.getUsedAttributeNames(t),o={},a=0,s=n;a<s.length;a++){var u=s[a];G(o,u,void 0)}return this._graphics.animate(t,function(){i._individualAttributesLayer.setAttributeValues(t,o)},r)},$h.prototype.getMultipleAttributes=function(t,e){return this._graphics.getAttributeValues(t,e,!0,!1)},$h.prototype.getSingleAttribute=function(t,e){return this._graphics.getAttributeValues(t,e,!1,!1)},$h.prototype.replaceOriginalAttributes=function(t,e,r){void 0===r&&(r=[]);for(var i={},n=this._originalAttributesLayer.getUsedAttributeNames(t).filter(function(t){return!r.includes(t)}),o=0;o<n.length;++o)G(i,n[o],void 0);this._originalAttributesLayer.setAttributeValues(t,i),this._originalAttributesLayer.setAttributeValues(t,e)},$h.prototype.getSinglePreviousAttribute=function(t,e){return this._graphics.getAttributeValues(t,e,!1,!0)},$h.prototype.getMultiplePreviousAttributes=function(t,e){return this._graphics.getAttributeValues(t,e,!0,!0)},$h);function $h(t){var e,r=t.events,i=t.graphics,o=Qh.call(this)||this;return o._events=r,o._graphics=i,r.register([be.SET_MULTIPLE_ATTRIBUTES]),r.on(((e={})[be.ADD_NODES+" "+be.ADD_EDGES]=function(t){var e=t.nodes,r=t.edges,i=e||r,n=t.objects.map(function(t){return t.attributes});o._originalAttributesLayer.setAttributeValues(i,n)},e)),o._originalAttributesLayer=o._graphics.addAttributeLayer({name:"original-attributes",priority:1,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),o._individualAttributesLayer=o._graphics.addAttributeLayer({name:"individual-attributes",priority:4,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),o}var tc,ec=(b(rc,tc=Ee),rc.prototype.onMounted=function(t,e){e.renderer&&this.update({renderer:e.renderer}),e.options&&this.update(e.options)},rc.prototype.register=function(t,e,r,i){return void 0===i&&(i=!0),this._keys.push(t),this._currentValue[t]=e,this._defaultValues[t]=e,this._onChange[t]=r||function(){},r&&i&&r(e),this},rc.prototype.update=function(t){t=q(t);for(var e=this._keys,r={},i=this._currentValue,n=0;n<e.length;++n){var o=e[n];if(o in t){var value=t[o];void 0===value&&(value=this._defaultValues[o]),r[o]=i[o],i[o]=value}}var a=Object.keys(r);for(n=0;n<a.length;++n){var s=a[n],u=this._currentValue[s],l=r[s];u!==l&&this._onChange[s](u,l)}return W(r)},rc.prototype.get=function(t){return arguments.length?this._currentValue[t]:W(this._currentValue)},rc.prototype.set=function(t,value){var e=this._currentValue[t],r=this._onChange[t];this._currentValue[t]=value,r&&r(value,e)},rc);function rc(){var t=null!==tc&&tc.apply(this,arguments)||this;return t._currentValue={},t._onChange={},t._defaultValues={},t._keys=[],t}var ic=(nc.prototype.getName=function(){return this._name},nc.prototype.getIndex=function(){return this._classes.getIndex(this._name)},nc.prototype.setIndex=function(t){return this._classes.setIndex(this._name,t)},nc.prototype.update=function(t){return this._classes.update(this._name,t),this},nc.prototype.getDefinition=function(){return this._classes.getDefinition(this._name)},nc.prototype.getNodes=function(t){return this._classes.getElementsByClass(this._name,t).nodes},nc.prototype.getEdges=function(t){return this._classes.getElementsByClass(this._name,t).edges},nc.prototype.clearNodes=function(t){this.getNodes(t).removeClass(this._name)},nc.prototype.clearEdges=function(t){this.getEdges(t).removeClass(this._name)},nc.prototype.add=function(t){t.addClass(this._name)},nc.prototype.remove=function(t){t.removeClass(this._name)},nc);function nc(t,e){this._classes=t,this._name=e}var oc,ac=(b(sc,oc=Ee),sc.prototype._getClassList=function(t){return t?this._builtinClasses:this._userClasses},sc.prototype.createClass=function(t){var e=void 0===t?{}:t,r=e.name,i=e.isBuiltin,n=void 0!==i&&i,o=e.after,a=e.nodeAttributes,s=e.nodeDependencies,u=e.nodeOutput,l=e.edgeAttributes,d=e.edgeDependencies,h=e.edgeOutput;if("string"!=typeof r)throw new Error('the "name" argument should be a string');var c=this._getClassList(n),f=o?function(t,e){for(var r=0;r<t.length;++r)if(t[r].name===e)return r;return-1}
/**
   * @linkurious/spatial-index v0.3.0
   * Ogma spatial index data structures
   *
   * @author Alexander Milevski
   * @license ISC
   * @preserve
   */(c,o)+1:c.length;if(-1===f)throw new Error('createClass: class specified as `after` parameter "'+o+'" does not exist');if(n&&!r.startsWith("_"))throw new Error('invalid builtin class name "'+r+"\": builtin classes should start with '_'");var g=new ia(this._graph),p=new ic(this,r),_={name:r,elementSet:g,attributeLayer:this._graphics.addAttributeLayer({name:"class("+r+")",tag:r,standaloneSelectors:!0,nodeAttributes:a||void 0,edgeAttributes:l||void 0,nodeSelector:function(t,e){return e.hasElement(t)},edgeSelector:function(t,e){return e.hasElement(t)},nodeContext:g,edgeContext:g,nodeOutput:u,edgeOutput:h,nodeDependencies:s,edgeDependencies:d}),isBuiltin:n,wrapper:p};return c.splice(f,0,_),n&&c.sort(function(t,e){return br.indexOf(t.name)-br.indexOf(e.name)}),this._updatePriorities(n),this._classesByName[r]=_,this._events.register([uc(r,!0,!0),uc(r,!0,!1),uc(r,!1,!0),uc(r,!1,!1)]),p},sc.prototype._updatePriorities=function(t){for(var e=this._getClassList(t),r=5+(t?.5:0),i=0;i<e.length;++i){var n=r+5e-4*i;e[i].attributeLayer.update({priority:n})}},sc.prototype._get=function(t){var e=this._classesByName[t];if(!e)throw new Error('class "'+t+'" does not exist');return e},sc.prototype.getIndex=function(t){var e=this._get(t);return this._getClassList(e.isBuiltin).indexOf(e)},sc.prototype.setIndex=function(t,e){var r=this._get(t),i=this._getClassList(r.isBuiltin),n=i.indexOf(r),o=Xe(e,0,i.length-1);i.splice(n,1),i.splice(o,0,r),this._updatePriorities(r.isBuiltin)},sc.prototype.update=function(t,e){var r=void 0===e?{}:e,i=r.nodeAttributes,n=r.edgeAttributes,o=r.nodeDependencies,a=r.edgeDependencies,s=r.nodeOutput,u=r.edgeOutput,l=r.fullOverwrite;this._get(t).attributeLayer.update({nodeAttributes:i,edgeAttributes:n,nodeDependencies:o,edgeDependencies:a,nodeOutput:s,edgeOutput:u,fullOverwrite:l})},sc.prototype.getDefinition=function(t){var e=this._get(t).attributeLayer.getDefinition(),r=e.nodeAttributes,i=e.nodeDependencies,n=e.nodeOutput;return{nodeAttributes:r||void 0,edgeAttributes:e.edgeAttributes||void 0,nodeDependencies:i,edgeDependencies:e.edgeDependencies,nodeOutput:n,edgeOutput:e.edgeOutput}},sc.prototype._addOrRemoveClassesToElements=function(t,e,r){for(var i=e.isNode,n=0;n<t.length;++n){var o=t[n],a=this._get(o),s=a.elementSet,u=a.attributeLayer,l=s.addOrRemoveElements(e,r),d=uc(o,i,r);l.size&&(u.updateElements(l),this._events.fire(d,i?{nodes:l}:{edges:l}))}},sc.prototype.addClassesToElements=function(t,e,r){var i=this,n=e.toList();return this._graphics.animate(e,function(){i._addOrRemoveClassesToElements(t,n,!0)},r)},sc.prototype.removeClassesFromElements=function(t,e,r){var i=this,n=e.toList();return this._graphics.animate(e,function(){i._addOrRemoveClassesToElements(t,n,!1)},r)},sc.prototype.hasSingleElementClass=function(t,e){return this._get(t).elementSet.hasElement(e)},sc.prototype.getElementsClassList=function(t,e){void 0===e&&(e={});for(var r=e.includeBuiltinClasses,i=void 0!==r&&r,n=new Array(t.size),o=0;o<n.length;++o)n[o]=[];return this._addClassNamesToList(n,t,this._userClasses),i&&this._addClassNamesToList(n,t,this._builtinClasses),n},sc.prototype._addClassNamesToList=function(t,e,r){for(var i=e.toList(),n=0;n<r.length;++n)for(var o=this._userClasses[n],a=o.name,s=o.elementSet,u=0;u<i.size;++u){var l=i.get(u);s.hasElement(l)&&t[u].push(a)}},sc.prototype.getClassByName=function(t,e){void 0===e&&(e=!1);var r=this._classesByName[t]||null;if(e&&!r)throw new Error('class "'+t+'" does not exist');return r&&r.wrapper},sc.prototype.getClassList=function(){return this._userClasses.map(function(t){return t.wrapper})},sc.prototype.getElementsByClass=function(t,e){void 0===e&&(e="visible");var r=this._get(t).elementSet.getElements(),i=r.nodes,n=r.edges;return"visible"===e?(i=i.filter(function(t){return t.isVisible()}),n=n.filter(function(t){return t.isVisible()})):"raw"===e&&(i=i.filter(function(t){return!t.isVirtual()}),n=n.filter(function(t){return!t.isVirtual()})),{nodes:i,edges:n}},sc.prototype._onClassEvent=function(t,e,r,i){var n=uc(t,r,i);this._events.on(n,e)},sc.prototype.onNodeClassAdded=function(t,e){this._onClassEvent(t,e,!0,!0)},sc.prototype.onNodeClassRemoved=function(t,e){this._onClassEvent(t,e,!0,!1)},sc.prototype.onEdgeClassAdded=function(t,e){this._onClassEvent(t,e,!1,!0)},sc.prototype.onEdgeClassRemoved=function(t,e){this._onClassEvent(t,e,!1,!1)},sc);function sc(t){var e,r=t.events,i=t.graphics,n=t.graph,o=oc.call(this)||this;return o._builtinClasses=[],o._userClasses=[],o._classesByName={},o._events=r,o._graphics=i,o._graph=n,r.on(((e={})[be.EXCLUDED_STATE_CHANGE]=function(t){var e=t.elements;if(t.value){var r=o._builtinClasses.map(function(t){return t.name});o._addOrRemoveClassesToElements(r,e,!1)}},e[be.CLEAR_GRAPH]=function(){o._builtinClasses.concat(o._userClasses).forEach(function(t){return t.elementSet.clear()})},e)),o}function uc(t,e,r){return(e?"node":"edge")+"Class"+(r?"Added":"Removed")+"_"+t}var lc=function(t,e){this.key=t,this.data=e,this.left=null,this.right=null};function dc(t,e){return e<t?1:t<e?-1:0}function hc(t,e,r){if(null===e)return e;var i,n,o,a=new lc;for(i=n=a;;){var s=r(t,e.key);if(s<0){if(null===e.left)break;if(r(t,e.left.key)<0&&(o=e.left,e.left=o.right,o.right=e,null===(e=o).left))break;n.left=e,e=(n=e).left}else{if(!(0<s))break;if(null===e.right)break;if(0<r(t,e.right.key)&&(o=e.right,e.right=o.left,o.left=e,null===(e=o).right))break;i.right=e,e=(i=e).right}}return i.right=e.left,n.left=e.right,e.left=a.right,e.right=a.left,e}function cc(t,e,r,i,n){var o=new lc(t,e);if(n._size++,null===r)return o.left=o.right=null,o;var a=i(t,(r=hc(t,r,i)).key);return a<0?(o.left=r.left,(o.right=r).left=null):0<=a&&(o.right=r.right,(o.left=r).right=null),o}function fc(t,e,r,i){var n;return null===e?null:t===(e=hc(t,e,r)).key?(null===e.left?n=e.right:(n=hc(t,e.left,r)).right=e.right,i._size--,n):e}function gc(t,e,r){var i,n;if(null===e)i=n=null;else{var o=r((e=hc(t,e,r)).key,t);0===o?(i=e.left,n=e.right):o<0?(n=e.right,e.right=null,i=e):(i=e.left,e.left=null,n=e)}return{left:i,right:n}}function pc(t){void 0===t&&(t=dc),this._comparator=t,this._root=null,this._size=0}var _c={size:{configurable:!0}};pc.prototype.insert=function(t,e){return this._root=cc(t,e,this._root,this._comparator,this)},pc.prototype.add=function(t,e){return this._root=function(t,e,r,i,n){var o=new lc(t,e);if(null===r)return o.left=o.right=null,n._size++,o;var a=i(t,(r=hc(t,r,i)).key);return 0===a?r:(a<0?(o.left=r.left,(o.right=r).left=null):0<a&&(o.right=r.right,(o.left=r).right=null),n._size++,o)}(t,e,this._root,this._comparator,this)},pc.prototype.remove=function(t){this._root=fc(t,this._root,this._comparator,this)},pc.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=hc(t.key,this._root,this._comparator),this._root=fc(t.key,this._root,this._comparator,this),{key:t.key,data:t.data}}return null},pc.prototype.findStatic=function(t){for(var e=this._root,r=this._comparator;e;){var i=r(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},pc.prototype.find=function(t){return this._root&&(this._root=hc(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},pc.prototype.contains=function(t){for(var e=this._root,r=this._comparator;e;){var i=r(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},pc.prototype.forEach=function(t,e){for(var r=this._root,i=[],n=!1;!n;)null!==r?(i.push(r),r=r.left):0!==i.length?(r=i.pop(),t.call(e,r),r=r.right):n=!0;return this},pc.prototype.range=function(t,e,r,i){for(var n=[],o=this._comparator,a=this._root;0!==n.length||a;)if(a)n.push(a),a=a.left;else{if(0<o((a=n.pop()).key,e))break;if(0<=o(a.key,t)&&r.call(i,a))return this;a=a.right}return this},pc.prototype.keys=function(){var r=[];return this.forEach(function(t){var e=t.key;return r.push(e)}),r},pc.prototype.values=function(){var r=[];return this.forEach(function(t){var e=t.data;return r.push(e)}),r},pc.prototype.min=function(){return this._root?this.minNode(this._root).key:null},pc.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},pc.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},pc.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},pc.prototype.at=function(t){for(var e=this._root,r=!1,i=0,n=[];!r;)if(e)n.push(e),e=e.left;else if(0<n.length){if(e=n.pop(),i===t)return e;i++,e=e.right}else r=!0;return null},pc.prototype.next=function(t){var e=this._root,r=null;if(t.right){for(r=t.right;r.left;)r=r.left;return r}for(var i=this._comparator;e;){var n=i(t.key,e.key);if(0===n)break;e=n<0?(r=e).left:e.right}return r},pc.prototype.prev=function(t){var e=this._root,r=null;if(null!==t.left){for(r=t.left;r.right;)r=r.right;return r}for(var i=this._comparator;e;){var n=i(t.key,e.key);if(0===n)break;e=n<0?e.left:(r=e).right}return r},pc.prototype.clear=function(){return this._root=null,this._size=0,this},pc.prototype.toList=function(){return function(t){var e=t,r=[],i=!1,n={next:null},o=n;for(;!i;)e?(r.push(e),e=e.left):0<r.length?e=(e=o=o.next=r.pop()).right:i=!0;return o.next=null,n.next}(this._root)},pc.prototype.load=function(t,e,r){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===r&&(r=!1);var i=t.length,n=this._comparator;if(r&&!function t(e,r,i,n,o){if(n<=i)return;var a=e[i+n>>1];var s=i-1;var u=n+1;for(;;){for(;o(e[++s],a)<0;);for(;0<o(e[--u],a););if(u<=s)break;var l=e[s];e[s]=e[u],e[u]=l,l=r[s],r[s]=r[u],r[u]=l}t(e,r,i,u,o);t(e,r,u+1,n,o)}(t,e,0,i-1,n),null===this._root)this._root=function t(e,r,i,n,o){var a=o-n;if(0<a){var s=n+Math.floor(a/2),u=r[s],l=i[s],d={key:u,data:l,parent:e};return d.left=t(d,r,i,n,s),d.right=t(d,r,i,s+1,o),d}return null}(this._root,t,e,0,i),this._size=i;else{var o=function(t,e,r){void 0===r&&(r=function(t,e){return t-e});var i={},n=i,o=t,a=e;for(;null!==o&&null!==a;)r(o.key,a.key)<0?o=(n.next=o).next:a=(n.next=a).next,n=n.next;null!==o?n.next=o:null!==a&&(n.next=a);return i.next}(this.toList(),function(t,e){for(var r={next:null},i=r,n=0;n<t.length;n++)i=i.next={key:t[n],data:e[n]};return i.next=null,r.next}(t,e),n);i=this._size+i,this._root=function t(e,r,i){var n=i-r;if(0<n){var o=r+Math.floor(n/2),a=t(e,r,o),s=e.head;return s.left=a,e.head=e.head.next,s.right=t(e,o+1,i),s}return null}({head:o},0,i)}return this},pc.prototype.isEmpty=function(){return null===this._root},_c.size.get=function(){return this._size},pc.prototype.toString=function(t){void 0===t&&(t=function(t){return t.key});var e=[];return function t(e,r,i,n,o){if(e){n(r+(i?" ":" ")+o(e)+"\n");var a=r+(i?"    ":"   ");e.left&&t(e.left,a,!1,n,o),e.right&&t(e.right,a,!0,n,o)}}(this._root,"",!0,function(t){return e.push(t)},t),e.join("")},pc.prototype.update=function(t,e,r){var i,n,o,a=this._comparator,s=gc(t,this._root,a),u=s.left,l=s.right;this._size--,a(t,e)<0?l=cc(e,r,l,a,this):u=cc(e,r,u,a,this),this._root=(i=u,o=a,null===(n=l)?i:(null===i||((n=hc(i.key,n,o)).left=i),n))},pc.prototype.split=function(t){return gc(t,this._root,this._comparator)},Object.defineProperties(pc.prototype,_c);var vc=function(e){function t(t){e.call(this,t,!0)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(pc);vc.prototype.lte=function(t){for(var e,r=this._comparator,i=this._root;i;){if(e=r(i.key,t),null===i.left&&null===i.right&&0<e)return null;if(e<=0&&null===i.right||e<=0&&0<r(i.right.key,t))return i;i=0<=e?i.left:i.right}return i},vc.prototype.gte=vc.prototype.gte||function(t){for(var e=[],r=this._comparator,i=this._root;0!==e.length||i;)if(i)e.push(i),i=i.left;else{if(0<=r((i=e.pop()).key,t))break;i=i.right}return i},vc.prototype.clear=vc.prototype.clear||function(){return this._root=null,this._size=0,this};function mc(t,e,r){void 0===t&&(t=Int32Array),void 0===e&&(e=16),void 0===r&&(r=8),this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=t,this._capacity=e,this._MAX_LIST_SIZE=r,this._freeIndex=-1,this.clear()}var yc={averageSize:{configurable:!0}};function bc(t,e){var r=new t.constructor(e);return r.set(t),r}
/* eslint-disable */mc.prototype.clear=function(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex={},this._constList=new Array(this._MAX_LIST_SIZE)},mc.prototype.addEntry=function(t){var e;return-1===this._freeIndex?e=this._nextIndex++:(e=this._freeIndex,this._freeIndex=-1),(this._idToIndex[t]=e)>=this._capacity&&this._expand(e+1),this._sizes[e]=0,e},mc.prototype.getItems=function(t){var e=this._idToIndex[t];if(void 0!==e){var r=this._sizes[e],i=this._MAX_LIST_SIZE*e;if(r<=this._MAX_LIST_SIZE){for(var n=0,o=this._constList.length=r;n<o;++n)this._constList[n]=this._buffer[i+n];return this._constList}if(r===this._BIG_LIST){var a=this._buffer[i];return this._bigLists[a]}}},mc.prototype.removeEntry=function(t){var e=this._idToIndex[t];if(this._sizes[e]===this._BIG_LIST){var r=this._MAX_LIST_SIZE*e,i=this._buffer[r];this._bigLists[i].length=0}this._sizes[e]=0,this._freeIndex=e},mc.prototype.size=function(t){var e=this._idToIndex[t],r=this._sizes[e];return r<=this._MAX_LIST_SIZE?r:this._bigLists[this._buffer[e*this._MAX_LIST_SIZE]].length},mc.prototype.sizes=function(t){for(var e=this._sizes,r=this._bigLists,i=this._buffer,n=this._MAX_LIST_SIZE,o=t.length,a=new Array(o),s=0;s<o;s++){var u=this._idToIndex[t[s]],l=e[u];a[s]=l<=n?l:r[i[u*n]].length}return a},mc.prototype.addTo=function(t,value){var e=this._idToIndex[t],r=this._sizes[e],i=e*this._MAX_LIST_SIZE;if(r<this._MAX_LIST_SIZE)this._buffer[i+r]=value,this._sizes[e]=r+1;else if(r===this._BIG_LIST){var n=this._buffer[i];this._bigLists[n].push(value)}else{for(var o=new Array(this._MAX_LIST_SIZE),a=0;a<this._MAX_LIST_SIZE;++a)o[a]=this._buffer[i+a];o.push(value),this._bigLists.push(o),this._sizes[e]=this._BIG_LIST,this._buffer[i]=this._bigLists.length-1}},mc.prototype.removeFrom=function(t,value){this.removeFromAndGetSize(t,value)},mc.prototype.removeFromAndGetSize=function(t,value){var e=this._idToIndex[t],r=this._sizes[e],i=this._MAX_LIST_SIZE*e;if(r<=this._MAX_LIST_SIZE){for(var n=i,o=i+r;n<o;++n)if(this._buffer[n]===value)return--r,this._buffer[n]=this._buffer[o-1],this._sizes[e]=r}else if(r===this._BIG_LIST){var a=this._buffer[i],s=this._bigLists[a],u=s.indexOf(value);if(-1!==u)return s.splice(u,1),s.length}},mc.prototype.reserve=function(t){this._capacity<t&&this._expand(t)},mc.prototype._expand=function(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t))),this._buffer=bc(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=bc(this._sizes,this._capacity)},mc.prototype.has=function(t){var e=this._idToIndex[t];return!(void 0===e||e>=this._capacity)&&0!==this._sizes[e]},yc.averageSize.get=function(){for(var t=0,e=0;e<this._capacity;e++)t+=this._sizes[e];return t/this._capacity},Object.defineProperties(mc.prototype,yc);for(var xc,Ec,Ac=[0,1],Sc=[0,2],wc=4;wc<65535;wc<<=2)for(var Tc=0,Cc=Ac.length;Tc<Cc;Tc++)Ac.push(Ac[Tc]|wc),Sc.push((Ac[Tc]|wc)<<1);function Mc(t,e){return(Sc[255&e]|Ac[255&t])+65536*(Sc[e>>8&255]|Ac[t>>8&255])+4294967296*(Sc[e>>16&255]|Ac[t>>16&255])}function Ic(t,e){if(void 0===e&&(e=[0,0]),0xffffffffffff<t)throw"Only morton codes up to 48 bits are supported.";if(!xc){xc={},Ec={};for(var r=0;r<256;r++)xc[Mc(r,0)]=r,Ec[Mc(0,r)]=r}var i=xc[21845&t],n=Ec[43690&t];return 65535<t&&(i|=xc[21845&(t/=65536)]<<8,n|=Ec[43690&t]<<8,65535<t&&(i|=xc[21845&(t/=65536)]<<16,n|=Ec[43690&t]<<16)),e[0]=i,e[1]=n,e}Mc.code=function(t,e,r){if(24<t)throw"Morton codes are only supported up to Z=24";var i=1<<24-t;return Mc(e*i,r*i)},Mc.range=function(t,e,r){if(24<t)throw"Morton ranges are only supported up to Z=24";var i=1<<24-t,n=Mc(e*i,r*i);return[n,n+i*i-1]},Mc.reverse=Ic,Mc.decode=function(t,e){var r=Ic(e),i=1<<24-t;return[r[0]/i,r[1]/i]},Mc.min=function(t,e){var r=1431655765&t,i=1431655765&e,n=2863311530&t,o=2863311530&e;return Math.min(r,i)+Math.min(n,o)};var Lc=0,Nc=1,Oc=3,kc=4,Rc=5,Fc=1e-6,Dc=1e-12;function Pc(){for(var t=arguments,e=t.length-1,r=e,i=[],n=0;n<=e&&Math.abs(t[n])<=Dc;n++)e--;switch(e){case 1:!function(t,e,r){void 0===r&&(r=[]);0!==e&&r.push(-t/e)}(t[r],t[r-1],i);break;case 2:!function(t,e,r,i){void 0===i&&(i=[]);var n=e/r,o=n*n-t/r*4;if(0<o){var a=Math.sqrt(o);i.push(.5*(-n+a)),i.push(.5*(-n-a))}else 0==o&&i.push(.5*-n)}(t[r],t[r-1],t[r-2],i);break;case 3:!function(t,e,r,i,n){void 0===n&&(n=[]);var o,a,s=r/i,u=e/i,l=(3*u-s*s)/3,d=(2*s*s*s-9*u*s+t/i*27)/27,h=s/3,c=d*d/4+l*l*l/27,f=d/2;Math.abs(c)<=Fc&&(c=0);if(0<c){var g=Math.sqrt(c);a=0<=(o=-f+g)?Math.pow(o,1/3):-Math.pow(-o,1/3),0<=(o=-f-g)?a+=Math.pow(o,1/3):a-=Math.pow(-o,1/3),n.push(a-h)}else if(c<0){var distance=Math.sqrt(-l/3),p=Math.atan2(Math.sqrt(-c),-f)/3,_=Math.cos(p),v=Math.sin(p),m=Math.sqrt(3);n.push(2*distance*_-h),n.push(-distance*(_+m*v)-h),n.push(-distance*(_-m*v)-h)}else o=0<=f?-Math.pow(f,1/3):Math.pow(-f,1/3),n.push(2*o-h),n.push(-o-h)}(t[r],t[r-1],t[r-2],t[r-3],i)}return i}function zc(t,e,r,i,n,o,a,s,u,l,d){var h,c,f=Math.min(a,u),g=Math.min(s,l),p=Math.max(a,u),_=Math.max(s,l);for(var v=Pc((h=s-l)*(t+-2*r+n)+(c=u-a)*(e+-2*i+o),h*(-2*t+2*r)+c*(-2*e+2*i),h*t+c*e+(a*l-u*s)),m=0;m<v.length;m++){var y=v[m];if(0<=y&&y<=1){var b=t+(r-t)*y,x=e+(i-e)*y,E=b+(r+(n-r)*y-b)*y,A=x+(i+(o-i)*y-x)*y;if(a===u){if(g<=A&&A<=_){if(!d)return 1;d.push(E,A)}}else if(s===l){if(f<=E&&E<=p){if(!d)return 1;d.push(E,A)}}else if(f<=E&&g<=A&&E<=p&&A<=_){if(!d)return 1;d.push(E,A)}}}return d&&d.length/2}function Bc(t,e,r,i,n,o,a,s,u,l,d,h,c){var f,g,p=Math.min(u,d),_=Math.min(l,h),v=Math.max(u,d),m=Math.max(l,h);for(var y=Pc((f=l-h)*(-1*t+3*r+-3*n+a)+(g=d-u)*(-1*e+3*i+-3*o+s),f*(3*t+-6*r+3*n)+g*(3*e+-6*i+3*o),f*(-3*t+3*r)+g*(-3*e+3*i),f*t+g*e+(u*h-d*l)),b=0;b<y.length;b++){var x=y[b];if(0<=x&&x<=1){var E=t+(r-t)*x,A=e+(i-e)*x,S=r+(n-r)*x,w=i+(o-i)*x,T=E+(S-E)*x,C=A+(w-A)*x,M=T+(S+(n+(a-n)*x-S)*x-T)*x,I=C+(w+(o+(s-o)*x-w)*x-C)*x;if(u===d){if(_<=I&&I<=m){if(!c)return 1;c.push(M,I)}}else if(l===h){if(p<=M&&M<=v){if(!c)return 1;c.push(M,I)}}else if(p<=M&&_<=I&&M<=v&&I<=m){if(!c)return 1;c.push(M,I)}}}return c&&c.length/2}var Uc=function(t,e,r,i,n,o,a,s,u,l,d){return d?(zc(t,e,r,i,n,o,a,s,u,s,d),zc(t,e,r,i,n,o,u,s,u,l,d),zc(t,e,r,i,n,o,a,l,u,l,d),zc(t,e,r,i,n,o,a,s,a,l,d),d.length/2):a<=t&&t<=u&&s<=e&&e<=l||a<=n&&n<=u&&s<=o&&o<=l||zc(t,e,r,i,n,o,a,s,u,s)||zc(t,e,r,i,n,o,u,s,u,l)||zc(t,e,r,i,n,o,a,l,u,l)||zc(t,e,r,i,n,o,a,s,a,l)?1:0},Vc=function(t,e,r,i,n,o,a,s,u,l,d,h,c){return c?(Bc(t,e,r,i,n,o,a,s,u,l,d,l,c),Bc(t,e,r,i,n,o,a,s,d,l,d,h,c),Bc(t,e,r,i,n,o,a,s,u,h,d,h,c),Bc(t,e,r,i,n,o,a,s,u,l,u,h,c),c.length/2):u<=t&&t<=d&&l<=e&&e<=h||u<=a&&a<=d&&l<=s&&s<=h||Bc(t,e,r,i,n,o,a,s,u,l,d,l)||Bc(t,e,r,i,n,o,a,s,d,l,d,h)||Bc(t,e,r,i,n,o,a,s,u,h,d,h)||Bc(t,e,r,i,n,o,a,s,u,l,u,h)?1:0};function jc(t,e,r){return Math.min(Math.max(e,t),r)}function Gc(t,e,r,i,n,o,a,s){var u=((a-n)*(e-o)-(s-o)*(t-n))/((s-o)*(r-t)-(a-n)*(i-e)),l=((r-t)*(e-o)-(i-e)*(t-n))/((s-o)*(r-t)-(a-n)*(i-e));return 0<=u&&u<=1&&0<=l&&l<=1}function Hc(t,e,r,i,n){var o,a,s,u,l,d,h,c,f,g,p,_,v,m,y,b,x,E=t.type,A=t.coordinates;return E===Rc?(p=A[0],_=A[1],v=A[2],m=r,y=n,b=p-jc(p,e,i),x=_-jc(_,m,y),b*b+x*x<v*v):E===Nc?(s=A[0],u=A[1],l=A[2],d=A[3],c=r,f=i,g=n,(h=e)<=s&&c<=u&&s<=f&&u<=g||h<=l&&c<=d&&l<=f&&d<=g||Gc(s,u,l,d,h,c,h,g)||Gc(s,u,l,d,f,c,f,g)||Gc(s,u,l,d,h,c,f,c)||Gc(s,u,l,d,h,g,f,g)):E===Oc?Uc(A[0],A[1],A[2],A[3],A[4],A[5],e,r,i,n):E===kc?Vc(A[0],A[1],A[2],A[3],A[4],A[5],A[6],A[7],e,r,i,n):(a=[e,r,i,n],(o=A)[3]>a[1]&&o[1]<a[3]&&o[2]>a[0]&&o[0]<a[2])}function qc(t,e,r,i,n){for(var o,a=Math.abs(r-t),s=t<r?1:-1,u=-Math.abs(i-e),l=e<i?1:-1,d=a+u;;){if(n(t,e),u<=(o=2*d)){if(t===r)break;d+=u,t+=s}if(o<=a){if(e===i)break;d+=a,e+=l}}}function Wc(t,e){if(void 0===e&&(e="assert error"),!t)throw new Error(e)}function Xc(t,e,r,i,n,o,a){var s,u,l,d,h,c=n-r,f=o-i,g=t-r,p=e-i,_=g*f-p*c;if(g*g+p*p<c*c+f*f&&(n=t,t=c+r,o=e,e=f+i,_=-_),0!=_){g+=c,p+=f,s=2*(g*=c=t<n?1:-1)*(p*=f=e<o?1:-1),g*=g,p*=p,_*c*f<0&&(g=-g,p=-p,s=-s,_=-_),u=4*f*(r-t)*_+g-s,l=4*c*(e-i)*_+p-s,g+=g,p+=p,d=u+l+s;do{if(_=Math.min(u+s,-s-l),h=Math.max(u+s,-s-l),h+=2*h*_*_/(4*h*h+_*_),a(t,e,255*Math.abs(d-u-l-s)/h),t==n||e==o)break;r=t,_=u-d,i=2*d+l<0,0<2*d+u&&(d-l<h&&a(t,e+f,255*Math.abs(d-l)/h),t+=c,u-=s,d+=l+=p),i&&(_<h&&a(r+c,e,255*Math.abs(_)/h),e+=f,l-=s,d+=u+=g)}while(l<u)}!function(t,e,r,i,n){var o,a=t<r?1:-1,s=e<i?1:-1,u=Math.abs(r-t),l=Math.abs(i-e),d=u*u+l*l,h=0==d?1:16777087/Math.sqrt(d);for(d=(u*=h)-(l*=h);;){if(n(t,e,Math.abs(d-u+l)>>16),o=t,-u<=2*(h=d)){if(t==r)break;h+l<16711680&&n(t,e+s,h+l>>16),d-=l,t+=a}if(2*h<=l){if(e==i)break;u-h<16711680&&n(o+a,e,u-h>>16),d+=u,e+=s}}}(t,e,n,o,a)}function Yc(t,e,r,i,n,o,a,s,u){var l,d,h,c,f,g,p,_,v,m,y,b,x,E,A=1,S=t<a?1:-1,w=e<s?1:-1,T=-Math.abs(t+r-n-a),C=T-4*S*(r-n),M=S*(t-r-n+a),I=-Math.abs(e+i-o-s),L=I-4*w*(i-o),N=w*(e-i-o+s);if(Wc((r-t)*(n-a)<.01&&((a-t)*(r-n)<.01||M*M<C*T+.01),"slope change"),Wc((i-e)*(o-s)<.01&&((s-e)*(i-o)<.01||N*N<L*I+.01),"slope change"),0==C&&0==L)return function(t,e,r,i,n,o,a){var s,u,l,d,h=n-r,c=o-i,f=t-r,g=e-i,p=f*c-g*h;if(Wc(f*h<=0&&g*c<=0,"sign of gradient must not change"),f*f+g*g<h*h+c*c&&(n=t,t=h+r,o=e,e=c+i,p=-p),0!=p){f+=h,g+=c,s=2*(f*=h=t<n?1:-1)*(g*=c=e<o?1:-1),f*=f,g*=g,p*h*c<0&&(f=-f,g=-g,s=-s,p=-p),u=4*c*p*(r-t)+f-s,l=4*h*p*(e-i)+g-s,f+=f,g+=g,d=u+l+s;do{if(a(t,e),t==n&&e==o)return;i=2*d<u,l<2*d&&(t+=h,u-=s,d+=l+=g),i&&(e+=c,l-=s,d+=u+=f)}while(l<0&&0<u)}qc(t,e,n,o,a)}(t,e,S=Math.floor((3*r-t+1)/2),w=Math.floor((3*i-e+1)/2),a,s,u);r=(r-t)*(r-t)+(i-e)*(i-e)+1,n=(n-a)*(n-a)+(o-s)*(o-s)+1;do{c=C*N-M*L,y=27*(8*(c*=l=0<(x=c*(c+(f=C*I-T*L)-3*(g=M*I-T*N))+f*f)?1:Math.sqrt(1+1024/r))*(N*N-L*I)+(x*=l*l)*(L+2*N+I))/64-L*L*((v=9*(c+(f*=l)+(g*=l))/8)-L),b=27*(8*c*(M*M-C*T)-x*(C+2*M+T))/64-C*C*(v+C),_=3*(3*c*(3*N*N-L*L-2*L*I)-L*(3*f*(L+N)+L*(p=8*(C-L))))/4,m=3*(3*c*(3*M*M-C*C-2*C*T)-C*(3*f*(C+M)+C*p))/4,v=3*((v=C*L*(6*c+6*f-3*g+p))+9*l*((p=C*C)*N*I-M*T*(f=L*L))-18*M*N*c)/8,x<0&&(y=-y,b=-b,_=-_,m=-m,v=-v,f=-f,p=-p),c=6*L*f,f*=-6*C,g=6*L*p,p*=-6*C,x=(y+=v)+b,b+=v;t:for(E=v,d=h=l;t!=a&&e!=s;){u(t,e);do{if(E<y||b<E)break t;i=2*x-b,y<=2*x&&(d--,x+=y+=_,b+=v+=f,m+=g,_+=c),i<=0&&(h--,x+=b+=m,y+=v+=g,_+=f,m+=p)}while(0<d&&0<h);2*d<=l&&(t+=S,d+=l),2*h<=l&&(e+=w,h+=l),E==v&&y<0&&0<b&&(E=.01)}_=t,t=a,a=_,S=-S,M=-M,m=e,e=s,s=m,w=-w,N=-N,r=n}while(A--);qc(t,e,a,s,u)}function Zc(t,e,r,i,n,o,a,s,u){!function(t,e,r,i,n,o,a,s,u,l){var d,h,c,f,g,p,_,v=0,m=0,y=t+r-n-a,b=y-4*(r-n),x=t-r-n+a,E=x+4*(r+n),A=e+i-o-s,S=A-4*(i-o),w=e-i-o+s,T=w+4*(i+o),C=t,M=e,I=x*x-b*y,L=[0,0,0,0,0];for(0==b?Math.abs(y)<2*Math.abs(x)&&(L[v++]=y/(2*x)):0<I&&(I=(x-(_=Math.sqrt(I)))/b,Math.abs(I)<1&&(L[v++]=I),I=(x+_)/b,Math.abs(I)<1&&(L[v++]=I)),I=w*w-S*A,0==S?Math.abs(A)<2*Math.abs(w)&&(L[v++]=A/(2*w)):0<I&&(I=(w-(_=Math.sqrt(I)))/S,Math.abs(I)<1&&(L[v++]=I),I=(w+_)/S,Math.abs(I)<1&&(L[v++]=I)),m=1;m<v;m++)(I=L[m-1])>L[m]&&(L[m-1]=L[m],L[m]=I,m=0);for(I=-1,L[v]=1,m=0;m<=v;m++)d=(I*(I*x-2*y)-(_=L[m])*(I*(I*b-2*x)+y)+E)/8-C,f=(I*(I*w-2*A)-_*(I*(I*S-2*w)+A)+T)/8-M,h=(_*(_*x-2*y)-I*(_*(_*b-2*x)+y)+E)/8-C,g=(_*(_*w-2*A)-I*(_*(_*S-2*w)+A)+T)/8-M,C-=c=(_*(_*(3*x-_*b)-3*y)+E)/8,M-=p=(_*(_*(3*w-_*S)-3*A)+T)/8,a=Math.floor(.5+c),s=Math.floor(.5+p),0!=C&&(d*=C=(t-a)/C,h*=C),0!=M&&(f*=M=(e-s)/M,g*=M),t==a&&e==s||u(t,e,t+d,e+f,t+h,e+g,a,s,l),t=a,e=s,C=c,M=p,I=_}(t,e,r,i,n,o,a,s,Yc,u)}var Kc,Qc,Jc,$c=Mc;function tf(t,e,r){var i=1<<r;return[t=~~((t+Jc)/Qc*i),e=~~((e+Jc)/Qc*i)]}function ef(t,e,r){var i=1<<r;return[t=(t+Jc)/Qc*i,e=(e+Jc)/Qc*i]}function rf(t,e,r,i,n,o){for(var a=tf(t,e,n),s=tf(r,i,n),u=a[0];u<=s[0];u++)for(var l=a[1];l<=s[1];l++)o.push($c(u,l))}function nf(t,e,r){var i,n,o,a,s,u,l,d,h,c,f,g=tf(t[0],t[1],e),p=g[0],_=g[1],v=tf(t[2],t[3],e),m=v[0],y=v[1],b=tf(t[4],t[5],e),x=b[0],E=b[1];u=E,l=function(t,e){r.push($c(t,e))},c=(n=_)-(a=y),f=(i=p)-2*(o=m)+(s=x),0<(h=i-o)*(s-o)&&(0<c*(u-a)&&Math.abs((n-2*a+u)/f*h)>Math.abs(c)&&(i=s,s=h+o,n=u,u=c+a),d=(1-(f=(i-o)/f))*((1-f)*n+2*f*a)+f*f*u,f=(i*s-o*o)*f/(i-o),h=Math.floor(f+.5),c=Math.floor(d+.5),d=(a-n)*(f-i)/(o-i)+n,Xc(i,n,h,Math.floor(d+.5),h,c,l),d=(a-u)*(f-s)/(o-s)+u,i=o=h,n=c,a=Math.floor(d+.5)),0<(n-a)*(u-a)&&(d=(1-(f=(n-a)/(f=n-2*a+u)))*((1-f)*i+2*f*o)+f*f*s,f=(n*u-a*a)*f/(n-a),h=Math.floor(d+.5),c=Math.floor(f+.5),d=(o-i)*(f-n)/(a-n)+i,Xc(i,n,Math.floor(d+.5),c,h,c,l),d=(o-s)*(f-u)/(a-u)+s,i=h,o=Math.floor(d+.5),n=a=c),Xc(i,n,o,a,s,u,l)}Qc=1<<(Kc=14),Jc=1<<Kc-1;var of=[[0,0],[0,0]];function af(t,e){var r,i,n,o,a,s,u,l,d,h,c,f,g,p=t.type,_=t.coordinates,v=[];switch(p){case Nc:of[0][0]=_[0],of[0][1]=_[1],of[1][0]=_[2],of[1][1]=_[3],function(t,e,r,i){for(var n,o,a=0;a<t.length-1;a++){var s=ef(t[a][0],t[a][1],e),u=ef(t[a+1][0],t[a+1][1],e),l=s[0],d=s[1],h=u[0]-l,c=u[1]-d;if(0!=c||0!=h){var f=0<h?1:-1,g=0<c?1:-1,p=Math.floor(l),_=Math.floor(d),v=0==h?1/0:Math.abs(((0<h?1:0)+p-l)/h),m=0==c?1/0:Math.abs(((0<c?1:0)+_-d)/c),y=Math.abs(f/h),b=Math.abs(g/c);for(p===n&&_===o||(i.push($c(p,_)),r&&_!==o&&r.push([p,_]),n=p,o=_);v<1||m<1;)v<m?(v+=y,p+=f):(m+=b,_+=g),i.push($c(p,_)),r&&_!==o&&r.push([p,_]),n=p,o=_}}r&&_===r[0][1]&&r.pop()}(of,e,void 0,v);break;case Lc:rf(_[0],_[1],_[2],_[3],e,v);break;case Rc:var m=_[0],y=_[1],b=_[2];rf(m-b,y-b,m+b,y+b,e,v);break;case Oc:nf(_,e,v);break;case kc:i=e,n=v,o=tf((r=_)[0],r[1],i),a=o[0],s=o[1],u=tf(r[2],r[3],i),l=u[0],d=u[1],h=tf(r[4],r[5],i),c=h[0],f=h[1],g=tf(r[6],r[7],i),Zc(a,s,l,d,c,f,g[0],g[1],function(t,e){n.push($c(t,e))})}return v}var sf=1,uf=3,lf=4,df=5,hf=2863311530,cf=4294967295,ff=31;function gf(t,e,r){for(var i=e,n=ff;0<=n;n--){var o=1<<n,a=((r&o)<<2|(t&o)<<1|e&o)>>n;if(a===sf){i=t&(~(hf>>>ff-n)&cf)|1<<n,e=(e|hf>>>ff-n&~(cf<<n)&cf)&~(1<<n)&cf}else{if(a===uf)return t;if(a===lf)return i;a===df&&(t=t&(~(hf>>>ff-n)&cf)|1<<n)}}return i}function pf(t,e,r){for(var i=ff;0<=i;i--){var n=1<<i,o=((r&n)<<2|(t&n)<<1|e&n)>>i;if(o===sf){e=(e|hf>>>ff-i&~(cf<<i)&cf)&~(1<<i)&cf}else{if(o===uf)return;if(o===lf)return;o===df&&(t=t&(~(hf>>>ff-i)&cf)|1<<i)}}return 1}function _f(t,e,r){for(var i=r+1,n=0,o=ff;0<=o;o--){var a=1<<o,s=(i&a)>>o,u=(t&a)>>o,l=(e&a)>>o,d=1&o,h=n&3<<2*d;if(0==h&&l<s&&u<=l){n|=2<<2*d;break}if(0==h&&s<u){n|=1<<2*d;break}}return 0===n?i:gf(t,e,r)}function vf(t,e){void 0===e&&(e=8),this.setLevel(e),this.setAccessor(t),this._tree=new vc(function(t,e){return t-e}),this._nodeToId=new mc(Uint32Array,1e3,16),this._idToNode=new mc(Uint32Array,16,8),this._size=0,this._checkedNodes=[],this._codeCache=[0,0]}var mf={intersectionChecks:{configurable:!0},level:{configurable:!0},size:{configurable:!0}};vf.prototype.setAccessor=function(t){return this._getGeometry=t,this},vf.prototype.load=function(t){for(var e=[],r=this._nodeToId,i=this._idToNode,n=this._level,o=this._getGeometry,a=0;a<t.length;a++){var s=t[a],u=af(o(s),n);i.addEntry(s);for(var l=0;l<u.length;l++){var d=u[l];r.has(d)||(r.addEntry(d),e.push(d)),r.addTo(d,s),i.addTo(s,d)}}return this._tree.load(e,[],!0),this._size+=t.length,this},vf.prototype.addToPage=function(){},vf.prototype.removeFromPage=function(){},vf.prototype.insert=function(t){var e=af(this._getGeometry(t),this._level),r=this._idToNode,i=this._nodeToId,n=this._tree;this._size++,r.addEntry(t);for(var o=0;o<e.length;o++){var a=e[o];i.has(a)||(n.insert(a),i.addEntry(a)),i.addTo(a,t),r.addTo(t,a)}},vf.prototype.remove=function(t){var e=this._idToNode.getItems(t),r=this._nodeToId,i=this._tree;if(e)for(var n=0;n<e.length;n++){var o=e[n];0===r.removeFromAndGetSize(o,t)&&i.remove(o)}return this._idToNode.removeEntry(t),this._size--,this},vf.prototype.update=function(t){return this.remove(t),this.insert(t),this},vf.prototype.forEach=function(t){return this._tree.forEach(t),this},vf.prototype.all=function(){var e=[];return this._tree.forEach(function(t){return e.push(t)}),e},vf.prototype.clear=function(){return this._tree.clear(),this._nodeToId.clear(),this._idToNode.clear(),this},vf.prototype.setLevel=function(t){return this._level=t,this},vf.prototype.traverse=function(t,e,r,i,n){for(var o=ef(e,r,this._level),a=o[0],s=o[1],u=ef(i,n,this._level),l=u[0],d=u[1],h=Mc(a,s),c=Mc(l,d),f=this._tree._root,g=[],p=h;0<g.length||f;)if(f)g.push(f),f=f.left;else{var _=(f=g.pop()).key;if(c<_)break;if(h<=_&&p<=_&&(p=_f(h,c,_),t(f)))return this;f=f.right}return this},vf.prototype.getKeys=function(t){for(var e=t[0],r=t[1],i=t[2],n=t[3],o=ef(e,r,this._level),a=o[0],s=o[1],u=ef(i,n,this._level),l=u[0],d=u[1],h=Mc(a,s),c=Mc(l,d),f=this._tree._root,g=[],p=h;0<g.length||f;)if(f)g.push(f),f=f.left;else{var _=(f=g.pop()).key;if(c<_)break;h<=_&&p<=_&&(p=_f(h,c,_)),f=f.right}return this},vf.prototype.traverseDescend=function(t,e,r,i,n){var o=ef(e,r,this._level),a=ef(i,n,this._level),s=Mc(o[0],o[1]),u=Mc(a[0],a[1]);return this._recurse(this._tree._root,s,u,s,u,t,e,r,i,n),this},vf.prototype.traverseRange=function(r,t,e,i,n){var o=this,a=ef(t,e,this._level),s=a[0],u=a[1],l=ef(i,n,this._level),d=l[0],h=l[1],c=Mc(s,u),f=Mc(d,h);return this._tree.range(c,f,function(t){var e=t.key;if(pf(c,f,e)&&r(t))return o}),this},vf.prototype._recurse=function(t,e,r,i,n,o){if(null!==t){var a=t.key;if(a<e)return this._recurse(t.right,e,r,i,n,o);if(r<a)return this._recurse(t.left,e,r,i,n,o);if(pf(i,n,a)){if(this._recurse(t.left,e,a,i,n,o),o(t))return;this._recurse(t.right,a,r,i,n,o)}else{var s=gf(i,n,a),u=function(t,e,r){for(var i=t,n=ff;0<=n;n--){var o=1<<n,a=((r&o)<<2|(t&o)<<1|e&o)>>n;if(a===sf){e=(e|hf>>>ff-n&~(cf<<n)&cf)&~(1<<n)&cf}else{if(a===uf)return i;if(a===lf)return e;a===df&&(i=(e|hf>>>ff-n&~(cf<<n)&cf)&~(1<<n)&cf,t=t&(~(hf>>>ff-n)&cf)|1<<n)}}return i}(i,n,a);this._recurse(t.left,e,u,i,n,o),this._recurse(t.right,s,r,i,n,o)}}},vf.prototype.query=function(t,e,r,i){var n=[],o=[];this.traverse(function(t){n.push(t)},t,e,r,i);for(var a={},s=this._getGeometry,u=this._intersectionChecks=0;u<n.length;u++)for(var l=n[u],d=this._nodeToId.getItems(l.key),h=0;h<d.length;h++){var c=d[h];if(!a[c]){var f=s(c);this._intersectionChecks++,Hc(f,t,e,r,i)&&o.push(c),a[c]=!0}}return this._checkedNodes=n,o},vf.prototype.getItems=function(t){return this._nodeToId.getItems(t)},mf.intersectionChecks.get=function(){return this._intersectionChecks},mf.level.get=function(){return this._level},mf.size.get=function(){return this._size},vf.prototype.keyToBBox=function(t){var e=Kc,r=Mc.reverse(t),i=r[0],n=r[1],o=1<<12-this._level+(e-12),a=1<<e-1;return[i*o-a,n*o-a,(i+1)*o-a,(n+1)*o-a]},Object.defineProperties(vf.prototype,mf),vf.MAX_ZOOM=12;var yf=function(t,e){return(yf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function bf(t,e){function r(){this.constructor=t}yf(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var xf="undefined"==typeof Map?function(){function t(){this._values={},this._size=0}var e={size:{configurable:!0}};return e.size.get=function(){return this._size},t.prototype.has=function(t){return!!this._values[t]},t.prototype.set=function(t,value){t in this._values||this._size++,this._values[t]=value},t.prototype.get=function(t){return this._values[t]},t.prototype.delete=function(t){t in this._values&&(delete this._values[t],this._size--)},t.prototype.keys=function(){return Object.keys(this._values)},t.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(t.prototype,e),t}():Map,Ef="undefined"==typeof Set?function(){function t(){this._values={},this._size=0}var e={size:{configurable:!0}};return e.size.get=function(){return this._size},t.prototype.has=function(t){return!!this._values[t]},t.prototype.add=function(t){t in this._values||this._size++,this._values[t]=!0},t.prototype.delete=function(t){t in this._values&&(delete this._values[t],this._size--)},t.prototype.keys=function(){return Object.keys(this._values)},t.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(t.prototype,e),t}():Set,Af=(Sf.prototype.setBoundsGetter=function(t){return this._getBounds=t,this},Sf.prototype.setIntersector=function(t){return this._intersects=t,this},Sf);function Sf(){this._intersects=null,this._getBounds=null}function wf(t,e,r){return r|Mc(t,e)<<4}function Tf(t,e){return Mc.reverse(t>>4,e),e[2]=t&Mf,e}var Cf,Mf=(1<<Math.log2(16))-1,If=(bf(Lf,Cf=Af),Lf.prototype.setMinCellSize=function(t){return this._minCellSize=t,this},Lf.prototype.setOffset=function(t){return this._offset=t,this._min=-t,this._max=t,this._resolution=65535/(this._max-this._min),this},Lf.prototype.insert=function(t,e,r,i,n){var o;void 0===e&&(e=(o=this._getBounds(t))[0],r=o[1],i=o[2],n=o[3]);var a,s=Math.max(i-e,n-r),u=this._minCellSize;for(a=0;u<s&&a<16;a++)u*=2;var l=this._resolution,d=this._min,h=l*(.5*(i+e)-d)/u|0,c=l*(.5*(n+r)-d)/u|0,f=wf(h,c,a);this._cells.has(f)||this._cells.addEntry(f),this._cells.addTo(f,t),this._objectsAtLevel[a]++,this._occupied|=1<<a;var g=4*a,p=this._bounds;return h<p[g]&&(p[g]=h),c<p[1+g]&&(p[1+g]=c),h>p[2+g]&&(p[2+g]=h),c>p[3+g]&&(p[3+g]=c),this._idToCode.set(t,f),f},Lf.prototype.has=function(t){return this._idToCode.has(t)},Lf.prototype.update=function(t,e,r,i,n){return this.remove(t),this.insert(t,e,r,i,n)},Lf.prototype.remove=function(t){var e=this._idToCode.get(t);Tf(e,this._codeCache);var r=this._codeCache[2];return 0==--this._objectsAtLevel[r]&&(this._occupied&=~(1<<r),this._bounds[4*r]=1/0,this._bounds[4*r+1]=1/0,this._bounds[4*r+2]=-1/0,this._bounds[4*r+3]=-1/0),this._cells.removeFrom(e,t),this._idToCode.delete(t),this},Lf.prototype.query=function(t,e,r,i){for(var n=this._cells,o=this._bounds,a=this._intersects,s=this._min,u=this._resolution,l=this._minCellSize,d=this._occupied,h=[],c=0;c<16&&0!==d;l*=2,d>>=1,c++)if(0!=(1&d))for(var f=1/l,g=4*c,p=Math.max(o[g],u*(t-s)*f-1>>0),_=Math.max(o[1+g],u*(e-s)*f-1>>0),v=Math.min(o[2+g],u*(r-s)*f+1>>0),m=Math.min(o[3+g],u*(i-s)*f+1>>0),y=p;y<=v;y++)for(var b=_;b<=m;b++){var x=wf(y,b,c),E=n.getItems(x);if(void 0!==E)for(var A=0;A<E.length;A++){var S=E[A];a(S,t,e,r,i)&&h.push(S)}}return h},Lf.prototype.collisions=function(t,e){if(void 0===e&&(e=this._getBounds),"function"!=typeof e)throw new Error("getBounds function is required to get the object bounds");for(var r=Array.from(this._idToCode.keys()),i=this._min,n=this._resolution,o=this._cells,a=new xf,s=[],u=0;u<r.length;u++){var l=0,d=this._minCellSize,h=this._occupied,c=r[u],f=e(c),g=f[0],p=f[1],_=f[2],v=f[3],m=Math.max(_-g,v-p);for(l=0;d<m;l++)d*=2,h>>=1;g=n*(g-i),p=n*(p-i),_=n*(_-i),v=n*(v-i);for(var y=l;y<16&&0!==h;d*=2,h>>=1,y++)if(0!=(1&h))for(var b=1/d,x=p*b-1>>0,E=_*b+1>>0,A=v*b+1>>0,S=g*b-1>>0;S<=E;S++)for(var w=x;w<=A;w++){var T=wf(S,w,y);if(a.get(T)!==u){a.set(T,u);var C=o.getItems(T);if(void 0!==C)for(var M=0;M<C.length;M++){var I=C[M];I!==c&&t(c,I)&&s.push(c,I)}}}}return function(t){for(var e=new Ef,r=[],i=0;i<t.length;i+=2){var n=t[i],o=t[i+1],a=n<o?n*o+(o-n-1)*(o-n-1)/4:n*o+(n-o-1)*(n-o-1)/4;e.has(a)||(e.add(a),r.push(n,o))}return r}(s)},Lf.prototype.clear=function(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(16).fill(0),this._bounds=new Array(64);for(var t=0;t<16;t++)this._bounds[4*t]=1/0,this._bounds[4*t+1]=1/0,this._bounds[4*t+2]=-1/0,this._bounds[4*t+3]=-1/0;return this},Lf.prototype.keyToBBox=function(t){var e=Tf(t,[0,0,0]),r=e[0],i=e[1],n=e[2],o=this._minCellSize*(1<<n),a=this._min,s=this._resolution;return[r*o/s+a,i*o/s+a,(r+1)*o/s+a,(i+1)*o/s+a]},Lf.prototype.keys=function(){return Object.keys(this._cells._idToIndex)},Object.defineProperty(Lf.prototype,"averageCellOccupancy",{get:function(){return this._cells.averageSize},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"size",{get:function(){return this._idToCode.size},enumerable:!1,configurable:!0}),Lf.prototype.getBoxes=function(){var e=this;return Array.from(this._idToCode.keys()).map(function(t){return e._getBounds(t)})},Lf.code=wf,Lf.decode=Tf,Lf);function Lf(t,e,r,i,n){void 0===r&&(r=16),void 0===i&&(i=65536),void 0===n&&(n=Int32Array);var o=Cf.call(this)||this;o._occupied=0,o._objectsAtLevel=new Array(16).fill(0),o._idToCode=new xf,o._codeCache=[0,0,0],o._intersects=t,o._getBounds=e,o._cells=new mc(n),o._offset=i,o._min=-i,o._max=i,o._resolution=65535/(o._max-o._min),o._minCellSize=r*o._resolution,o._bounds=new Array(64);for(var a=0;a<16;a++)o._bounds[4*a]=1/0,o._bounds[4*a+1]=1/0,o._bounds[4*a+2]=-1/0,o._bounds[4*a+3]=-1/0;return o}function Nf(t,e,r,i,n,o,a,s){return n<t&&t<a&&o<e&&e<s||n<r&&r<a&&o<i&&i<s}function Of(t,e,r,i,n,o,a,s){return o<=i&&e<=s&&n<=r&&t<=a}function kf(t,e,r,i,n,o){return{minX:t,minY:e,maxX:r,maxY:i,leaf:!0,level:o,parent:n,objects:[],final:!1,children:[]}}function Rf(t){return[t.minX,t.minY,t.maxX,t.maxY]}function Ff(t,e,r,i,n,o,a,s){var u=(t+r)/2,l=(e+i)/2;return n<=u&&u<=a&&o<=l&&l<=s}var Df=0,Pf=1,zf=2,Bf=3;function Uf(t,e,r,i,n,o,a,s){var u=(o+s)/2,l=(e+i)/2;return(t+r)/2<=(n+a)/2?l<=u?Df:Pf:l<=u?Bf:zf}function Vf(t){return t}var jf,Gf=(bf(Hf,jf=Af),Object.defineProperty(Hf.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"root",{get:function(){return this._root},enumerable:!1,configurable:!0}),Hf.prototype.clear=function(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this},Hf.prototype.insert=function(t,e,r,i,n,o){var a;if(void 0===o&&(o=this._root),e||(e=(a=this._getBounds(t))[0],r=a[1],i=a[2],n=a[3]),!this._objects[t]){if(this._objects[t]=!0,this._size++,!this._root){var s=Math.max(Math.abs(i-e),Math.abs(n-r));return this._root=kf(e,r,e+s,r+s,null,this._rootLevel),this._root.objects=[t],t}for(var u,l,d=[o],h=!1,c=this._nodeCapacity,f=this._idToCell,g=this._maxLevel;l=d.pop();)Of(e,r,i,n,y=(u=l).minX,b=u.minY,x=u.maxX,E=u.maxY)&&(u.leaf?u.objects&&(u.objects.length<c||u.final)?(u.objects.push(t),f[t]?f[t].push(u):f[t]=[u],h=!0,(u.level>=g||Math.abs(x-y)<=Math.abs(i-e)||Math.abs(E-b)<=Math.abs(n-r))&&(u.final=!0)):(this.splitNode(u),d.push(u)):d.push.apply(d,u.children));if(h)return t;if(!Ff(e,r,i,n,(o=this._root).minX,o.minY,o.maxX,o.maxY)){var p,_=this._rootLevel,v=(e+i)/2,m=(r+n)/2;for(p=this._root?this._root:{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0};!Ff(e,r,i,n,this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){var y,b,x,E,A=y=(p=this._root).minX,S=b=p.minY,w=x=p.maxX,T=E=p.maxY,C=Math.abs(x-y),M=Math.abs(E-b);if(0===M&&0===C)break;var I=Math.max(C,M);v<=y&&(A-=I),m<=b&&(S-=I),y<v&&(w+=I),b<m&&(T+=I);var L=kf(A,S,w,T,null,--_);this.splitNode(L),L.children[Uf(y,b,x,E,A,S,w,T)]=p,this._root=p.parent=L}for(d=[this._root],this._root.level=this._rootLevel;l=d.shift();)if(!(u=l).leaf)for(var N=0;N<4;N++){var O=u.children[N];O.level=u.level+1,d.push(O)}}return(u=(o=this._root).children[Uf(e,r,i,n,o.minX,o.minY,o.maxX,o.maxY)]).leaf&&u.objects&&(u.objects.push(t),f[t]?f[t].push(u):f[t]=[u]),t}},Hf.prototype.removeById=function(t){if(!this._objects[t])return t;this._size--;for(var e=this._idToCell[t],r=0;r<e.length;r++)for(var i=e[r].objects||[],n=0,o=i.length;n<o;n++)if(i[n]===t){i.splice(n,1);break}return delete this._objects[t],delete this._idToCell[t],t},Hf.prototype.remove=function(t){for(var e,r,i=this._getBounds(t),n=i[0],o=i[1],a=i[2],s=i[3],u=[this._root],l=[];e=u.pop();)if(Of(n,o,a,s,e.minX,e.minY,e.maxX,e.maxY))if(e.leaf){for(var d=e.objects||[],h=0,c=d.length;h<c;h++)if(d[h]===t){d.splice(h,1),1===c&&l.push(e);break}}else u.push.apply(u,e.children);if(delete this._idToCell[t],delete this._objects[t],this._size--,l.length)for(;r=l.pop();)for(var f=r.parent,g=!0;f&&g;){if(!f.leaf){for(h=0;h<4;h++)if(!(e=f.children[h]).leaf||e.objects&&0!==e.objects.length){g=!1;break}g&&(f.leaf=!0,f.children=[],f.objects=[])}f=f.parent}return t},Hf.prototype.splitNode=function(t){var e=t.minX,r=t.minY,i=t.maxX,n=t.maxY,o=(e+i)/2,a=(r+n)/2,s=t.level+1,u=this._idToCell,l=this._maxLevel,d=[kf(e,r,o,a,t,s),kf(e,a,o,n,t,s),kf(o,a,i,n,t,s),kf(o,r,i,a,t,s)];if(null!==t.objects)for(var h=t.objects,c=this._getBounds,f=0,g=h.length;f<g;f++){for(var p=h[f],_=c(p),v=u[p],m=0;m<4;m++){var y=d[m],b=y.minX,x=y.minY,E=y.maxX,A=y.maxY;Of(_[0],_[1],_[2],_[3],b,x,E,A)&&(y.objects&&y.objects.push(p),(y.level>=l||Math.abs(E-b)<=Math.abs(_[2]-_[0])||Math.abs(A-x)<=Math.abs(_[3]-_[1]))&&(y.final=!0),v?v.push(y):v=[y])}v.splice(v.indexOf(t),1)}t.children=d,t.objects=null,t.leaf=!1},Hf.prototype.point=function(t,e,r){for(var i,n,o,a=[],s=[this._root],u=this._getBounds;i=s.pop();)if(t>=i.minX&&t<=i.maxX&&e>=i.minY&&e<=i.maxY){if(i.leaf){r&&i.objects&&(a=i.objects);for(var l=i.objects||[],d=0,h=l.length;d<h;d++)t>=(n=u(o=l[d]))[0]&&t<=n[2]&&e>=n[1]&&e<=n[3]&&a.push(o);break}s.push.apply(s,i.children)}return a.length?a:null},Hf.prototype.neigbours=function(t,e){for(var r,i=[],n=[this._root];r=n.pop();)if(t>=r.minX&&t<=r.maxX&&e>=r.minY&&e<=r.maxY){if(r.leaf){i=r.objects;break}n.push.apply(n,r.children)}return i},Hf.prototype.query=function(t,e,r,i){for(var n,o,a,s=[],u=[this._root],l=this._getBounds,d={},h=this._intersects;n=u.pop();)if(Of(t,e,r,i,n.minX,n.minY,n.maxX,n.maxY))if(n.leaf)for(var c=n.objects||[],f=0,g=c.length;f<g;f++)d[a=c[f]]||(Of(t,e,r,i,(o=l(a))[0],o[1],o[2],o[3])&&(h&&!h(a,t,e,r,i)||s.push(a)),d[a]=!0);else u.push.apply(u,n.children);return s},Hf.prototype.getOverlaps=function(){for(var t,e,r,i=[this._root],n=[],o=this._getBounds,a={};t=i.pop();)if(t.leaf){for(var s=t.objects||[],u=s.length,l=0;l<u;l++)for(var d=0;d<u;d++)if(e=s[l],r=s[d],l!==d&&!a[e+":"+r]&&!a[r+":"+e]){a[e+":"+r]=!0;var h=o(e),c=o(r);Of(h[0],h[1],h[2],h[3],c[0],c[1],c[2],c[3])&&n.push(e,r)}}else i.push.apply(i,t.children);return n},Hf.prototype.getAll=function(){return Object.keys(this._objects).map(function(t){return Number(t)})},Hf.prototype.forEach=function(t,e){for(var r,i=[this._root];r=i.pop();)if(r.leaf&&r.objects)for(var n=0,o=r.objects.length;n<o;n++)t.call(e,r.objects[n]);else i.push.apply(i,r.children);return this},Hf.prototype.getLeafs=function(){for(var t,e=[this._root],r=[];t=e.pop();)t.leaf?r.push(t):e.push.apply(e,t.children);return r},Hf.prototype.traverse=function(t,e){for(var r,i=[this._root];r=i.pop();)t.call(e,r,r.objects)||r.leaf||i.push.apply(i,r.children);return this},Hf.prototype.update=function(t,e,r,i,n){return this.remove(t),this.insert(t,e,r,i,n),this},Hf.prototype.getNodeBounds=function(t){return Rf(t)},Hf.flatAccessor=function(r,i){return function(t){var e=i*t;return r.slice(e,e+i)}},Hf.inside=Ff,Hf.intersects=Nf,Hf.overlaps=Of,Hf.getNodeBBox=Rf,Hf);function Hf(t,e,r,i){void 0===t&&(t=Vf),void 0===e&&(e=10),void 0===i&&(i=0);var n=jf.call(this)||this;return n._nodeCapacity=10,n._root=null,n._objects={},n._size=0,n._rootLevel=0,n._maxLevel=30,n._idToCell={},n._nodeCapacity=e,n._root=null,n._getBounds=t,n._rootLevel=i,n._maxLevel=i+30,n._idToCell={},r&&(n._root=kf(r[0],r[1],r[2],r[3],null,i)),n}var qf=function(){return{x:0,y:0,x1:0,y1:0,x2:0,y2:0}};function Wf(i,t,e,r,n,o){function a(t,e){return{x:(t-y)*_,y:(e-x)*_}}var s=void 0===o?{}:o,u=s.cells,l=void 0===u||u,d=s.boxes,h=void 0===d||d,c=s.query,f=void 0===c||c,g=St(),p=-e.getAngle(),_=e.getZoom()*g,v=e.getView(),m=v.x,y=void 0===m?0:m,b=v.y,x=void 0===b?0:b,E=v.width,A=void 0===E?0:E,S=v.height,w=A*g/2,T=(void 0===S?0:S)*g/2,C=r.keys().map(function(t){return r.keyToBBox(Number(t))}),M=r.getBoxes();if(i.clearRect(0,0,t.width,t.height),i.save(),i.translate(w,T),i.rotate(p),l&&(i.beginPath(),i.lineWidth=1,i.strokeStyle="#707070",C.forEach(function(t){var e=a(t[0],t[1]),r=a(t[2],t[3]);i.rect(e.x,e.y,r.x-e.x,r.y-e.y)}),i.stroke()),h&&(i.beginPath(),i.lineWidth=1,i.strokeStyle="#ff7070",M.forEach(function(t){var e=a(t[0],t[1]),r=a(t[2],t[3]);i.rect(e.x,e.y,r.x-e.x,r.y-e.y)}),i.closePath(),i.stroke()),f&&n){var I=n;i.beginPath(),i.lineWidth=2,i.strokeStyle="#3030ff";var L=a(I[0],I[1]),N=a(I[2],I[3]);i.rect(L.x,L.y,N.x-L.x,N.y-L.y),i.closePath(),i.stroke()}i.restore()}var Xf,Yf=["x","y","radius"],Zf=["width","curvature"],Kf=(b(Qf,Xf=Ee),Qf.prototype._getIntersector=function(){var t=this._graph,e=t.getNodeAttributes(["x","y","radius"]),f=e[0],g=e[1],p=e[2],r=t.getEdgeAttributes(["source","target","width","curvature"]),_=r[0],v=r[1],m=r[2],y=r[3],b=qf();return function(t,e,r,i,n){if(t<0){t=-t;var o=_.get(t),a=v.get(t),s=y.get(t),u=m.get(t)/2,l=f.get(o),d=g.get(o),h=f.get(a),c=g.get(a);return o===a?(vs(l,d,s,p.get(o),0,b),Tu(l,d,b.x1,b.y1,b.x2,b.y2,h,c,e-u,r-u,i+u,n+u)):0===s?_u(l,d,h,c,e-u,r-u,i+u,n+u):(_s(l,d,h,c,s,b),Su(l,d,b.x,b.y,h,c,e-u,r-u,i+u,n+u))}return xd(f.get(t),g.get(t),p.get(t),e,r,i,n)}},Qf.prototype.reindex=function(){this._graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._graph.getNodes("all")._indexes,this._graph.getEdges("all")._indexes)},Qf.prototype.getSize=function(){return this._index.size},Qf.prototype._updateIndex=function(){if(!this._elementsToUpdate.isEmpty()){var t=this._elementsToUpdate.getElements(),e=t.nodes,r=t.edges;this._updateItems(e._indexes,r._indexes),this._elementsToUpdate.clear()}},Qf.prototype._updateItems=function(t,e){var r=this._index,i=this._removedNodes,n=this._removedEdges,o=this._excludedNodes,a=this._excludedEdges,s=[],u=[];if(i&&o)for(var l=0;l<t.length;l++){var d=t[l];0!==i.get(d)||0!==o.get(d)?s.push(d):(r.has(d)&&s.push(d),u.push(d))}if(n&&a)for(l=0;l<e.length;l++)d=-e[l],0!==n.get(-d)||0!==a.get(-d)?s.push(d):(r.has(d)&&s.push(d),u.push(d));for(var h=0,c=s;h<c.length;h++)d=c[h],r.remove(d);for(var f=0,g=u;f<g.length;f++)d=g[f],r.insert(d)},Qf.prototype.getNodesInScreenByDistance=function(e){var t=e.getPositionOnScreen(),n=t.x,o=t.y;return this._graph.getNodes().filter(function(t){return t.isInScreen()&&t!==e}).sort(function(t,e){var r=t.getPositionOnScreen(),i=e.getPositionOnScreen();return distance(r.x,r.y,n,o)-distance(i.x,i.y,n,o)})},Qf.prototype.getNearestNodesForNode=function(t,e,r){void 0===e&&(e=240);var i=t.getPosition(),n=i.x,o=i.y;return this.getNearestNodes(n,o,e,r,t)},Qf.prototype.getNearestNodes=function(t,e,r,i,n){if(this._updateIndex(),i){var o=this._camera.screenToGraphVector({x:r,y:r});r=distance(0,0,o.x,o.y)}return this._getNearestNodes(t,e,r,n)},Qf.prototype._getNearestNodes=function(t,e,r,i){for(var n=[],o=r*r,a=i?i._index:0,s=this._graph.getNodes()._indexes,u=this._graph.getNodeAttributes(["x","y"]),l=u[0],d=u[1],h=0,c=s.length;h<c;h++){var f=s[h];if(f!==a){var g=t-l.get(f),p=e-d.get(f);g*g+p*p<=o&&n.push(f)}}return this._graph.nodeList(new Uint32Array(n))},Qf.prototype.queryRaw=function(t,e,r,i){this._updateIndex();var n=this._queryBounds;n[0]=t,n[1]=e,n[2]=r,n[3]=i;var o=this._index.query(t,e,r,i),a=this._queryResult,s=a.nodes,u=a.edges;s.length=u.length=0;for(var l=0;l<o.length;l++){var d=o[l];d<0?u.push(-d):s.push(d)}return this._queryResult},Qf.prototype.queryRawProjected=function(t,e,r,i){var n=this._queryBounds;return n[0]=t,n[1]=e,n[2]=r,n[3]=i,this._camera.projectBounds(n),this.queryRaw(n[0],n[1],n[2],n[3])},Qf.prototype.query=function(t,e,r,i){var n=this._graph,o=this.queryRaw(t,e,r,i),a=o.nodes,s=o.edges;return{nodes:n.nodeList(new Uint32Array(a.slice())),edges:n.edgeList(new Uint32Array(s.slice()))}},Qf.prototype.queryProjected=function(t,e,r,i){var n=this._graph,o=this.queryRawProjected(t,e,r,i),a=o.nodes,s=o.edges;return{nodes:n.nodeList(new Uint32Array(a.slice())),edges:n.edgeList(new Uint32Array(s.slice()))}},Qf.prototype.getNodesByBoundingBox=function(t,e,r,i,n){if(this._updateIndex(),n){var o=void 0;t=(o=this._camera.screenToGraphVector({x:t,y:e})).x,e=o.y,r=(o=this._camera.screenToGraphVector({x:r,y:i})).x,i=o.y}for(var a=this._graph,s=a.getNodes()._indexes,u=[],l=a.getNodeAttribute("excluded"),d=a.getNodeAttributes(["x","y"]),h=d[0],c=d[1],f=0,g=s.length;f<g;f++){var p=s[f];if(!l||!l.get(p)){var _=h&&h.get(p),v=c&&c.get(p);t<=_&&_<=r&&e<=v&&v<=i&&u.push(p)}}return a.nodeList(new Uint32Array(u))},Qf.prototype.toggleDebug=function(t){t?(this._canvas=En(),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d")):this._canvas&&(this._graphics.removeCanvas(this._canvas),this._canvas=this._ctx=null)},Qf.prototype.renderDebug=function(t){if(!this._canvas||!this._ctx)return this.toggleDebug(!0);Wf(this._ctx,this._canvas,this._camera,this._index,this._queryBounds,t)},Qf);function Qf(t){var e,r,i,h,c,f,n,g,p,_,v,m,o=t.graph,a=t.camera,s=t.graphics,u=t.events,l=Xf.call(this)||this;return l._minCellSize=8,l._clear=function(){l._index.clear(),l._elementsToUpdate.clear()},l._onGraphUpdate=function(t){if(t.nodes&&(!t.nodeAttributes||t.nodeAttributes.some(function(t){return Yf.includes(t)}))){var e=t.nodes.fastGetAdjacentElements().edges;l._elementsToUpdate.addElements(t.nodes),l._elementsToUpdate.addElements(e)}t.edges&&(t.edgeAttributes&&!t.edgeAttributes.some(function(t){return Zf.includes(t)})||l._elementsToUpdate.addElements(t.edges))},l._graph=o,l._camera=a,l._graphics=s,l._index=new If(l._getIntersector(),(r=l._graph,i=r.getNodeAttributes(["x","y","radius"]),h=i[0],c=i[1],f=i[2],n=r.getEdgeAttributes(["source","target","curvature"]),g=n[0],p=n[1],_=n[2],v=qf(),m=oa(),function(t){if(t<0){t=-t;var e=g.get(t),r=p.get(t),i=_.get(t),n=h.get(e),o=c.get(e),a=h.get(r),s=c.get(r);e===r?(vs(n,o,i,f.get(e),0,v),Ou(n,o,v.x1,v.y1,v.x2,v.y2,a,s,m)):0===i?(m.minX=Math.min(n,a),m.minY=Math.min(o,s),m.maxX=Math.max(n,a),m.maxY=Math.max(o,s)):(_s(n,o,a,s,i,v),Nu(n,o,v.x,v.y,a,s,m))}else{var u=h.get(t),l=c.get(t),d=f.get(t);m.minX=u-d,m.minY=l-d,m.maxX=u+d,m.maxY=l+d}return[m.minX,m.minY,m.maxX,m.maxY]}),l._minCellSize,1e6),l._elementsToUpdate=new ia(l._graph),l._removedNodes=o.getNodeAttribute("removed"),l._removedEdges=o.getEdgeAttribute("removed"),l._excludedNodes=o.getNodeAttribute("excluded"),l._excludedEdges=o.getEdgeAttribute("excluded"),l._queryResult={edges:[],nodes:[]},l._queryBounds=[0,0,0,0],u.on(((e={})[[be.ADD_NODES,be.ADD_EDGES,be.REMOVE_NODES,be.REMOVE_EDGES,be.UPDATE_ATTRIBUTES].join(" ")]=l._onGraphUpdate,e[be.EXCLUDED_STATE_CHANGE]=function(t){var e=t.elements;l._elementsToUpdate.addElements(e)},e[be.CLEAR_GRAPH]=l._clear,e)),l}var Jf,$f,tg,eg=(b(rg,Jf=Ee),rg.prototype.onMounted=function(){this.locateGraph({},!0)},rg.prototype.locateGraph=function(t,force){var e=this;return void 0===force&&(force=!1),force?this._locateGraph(t):this._transformations.whenApplied().then(function(){return e._locateGraph(t)})},rg.prototype._locateGraph=function(t){return this._locateBoundingBox(this.getGraphBoundingBox(),t)},rg.prototype.locateElements=function(t,e){var r=this;return this._transformations.whenApplied().then(function(){return r._locateBoundingBox(r.getBoundingBox(t),e)})},rg.prototype.locateRawGraph=function(t,e){return this._locateBoundingBox(this.getRawGraphBoundingBox(t),e)},rg.prototype.getGraphBoundingBox=function(){return this._cacheValid||this._updateCache(),Object.assign({},this._cachedGraphBoundingBox)},rg.prototype.forceInvalidCache=function(){this._invalidCache()},rg.prototype._updateCache=function(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._graph.getNodes())},rg.prototype.getBoundingBox=function(t,e){return t.isNode?this._getNodesBoundingBox(t.toList()):this._getEdgesBoundingBox(t.toList(),e)},rg.prototype._getNodesBoundingBox=function(t){this._graphics.forceAttributesComputation();for(var e=this._graphics.getNodeAttributes(),r=[],i=[],n=[],o=[],a=0;a<t.size;++a){var s=t._indexes[a];if(0===e.excluded.get(s)){var u=e.x.get(s),l=e.y.get(s),d=2*e.radius.get(s);"scaled"===e.scalingMethod.get(s)?n.push(d):o.push(d),r.push(u),i.push(l)}}return new aa({xValues:r,yValues:i,scaledSizeValues:n,fixedSizeValues:o})},rg.prototype._getEdgesBoundingBox=function(t,e){void 0===e&&(e=!1),this._graphics.forceAttributesComputation();for(var r=this._graphics.getEdgeAttributes(),i=this._graphics.getNodeAttributes(),n={x1:0,y1:0,x2:0,y2:0},o={x:0,y:0},a={minX:0,minY:0,maxX:0,maxY:0},s=[],u=[],l=[],d=[],h=0;h<t.size;++h){var c=t._indexes[h],f=r.source.get(c),g=r.target.get(c),p=r.curvature.get(c),_=i.x.get(f),v=i.y.get(f),m="scaled"===i.scalingMethod.get(f),y=2*i.radius.get(f),b=i.x.get(g),x=i.y.get(g),E="scaled"===i.scalingMethod.get(g),A=2*i.radius.get(g);m?l.push(y):d.push(y),E?l.push(A):d.push(A),e||0===p?(s.push(_,b),u.push(v,x)):(f===g?(vs(_,v,p,y/2,0,n),Ou(_,v,n.x1,n.y1,n.x2,n.y2,b,x,a)):(_s(_,v,b,x,p,o),Nu(_,v,o.x,o.y,b,x,a)),s.push(a.minX,a.maxX),u.push(a.minY,a.maxY))}return new aa({xValues:s,yValues:u,scaledSizeValues:l,fixedSizeValues:d})},rg.prototype.getRawGraphBoundingBox=function(t){for(var e=t.nodes.length,r=new Array(e),i=new Array(e),n=new Array(e),o=0;o<e;o++){var a=t.nodes[o].attributes||{};r[o]=a.x||0,i[o]=a.y||0,n[o]=a.radius||5}return new aa({xValues:r,yValues:i,scaledSizeValues:n})},rg.prototype._computeCameraConfig=function(t,e,r){"number"==typeof e&&(e={left:e,right:e,top:e,bottom:e});var i,n=void 0===e.left?40:e.left,o=void 0===e.right?40:e.right,a=void 0===e.top?40:e.top,s=void 0===e.bottom?40:e.bottom,u=this._dom.getDimensions(),l=n+o,d=a+s,h=0===t.width?t.maxFixedSize:t.width,c=0===t.height?t.maxFixedSize:t.height,f=(u.width-l)/(h+t.maxScaledSize),g=(u.height-d)/(c+t.maxScaledSize),p=(u.width-l-t.maxFixedSize)/h,_=(u.height-d-t.maxFixedSize)/c,v=r/t.maxScaledSize||NaN,m=(i=[f,g,p,_,v].filter(function(t){return isFinite(t)&&0<t})).length?Qe(i):1;return{x:t.cx+(o-n)/(2*m),y:t.cy+(s-a)/(2*m),zoom:m}},rg.prototype._locateBoundingBox=function(t,e){if(void 0===e&&(e={}),isNaN(t.cx))return Promise.resolve();var r=e.padding,i=void 0===r?{}:r,n=e.easing,o=void 0===n?"quadraticInOut":n,a=e.duration,s=void 0===a?0:a,u=e.maxNodeSizeOnScreen,l=void 0===u?200:u,d=e.ignoreZoomLimits,h=void 0!==d&&d,c=this._computeCameraConfig(t,i,l),f=c.x,g=c.y,p=c.zoom,_=p/this._camera.getZoom();return this._moveCamera(f,g,p,s,o,_,h)},rg.prototype._moveCamera=function(t,e,r,i,n,o,a){return 1.01<o?(this._camera.setCenter({x:t,y:e},{duration:i,easing:n,ignoreZoomLimits:a}),this._camera.setZoom(r,{duration:i,easing:n,ignoreZoomLimits:a,startAfter:.5})):o<.99?(this._camera.setCenter({x:t,y:e},{duration:i,easing:n,ignoreZoomLimits:a,startAfter:.5}),this._camera.setZoom(r,{duration:i,easing:n,ignoreZoomLimits:a})):this._camera.setCenter({x:t,y:e},{duration:i,easing:n,ignoreZoomLimits:a})},rg.prototype.computeConfigForBounds=function(t,e){void 0===e&&(e={});var r=e.padding,i=void 0===r?{}:r,n=e.maxNodeSizeOnScreen,o=void 0===n?200:n;return this._computeCameraConfig(t,i,o)},rg.prototype.layoutDataBoundingBox=function(t){for(var e=t.x,r=t.y,i=t.indexes,n=this._graphics.getNodeAttributes(),o=[],a=[],s=[],u=[],l=0;l<i.length;++l){var d=i[l],h=e[l],c=r[l],f=2*n.radius.get(d),g="scaled"===n.scalingMethod.get(d);o.push(h),a.push(c),g?s.push(f):u.push(f)}return new aa({xValues:o,yValues:a,scaledSizeValues:s,fixedSizeValues:u})},rg.prototype.isEdgeInPolygon=function(t,e){var r=t.getSource(),i=t.getTarget(),n=r.getPositionOnScreen(),o=i.getPositionOnScreen();if(eh(n.x,n.y,e)||eh(o.x,o.y,e))return!0;for(var a=ig(t,this._camera.getZoom()),s=0;s<a.length-1;++s)for(var u=a[s],l=a[s+1],d=0;d<e.length-1;++d){var h=e[d],c=e[d+1];if(pu(u.x,u.y,l.x,l.y,h.x,h.y,c.x,c.y))return!0}return!1},rg.prototype.isElementInView=function(t,e){var r=(void 0===e?{}:e).margin,i=void 0===r?0:r,n=this._camera.getSize(),o={minX:-i,minY:-i,maxX:n.width+i,maxY:n.height+i};return t.isNode?this.isNodeInRectangle(t,o):this.isEdgeInRectangle(t,o)},rg.prototype.isNodeInRectangle=function(t,e){var r=t.getPositionOnScreen(),i=Number(t.getAttribute("radius"))*this._camera.getZoom(),n=r.x-i,o=r.y-i,a=r.x+i,s=r.y+i;return a>=e.minX&&n<=e.maxX&&s>=e.minY&&o<=e.maxY},rg.prototype.isNodeInPolygon=function(t,e){var r=t.getPositionOnScreen();return eh(r.x,r.y,e)},rg.prototype.isEdgeInRectangle=function(t,e){for(var r=ig(t,this._camera.getZoom()),i=0;i<r.length-1;++i){var n=r[i],o=r[i+1];if(_u(n.x,n.y,o.x,o.y,e.minX,e.minY,e.maxX,e.maxY))return!0}return!1},rg);function rg(t){var e=t.dom,r=t.events,i=t.camera,n=t.graphics,o=t.graph,a=t.transformations,s=Jf.call(this)||this;return s._cacheValid=!0,s._cachedGraphBoundingBox=new aa,s._invalidCache=function(){s._cacheValid=!1},s._dom=e,s._events=r,s._camera=i,s._graph=o,s._graphics=n,s._transformations=a,s._events.on([be.ADD_NODES,be.REMOVE_NODES,be.ADD_EDGES,be.REMOVE_EDGES,be.EXCLUDED_STATE_CHANGE,be.CLEAR_GRAPH,be.UPDATE_ATTRIBUTES].join(" "),s._invalidCache),s}function ig(t,e){var r=t.getAttribute("curvature"),i=t.getSource(),n=t.getTarget(),o=i.getPositionOnScreen();if(i===n){var a=(r+i.getAttribute("radius"))*sn*e,s=o.x,u=o.y,l=s-a,d=u,h=s,c=u+a;return x([o],[.2,.4,.6,.8].map(function(t){return Iu(t,s,u,s,u,l,d,h,c)}),[o])}var f=n.getPositionOnScreen();if(0===r)return[o,f];var g=f.x-o.x,p=f.y-o.y,distance=Math.sqrt(g*g+p*p),_=(o.x+f.x)/2,v=(o.y+f.y)/2,m=r*(distance/an)*2,y=_+p/distance*m,b=v+-g/distance*m;return x([o],[.25,.5,.75].map(function(t){return Cu(t,o.x,o.y,f.x,f.y,y,b)}),[f])}(tg=$f=$f||{}).LEFT="left",tg.MIDDLE="middle",tg.RIGHT="right";var ng=ct&&"msLaunchUri"in navigator&&!("documentMode"in document);var og,ag=(b(sg,og=Ee),Object.defineProperty(sg.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(sg.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(sg.prototype,"left",{get:function(){return this._left},enumerable:!0,configurable:!0}),Object.defineProperty(sg.prototype,"right",{get:function(){return this._right},enumerable:!0,configurable:!0}),Object.defineProperty(sg.prototype,"middle",{get:function(){return this._middle},enumerable:!0,configurable:!0}),sg.prototype._isEnabled=function(){return this._settings.get("mouse.enabled")},sg.prototype._isWheelEnabled=function(){return this._settings.get("mouse.wheelEnabled")},sg.prototype._disableWheelUntilMouseDown=function(){return this._settings.get("mouse.disableWheelUntilMouseDown")},sg.prototype._getDoubleClickTimer=function(){return this._settings.get("mouse.doubleClickTimer")},sg.prototype._resetClickCounter=function(t,value){void 0===value&&(value=0),t?this._clickCounter[t]=value:(this._clickCounter.left=value,this._clickCounter.middle=value,this._clickCounter.right=value),this._dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null},sg.prototype._setXY=function(t){var e=this._domElt.getBoundingClientRect();return!!(this._bounds=e)&&(this._evt=t,this._button=Ht[t.button],this._px=this._position.x,this._py=this._position.y,this._position.x=t.clientX-e.left,this._position.y=t.clientY-e.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)},sg.prototype._applyMouseWheelZoom=function(t){var e;this._setXY(t)&&this._events.fire(be.MOUSE_WHEEL,{delta:(e=t,ng?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/St():e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0),x:this._position.x,y:this._position.y,domEvent:this._evt})},sg.prototype._initializeListeners=function(){var e=this,t=this._domElt,r=this._dom;gt&&this._dom.addElementEventListener(document,"contextmenu",function(t){e._lastMouseDownTarget&&t.target!==e._lastMouseDownTarget&&t.preventDefault()}),r.addElementEventListener(t,"contextmenu",function(t){e._setXY(t),e._dom.hasFocus()&&e._settings.get("mouse.enabled")&&t.preventDefault()},!1);var i="onwheel"in t?"wheel":void 0!==t.onmousewheel?"mousewheel":"DOMMouseScroll";r.addElementEventListener(t,i,this._onMouseWheel),r.addElementEventListener(t,"mousemove",this._onMouseMove),r.addElementEventListener(t,"mouseleave",function(){e._isEnabled()&&(e._dom.blur(),e._events.fire(be.MOUSE_LEAVE,{domEvent:e._evt}))}),r.addElementEventListener(t,"mousedown",this._onMouseDown),r.addElementEventListener(t,"mouseup",this._onMouseUp),r.addElementEventListener(t,"dragover",function(t){t.preventDefault()}),r.addElementEventListener(t,"drop",this._onDrop)},sg);function sg(t){var e=t.dom,r=t.position,i=t.settings,n=t.events,o=t.graphics,a=t.camera,s=og.call(this)||this;return s._px=0,s._py=0,s._pressX=0,s._pressY=0,s._left=!1,s._middle=!1,s._right=!1,s._clickCounter={left:0,middle:0,right:0},s._buttons={left:!1,middle:!1,right:!1},s._skipNextMove=!1,s._onMouseWheel=function(t){s._isEnabled()&&s._isWheelEnabled()&&(!s._disableWheelUntilMouseDown()||s._dom.hasFocus())&&(t.preventDefault(),t.stopPropagation(),s._applyMouseWheelZoom(t))},s._onMouseMove=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,r=s._position.y,i=e-s._px,n=r-s._py;0==i&&0==n||(s._skipNextMove?s._skipNextMove=!1:6<=distance(e,r,s._pressX,s._pressY)&&(s._resetClickCounter(),s._events.fire(be.MOUSE_MOVE,{x:e,y:r,dx:i,dy:n,domEvent:s._evt})))}},s._onDocumentMouseMove=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,r=s._position.y,i=s._bounds,n=e-s._px,o=r-s._py;(e<0||e>i.width||r<0||r>i.height)&&s._events.fire(be.DOCUMENT_MOUSE_MOVE,{x:e,y:r,dx:n,dy:o,domEvent:s._evt})}},s._onMouseUp=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,r=s._position.y,i=s._button,n=s._evt;s._buttons[i]=!1,1===s._clickCounter[s._button]?s._events.fire(be.MOUSE_CLICK,{button:i,x:e,y:r,domEvent:n}):1<s._clickCounter[i]&&(s._events.fire(be.MOUSE_DOUBLE_CLICK,{button:i,x:e,y:r,domEvent:n}),s._resetClickCounter(i)),s._events.fire(be.MOUSE_UP,{button:i,x:e,y:r,domEvent:n})}},s._onDocumentMouseup=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,r=s._position.y,i=s._button;s._buttons[i]=!1;var n=s._dom;s._events.fire(be.DOCUMENT_MOUSE_UP,{button:i,x:e,y:r,domEvent:s._evt}),n.removeDirectWindowEventListener("mousemove",s._onDocumentMouseMove),n.removeDirectWindowEventListener("mouseup",s._onDocumentMouseup)}},s._onMouseDown=function(t){if(s._isEnabled()&&s._setXY(t)){var e=s._position.x,r=s._position.y,i=s._button,n=s._dom;s._skipNextMove=!0,s._pressX=e,s._pressY=r,s._lastMouseDownTarget=t.target,n.focus(),s._buttons[i]=!0,s._clickCounter[i]+=1;var o=i;s._dbclickTimer=n.setTimeout(function(){s._resetClickCounter(o,0)},s._getDoubleClickTimer()),s._events.fire(be.MOUSE_DOWN,{button:i,x:e,y:r,domEvent:s._evt}),n.addDirectWindowEventListener("mousemove",s._onDocumentMouseMove),n.addDirectWindowEventListener("mouseup",s._onDocumentMouseup)}},s._onDrop=function(t){if(s._isEnabled()&&s._setXY(t)){t.preventDefault();var e=s._camera.screenToGraphCoordinates(s._position),r=e.x,i=e.y;s._events.fire(be.DROP,{domEvent:s._evt,x:r,y:i})}},s._dom=e,s._settings=i,s._events=n,s._graphics=o,s._position=r,s._camera=a,s._domElt=s._graphics.getDomElement(),i.register("mouse.enabled",!0),i.register("mouse.wheelEnabled",!0),i.register("mouse.disableWheelUntilMouseDown",!1),i.register("mouse.doubleClickTimer",500),n.register([be.MOUSE_DOWN,be.MOUSE_UP,be.MOUSE_MOVE,be.MOUSE_WHEEL,be.MOUSE_CLICK,be.MOUSE_DOUBLE_CLICK,be.MOUSE_LEAVE,be.DOCUMENT_MOUSE_UP,be.DOCUMENT_MOUSE_MOVE,be.DROP]),e.afterNextFrame().then(function(){return s._initializeListeners()}),s}var ug,lg=500,dg=(b(hg,ug=Ee),Object.defineProperty(hg.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(hg.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(hg.prototype,"pressed",{get:function(){return this._pressed},enumerable:!0,configurable:!0}),hg.prototype._listen=function(t,e,r){if(re){if(e===$t.START)return pe(this._addEvent,t,r);if(e===$t.MOVE)return ve(this._addWinEvent,t,r);if(e===$t.END)return me(this._addWinEvent,t,r);if(e===$t.CANCEL)return _e(this._addWinEvent,t,r)}return this._dom.addElementEventListener(t,e,r)},hg.prototype._initialize=function(t){function p(){_._position.x=v,_._position.y=m,_._pressed=l}function a(t,e){var r=_._domElt.getBoundingClientRect();if(!r||null==t.touches)return null;var i=t.touches[0].clientX-r.left,n=t.touches[0].clientY-r.top,o=t.touches[1].clientX-r.left,a=t.touches[1].clientY-r.top,s=(i+o)/2,u=(n+a)/2,l=s-v,d=u-m,h=distance(i,n,o,a),c=h/y,f=cu(i,n,o,a),g={dx:l,dy:d,rotation:f-b,scale:c};return y=h,b=f,v=s,m=u,p(),g}function i(t){if(d=Ht[t.button],t.touches){if(1!==t.touches.length)return l=!1,1<t.touches.length&&_._events.fire(be.TOUCH_UP,{x:v,y:m,domEvent:g,button:d}),0;var e=_._domElt.getBoundingClientRect();return e&&(s=v,u=m,v=t.touches[0].clientX-e.left|0,m=t.touches[0].clientY-e.top|0,l=!0,g=t,p()),1}}function n(){h=0,_._dom.clearTimeout(x)}function r(t){if(t.preventDefault(),t.touches){if(2!==t.touches.length&&f&&(f=!1,_._events.fire(be.TOUCH_END_GESTURE,{domEvent:g})),i(t),0===t.touches.length){var e={x:v,y:m,domEvent:g,button:d};1===h&&_._events.fire(be.TOUCH_TAP,e),1<h&&(_._events.fire(be.TOUCH_DOUBLE_TAP,e),n()),_._events.fire(be.TOUCH_UP,e)}var r=yt().documentElement;ye(_._removeWinEvent,r,$t.MOVE,_._onMove),ye(_._removeWinEvent,r,$t.END,_._onEnd)}}function o(t){!function(t){if(t.touches&&2===t.touches.length&&f){var e=a(t);if(e){var r=e.dx,i=e.dy,n=e.rotation,o=e.scale;_._events.fire(be.TOUCH_PROGRESS_GESTURE,{dx:r,dy:i,rotation:n,scale:o,x:v,y:m,domEvent:g,button:d})}}}(t),c?c=!1:(n(),i(t)&&_._events.fire(be.TOUCH_MOVE,{x:v,y:m,dx:v-s,dy:m-u,domEvent:g,button:d}))}var _=this,v=0,m=0,s=0,u=0,l=!1,d=$f.LEFT,h=0,c=!1,f=!1,y=1,b=0,g=null,x=null;this._listen(this._domElt,$t.START,function(t){if(t.touches){2!==t.touches.length||f||a(t)&&(f=!0,_._events.fire(be.TOUCH_START_GESTURE,{domEvent:g})),i(t)&&(_._dom.focus(),_._events.fire(be.TOUCH_DOWN,{x:v,y:m,domEvent:g,button:d}),h+=1,x=_._dom.setTimeout(n,lg),c=!0);var e=yt().documentElement;_._onMove=_._listen(e,$t.MOVE,o),_._onEnd=_._listen(e,$t.END,r)}})},hg);function hg(t){var e=t.dom,r=t.events,i=t.settings,n=t.graphics,o=t.position,a=ug.call(this)||this;return a._pressed=!1,a._addEvent=function(t,e,r,i){a._dom.addElementEventListener(t,e,r,i)},a._addWinEvent=function(t,e,r,i){a._dom.addDirectWindowEventListener(e,r,i)},a._removeWinEvent=function(t,e,r){a._dom.removeDirectWindowEventListener(e,r)},a._dom=e,a._events=r,a._settings=i,a._graphics=n,a._position=o,a._domElt=a._graphics.getDomElement(),a._settings.register("touch.enabled",!0),a._events.register([be.TOUCH_DOWN,be.TOUCH_UP,be.TOUCH_TAP,be.TOUCH_DOUBLE_TAP,be.TOUCH_MOVE,be.TOUCH_START_GESTURE,be.TOUCH_PROGRESS_GESTURE,be.TOUCH_END_GESTURE,be.DOCUMENT_TOUCH_MOVE,be.DOCUMENT_TOUCH_UP]),a._dom.afterNextFrame().then(function(){a._initialize(a)}),a}function minDisk(t,e,r,i){var n;if(i)n=i;else{n=new Uint32Array(t.length);for(var o=0,a=t.length;o<a;o++)n[o]=o}var s=r?function(t,e,r,i,n,o){var a=r-t,s=i-e,u=o-n,l=Math.sqrt(a*a+s*s);return[(t+r+a/l*u)/2,(e+i+s/l*u)/2,(l+n+o)/2]}:function(t,e,r,i){var n=t-r,o=e-i;return[(t+r)/2,(e+i)/2,Math.sqrt(n*n+o*o)/2]},u=r?function(t,e,r,i,n,o,a,s,u){var l=2*(t-r),d=2*(e-i),h=2*(s-a),c=t*t+e*e-a*a-r*r-i*i+s*s,f=2*(t-n),g=2*(e-o),p=2*(u-a),_=t*t+e*e-a*a-n*n-o*o+u*u,v=f*d-l*g,m=(d*_-g*c)/v-t,y=(g*h-d*p)/v,b=(f*c-l*_)/v-e,x=(l*p-f*h)/v,E=y*y+x*x-1,A=2*(m*y+b*x+a),S=m*m+b*b-a*a,w=(-A-Math.sqrt(A*A-4*E*S))/(2*E);return[m+y*w+t,b+x*w+e,w]}:function(t,e,r,i,n,o){var a=2*(t*(i-o)+r*(o-e)+n*(e-i));if(0==a)return null;var s=((t*t+e*e)*(i-o)+(r*r+i*i)*(o-e)+(n*n+o*o)*(e-i))/a,u=((t*t+e*e)*(n-r)+(r*r+i*i)*(t-n)+(n*n+o*o)*(r-t))/a,l=s-t,d=u-e;return[s,u,Math.sqrt(l*l+d*d)]},l=r?bd:yd;return r=r||[],function t(e,r,i,n,o,a,s,u,l){if(0===i||3===r.length)return h=n,c=o,f=a,g=u,p=l,1===(y=(d=r).length)?[h[_=d[0]],c[_],f[_]||0]:2===y?(_=d[0],v=d[1],g(h[_],c[_],h[v],c[v],f[_],f[v])):3===y?(_=d[0],v=d[1],m=d[2],p(h[_],c[_],h[v],c[v],h[m],c[m],f[_],f[v],f[m])):null;var d,h,c,f,g,p,_,v,m,y,b=e[i-1],x=t(e,r,i-1,n,o,a,s,u,l);return null!==x&&s(x,n[b],o[b],a[b])||(r.push(b),x=t(e,r,i-1,n,o,a,s,u,l),r.pop()),x}(n=function(t){for(var e=t.length-1;0<=e;e--){var r=Math.floor(Math.random()*(e+1));r=Math.max(Math.min(r,e),0);var i=t[e];t[e]=t[r],t[r]=i}return t}(n),[],n.length,t,e,r,l,s,u)}var cg,fg=["x","y","radius"],gg=(b(pg,cg=Ee),pg.prototype.animateChildren=function(t,n,o){var a=this;t.getSubNodes().forEach(function(t){var e=a._subNodeOffsetX.get(t._index),r=a._subNodeOffsetY.get(t._index),i={x:o.x+e,y:o.y+r};t.setAttributes(i,n),t.getSubNodes()&&a.animateChildren(t,n,i)})},pg.prototype.resetOffsets=function(){this._recursiveGuard=!0;var t=this._graph.getNodes(),e=this._topologyLayer.getFlexArrays().nodes;t.setAttribute("x",e.x.getMultiple(t._indexes)),t.setAttribute("y",e.y.getMultiple(t._indexes)),e.x.reset(),e.y.reset(),this._recursiveGuard=!1},pg.prototype.addVisibleGroup=function(t,e){this._visualGroupsLayers.set(t._index,e),this._visibleGroups.add(t._index)},pg.prototype.getNodeDepth=function(t){return this._visualGroupsLayers.get(t._index)||0},pg.prototype.removeVisibleGroup=function(t){var e=t._index;this._visibleGroups.delete(e),this._groupsToHide.push(e),this._visualGroupsLayers.delete(e)},pg.prototype._getAllSubNodes=function(t){for(var e=Array.from(t._indexes),r=[],i=this._visibleGroups,n=this._subNodesList;0!==e.length;){var o=e.pop();if(null!=o&&i.has(o)){var a=n.get(o),s=Array.from(a._indexes);r.push.apply(r,s),e.unshift.apply(e,s)}}return this._graph.nodeList(new Uint32Array(r))},pg.prototype._getAllMetaNodes=function(t){for(var e=Array.from(t._indexes),r=this._visibleGroups,i=this._metaNodeList,n=[],o=new Set;0!==e.length;){var a=e.pop();if(null!=a){var s=i.get(a);null!==s&&!o.has(s._index)&&r.has(s._index)&&(o.add(s._index),n.push(s._index),e.unshift(s._index))}}return this._graph.nodeList(new Uint32Array(n))},pg.prototype.isVisibleGroup=function(t){return this._visibleGroups.has(t._index)},pg.prototype.getSubNodeOffset=function(t){return{x:this._subNodeOffsetX.get(t._index),y:this._subNodeOffsetY.get(t._index)}},pg.prototype._fetchSubEltsList=function(t){return t?this._subNodesList:this._subEdgesList},pg.prototype._fetchMetaEltList=function(t){return t?this._metaNodeList:this._metaEdgeList},pg.prototype.setSubElements=function(t,e){this._fetchSubEltsList(t.isNode).setMultiple(t._indexes,e)},pg.prototype.setMetaElement=function(t,e){this._fetchMetaEltList(t.isNode).setMultiple(t._indexes,e)},pg.prototype.getSubElements=function(t){return this._fetchSubEltsList(t.isNode).getMultiple(t._indexes)},pg.prototype.getMetaElement=function(t){return this._fetchMetaEltList(t.isNode).getMultiple(t._indexes)},pg);function pg(t){var e=t.graph,r=t.graphics,i=t.dom,n=t.events,s=cg.call(this)||this;return s._visibleGroups=new Set,s._visualGroupsLayers=new Map,s._groupsToHide=[],s._updateVisualGroups=function(t,e,r){var i=r.nodes.getUpdatedElementsList(),h=t.nodes.outputFlexArrays,c=t.nodes.inputFlexArrays,f=s._visibleGroups;if(0===i.size||0===f.size)return t.nodes.toUpdate.clear(),t.edges.toUpdate.clear(),t.nodes.formattedOutput&&(t.nodes.formattedOutput.attributes=[]),void(t.nodes.output&&(t.nodes.output.attributes=[]));for(var n=r.nodes.getUpdatedAttributes();0<s._groupsToHide.length;){var o=s._groupsToHide.pop();h.radius.set(o,void 0),h.x.set(o,void 0),h.y.set(o,void 0)}if(n.has("x")||n.has("y")||n.has("radius")){var a=s._getAllSubNodes(i),g=s._getAllMetaNodes(i),p=t.nodes.toUpdate,_=t.edges.toUpdate,v=s._subNodeOffsetX,m=s._subNodeOffsetY;t.nodes.formattedOutput&&t.nodes.output&&(t.nodes.formattedOutput.attributes=fg,t.nodes.output.attributes=fg);var y=new Set;i.forEach(function(t){var e=t._index;h.x.set(e,void 0),h.y.set(e,void 0),y.add(e)}),a.forEach(function(t){if(c){var e=t.getMetaNode(),r=t._index,i=c.x.get(r),n=c.y.get(r);if(e&&f.has(e._index)){var o=v.get(r),a=m.get(r),s=h.x.get(e._index),u=h.y.get(e._index),l=i-s,d=n-u;if(-1e7===o||-1e7===a)return v.set(r,l),m.set(r,d),void(g.includes(e)||(g=g.concat(e.toList())));p.addIndex(r),_.add(t.getAdjacentEdges()),y.has(r)||o===l&&a===d||(i=s+o,n=u+a,h.x.set(r,i),h.y.set(r,n)),v.set(r,i-s),m.set(r,n-u)}}}),g.forEach(function(t){var e=t.getSubNodes();if(e){var r=h.x.getMultiple(e._indexes),i=h.y.getMultiple(e._indexes),n=h.radius.getMultiple(e._indexes),o=minDisk(r,i,n),a=o[0],s=o[1],u=o[2];e.forEach(function(t,e){v.set(t._index,r[e]-a),m.set(t._index,i[e]-s)}),h.x.set(t._index,a),h.y.set(t._index,s),h.radius.set(t._index,u),p.addIndex(t._index),_.add(t.getAdjacentEdges())}}),r.nodes.addUpdatedAttribute("radius"),r.nodes.addUpdatedAttribute("x"),r.nodes.addUpdatedAttribute("y"),r.nodes.redrawElements(g)}},s._graph=e,s._graphics=r,s._dom=i,s._subNodesList=e.createNodeAttribute({storage:"any",default:null}),s._subEdgesList=e.createEdgeAttribute({storage:"any",default:null}),s._metaNodeList=e.createNodeAttribute({storage:"any",default:null}),s._metaEdgeList=e.createEdgeAttribute({storage:"any",default:null}),s._subNodeOffsetX=e.createNodeAttribute({storage:"float",default:-1e7}),s._subNodeOffsetY=e.createNodeAttribute({storage:"float",default:-1e7}),s._recursiveGuard=!1,n.on(be.SET_MULTIPLE_ATTRIBUTES,function(t){var e=t.elements,r=t.values,i=t.options;if(!s._recursiveGuard){var n=e.toList().map(function(t,e){return{group:t,translation:r.constructor===Array?{x:r[e]&&r[e].x||0,y:r[e]&&r[e].y||0}:{x:r.x||0,y:r.y||0},isGroup:t.isNode&&s._visibleGroups.has(t._index)}}).filter(function(t){return t.isGroup});n.length&&(s._recursiveGuard=!0,n.forEach(function(t){var e=t.group,r=t.translation;return s.animateChildren(e,i,r)}),s._recursiveGuard=!1)}}),s._groupAttributeLayer=r.addAttributeLayer({name:"internal(_compound)",priority:7,nodeSelector:function(t){return s._visibleGroups.has(t._index)},edgeSelector:function(t){return t.isVirtual()},nodeAttributes:{layer:function(t){return s._visualGroupsLayers.get(t._index)}},nodeOutput:{attributes:["layer"]},nodeDependencies:{self:{data:!1,hover:!0},adjacentNodes:{attributes:"all"},adjacentEdges:{attributes:"all"}}}),s._topologyLayer=s._graphics.addAttributeLayer({name:"internal(position-forcer)",priority:6.9,nodeDependencies:{self:{attributes:["x","y","radius"]},adjacentNodes:{attributes:"all"}},onBeforeUpdate:s._updateVisualGroups,nodeOutput:{attributes:["x","y","radius","layer"]}}),s}var _g,vg=(b(mg,_g=Ee),mg.prototype.refresh=function(){var t=this;return this._list.length?(this._mustRefresh||this._safeGuard||(this._mustRefresh=!0,this._safeGuard=!0,this._afterCurrentUpdate=this._afterCurrentUpdate.then(function(){return t._update()}).then(function(){return t._dom.refresh(),t._dom.afterNextFrame()}).then(function(){return t._dom.refresh(),t._mustRefresh=!1,t._safeGuard=!1,t._list.forEach(function(t){if(t.getError())return t.reject();t.resolve()}),Promise.resolve()})),this._afterCurrentUpdate):Promise.resolve()},mg.prototype._getSubElements=function(t){var i=this;return t.reduce(function(t,e){var r=i._ogma.modules.grouping.getSubElements(e)[0];return r?t.concat(i._getSubElements(r)):t.concat(e)},t.slice(0,0))},mg.prototype._assignTransformationIds=function(t,e,r){null!==e&&this._nodeTransformationIdList.setMultiple(e._indexes,t),null!==r&&this._edgeTransformationIdList.setMultiple(r._indexes,t)},mg.prototype._resolveTransformations=function(t,r,e){var i=this;if(e||(t.forEach(function(t){return t.setDuration(0)}),r.forEach(function(t){return t.setDuration(0)})),this._destroyed)return Promise.resolve();var n=this._selection.getSelectedNodes().getId(),o=this._selection.getSelectedEdges().getId(),a=Promise.resolve();return t.forEach(function(e){null!==e.getContext()&&(a=a.then(function(){return e.undo()})),r.find(function(t){return t.getId()===e.getId()})||(a=a.then(function(){return e.cleanup()}).then(function(){e.resetContext()}))}),r.forEach(function(r){a=a.then(function(){return r.run()}).catch(function(t){return r.setError(t),r.resetContext(),!0}).then(function(t){if(!0===t)return Promise.resolve();var e=t;return i._assignTransformationIds(r.getId(),e.virtualNodes,e.virtualEdges),r.setContext(e),r.cleanup()})}),a=a.then(function(){i._destroyed||(i._graph.getNodes(n).setSelected(!0),i._graph.getEdges(o).setSelected(!0))})},mg.prototype.getList=function(){return this._list},mg.prototype.clear=function(){var t=this,e=this._list.slice();return e.forEach(function(t){t.shouldUndo=!0,t.shouldDo=!1,t.setRemovalDuration(0)}),this.refresh().then(function(){return t._list=t._list.filter(function(t){return!e.includes(t)}),Promise.resolve()})},mg.prototype._get=function(e,t){void 0===t&&(t=!0);var r=this._list.find(function(t){return t.getId()===e});if(r)return r;if(t)throw new Error("calling a method on a destroyed transformation");return null},mg.prototype.enable=function(t,e){var r=this;return this._afterCurrentUpdate.then(function(){return t.shouldDo=!0,t.shouldUndo=t.enabled,t.setDuration(e),r.refresh()})},mg.prototype.disable=function(t,e){var r=this;return this._afterCurrentUpdate.then(function(){return t.shouldUndo=!0,t.shouldDo=!1,t.setRemovalDuration(e),r.refresh()})},mg.prototype.remove=function(t,e){var r=this;return this._afterCurrentUpdate.then(function(){return t.setRemovalDuration(e),t.shouldUndo=!0,t.shouldDo=!1,r.refresh().then(function(){r._list.splice(t.getIndex(),1)})})},mg.prototype.setIndex=function(t,e){var r=this;return this._afterCurrentUpdate.then(function(){return t&&(r._list.splice(t.getIndex(),1),r._list.splice(Xe(e,0,r._list.length),0,t)),r.refresh()})},mg.prototype.getIndex=function(t){for(var e=0;e<this._list.length;e++)if(this._list[e]===t)return e;return-1},mg.prototype.add=function(t){return t.initialize({ogma:this._ogma,id:++this._idCounter}),this._list.push(t),this.refresh(),t},mg.prototype.whenApplied=function(){var t=this;return this._dom.afterNextFrame().then(function(){return t._afterCurrentUpdate})},mg.prototype.isEnabled=function(t){var e=this._get(t);return e&&e.enabled||!1},mg.prototype._getElementTransformationId=function(t){return(t.isNode?this._nodeTransformationIdList:this._edgeTransformationIdList).get(t._index)},mg.prototype.isElementVirtual=function(t){return 0!==this._graph.getAttribute(t.isNode,"virtual").get(t._index)},mg.prototype.getElementTransformation=function(t){return this._get(this._getElementTransformationId(t),!1)},mg.prototype.destroy=function(){this._destroyed=!0},mg);function mg(t,e){var r,i=t.settings,n=t.dom,o=t.events,a=t.captor,s=t.selection,u=t.classes,l=t.graph,d=_g.call(this)||this;return d._list=[],d._idCounter=0,d._mustRefresh=!1,d._safeGuard=!1,d._afterCurrentUpdate=Promise.resolve(),d._destroyed=!1,d._update=function(){var t=Promise.resolve();d._captor.setDetectionEnabled(!1);var e,r,i=d._list.filter(function(t){return t.shouldDo}),n=d._list.filter(function(t){var e=t.enabled,r=t.shouldUndo;return e||r}),o=!1;if(n.length===i.length+1&&yg(n,i,i.length)){var a=n.pop();e=a?[a]:[],r=[],o=!0}else if(i.length===n.length+1&&yg(n,i,n.length)){e=[];var s=i.pop();r=s?[s]:[],o=!0}else e=n,r=i,o=!1;return t=t.then(function(){return d._resolveTransformations(e,r,o)}).then(function(){return d._captor.setDetectionEnabled(!0)}).then(function(){e.forEach(function(t){t.shouldUndo=!1,t.enabled=!1}),r.forEach(function(t){t.shouldDo=!0,t.enabled=!0})})},d._settings=i,d._dom=n,d._graph=l,d._captor=a,d._classes=u,d._selection=s,d._ogma=e,u.createClass({name:pr,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0,width:0}}),d._classes.createClass({name:_r,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),d._nodeTransformationIdList=l.createNodeAttribute({storage:16,default:0}),d._edgeTransformationIdList=l.createEdgeAttribute({storage:16,default:0}),i.register("transformations.updateOnDataChange",!0),o.on(((r={})[[be.ADD_NODES,be.ADD_EDGES,be.REMOVE_NODES,be.REMOVE_EDGES].join(" ")]=function(t){t.virtual||d._afterCurrentUpdate.then(function(){return d.refresh()})},r[be.REQUEST_ELEMENTS_TO_DELETE]=function(t){t.virtual||(t.elementsToRemove=d._getSubElements(t.elementsToRemove),d._resolveTransformations(d._list,[],!1))},r[be.UPDATE_NODE_DATA+" "+be.UPDATE_EDGE_DATA]=function(){d._settings.get("transformations.updateOnDataChange")&&!d._safeGuard&&d.refresh()},r)),d}function yg(t,e,r){for(var i=0;i<r;++i)if(t[i].getId()!==e[i].getId())return;return 1}var bg,xg={layer:2,outline:!0,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},Eg={layer:2,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0},stroke:{width:2}},Ag=(b(Sg,bg=Ee),Sg.prototype.onMounted=function(t){function e(){r._selectionExtremityHighlightedClass.clearNodes(),r._selectedClass.getEdges().getExtremities().addClass(hr)}var r=this;t.events.onEdgesClassAdded(dr,e),t.events.onEdgesClassRemoved(dr,e)},Sg.prototype.setNodeAttributes=function(t,e){this._selectedClass.update({nodeAttributes:t,fullOverwrite:e}),this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},Sg.prototype.setEdgeAttributes=function(t,e){this._selectedClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},Sg.prototype._updateExtremityHighlightLayer=function(){var t=this._selectedClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})},Sg.prototype.setActive=function(t,r){if(M(r)){var i=[],n=[];t.toList().forEach(function(t,e){(r[e]?i:n).push(t.getId())}),0!==i.length&&this._graph.getElements(t.isNode,i).addClass(dr),0!==n.length&&this._graph.getElements(t.isNode,n).removeClass(dr)}else t[r?"addClass":"removeClass"](dr)},Sg.prototype.areActive=function(t){return t.hasClass(dr)},Sg.prototype.getSelectedNodes=function(){return this._selectedClass.getNodes()},Sg.prototype.getSelectedEdges=function(){return this._selectedClass.getEdges()},Sg.prototype.getNonSelectedNodes=function(){return this._graph.getNodes().filter(function(t){return!t.hasClass(dr)})},Sg.prototype.getNonSelectedEdges=function(){return this._graph.getEdges().filter(function(t){return!t.hasClass(dr)})},Sg.prototype.clear=function(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()},Sg);function Sg(t){var e=t.events,r=t.settings,i=t.graph,n=t.keyboard,o=t.graphics,a=t.interactions,s=t.classes,u=bg.call(this)||this;return u._events=e,u._settings=r,u._graph=i,u._keyboard=n,u._graphics=o,u._selectionExtremityHighlightedClass=s.createClass({name:hr,isBuiltin:!0,nodeAttributes:xg}),u._selectedClass=s.createClass({name:dr,isBuiltin:!0,nodeAttributes:xg,edgeAttributes:Eg}),r.register("interactions.selection.enabled",!0),r.register("interactions.selection.multiSelectionKey","ctrl"),a.onClick({priority:"selection",check:function(t){var e=t.button,r=u._settings.get("interactions.selection.enabled");return"left"===e&&r&&!u._graphics.isAnimating()},handler:function(t){var e=t.target;if(e){var r=u._settings.get("interactions.selection.multiSelectionKey"),i=r&&u._keyboard.isPressed(r);if(e.isNode?u._selectedClass.clearEdges():u._selectedClass.clearNodes(),i)e.hasClass(dr)?e.removeClass(dr):e.addClass(dr);else(e.isNode?u._selectedClass.getNodes():u._selectedClass.getEdges()).filter(function(t){return t!==e}).removeClass(dr),e.hasClass(dr)||e.addClass(dr)}else u._selectedClass.clearNodes(),u._selectedClass.clearEdges()}}),u._events.on(be.BEFORE_REMOVE_EDGES,function(t){return t.edges.setSelected(!1)}),u._events.on(be.EXCLUDED_STATE_CHANGE,function(t){var e=t.elements;t.value||e.setSelected(!1)}),u}var wg,Tg=(b(Cg,wg=Ee),Cg.prototype._nextTimeIdle=function(t){var e=this,r=new Mg(this._dom,this._idIdle,t);return this._delayedCalls.push(r),r.whenDone().then(function(){e._delayedCalls.splice(e._delayedCalls.indexOf(r),1)})},Cg.prototype.debounceIdle=function(e,r){var i=this;function n(){var t=a;o=!1,a=[],e(),t.forEach(function(t){return t()})}void 0===r&&(r=0);var o=!1,a=[];return function(){return new Promise(function(t){a.push(t),o||(o=!0,i._nextTimeIdle(r).then(n))})}},Cg);function Cg(t){var e,r=t.dom,i=t.events,n=t.captor,o=wg.call(this)||this;return o._dom=r,o._events=i,o._captor=n,o._delayedCalls=[],o._idIdle=function(){return!o._captor.isAnyButtonPressed()&&!o._dom.isPlayingFrame()},o._events.on(((e={})[[be.DOWN,be.UP,be.BEFORE_NEW_FRAME,be.NEW_FRAME].join(" ")]=function(){o._delayedCalls.forEach(function(t){return t.reset()})},e)),o}var Mg=(Ig.prototype._startTimeout=function(){var t=this;this._timeout=this._dom.setTimeout(function(){t._isIdle()?(t._done=!0,t._resolve()):t._startTimeout()},this._delay)},Ig.prototype.reset=function(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())},Ig.prototype.whenDone=function(){return this._promise},Ig);function Ig(t,e,r){var i=this;this._timeout=null,this._done=!1,this._dom=t,this._promise=new Promise(function(t){return i._resolve=t}),this._isIdle=e,this._delay=r,this._startTimeout()}var Lg,Ng={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2,enabled:!1},Og={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2,enabled:!1},kg=(b(Rg,Lg=Ee),Rg.prototype._onElementsAttributeChange=function(t,e){if(e.includes("pulse.enabled")){var r=zr(this._graph,t,function(t){return t.getAttribute("pulse.enabled")}),i=r.valid,n=r.invalid;this._hasPulses.removeElements(n),this._hasPulses.addElements(i),this._removePulses(n)}},Rg.prototype._removePulses=function(t){for(var e=t.isNode?this._nodePulses:this._edgePulses,r=0;r<t._indexes.length;r++){var i=t._indexes[r],n=e.get(i);if(n){for(var o=0;o<n.length;o++){var a=n[o];this._graphics.releaseGraphicsEngineBlockId(a.blockId)}e.set(i,null)}}},Rg.prototype._refreshElementsPulses=function(t,e){for(var r=t.isNode,i=r?this._nodePulses:this._edgePulses,n=r?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,o=r?"_createNodePulseBlock":"_createEdgePulseBlock",a=r?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,s=r?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,u=0;u<t._indexes.length;u++){var l=t._indexes[u],d=i.get(l);d||(d=[],i.set(l,d));for(var h=0;h<d.length;h++){var c=d[h],f=c.startTime,g=c.duration,p=c.blockId;f+g<=e&&(this._graphics.releaseGraphicsEngineBlockId(p),d.splice(h--,1))}var _=d[d.length-1];if(!_||e>=_.startTime+a.get(l)){g=n.get(l);var v=s.get(l);0!==v&&d.push({blockId:this[o](l,e,g),startTime:e,duration:g}),0<v&&s.set(l,v-1)}}},Rg.prototype._createNodePulseBlock=function(t,e,r){var i=this._nodeFlexArrays,n=i.color.get(t),o=i.layer.get(t),a=i.x.get(t),s=i.y.get(t),u=i.radius.get(t),l="scaled"===i.scalingMethod.get(t),d=i.pulse.startRatio.get(t),h=i.pulse.endRatio.get(t),c=i.pulse.width.get(t),f=2*u*d,g=2*u*h,p=rd(o).nodeBody,_=i.pulse.startColor.get(t),v=i.pulse.endColor.get(t),m=this._graphics.allocateGraphicsEngineBlockId(),y=this._group.reset(1,!0,p),b=y.nextAndReset(),x=ql(_,n),E=ql(v,n);return b.end.shape="circle",b.end.pieceId=ji,b.end.x1=a,b.end.y1=s,b.end.x2=a,b.end.y2=s,b.end.rectWidthOrSourceRadiusScaled=l?g:0,b.end.rectHeightOrTargetRadiusScaled=l?g:0,b.end.rectWidthOrSourceRadiusFixed=l?0:g,b.end.rectHeightOrTargetRadiusFixed=l?0:g,b.end.strokeWidthFixed=c,b.end.strokeColor=E,b.start.shape="circle",b.start.pieceId=ji,b.start.x1=a,b.start.y1=s,b.start.x2=a,b.start.y2=s,b.start.rectWidthOrSourceRadiusScaled=l?f:0,b.start.rectHeightOrTargetRadiusScaled=l?f:0,b.start.rectWidthOrSourceRadiusFixed=l?0:f,b.start.rectHeightOrTargetRadiusFixed=l?0:f,b.start.strokeWidthFixed=c,b.start.strokeColor=x,b.animation.duration=r,b.animation.beginTime=e,this._engine.storeGroup(m,y),m},Rg.prototype._createEdgePulseBlock=function(t,e,r){var i=this._edgeFlexArrays,n=this._nodeFlexArrays,o=i.pulse.startRatio.get(t),a=i.pulse.endRatio.get(t),s=i.pulse.startColor.get(t),u=i.pulse.endColor.get(t),l=rd(i.layer.get(t)).edgeBody,d=this._edgeSourceList.get(t),h=this._edgeTargetList.get(t),c=i.curvature.get(t),f=0!==c,g=this._graphics.allocateGraphicsEngineBlockId(),p=this._group.reset(f?3:1,!0,l),_=p.nextAndReset(),v={isSelfLoop:d===h,curvature:c,sourceX:n.x.get(d),sourceY:n.y.get(d),targetX:n.x.get(h),targetY:n.y.get(h),sourceRadius:n.radius.get(d),targetRadius:n.radius.get(h),isSourceRadiusScaled:"scaled"===n.scalingMethod.get(d),isTargetRadiusScaled:"scaled"===n.scalingMethod.get(h),width:i.width.get(t),isWidthScaled:"scaled"===i.scalingMethod.get(t),strokeWidth:i.pulse.width.get(t)};return Fg(_.start,v),Fg(_.end,v),_.start.strokeColor=s,_.end.strokeColor=u,_.start.thicknessOrFontSizeScaled*=o,_.start.thicknessOrFontSizeFixed*=o,_.end.thicknessOrFontSizeScaled*=a,_.end.thicknessOrFontSizeFixed*=a,_.animation.duration=r,_.animation.beginTime=e,this._engine.storeGroup(g,p),g},Rg.prototype.pulse=function(t,e){var r=t.isNode,i=I(I({},r?Ng:Og),e),n=i.number,o=i.interval,a=i.duration,s=r?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,u=(n-1)*o+a;delete i.number,i.enabled=!0,t.setAttributes({pulse:i}),s.setMultiple(t._indexes,n),this._dom.setTimeout(function(){t.setAttribute("pulse.enabled",!1),s.setMultiple(t._indexes,-1)},u)},Rg);function Rg(t){var e,r=t.graphics,i=t.graph,n=t.dom,o=t.events,a=Lg.call(this)||this;return a._onAttributeChange=function(t){var e=t.nodes,r=t.edges,i=t.nodeAttributes,n=t.edgeAttributes;a._onElementsAttributeChange(e,i),a._onElementsAttributeChange(r,n)},a._refreshPulses=function(){var t=a._hasPulses.getElements(),e=t.nodes,r=t.edges;if(0!==e.size||0!==r.size){var i=a._engine.getCurrentTime();a._refreshElementsPulses(e,i),a._refreshElementsPulses(r,i),a._dom.refresh()}},a._graph=i,a._dom=n,a._graphics=r,o.on(((e={})[be.UPDATE_ATTRIBUTES]=a._onAttributeChange,e[be.NEW_FRAME]=a._refreshPulses,e[be.BEFORE_REMOVE_NODES+" "+be.BEFORE_REMOVE_EDGES]=function(t){var e=t.nodes,r=t.edges;e&&e.setAttribute("pulse.enabled",!1),r&&r.setAttribute("pulse.enabled",!1)},e[be.CLEAR_GRAPH]=function(){return a._hasPulses.clear()},e)),a._engine=a._graphics.getGraphicsEngine(),a._group=a._engine.createGroup(),a._nodePulses=i.createNodeAttribute({storage:"any"}),a._edgePulses=i.createEdgeAttribute({storage:"any"}),a._nodeNbPulsesRemaining=i.createNodeAttribute({storage:"int16",default:-1}),a._edgeNbPulsesRemaining=i.createEdgeAttribute({storage:"int16",default:-1}),a._nodeFlexArrays=a._graphics.getNodeAttributes(),a._edgeFlexArrays=a._graphics.getEdgeAttributes(),a._edgeSourceList=i.getEdgeAttribute("source"),a._edgeTargetList=i.getEdgeAttribute("target"),a._hasPulses=new ia(a._graph),a}function Fg(t,e){var r=e.sourceX,i=e.sourceY,n=e.targetX,o=e.targetY,a=e.isSourceRadiusScaled,s=e.isTargetRadiusScaled,u=e.targetRadius,l=e.sourceRadius,d=e.isWidthScaled,h=e.width,c=e.strokeWidth,f=e.curvature,g=e.isSelfLoop;t.pieceId=Gi,t.shape="line",t.x1=r,t.y1=i,t.x2=n,t.y2=o,t.rectWidthOrSourceRadiusScaled=a?l:0,t.rectWidthOrSourceRadiusFixed=a?0:l,t.rectHeightOrTargetRadiusScaled=s?u:0,t.rectHeightOrTargetRadiusFixed=s?0:u,t.thicknessOrFontSizeScaled=d?h:0,t.thicknessOrFontSizeFixed=d?0:h,t.strokeWidthFixed=c,t.curvature=f,t.isSelfLoop=g}var Dg,Pg={duration:0,easing:"linear",callback:function(){},startAfter:0},zg=(b(Bg,Dg=Ee),Bg.prototype.play=function(t,e){var r=Q(e,Pg),i=r.duration,n=r.easing,o=r.callback,a=r.startAfter,s=null;return i<=0?(t(1),o()):(s={func:t,easing:"function"==typeof n?n:Il[n],duration:i,callback:o,startAfter:a,creationDate:Zt(),done:!1},this._animationList.push(s),this._dom.refresh()),s},Bg.prototype.end=function(t,e){void 0===e&&(e=!0);var r=this._animationList.indexOf(t);-1!==r&&(t.func(1),this._animationList.splice(r,1),t.done=!0,e&&t.callback(!0))},Bg);function Bg(t){var e=t.dom,r=t.events,u=Dg.call(this)||this;return u._animationList=[],u._update=function(){if(0!==u._animationList.length){for(var t=Zt(),e=[],r=0;r<u._animationList.length;++r){var i=u._animationList[r],n=(t-i.creationDate)/i.duration,o=i.startAfter,a=i.easing(n);if(1<=n)i.func(1),i.done=!0,u._animationList.splice(r,1),--r,e.push(i.callback);else if(o<=a){a=(a-o)*(1/(1-o)),i.func(a)}}for(var s=0;s<e.length;++s)e[s](!1);u._dom.refresh()}},u._dom=e,u._events=r,u._animationList=[],u._events.on(be.BEFORE_NEW_FRAME,u._update),u}function Ug(t){return t+(-1===t.indexOf("?")?"?":"&")+"noCache="+Date.now()}var Vg={tileLayers:function(e,a,t,o,s){var u=t._getMapPanePos(),r=e.getContainer();if(!r)throw new Error("Trying to access the container of "+e+" but it does not exist.");var l=o.DomUtil.getPosition(r);t.removeLayer(e),e.options.crossOrigin="anonymous";var d=[],h=[];return e.on("tileload",function(t){var e=t.tile,r=o.DomUtil.getPosition(e),i=r.x,n=r.y;d.push(e),h.push({x:i-l.x+u.x-s.x,y:n-l.y+u.y-s.y})}),t.addLayer(e),new Promise(function(t){e.once("load",function(){var o=e.getTileSize();d.forEach(function(t,e){var r=h[e],i=r.x,n=r.y;a.drawImage(t,i,n,o.x,o.y)}),t()})})},imageOverlays:function(a,s,u,t,l){return new Promise(function(o){u.removeLayer(a),a.setUrl(Ug(a.getUrl())),a.options.crossOrigin="anonymous",a.once("load",function(){var t=a.getBounds(),e=u.latLngToContainerPoint(t.getNorthWest()),r=u.latLngToContainerPoint(t.getSouthEast()),i=r.x-e.x,n=r.y-e.y;s.drawImage(a._image,e.x-l.x,e.y-l.y,i,n),o()}),u.addLayer(a)})},vectorLayers:function(a,s,u,l,d,h){return new Promise(function(t){var e=a.options.renderer;u.removeLayer(a),a.options.renderer=h,u.addLayer(a),h._updatePaths();var r=u._getMapPanePos(),i=h._container,n=l.DomUtil.getPosition(i),o=St();s.drawImage(h._container,n.x+r.x-d.x,n.y+r.y-d.y,i.width/o,i.height/o),u.removeLayer(a),a.options.renderer=e,u.addLayer(a),t()})},markers:function(g,p,_,t,v){return new Promise(function(t){var e=_.getPixelBounds().min,r=_.project(g.getLatLng(),_.getZoom()),i=/^data\:/.test(g._icon.src),n=i?g._icon.src:Ug(g._icon.src),o=new Image,a=g.options.icon;if(a){var s=a.options,u=s.iconSize||[24,24],l=r.subtract(e),d=s.iconAnchor||[0,0];Array.isArray(u)||(u=[u.x,u.y]),Array.isArray(d)||(d=[d.x,d.y]);var h=Math.round(l.x-u[0]+d[0])-v.x,c=Math.round(l.y-d[1])-v.y;o.crossOrigin="";var f=function(){p.drawImage(o,h,c,u[0],u[1]),t()};o.onload=f,o.src=n,i&&f()}})},vectorMap:function(t,r,e,i,n){var o=e._getMapPanePos(),a=t.getMapboxMap(),s=t.getCanvas(),u=t.getSize().round(),l=i.DomUtil.getPosition(t.getContainer()),d=l.x+o.x-n.x,h=l.y+o.y-n.y;return new Promise(function(t){function e(){r.drawImage(s,d,h,u.x,u.y),t()}if(a.loaded())return e();a.once("idle",e)})}};function jg(o,a,s,u,l,d){var h={vectorMap:[],tileLayers:[],vectorLayers:[],imageOverlays:[],markers:[]};return a.eachLayer(function(t){if(t!==o){var e=(i=t)instanceof(n=u).TileLayer?"tileLayers":i instanceof n.ImageOverlay?"imageOverlays":i instanceof n.Path?"vectorLayers":i instanceof n.Marker?"markers":"MapboxGL"in n&&i instanceof n.MapboxGL?"vectorMap":void 0;if(e&&e in h){var r=Vg[e];h[e].push(function(){return r(t,s,a,u,l,d)})}}var i,n}),h}function Gg(t,e,r,u){var i=t.filter(function(t){return t.isVisible()}),n=0===i.size,o=i.reduce(function(t,e){var r=e.getGeoCoordinates(),i=r.latitude,n=r.longitude,o=u(i,n),a=o.x,s=o.y;return t.mapX.push(a),t.mapY.push(s),t},{mapX:[],mapY:[]}),a=o.mapX,s=o.mapY,l=i.getAttribute("x"),d=i.getAttribute("y"),h=i.getAttribute("radius").map(Number),c=new aa({xValues:l,yValues:d,scaledSizeValues:h}),f=new aa({xValues:a,yValues:s});n&&(c.cx=c.cy=0,c.width=c.height=0),isFinite(f.width)&&isFinite(f.height)||(f.cx=f.cy=0,f.width=f.height=0);var g=f.cx-c.cx,p=f.cy-c.cy,_=n?1:Math.max(f.width,f.height)/Math.max(c.width,c.height),v=h.reduce(function(t,e){return t[0]=Math.min(t[0],e*_),t[1]=Math.max(t[1],e*_),t},[1/0,0]),m=v[0],y=v[1];f.pad(y),f.minScaledSize=m,f.maxScaledSize=y;var b,x=r.computeConfigForBounds(f),E=e.zoom/(b=x.zoom,Math.pow(2,Math.ceil(Math.log2(b))));g+=(c.cx-e.x)*E,p+=(c.cy-e.y)*E;var A=c.cx+g,S=c.cy+p;return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:function(t){return Number(t.getAttribute("radius"))*E},x:function(t){return(t.getAttribute("x")+g-A)*E+A},y:function(t){return(t.getAttribute("y")+p-S)*E+S}},edgeAttributes:{width:function(t){return Number(t.getAttribute("width"))*E}}},camera:I({zoom:e.zoom/E,x:(e.x+g-A)*E+A,y:(e.y+p-S)*E+S,angle:0},e.getSize())}}var Hg,qg={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},Wg={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},Xg={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:void 0},Yg=(b(Zg,Hg=Ee),Zg.prototype.set=function(t,e){var r=I(I({},Xg),e),i=r.position,n=r.horizontalMargin,o=r.verticalMargin,a=r.className;qg[i]||(i=Xg.position),this.remove();var s=document.createElement("div");return s.innerHTML=t,s.style.position="absolute",Kg(s,i,n,o),s.style.padding="0px 0px 0px 0px",s.style.zIndex="10",a&&s.setAttribute("class",a),this._brand=s,this._dom.setLayer("brand",this._brand),s},Zg.prototype.remove=function(){this._dom.setLayer("brand",null),this._brand=null},Zg);function Zg(t){var e=t.dom,r=Hg.call(this)||this;return r._dom=e,r._brand=null,r}function Kg(t,e,r,i){var n=void 0===r?"":r+"px",o=void 0===i?"":i+"px";t.style[qg[e]]=n,t.style[Wg[e]]=o}var Qg,Jg=(b($g,Qg=Ee),$g.prototype._onDataChange=function(t){var r=this,e=t.filter(function(t){var e=t.property;return e===r.latitudePath||e===r.longitudePath});if(e.length){var i=e.reduce(function(t,e){var r=e.nodes,i=e.newValues;if(!r)return t;var n=r.filter(function(t,e){return null!=i[e]});return t?t.concat(n):n},null);i&&this._refreshOrAddNodes(i)}},$g.prototype._refreshOrAddNodes=function(t){this._updateNodesCoordinates(t),this._enabled&&(this._filter.refresh(),this._updatePrevNodesCoordinates(t))},$g.prototype._updatePrevNodesCoordinates=function(t){gi(this._graph,t,ei,"geo.prevLat"),gi(this._graph,t,ri,"geo.prevLng")},$g.prototype._restorePrevNodesCoordinates=function(t){gi(this._graph,t,"geo.prevLat",ei),gi(this._graph,t,"geo.prevLng",ri)},$g.prototype._updateNodesCoordinates=function(t){!function(t,e,r){for(var i=r.longitudePath,n=r.latitudePath,o=r.wrapCoordinates,a=t.getAttributes(!0,[ei,ri]),s=a[0],u=a[1],l=e._indexes,d=e.getId(),h=l.length,c=e.getData(n),f=e.getData(i),g=0;g<h;g++){var p=f[g],_=c[g],v=l[g],m=d[g];null!=_&&null!=p&&(di(m,p),hi(m,_),o&&(p%=180,_=Xe(+_,-ii,ii)),u.set(v,p),s.set(v,_))}}(this._graph,t,this._settings)},$g.prototype._createMapTileLayer=function(t,e){if(t&&!J(t))return t;var r,i=t.wms?this.L.tileLayer.wms:this.L.tileLayer,n=(r=t,(null==e&&r.url===oi.tiles.url?'Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>':null)||"");return i(t.url,I({attribution:n},t))},$g.prototype._setupTileLayer=function(t,e){var r=this,i=this._createMapTileLayer(t,e);return i.once("load",function(){r._events.fire(be.GEO_LOADED)}),i.addTo(this._map),i},$g.prototype._onSettingsChanged=function(t,e){var r,i,n=t.wrapCoordinates!==e.wrapCoordinates,o=t.latitudePath!==e.latitudePath||t.longitudePath!==e.longitudePath;(n||o)&&this._updateNodesCoordinates(this._graph.getNodes("all")),this._enabled&&(i=e,(r=t).attribution===i.attribution&&r.tiles===i.tiles||!this._map||(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(e.tiles,e.attribution)),t.sizeRatio!==e.sizeRatio&&this._updateSizes(),t.maxZoomLevel!==e.maxZoomLevel&&this._settingsModule.update({minZoom:1,maxZoom:Math.pow(2,e.maxZoomLevel)}),t.disableNodeDragging!==e.disableNodeDragging&&this._setDragging(!e.disableNodeDragging),t.attributionOptions!==e.attributionOptions&&this._setAttributionOptions(e.attributionOptions,e.attribution))},$g.prototype._setMapDragging=function(t){if(this._map){var e=t?"enable":"disable";this._map.dragging[e]()}},$g.prototype._fromLatLngToPoint=function(t,e){return this._map.options.crs.latLngToPoint(this.L.latLng(t,e),ni)},$g.prototype._fromPointToLatLng=function(t,e){var r=this._map.options.crs.pointToLatLng(this.L.point({x:t,y:e}),ni);return{latitude:r.lat,longitude:r.lng}},$g.prototype._updateSizes=function(){this._enabled&&this._projection&&this._projection.updateAll()},$g.prototype.enable=function(t){return this.setEnabled(!0,t)},$g.prototype.getMap=function(){return this._enabled?this._map:null},$g.prototype.getOptions=function(){return this._enabled?I(I({},this._settings),{tiles:I({},this._settings.tiles)}):I({},oi)},$g.prototype.setOptions=function(t){if(this._enabled){!function(t,e){void 0===t&&(t={});var r=t.tileUrlSubdomains,i=t.tileUrlTemplate,n=t.attribution,o=t.attributionOptions,a=t.latitudePath,s=t.longitudePath,u=t.sizeRatio,l=t.tiles;if(null!=i&&"string"!=typeof i)throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(null!=r&&"string"!=typeof r)throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(null!=l){if(!(J(l)||l instanceof e.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");var d=l;if(null!=d.url&&"string"!=typeof d.url)throw new TypeError("Geo mode: tiles.url must be a string");if(null!=d.subdomains&&"string"!=typeof d.subdomains)throw new TypeError("Geo mode: tiles.subdomains must be a string");if(d.tms&&"boolean"!=typeof d.tms)throw new TypeError("Geo mode: tiles.tms must be a boolean");if(d.wms&&"boolean"!=typeof d.wms)throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(null!=n&&"string"!=typeof n)throw new TypeError("Geo mode: Map attribution must be a string");if(null!=o&&!J(o))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(null!=a&&"string"!=typeof a&&!Array.isArray(a))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(null!=s&&"string"!=typeof s&&!Array.isArray(s))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(null!=u&&(!isFinite(u)||u<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}(t,this.L);var e=this._settings;this._settings=I(I(I({},oi),t),{tiles:function(t,e){if(void 0===e&&(e={}),void 0===e.tiles||e.tileUrlTemplate||e.tileUrlSubdomains){var r=oi.tiles;return I(I(I({},e.tiles||{}),oi.tiles),{url:e.tileUrlTemplate||r.url,subdomains:e.tileUrlSubdomains||r.subdomains})}return J(e.tiles)?I(I({},t.tiles),e.tiles):e.tiles}(oi,t)}),this._onSettingsChanged(e,this._settings)}},$g.prototype.disable=function(t){return this.setEnabled(!1,t)},$g.prototype.isEnabled=function(){return this._enabled},$g.prototype.toggle=function(t){return void 0===t&&(t={}),this.setEnabled(!this._enabled,t)},$g.prototype.getContainerCoords=function(t){var i=this;return t.getGeoCoordinates().map(function(t){var e=t.latitude,r=t.longitude;return i._map.latLngToContainerPoint([e,r])})},$g.prototype.setEnabled=function(value,t){var e=this;if(!si())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||value===this._enabled)return Promise.resolve();var r=this._settingsModule;this._enabled||(this._prevSettings=r.get()),this._enabled=value,this._transition=!0,this.setOptions(t);var i=this._settings;return value?(this._nodeDraggingSetting=!!r.get("interactions.drag.enabled"),this._setDragging(!i.disableNodeDragging),this._show().then(function(){return e._registerTextStyle(),e._setDragging(!i.disableNodeDragging),e._transition=!1,e._updating=!1,e._events.fire(be.GEO_ENABLED),e._events.fire(be.GEO_READY),e._adjustMinvisibleSizes()})):this._hide().then(function(){return e._transition=!1,e._events.fire(be.GEO_DISABLED),e._setDragging(e._nodeDraggingSetting,!0),e._restoreTextStyle()})},$g.prototype.destroy=function(){return this._enabled&&this._destroyMapSync(),Promise.resolve()},$g.prototype._registerTextStyle=function(){var n,t,o,e=this;this._edgesOriginalTextStyle=pi(this._graph.getEdges()),this._nodesOriginalTextStyle=(n=this._graph.getNodes(),t=n.getAttributes(["text.minVisibleSize","text.size","text.scale","radius"]),o={},t.forEach(function(t,e){var r=t.text,i=t.radius;o[n.get(e).getId()]={"text.minVisibleSize":r.minVisibleSize,"text.size":r.size,"text.scale":r.scale,minVisibleSize:r.minVisibleSize,size:Math.max(1,Number(i))}}),o);var r=this._hover.getHoverClassDefinition(),i=r.nodeAttributes,a=r.edgeAttributes;this._hoverEdgesOriginalTextStyle=a||void 0,this._hoverNodesOriginalTextStyle=i||void 0,this._hover.updateEdgeAttributes({text:{size:function(t){return e._edgesOriginalTextStyle[t.getId()]["text.size"]}}}),this._hover.updateNodeAttributes({text:{size:function(t){return e._nodesOriginalTextStyle[t.getId()]["text.size"]}}})},$g.prototype._restoreTextStyle=function(){var t,r,e,i=this;return this._hoverEdgesOriginalTextStyle&&this._hover.updateEdgeAttributes(this._hoverEdgesOriginalTextStyle,!0),this._hoverNodesOriginalTextStyle&&this._hover.updateNodeAttributes(this._hoverNodesOriginalTextStyle,!0),Promise.all([(t=this._graph.getEdges(),r=this._edgesOriginalTextStyle,e=t.getId().map(function(t){var e=r[t]||{};return Number(e["text.size"])}),t.setAttribute("text.size",e))]).then(function(){return i._edgesOriginalTextStyle=pi(i._graph.edgeList()),Promise.resolve()})},$g.prototype._setDragging=function(t,e){void 0===e&&(e=!1),this._settingsModule.update({interactions:{drag:{enabled:t,applyResult:e}}})},$g.prototype._setAttributionOptions=function(t,e){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),J(t)){this._attribution.setPrefix(""),t.position=t.position||"bottom-right";var r=t.position.replace("-","");this._attribution.setPosition(r);var i=this._attribution.getContainer();i&&(t.className&&this.L.DomUtil.addClass(i,t.className),Kg(i,t.position||"bottom-right",t.horizontalMargin,t.verticalMargin))}null!=e&&this._attribution.addAttribution(e)},$g.prototype._nodeIsVisible=function(t){return e=t,r=this._settings,i=this._hasCustomProjection(),n=r.longitudePath,o=r.latitudePath,a=r.wrapCoordinates,s=e.getData(n),u=e.getData(o),null!=s&&null!=u&&(!(!a&&!i)||Math.abs(u)<=ii&&Math.abs(s)<=180);var e,r,i,n,o,a,s,u},$g.prototype._updateSettingsForMap=function(){var t=this._graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);t[3]=0,this._settingsModule.update({backgroundColor:Ni(t),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})},$g.prototype.getGraphPosition=function(t){var e,r=this.L.latLngBounds((e=[[1/0,1/0],[-1/0,-1/0]],t.getGeoCoordinates().reduce(function(t,e){var r=e.latitude,i=e.longitude,n=t[0],o=t[1];return n[0]=Math.min(n[0],r),n[1]=Math.min(n[1],i),o[0]=Math.max(o[0],r),o[1]=Math.max(o[1],i),t},e)));return{center:0<t.size?r.getCenter():this.L.latLng([0,0]),zoom:this._clampZoom(this._map.getBoundsZoom(r))}},$g.prototype._initMap=function(){this._updateSettingsForMap(),this._mapContainer=function(t){var e=yt().createElement("div");e.className="ogma-geo-container",e.style.width=e.style.height="100%";var r=t||fi;return r.insertBefore(e,r.firstChild),e}(this._dom.getContainer());var t=I(I({},ai),{minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel});this._hasCustomProjection()&&(t.crs=this._settings.crs,t.worldCopyJump=!1,t.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,t),this._hasCustomProjection()||this._map.setMaxBounds(this.L.latLngBounds([[ii,-180],[-ii,180]])),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()},$g.prototype._clampZoom=function(t){var e=this._tileLayer.options.maxZoom;return void 0===e&&(e=1/0),Math.min(t,e)},$g.prototype._show=function(){var u=this;return this._filter=this._filters.addNodeFilter(function(t){return u._nodeIsVisible(t)}),this._filter.whenApplied().then(function(){u._initMap();var t=u._graph.getNodes(),e=u._graph.getEdges(),r=u.getGraphPosition(t),i=r.center,n=r.zoom,o=u._transformToGeo(),a=o.offset,s=o.newCameraView;return u._camera.setView(s,{ignoreZoomLimits:!0}).then(function(){return u._updatePrevNodesCoordinates(t),u._map.setView(i,n,{animate:!1}),u._graphics.animate({nodes:t,edges:e},function(){u._projection=u._createFinalPositionLayer()},u._settings.duration)}).then(function(){return a.destroy()})})},$g.prototype._hasCustomProjection=function(){return null!=this._settings.crs},$g.prototype._setupLayers=function(){var t=this;this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution)),this._layer=new this.L.OgmaOverlay({container:this._graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:function(){return t._onMapUpdate()}}),this._layer.addTo(this._map)},$g.prototype._adjustMinvisibleSizes=function(){return Promise.all([function(t,a,s){if(!a||!Object.keys(a).length)return Promise.resolve();var e=t.getId().map(function(t){var e=Number(a[t]["text.minVisibleSize"]),r=Number(a[t].minVisibleSize),i=Number(a[t]["text.size"]),n=Number(a[t]["text.scale"]),o=Number(a[t].size)*n*s;return o<=r||o<=e?0:i});return t.setAttribute("text.size",e)}(this._graph.getEdges(),this._edgesOriginalTextStyle,this._map.getZoom())])},$g.prototype._hide=function(){var t=this;if(!this._map)return Promise.resolve();this._settingsModule.update(this._prevSettings),this._map.removeLayer(this._layer);var e=this._dom.getContainer(),r=this._graphics.getDomElement();e&&e.appendChild(r),this._map.getContainer().style.zIndex="0";var i=this._graph.getNodes("all"),n=this._graph.getEdges("all"),o=this._transformToGraph(),a=o.offset,s=o.newCameraView;return this._camera.setView(s||{}).then(function(){return Promise.all([Wt(t._map.getContainer(),1,0,t._settings.duration/2).then(function(){return t._destroyMapSync()}),t._graphics.animate({nodes:i,edges:n},function(){return a&&a.destroy()},t._settings.duration)])}).then(function(){return t._map=null,t._filter.destroy()})},$g.prototype._destroyMapSync=function(){if(this._map){this._layer&&this._layer._map&&this._map.removeLayer(this._layer),this._map.remove(),this._map._animatingZoom=!1,this._map=null;var t=this._mapContainer.parentNode;t&&t.removeChild(this._mapContainer)}},$g.prototype._transformToGeo=function(){var r=this,t=Gg(this._graph.getNodes(),this._camera,this._locate,function(t,e){return r._fromLatLngToPoint(t,e)}),e=t.offsetChanges,i=t.camera;return{offset:this._addGraphAttributesLayer(e),newCameraView:i}},$g.prototype._addGraphAttributesLayer=function(t){return this._graphics.addAttributeLayer(I({priority:6,nodeSelector:function(t){return t.isVisible()},edgeSelector:function(t){return t.isVisible()}},t))},$g.prototype._transformToGraph=function(){var t=this,e=function(t,e,r,i){var n=t.getAttributes(["x","y","radius"]),o=t.getBoundingBox(),a=0===t.size,s=t.reduce(function(t,e,r){return t[e._index]=r,t},{});i();var u=t.getAttribute("x"),l=t.getAttribute("y"),d=t.getAttribute("radius").map(Number),h=new aa({xValues:u,yValues:l,scaledSizeValues:d.map(function(t){return 2*t})});a&&(o.reset(),h.reset());var c,f,g=h.cx-o.cx,p=h.cy-o.cy,_=0,v=0,m=r.computeConfigForBounds(h),y=e.zoom/m.zoom;return f=isNaN(o.cx)||isNaN(o.cy)?(o.cx=e.x,o.cy=e.y,c=m.x,m.y):(g+=(o.cx-e.x)*y,p+=(o.cy-e.y)*y,_=o.cx+g,v=o.cy+p,c=(e.x+g-_)*y+_,(e.y+p-v)*y+v),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:function(t){return(n[s[t._index]].x+g-_)*y+_},y:function(t){return(n[s[t._index]].y+p-v)*y+v}}},camera:I({zoom:m.zoom,x:c,y:f,angle:0},e.getSize())}}(this._graph.getNodes("all"),this._camera,this._locate,function(){t._projection&&(t._projection.destroy(),t._projection=null)}),r=e.offsetChanges,i=e.camera;return{offset:this._addGraphAttributesLayer(r),newCameraView:i}},$g.prototype.getPointFromLatLng=function(t){var e=t.getGeoCoordinates(),r=e.latitude,i=e.longitude;return null==r?t.getAttributes(["x","y"]):this._fromLatLngToPoint(r,i)},$g.prototype._createFinalPositionLayer=function(){var e=this;return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:function(t){return Number(t.getAttribute("radius"))*e._settings.sizeRatio},x:function(t){return e.getPointFromLatLng(t).x},y:function(t){return e.getPointFromLatLng(t).y}},edgeAttributes:{scalingMethod:"fixed",width:function(t){return Number(t.getAttribute("width"))*e._settings.sizeRatio}}})},$g.prototype.setCenter=function(t,e){return this._enabled?this.setView(t,e,ui(this._camera.getZoom())):Promise.resolve()},$g.prototype.setZoom=function(e){var r=this;return this._enabled?(e=this._clampZoom(e),this._map.setZoom(e),new Promise(function(t){if(r._map.getZoom()===e)return t();r._map.once("moveend zoomend",t)}).then(this._onMapUpdate)):Promise.resolve()},$g.prototype.zoomIn=function(){return this.setZoom(this.getZoom()+1)},$g.prototype.zoomOut=function(){return this.setZoom(this.getZoom()-1)},$g.prototype.setView=function(t,e,r){var i=this;if(!this._enabled)return Promise.resolve();r=this._clampZoom(r);var n=this.L.latLng([t,e]);return this._map.setView(n,r,{animate:!1}),new Promise(function(t){if(i._map.getZoom()===r&&i._map.getCenter().equals(n))return t();i._map.once("moveend zoomend",t)}).then(this._onMapUpdate)},$g.prototype.getView=function(){if(this._enabled){var t=this._map.getCenter();return{zoom:this._map.getZoom(),latitude:t.lat,longitude:t.lng}}},$g.prototype.getCenter=function(){if(this._enabled){var t=this._map.getCenter();return{latitude:t.lat,longitude:t.lng}}},$g.prototype.getZoom=function(){if(this._enabled)return this._map.getZoom()},$g.prototype.resetCoordinates=function(){if(this._enabled&&this._projection){var t=this._graph.getNodes();this._restorePrevNodesCoordinates(this._graph.getNodes());var e=this._graph.getNodeAttribute(ei).getMultiple(t._indexes),r=this._graph.getNodeAttribute(ri).getMultiple(t._indexes);t.setData(this._settings.latitudePath,e),t.setData(this._settings.longitudePath,r),this._projection.update()}},$g.prototype.getUnprojectedCoordinates=function(t){this._projection&&this._projection.destroy();var e=t.getPosition();return this._projection=this._createFinalPositionLayer(),e},Object.defineProperty($g.prototype,"latitudePath",{get:function(){return this._settings.latitudePath},enumerable:!0,configurable:!0}),Object.defineProperty($g.prototype,"longitudePath",{get:function(){return this._settings.longitudePath},enumerable:!0,configurable:!0}),$g.prototype.exportBackground=function(t){var e=this,r=En();r.width=t.width,r.height=t.height;var i=r.getContext("2d");if(!i)throw new Error("Unable to get 2d context from  "+r);var n=this._map.getSize(),o=this.getView(),a=I({zoom:ui(t.zoom)},this._fromPointToLatLng(t.x,t.y)),s={x:(n.x-t.width)/2,y:(n.y-t.height)/2},u=new this.L.Canvas;this._map.addLayer(u);var l=jg(this._layer,this._map,i,this.L,s,u),d=l.vectorMap,h=l.tileLayers,c=l.vectorLayers,f=l.imageOverlays,g=l.markers,p=this._map.options.zoomSnap;return this.setView(a.latitude,a.longitude,a.zoom).then(function(){return e._map._onResize()}).then(function(){return P(x(d,h,f,c,g))}).then(function(){e._map._onResize(),e.setView(o.latitude,o.longitude,o.zoom),e._map.options.zoomSnap=p}).then(function(){return new Promise(function(t){return e.L.Util.requestAnimFrame(t)})}).then(function(){return e._map.removeLayer(u)}).then(function(){return r})},$g);function $g(t){var e,r=t.camera,i=t.graph,n=t.settings,o=t.filters,a=t.events,s=t.hover,u=t.dom,l=t.graphics,d=t.locate,h=Qg.call(this)||this;return h._enabled=!1,h._settings=I({},oi),h._nodeDraggingSetting=!1,h._transition=!1,h._attribution=null,h._updating=!1,h._updateRate=50,h._x=0,h._y=0,h._onCameraUpdate=function(){if(h.L&&h._enabled&&h._map&&h._map._loaded){var t=h._x-h._camera.x,e=h._y-h._camera.y;if(t||e){h._updating||(h._updating=!0,h._layer.setLocked(!0),h._map._moveStart(!0,!1));var r=h._fromPointToLatLng(h._camera.x,h._camera.y),i=ui(h._camera.zoom),n=h.L.latLng(r.latitude,r.longitude);h._map._move(n,i,{pinch:!0,round:!1}),clearTimeout(h._updateRequest),h._updateRequest=h._dom.setTimeout(function(){h._updating=!1,h._layer.setLocked(!1),h._map&&h._map._move(n,i,{pinch:!0})._moveEnd(!0)},h._updateRate)}}},h._onNodesDragStart=function(){h._enabled&&(h._setMapDragging(!1),h._nodeDragOffsetX=h._nodeDragOffsetY=0)},h._onNodesDragged=function(t){var e=t.nodes,n=t.dx,o=t.dy;if(h._enabled){var r=e.map(function(t){var e=t.getAttributes(["x","y"]),r=e.x,i=e.y;return h._fromPointToLatLng(r+n-h._nodeDragOffsetX,i+o-h._nodeDragOffsetY)});return h._nodeDragOffsetX=n,h._nodeDragOffsetY=o,e.setGeoCoordinates(r)}return Promise.resolve(h._graph.nodeList())},h._onMapUpdate=function(){var t=h._map.getCenter(),e=t.lat,r=t.lng,i=h._fromLatLngToPoint(e,r);h._x=i.x,h._y=i.y;var n,o=(n=h._map.getZoom(),Math.pow(2,n-ni));return h._camera.setView({zoom:o,x:i.x,y:i.y},{ignoreZoomLimits:!0}).then(function(){return h._adjustMinvisibleSizes()})},h._graph=i,h._camera=r,h._settingsModule=n,h._filters=o,h._events=a,h._dom=u,h._graphics=l,h._locate=d,h._hover=s,a.register(["geoEnabled","geoDisabled","geoLoaded","geoReady"]),si()&&(h.L=C("L")||C("leaflet"),h.L&&function(a){a.TileLayer.prototype.getUrl=function(){return this._url},a.ImageOverlay.prototype.getUrl=function(){return this._url};var r="leaflet-zoom-animated";a.OgmaOverlay||(a.OgmaOverlay=a.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:function(){}},initialize:function(t){var e=t.container;a.Util.setOptions(this,t),this._container=e},setLocked:function(value){return this._locked=value,this},onAdd:function(t){this._map=t,this.getPane().appendChild(this._container),this._wgsOrigin=a.latLng([0,0]),this._wgsInitialShift=t.project(this._wgsOrigin,this._initialZoom),a.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(a.DomUtil.addClass(this._container,r),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds:function(){var t=this.options.padding,e=this._map.getSize(),r=this._map.containerPointToLayerPoint(e.multiplyBy(-t));this._bounds=new a.Bounds(r,r.add(e.multiplyBy(1+2*t))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update:function(t){var e=this;this._updateBounds(),this._redraw(this._bounds.min,t),this._positionTimer=a.Util.requestAnimFrame(function(){e._container&&a.DomUtil.setPosition(e._container,e._bounds.min)})},_redraw:function(t,e){this.options.onUpdate()},_updateTransform:function(t,e){if(!this._locked){var r=this._map.getZoomScale(e,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),n=this._map.project(this._center,e),o=i.multiplyBy(-r).add(n).subtract(this._map._getNewPixelOrigin(t,e));a.Browser.any3d?a.DomUtil.setTransform(this._container,o,r):a.DomUtil.setPosition(this._container,o)}},_onZoom:function(t){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd:function(t){this._update(t)},_onAnimZoom:function(t){var e=t.center,r=t.zoom;this._updateTransform(e,r)},bringToFront:function(){a.DomUtil.toFront(this._container)},getEvents:function(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){a.DomUtil.removeClass(this._container,r);var e=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach(function(t){return e.style[t]=null}),a.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}(h.L)),i.createNodeAttribute({name:"geo.prevLat",storage:"float"}),i.createNodeAttribute({name:"geo.prevLng",storage:"float"}),i.createNodeAttribute({name:ei,storage:"float"}),i.createNodeAttribute({name:ri,storage:"float"}),a.on(((e={})[be.ADD_NODES]=function(t){return h._refreshOrAddNodes(t.nodes)},e[be.UPDATE_NODE_DATA]=function(t){h._enabled&&h._onDataChange(t.changes)},e[be.NODES_DRAG_PROGRESS]=h._onNodesDragged,e[[be.NODES_DRAG_START,be.LASSO_ENABLED].join(" ")]=h._onNodesDragStart,e[[be.NODES_DRAG_END,be.LASSO_DISABLED].join(" ")]=function(){return h._setMapDragging(!0)},e[be.CAMERA_MOVE]=h._onCameraUpdate,e[be.VIEW_CHANGED]=h._onCameraUpdate,e)),h}function weightedStress(t,e,r,i,n,o){for(var a=0,s=0;s<i;s++)for(var u=0;u<i;u++){var l=o[s],d=o[u];if(l!==d){var h=t[l][d]*n,c=1/(h*h);if(c){var f=e[l]-e[d],g=r[l]-r[d];a+=c*Math.pow(h-Math.sqrt(f*f+g*g),2)}}}return a}function distanceStress(t,e,r,i,n,o,a){var s=0;if(-1===n)return 0;for(var u=0;u<i;u++)for(var l=0;l<i;l++){var d=a[u],h=a[l];if(d!==h&&(d===n||h===n)){var c=t[d][h]*o,f=1/(c*c);if(f){var g=e[d]-e[h],p=r[d]-r[h];s+=f*Math.pow(c-Math.sqrt(g*g+p*p),2)}}}return s}function constrainedStress(t,e,r,i,n,o,a,s){a=a||0;for(var weightedStress=0,distanceStress=0,u=0;u<i;u++)for(var l=0;l<i;l++){var d=s[u],h=s[l];if(d!==h){var c=t[d][h]*o,f=1/(c*c);if(f){var g=e[d]-e[h],p=r[d]-r[h],_=f*Math.pow(c-Math.sqrt(g*g+p*p),2);weightedStress+=_,d!==n&&h!==n||(distanceStress+=_)}}}return(1-a)*weightedStress+a*distanceStress}function stressMinimizationStep(t,e,r,i,n,o,a,s,u){a=a||0;var l=e,d=r;-1===(n=void 0===n?-1:n)&&(a=0);for(var h=e[n],c=r[n],f=0;f<i;f++){var g=s[f],p=u(t[n][f]),_=a/(p*p);if(0!==p){for(var v=0,m=0,y=0,b=e[g],x=r[g],E=0;E<i;E++){var A=s[E];if(A!==g){var S=t[g][A]*o,w=1/(S*S),T=e[A],C=r[A];if(0!=w){var M=(O=(L=b-T)*L+(N=x-C)*N)<1e-6?0:1/Math.sqrt(O);m+=(1-a)*w*(T+S*(b-T)*M),y+=(1-a)*w*(C+S*(x-C)*M)}v+=w}}var I=(1-a)*v+_;if(0!=I){var L,N,O;O=(O=(L=b-h)*L+(N=x-c)*N)<1e-6?0:1/Math.sqrt(O);var k=0===p?0:p*O*_;l[g]=(m+k*e[g])/I,d[g]=(y+k*r[g])/I}}}return{x:l,y:d}}function minHeap(o,a,s,u){void 0===o&&(o=function(t,e){return t-e}),void 0===a&&(a=[]),void 0===s&&(s={}),void 0===u&&(u=function(t){return t});var l=a.length;function e(t){for(;;){var e=2*t+1,r=1+e,i=t;if(e<l&&o(a[e],a[i])<0&&(i=e),r<l&&o(a[r],a[i])<0&&(i=r),i===t)return t;var n=a[i];a[i]=a[t],a[t]=n,s[u(a[i])]=i,s[u(n)]=t,t=i}}return{get keys(){return s},get size(){return l},heapify:e,pop:function(){if(!(l<=0)){if(1===l)return l--,a[0];var t=a[0];return a[0]=a[l-1],l--,e(0),t}},decreaseKey:function(t,value){for(void 0!==value&&(a[t]=value,s[u(value)]=t);0<t;){var e=t-1>>1;if(!(0<o(a[e],a[t])))break;var r=a[t];a[t]=a[e],a[e]=r,s[u(a[t])]=t,t=s[u(r)]=e}return t},min:function(){return a[0]},remove:function(t){return this.decreaseKey(t,Number.NEGATIVE_INFINITY),this.pop()},push:function(t){var e=++l-1;for(a[e]=t;0<e;){var r=e-1>>1;if(!(0<o(a[r],a[e])))break;var i=a[e];a[e]=a[r],a[r]=i,s[u(a[e])]=e,e=s[u(i)]=r}return e},empty:function(){return l<=0},toArray:function(){return a.slice(0,l)}}}function bellmanFord(t){var e=t.sources,r=t.targets,i=t.weights,n=t.source,o=t.target,a=t.undirected,s=void 0!==a&&a,u=t.indexes,l=t.N;if(!(l=u?u.length:l)||!isFinite(l)||0===l)throw new Error("Invalid number of nodes "+l);var d=new Float32Array(l),h=new Int32Array(l),c={},f=Number.POSITIVE_INFINITY;if(!i){i=[];for(var g=0;g<l;g++)i[g]=1}if(!u){u=new Uint32Array(l);for(g=0;g<l;g++)u[g]=g+1}for(g=0;g<l;g++)d[g]=f,h[g]=-1,c[u[g]]=g;d[c[n]]=0;var p=!1;for(g=1;g<=l;g++){for(var _=0;_<i.length;_++){var v=e[_],m=r[_],y=c[v],b=c[m];if(void 0!==y&&void 0!==b){var x=i[_],E=d[y]+x;d[y]!==f&&E<d[b]&&(d[b]=E,h[b]=v,p=!0),s&&(E=d[b]+x,d[b]!==f&&E<d[y]&&(d[y]=E,h[y]=m,p=!0))}}if(!p)break}if(p)for(g=0;g<i.length;g++){v=e[g],m=r[g],y=c[v],b=c[m];if(void 0!==y&&void 0!==b){x=i[g];if(d[y]+x<d[b])return null}}var A=null,S=null;if(void 0!==o){var w=c[o];if(void 0!==w&&d[w]!==f){A=[];for(g=o;-1!==g;g=h[c[g]])A.push(g);A=A.reverse(),S=d[w]}}return{distances:d,path:A,pathLength:S}}function dijkstra(t,e,r,i,n,o,a){var s=(i=i||t.map(function(t,e){return e+1})).length,u=new Float32Array(s),l=new Int32Array(s),d=new Uint32Array(s),h=Number.POSITIVE_INFINITY,c={};if(0===s)return{distances:u,path:null,pathLength:null};if(!n){n={};for(var f=0;f<s;f++)n[i[f]]=f}for(f=0;f<s;f++)u[f]=h,l[f]=-1,d[f]=c[f]=f;var g=minHeap(function(t,e){return u[t]-u[e]},d,c);for(u[n[e]]=0,g.decreaseKey(c[n[e]]);0!==g.size;){var p=g.pop(),_=u[p],v=t[p];if(_===h)break;f=0;for(var m=v.nodes.length;f<m;f++){var y=v.nodes[f],b=o?1:a?a(i[p],y):v.weights?v.weights[f]:1,x=n[y];if(void 0!==x){var E=_+b;E<u[x]&&(u[x]=E,l[x]=p,g.decreaseKey(c[x]))}}}var A=null,S=null;if(void 0!==r){var w=n[r];if(u[w]!==h){A=[];for(f=w;-1!==f;f=l[f])A.push(i[f]);A.reverse(),S=u[r]}}return{distances:u,path:A,pathLength:S}}function johnson(t){var e=t.sources,r=t.targets,i=t.weights,n=t.indexes,o=t.adjacency,a=t.undirected,s=t.ignoreWeights,u=Number.POSITIVE_INFINITY,l=n?n.length:o.length;if(!n){n=new Uint32Array(l);for(var d=0;d<l;d++)n[d]=d+1}var h=new Array(l),c={};for(d=0;d<l;d++){h[d]=new Float32Array(l);for(var f=0;f<l;f++)h[d][f]=d===f?0:u;c[n[d]]=d}var g=l,p=i.length;e=e.slice(),r=r.slice(),i=i.slice();for(d=0;d<l;d++)e[p+d]=g,r[p+d]=n[d],i[p+d]=0,s&&(i[d]=1);var _=bellmanFord({sources:e,targets:r,weights:i,undirected:a,N:l+1,source:g});if(null===_)throw new Error("Graph has negative weight loops");var v=_.distances;for(d=0;d<i.length;d++){var m=c[e[d]],y=c[r[d]];void 0!==m&&void 0!==y&&(i[d]=i[d]+v[m]-v[y])}e=e.slice(0,p),r=r.slice(0,p),i=i.slice(0,p);for(d=0;d<l;d++){var b=dijkstra(o,n[d],void 0,n,c,!!s).distances;for(f=0;f<l;f++)h[d][f]=d===f?0:b[f]}return h}var tp,ep,rp=(function(t){function e(t){if(!(this instanceof e))return new e(t);this.points=t||[]}function _(t,e,r){return 0<(e[0]-t[0])*(r[1]-t[1])-(e[1]-t[1])*(r[0]-t[0])}function v(t,e){return _(t,e.dest,e.orig)}function m(t,e){return _(t,e.orig,e.dest)}function y(t,e){return v(t.dest,e)}function b(t,e,r,i){if(t[0]===i[0]&&t[1]===i[1]||e[0]===i[0]&&e[1]===i[1]||r[0]===i[0]&&r[1]===i[1])return!1;var n=t[0]*t[0]+t[1]*t[1],o=e[0]*e[0]+e[1]*e[1],a=r[0]*r[0]+r[1]*r[1],s=i[0]*i[0]+i[1]*i[1],u=a-s,l=r[1]-i[1],d=r[1]*s-a*i[1],h=r[0]-i[0],c=r[0]*s-a*i[0],f=r[0]*i[1]-r[1]*i[0];return 1<t[0]*(e[1]*u-o*l+d)-t[1]*(e[0]*u-o*h+c)+n*(e[0]*l-e[1]*h+f)-e[0]*d+e[1]*c-o*f}function a(t,e,r){this.onext=t,this.rot=e,this.orig=r,this.mark=!1}function x(t,e){var r=new a(null,null,t),i=new a(null,null,null),n=new a(null,null,e),o=new a(null,null,null);return r.onext=r,n.onext=n,(i.onext=o).onext=i,(((r.rot=i).rot=n).rot=o).rot=r}function E(t,e){var r=t.onext.rot,i=e.onext.rot,n=t.onext,o=i.onext,a=r.onext;t.onext=e.onext,e.onext=n,r.onext=o,i.onext=a}function A(t,e){var r=x(t.dest,e.orig);return E(r,t.lnext),E(r.sym,e),r}function S(t){E(t,t.oprev),E(t.sym,t.sym.oprev)}e.prototype={triangulate:function(){var t=this.points;t.sort(function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]});for(var e=t.length-1;1<=e;e--)t[e][0]===t[e-1][0]&&t[e][1]===t[e-1][1]&&t.splice(e,1);if(t.length<2)return{};for(var r=function t(e){var r,i,n,o;{if(2===e.length)return{le:r=x(e[0],e[1]),re:r.sym};if(3===e.length)return r=x(e[0],e[1]),i=x(e[1],e[2]),E(r.sym,i),_(e[0],e[1],e[2])?(n=A(i,r),{le:r,re:i.sym}):_(e[0],e[2],e[1])?{le:(n=A(i,r)).sym,re:n}:{le:r,re:i.sym};for(var a=Math.ceil(e.length/2),s=t(e.slice(0,a)),u=t(e.slice(a)),l=s.le,d=s.re,h=u.le,c=u.re;;)if(m(h.orig,d))d=d.lnext;else{if(!v(d.orig,h))break;h=h.rprev}var f=A(h.sym,d);for(d.orig===l.orig&&(l=f.sym),h.orig===c.orig&&(c=f);;){var g=f.sym.onext;if(y(g,f))for(;b(f.dest,f.orig,g.dest,g.onext.dest);)o=g.onext,S(g),g=o;var p=f.oprev;if(y(p,f))for(;b(f.dest,f.orig,p.dest,p.oprev.dest);)o=p.oprev,S(p),p=o;if(!y(g,f)&&!y(p,f))break;f=!y(g,f)||y(p,f)&&b(g.dest,g.orig,p.orig,p.dest)?A(p,f.sym):A(f.sym,g.sym)}return{le:l,re:c}}}(t).le,i=[],n=0,o=[r];m(r.onext.dest,r);)r=r.onext;for(var a=r;o.push(a.sym),a.mark=!0,(a=a.lnext)!==r;);do{var s=o[n++];if(!s.mark)for(a=s;i.push(a.orig),a.sym.mark||o.push(a.sym),a.mark=!0,(a=a.lnext)!=s;);}while(n<o.length);return i}},a.prototype={get sym(){return this.rot.rot},get dest(){return this.sym.orig},get rotSym(){return this.rot.sym},get oprev(){return this.rot.onext.rot},get dprev(){return this.rotSym.onext.rotSym},get lnext(){return this.rotSym.onext.rot},get lprev(){return this.onext.sym},get rprev(){return this.sym.onext}},e.prototype.ccw=_,e.prototype.rightOf=v,e.prototype.leftOf=m,e.prototype.inCircle=b,t.exports=e}(ep={path:tp,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&ep.path)}},ep.exports),ep.exports);function ip(t){for(var e,r,i,n=t.length,o=[0,1],a=2,s=2;s<n;s++){for(;1<a&&(e=t[o[a-2]],r=t[o[a-1]],i=t[s],(r[0]-e[0])*(i[1]-e[1])-(r[1]-e[1])*(i[0]-e[0])<=0);)--a;o[a++]=s}return o.slice(0,a)}function np(t){var e=t.length;if(e<3)return null;for(var r=new Array(e),i=new Array(e),n=0;n<e;n++)r[n]=[+t[n][0],+t[n][1],n];r.sort(function(t,e){return t[0]-e[0]||t[1]-e[1]});for(n=0;n<e;n++)i[n]=[r[n][0],-r[n][1]];var o=ip(r),a=ip(i),s=a[a.length-1],u=o[o.length-1],l=a[0]===o[0],d=s===u?1:0,h=[];for(n=o.length-1;0<=n;--n)h.push(t[r[o[n]][2]]);for(n=+l;n<a.length-d;n++)h.push(t[r[a[n]][2]]);return h}function op(t,e,r,i,convexhull){if(void 0===e&&(e=1),void 0===r&&(r=0),!i||!convexhull){var n=t.map(function(t){return[t.x,t.y]});i=new rp(n.slice()).triangulate(),convexhull=np(n)}if(!convexhull)return[];for(var o,a,s,u,l,d,h,c,f,g,p=r*r,_=[],v={},m=0;m<i.length;m+=3){if(ap(convexhull,sp(i[m],i[m+1],i[m+2])))p<(E=(o=i[m],a=i[m+1],s=i[m+2],0,u=sp(o,a,s),l=u[0],d=u[1],h=o[0],c=o[1],(f=l-h)*f+(g=d-c)*g))&&(_.push(m),v[m]=E)}if(0===_.length)return[];_.sort(function(t,e){return v[t]-v[e]});var y=_[0],b=v[y],x=[];for(m=0;m<_.length;m++){var E,A=_[m];b<(E=v[A])&&p<E&&(y=A,b=E,x.push(y),x.length>e&&x.shift())}return x.map(function(t){return function(t,e,r){for(var i=arguments,n=sp(t,e,r),o=0,a=0;a<3;a++){var s=i[a],u=s[0]-n[0],l=s[1]-n[1],d=Math.sqrt(u*u+l*l);o<d&&(o=d)}return[n[0],n[1],o]}(i[t],i[t+1],i[t+2])})}function ap(t,e){for(var r=t.length,i=t[r-1],n=e[0],o=e[1],a=i[0],s=i[1],u=!1,l=0;l<r;l++){var d=t[l],h=d[0],c=d[1];o<c!=o<s&&n<(a-h)*(o-c)/(s-c)+h&&(u=!u),a=h,s=c}return u}function sp(t,e,r){var i=[(t[0]+e[0])/2,(t[1]+e[1])/2],n=[(e[0]+r[0])/2,(e[1]+r[1])/2],o=-1/((e[1]-t[1])/(e[0]-t[0])),a=-1/((r[1]-e[1])/(r[0]-e[0])),s=i[1]-o*i[0],u=(s-(n[1]-a*n[0]))/(a-o);return[u,o*u+s]}function removeRadialOverlap(t){var r=t.X,i=t.Y,e=t.sizes,n=t.indexes,o=t.R,a=t.center,s=t.gap,u=void 0===s?0:s,l=t.epsilon,d=void 0===l?.001:l,h=t.maxLoops,c=void 0===h?5:h,f=t.inPlace,g=void 0===f||f,p=n.length,_=a[0],v=a[1],m=p;g||(r=r.slice(),i=i.slice());for(var y=circleCircleIntersection,b=circleSortCompare,x=n.slice().sort(function(t,e){return b(r[t],i[t],r[e],i[e],_,v)}),E=x[p-1],A=r[E],S=i[E],w=!1,T=0;T<m-1;T++){var C=T%p,M=(T+1)%p;-1===T&&(C=p-1,M=0),C=x[C],M=x[M];var I=r[C],L=i[C],N=r[M],O=i[M],k=e[C]+e[M]+u,R=b(I,L,N,O,_,v);if(-1===R&&w&&(R=1),!(o<k)){if(1===R||k-distance(I,L,N,O)>d){var F=y(_,v,o,I,L,k);if(F){var D=F[0];w=_<N&&D[0]<_,N=r[M]=D[0],O=i[M]=D[1]}}else w=!1;if(T%p==p-2){var P=x[p-1],z=x[0];if(i[P]>v&&i[z]>v&&r[P]-e[P]<r[z]+e[P]){var B=0;for(m=Math.min(p*c,m+p);i[x[P]]>v&&i[x[0]]>v&&r[x[P]]<r[x[0]]&&++B<p;){(X=x.pop())&&x.unshift(X)}}}}}var U=A-_,V=S-v,j=r[E]-_,G=i[E]-v,H=U==j?0:Math.abs(Math.acos((U*j+V*G)/(Math.sqrt(U*U+V*V)*Math.sqrt(j*j+G*G))));if(0!==H){var q=Math.sin(-H),W=Math.cos(-H),X=void 0;for(T=0;T<p;T++){X=x[T];B=r[X]-_;var Y=i[X]-v;r[X]=B*W-Y*q+_,i[X]=B*q+Y*W+v}}return{X:r,Y:i}}function up(t,e,r,i,n,o){var a=Object.create(null),s=r[t],u=s,l=0,d=s;for(var h in e){for(var c=e[h],f=0,g=0,p=0,_=c.length;p<_;p++){var v=r[c[p]];g=Math.max(g,v),f+=2*v+i}var m=f/(2*Math.PI)+g,y=g+u,b=o?l+Math.max(o,y):l*n;l=Math.max(l,m,d,b),a[h]=l,u=g}return a[0]=0,a[Number.POSITIVE_INFINITY]=l,a}function lp(t){return--t*t*t+1}function dp(t,e,r){var i=t-r[0],n=e-r[1];return i*i+n*n}function hp(t,e,r,i,n){for(var o=new Array(t.length),a=0;a<e.length;a++){var s=i[e[a]],u=i[r[a]];o[s]=o[s]||[],o[s].push(u),n&&(o[u]=o[u]||[],o[u].push(s))}return o}function cp(t,e){return-1===t[e]?e:cp(t,t[e])}function fp(t,e,r,i,n,o,a,s){if(i[t]=n,r[t])return 1;if(!e[t]){e[t]=1,r[t]=1;var u=o[t];if(u)for(var l=0,d=u;l<d.length;l++){var h=d[l];if(fp(h,e,r,i,t,o,a,s))return a.push(s[h]),1}r[t]=0}}function gp(t,e,r){for(var i=t.length,n=new Uint8Array(i),o=new Uint8Array(i),a=new Int32Array(i),s={},u=0;u<i;u++)s[t[u]]=u;var l=hp(t,e,r,s,!1);for(u=0;u<i;u++){var d=[];if(fp(u,n,o,a,-1,l,d,t)&&1<d.length){for(var h=d[0],c=1;c<d.length;c++)if(d[c]===h){d.length=c;break}return d.push(h),d.reverse()}}return!1}function pp(t,e,r,i,n,o,a){e[t]=1,i[t]=r;var s=n[t];if(s)for(var u=0,l=s;u<l.length;u++){var d=l[u];if(e[d]){if(d!==r)return i[d]=t,o.push(a[d]),1}else if(pp(d,e,t,i,n,o,a))return o.push(a[d]),1}}var _p=(vp.prototype.getCycles=function(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(var t=0;t<this.nodes.length;t++)for(this.backtrack(t,t);0!==this.visitedLength;){var e=this.visitedStack.pop();void 0!==e&&this.visited[e]&&(this.visited[e]=0,this.visitedLength--)}return this.cycles},vp.prototype.backtrack=function(t,e){var r=!1;this.stack.push(e),this.visited[e]||(this.visited[e]=1,this.visitedLength++),this.visitedStack.push(e);for(var i=0,n=this.adjacency[e]||[];i<n.length;i++){var o=n[i];if(this.removed[e]=this.removed[e]||{},!this.removed[e][o])if(o<t)this.removed[e][o]=!0;else if(o===t){for(var a=[],s=0,u=!(r=!0);s<this.stack.length;s++){var l=this.stack[s];t===l&&(u=!0),u&&a.push(this.nodes[l])}this.cycles.push(a)}else if(!this.visited[o]){var d=this.backtrack(t,o);r=r||d}}if(r)for(var h=void 0;h=this.visitedStack.pop(),this.visited[h]&&(this.visited[h]=0,this.visitedLength--),h!==e;);return this.stack.pop(),r},vp);function vp(t,e,r){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=t,this.visited=new Uint8Array(this.nodes.length);for(var i=0;i<t.length;i++)this.idToIndex[t[i]]=i;this.adjacency=hp(t,e,r,this.idToIndex)}function mp(t,e){var r=t.index[e];if(void 0===r)return-1;for(;0<=r;)e=r,r=t.parent[r];return e}function yp(t,e,r,i,n){n&&e.sort(function(t,e){return n(t)-n(e)});var o,a,s=[],u={index:{},parent:[],count:0};t.forEach(function(t){var e,r;void 0===(e=u).index[r=t]&&(e.count+=1,e.index[r]=e.parent.push(-e.count))});for(var l=0;l<e.length&&!(u.count<=1);l++){var d=mp(u,r(e[l])),h=mp(u,i(e[l]));d!==h&&0<d&&0<h&&(a=d,(o=u).parent[h]=a,--o.count,s.push(e[l]))}return s}var bp,xp=Object.freeze({__proto__:null,minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,largestEmptyCircle:op,minDisk:minDisk,removeRadialOverlap:removeRadialOverlap,convexhull:np,circlePack:function(t){var I=t.X,L=t.Y,N=t.R,O=t.center,e=t.maxSteps,r=void 0===e?1e3:e,i=t.padding,k=void 0===i?5:i,n=t.epsilon,o=void 0===n?1e-5:n,a=t.damping,R=void 0===a?2:a,F=t.pinned,s=t.indexes,u=t.onUpdate,l=t.pushSmallerOut,D=void 0===l||l,P=s?s.length:I.length,z=s;if(isFinite(F)||(F=-1),void 0===z){z=new Uint32Array(P);for(var d=0;d<P;d++)z[d]=d}else z=s;if(-1!==F)O=[I[F],L[F]];else if(!O){var h=0,c=0;for(d=0;d<P;d++)h+=I[z[d]],c+=L[z[d]];O=[h/P,c/P]}var f=function(t,e){for(var r=1/0,i=-1/0,n=0;n<t.length;n++){var o=t[n],a=e?e[o]:o;r=Math.min(a,r),i=Math.max(a,i)}return{min:r,max:i}}(z,N),B=f.min,U=f.max;function g(t,e){for(var r=0,i=0;i<P-1;i++)for(var n=i+1;n<P;n++)if(i!==n){var o=z[i],a=z[n],s=I[o],u=L[o],l=N[o],d=I[a],h=L[a],c=N[a],f=d-s,g=h-u,p=f*f+g*g;if(p<(E=l+c+k)*E-t){var _=(E-Math.sqrt(p))*e,v=1/p,m=(A=f*v*_)*A+(S=g*v*_)*S;if(a!==F)r+=m*(C=l/B),I[a]+=A*C,L[a]+=S*C;if(o!==F)r+=m*(C=c/B),I[o]-=A*C,L[o]-=S*C}}var y=t*R*(1-e),b=O[0],x=O[1];for(i=0;i<P;i++){if((o=z[i])!==F){var E,A,S,w=I[o],T=L[o],C=(E=N[o])/U,M=D?y*C:y;r+=m=(A=(w-b)*M)*A+(S=(T-x)*M)*S,I[o]-=A,L[o]-=S}}return r}z.sort(function(t,e){return N[e]*dp(I[e],L[e],O)-N[t]*dp(I[t],L[t],O)});var p=0,_=0,v=lp(1/P);for(d=0;d<r&&(p=g(v,lp((d+1)/r)),u&&setTimeout(function(){return u(I,L)}),!(Math.abs(p-_)<o));d++)_=p;return{X:I,Y:L}},Quadtree:Gf,kruskal:yp,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,stressMinimizationStepGeneral:function(t,e,r,i,n,o,a,s){a=a||0;var u,l=e,d=r;-1===(n=void 0===n?-1:n)&&(a=0);for(var h=0;h<i;h++){for(var c=s[h],f=0,g=0,p=0,_=e[c],v=r[c],m=0;m<i;m++){var y=s[m],b=0;if(y!==c){var x=0,E=t[c][y]*o,A=1/(E*E);c!==n&&y!==n||(x=A);var S=(1-a)*A+a*x;if(f+=S,0!=A){var w=e[y],T=r[y],C=_-w,M=v-T,I=C*C+M*M;1e-6<I&&(b=1/Math.sqrt(I)),g+=S*(w+E*(_-w)*b),p+=S*(T+E*(v-T)*b)}}}0!==(u=f)&&(l[c]=g/u,d[c]=p/u)}return{x:l,y:d}},detectCyclesUndirected:function(t,e,r,i){void 0===i&&(i=!1);for(var n,o,a,s,u=new Int32Array(t.length),l={},d=0;d<t.length;d++)u[d]=-1,l[t[d]]=d;for(d=0;d<e.length;d++){var h=l[e[d]],c=l[r[d]];if(i&&h===c)return!0;var f=cp(u,h),g=cp(u,c);if(f===g)return!0;o=g,0,a=cp(n=u,f),s=cp(n,o),n[a]=s}return!1},detectCyclesDirected:gp,detectCyclesUndirectedDFS:function(t,e,r){for(var i=t.length,n=new Uint8Array(i),o=new Int32Array(i),a={},s=0;s<i;s++)o[a[t[s]]=s]=-1;var u=hp(t,e,r,a,!0);for(s=0;s<e.length;s++){var l=a[e[s]],d=a[r[s]];u[l]=u[l]||[],u[l].push(d)}for(s=0;s<i;s++){if(!n[s]&&pp(s,n,-1,o,u,[],t))return!0}return!1},CyclesFinder:_p}),Ep=(b(Ap,bp=Ee),Ap.prototype.shortestPath=function(t){void 0===t&&(t={source:void 0,target:void 0});var e=t.source,r=t.target,i=t.directed,n=void 0!==i&&i,o=t.filter,a=void 0===o?"visible":o,s=t.edgeCostFunction,u=void 0===s?function(){return 1}:s,l=t.heuristicFunction,d=void 0===l?function(){return 0}:l,h=this._graph.getNode(e),c=this._graph.getNode(r);if(!h)throw new Error("the source is not a node");if(!c)throw new Error("the target is not a node");var f=h._index,g=c._index,p=null;if(f===g)p={nodes:h.toList(),edges:this._graph.edgeList()};else{var _=this._graph.getNodeMaxIndex()+1,v=new Int32Array(_),m=new Float32Array(_),y=new Float32Array(_),b=new Set,x=new ea(y);for(m.fill(1/0),y.fill(1/0),v.fill(-1),x.add(f),m[f]=0,y[f]=d(h,c);!x.isEmpty();){var E=x.removeMin();if(E===g){p=this._constructPath(v,f,g);break}b.add(E);var A=this._graph.getAdjacentDirections(E);if(A)for(var S=0;S<A.length;++S){for(var w=A[S],T=this._graph.getEdgeIndexesInDirection(w),C=-1,M=0,I=-1,L=0;L<T.length;++L){var N=T[L],O=this._sourceList.get(N),k=this._targetList.get(N);if(O!==k&&!(n&&E!==O||"visible"===a&&this._excludedList.get(N)||"raw"===a&&this._virtualList.get(N))){var R=u(this._edgeList.get(N));(-1===C||R<M)&&(C=N,M=R,I=O===E?k:O)}}if(-1!==I||b.has(I)){var F=m[E]+M;if(!x.has(I)||F<m[I]){var D=this._nodeList.get(E);v[I]=C,m[I]=F,y[I]=F+d(D,c),x.add(I)}}}}}return Promise.resolve(p)},Ap.prototype._constructPath=function(t,e,r){for(var i=[r],n=[],o=r;o!==e;){var a=t[o],s=this._sourceList.get(a),u=this._targetList.get(a);o=o===s?u:s,i.push(o),n.push(a)}return i.reverse(),n.reverse(),{nodes:this._graph.nodeList(new Uint32Array(i)),edges:this._graph.edgeList(new Uint32Array(n))}},Ap.prototype.detectCycle=function(t,e){var r=e.getSource(),i=e.getTarget(),n=gp(t._indexes,r._indexes,i._indexes);return n?this._graph.nodeList(new Uint32Array(n)).dedupe():this._graph.nodeList()},Ap.prototype.getAllSimpleCycles=function(t,e){var r=this,i=e.getSource(),n=e.getTarget();return new _p(t._indexes,i._indexes,n._indexes).getCycles().map(function(t){return r._graph.nodeList(new Uint32Array(t))})},Ap.prototype.minimumSpanningTree=function(t,e,i){var n=this._graph;t=n.getNodes(t),e=n.getEdges(e);var r=new Set;t.forEach(function(t){return r.add(t._index)});var o=n.getConnectedComponents(t,{filter:function(t){return r.has(t)},internalIndexes:!0}),a={};o.forEach(function(t,e){return t.forEach(function(t){return a[t]=e})});var s=[];return e.forEach(function(t){var e=a[t.getSource()._index];void 0!==e&&(void 0===s[e]&&(s[e]=[]),s[e].push(t._index))}),o.map(function(t,e){var r=yp(t,s[e]||[],function(t){return n.edge(t).getSource()._index},function(t){return n.edge(t).getTarget()._index},i?function(t){return i(n.edge(t))}:void 0);return{nodes:n.nodeList(new Uint32Array(t)),edges:n.edgeList(new Uint32Array(r))}})},Ap);function Ap(t){var e=t.graph,r=bp.call(this)||this;return r._graph=e,r._nodeList=e.getNodeAttribute("object"),r._edgeList=e.getEdgeAttribute("object"),r._sourceList=e.getEdgeAttribute("source"),r._targetList=e.getEdgeAttribute("target"),r._excludedList=e.getEdgeAttribute("excluded"),r._virtualList=e.getEdgeAttribute("virtual"),r}var Sp,wp=(b(Tp,Sp=Ee),Tp.prototype._addAttributeLayer=function(){return this._graphics.addAttributeLayer({name:"curvature",priority:2,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:function(t,e){var r,i=e.edgesAlwaysCurvy,n=e.directedEdges,o=t.getSource()===t.getTarget(),a=t.getParallelEdges(),s=a.indexOf(t);if(-1===s)return 0;if(o)r=s+1;else{var u=t.getSource(),l=a.size;if(1===l&&!i)return 0;if(n){for(var d=0,h=0;h<s;++h)a.get(h).getSource()===u&&(d+=1);r=d+1}else{var c=u!==a.get(0).getSource();r=l%2!=1||i?(1+(s/2|0))*(s%2==0?1:-1)*(c?-1:1):0===s?0:((s+1)/2|0)*(s%2==0?1:-1)*(c?-1:1)}}return r}}})},Tp);function Tp(t){var e=t.settings,r=t.graphics,i=Sp.call(this)||this;return i._context={edgesAlwaysCurvy:!1,directedEdges:!1},i._settings=e,i._graphics=r,i._attributeLayer=i._addAttributeLayer(),e.register("edgesAlwaysCurvy",!1,function(value){i._context.edgesAlwaysCurvy=value,i._attributeLayer.updateAll()}),e.register("directedEdges",!1,function(value){i._context.directedEdges=value,i._attributeLayer.updateAll()}),i}function Cp(){return{}}function Mp(){}function Ip(){return!1}function Lp(){}function Np(){}function Op(){}var kp,Rp=(b(Fp,kp=ua),Fp.prototype.configure=function(t){this._onStart=t.onStart||Np,this._onEnd=t.onEnd||Op,this._update=t.update||Mp,this._onUpdate=t.onUpdate||Lp,this._createContext=t.context||Cp,this._isRunning=t.isRunning||Ip},Fp.prototype.setData=function(t){this._data=t},Fp.prototype.getData=function(){return this._data},Fp.prototype.onStart=function(){return this.fire("start",{target:this}),this._onStart.call(this),this},Fp.prototype.stop=function(){},Fp);function Fp(t,e,r){var i=kp.call(this)||this;return i._complete=!1,i._data=null,i._dependencies=e,i._dom=r,i.configure(t),i}var Dp,Pp=(b(zp,Dp=Rp),zp.prototype.sync=function(t){var e=t.data.isRunning,r=t.data.result,i=this._onUpdate.call(this,r,this._dependencies,e);return this.fire("update",{target:this,isRunning:e}),e?this.send(i):this.stop(r)},zp.prototype.stop=function(t){return this._complete||(this._onEnd.call(this,t,this._dependencies),this._worker.terminate(),this.fire("stop",{target:this})),this._complete=!0,this},zp.prototype.send=function(t){return this._worker.postMessage(Po(t)),this},zp);function zp(t,e,r){var i=Dp.call(this,t,e,r)||this,n=[function(t){void 0===t&&(t={});for(var e=Object.keys(t),r=[],i=0,n=e.length;i<n;i++){var o=e[i],a=t[o];if("function"!=typeof a)throw new Error('Asynchronous task: dependency "'+o+'" is not found');var s=Vp(a);s?(r.push(Up(a,o)),s!==o&&r.push("var "+o+" = "+s+";")):r.push("var "+o+" = "+Up(a,o)+";")}return r.join("\n")}(t.imports),"","","var __CONTEXT = ("+i._createContext.toString()+")();","var __UPDATE_FUNC = "+i._update.toString()+";","var __IS_RUNNING_FUNC = "+i._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result    = __UPDATE_FUNC(evt.data, __CONTEXT);","  var isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");return i._worker=zo(n),i._worker.addEventListener("message",function(t){i._dom.isDestroyed()||i.sync(t)}),i}var Bp=/^function\s*\(/;function Up(t,e){var r=t.toString();return Bp.test(r)?"function "+(t.name||e)+" "+r.substring(r.indexOf("(")):r}function Vp(t){var e=t.toString();return t.name?t.name:Bp.test(e)?null:e.substring("function ".length,e.indexOf("(")).trim()}var jp,Gp=(b(Hp,jp=Rp),Hp.prototype.sync=function(t){var e=this._update(t,this._context),r=this._isRunning(this._context,t),i=this._onUpdate.call(this,e,this._dependencies,r);this.fire("update",{target:this,isRunning:r}),r?this.send(i):this.stop(e)},Hp.prototype.send=function(t){var e=this;return this._complete||this._dom.setTimeout(function(){return e.sync(t)},0),this},Hp.prototype.stop=function(t){return this._complete||(this._onEnd(t,this._dependencies),this._complete=!0),this},Hp);function Hp(t,e,r){var i=jp.call(this,t,e,r)||this;return i._context=i._createContext(),i}var qp,Wp=(b(Xp,qp=Ee),Xp.prototype.run=function(t,e,r,i){var n=r,o=function(t,e,r){var i=t(e,r);return void 0===i&&(i=e),i}(t.configure||function(t){return t},e,i);return new(n?Pp:Gp)(t,i,this._dom).onStart().send(o)},Xp);function Xp(t){var e=t.dom,r=qp.call(this)||this;return r._dom=e,r}function Yp(t,e,r){void 0===e&&(e={}),void 0===r&&(r=!0),r||(e.edges=void 0);var i=function(t,e,r,i){if(void 0===i&&(i=t.getNodes()),!e)return r?t.nodeList():i.filter(function(t){return null===t.getMetaNode()});if(e instanceof yi)return e;if(Array.isArray(e)&&0<e.length)return t.getNodes(e);throw Error("[Layout]: 'nodes' must be a NodeList or an NodeId[]")}(t,e.nodes,e.edges),n=function(t,e,r){if(void 0===r&&(r=t.getEdges()),!e)return r;if(e instanceof $r)return e;if(Array.isArray(e)&&0<e.length)return t.getEdges(e);throw Error("[Layout]: 'edges' must be a EdgeList or a valid EdgeId[]")}(t,e.edges,function(t){if(t.size){for(var e=new Set,r=0,i=t.getId();r<i.length;r++){var n=i[r];e.add(n)}return t.getAdjacentEdges().filter(function(t){return t.getExtremities().getId().every(function(t){return e.has(t)})})}}(i));return I(I({},e),{nodes:i.concat(n.getExtremities()).dedupe(),edges:n})}var Zp,Kp="complete",Qp=500,Jp=!0,$p=!0,t_=!1,e_=(b(r_,Zp=Ee),r_.prototype.register=function(t,e){if(t in this._layouts)throw new Error("Layout "+t+" already exists");var r=I(I({},e),{name:t});this._layouts[t]=r},r_.prototype.getAvailableLayouts=function(){return Object.keys(this._layouts)},r_.prototype.start=function(u,t){var l=this;void 0===t&&(t={});var d=this._layouts[u],h=Yp(this._graph,t,-1===["radial","grid"].indexOf(u));return new Promise(function(i){if(!d)throw new Error("layout "+u+" does not exist");h.duration="number"==typeof h.duration?h.duration:Qp;var o=d.onSync;h.skipTextDrawing=void 0===h.skipTextDrawing?!!Jp:!!h.skipTextDrawing;var t=h.locate||t_;t&&"boolean"==typeof t&&(t={}),h.locate=t;var e=l._onTaskStart,a=l._onTaskUpdate,n=l._onTaskComplete,r={name:u,update:d.update,isRunning:d.isRunning,configure:d.configure,context:d.context,imports:d.imports,onStart:function(){e(d,h,this)},onUpdate:function(t,e,r){var i=t.lastUpdate||-1/0,n=Zt();r&&n-i<40||(t.lastUpdate=n,a(this,u,t,r,o,h))},onEnd:function(e){var r=this;this.once(Kp,function(t){n(r,e,t,d,h,i,r.getData())})}};l._graphics.forceAttributesComputation();var s=void 0===h.useWebWorker?!!$p:!!h.useWebWorker;l._running.push(l._tasks.run(r,h,s,l._modules))})},r_.prototype._animateCamera=function(t,e,r){if(0===t.indexes.length)return Promise.resolve();var i=this._locate.layoutDataBoundingBox(t),n=this._locate.computeConfigForBounds(i,e);return this._camera.setView(n,{duration:r,easing:e.easing})},r_.prototype.stop=function(){for(;0!==this._running.length;){var t=this._running.pop();t.stop(),t.fire(Kp,null)}return Promise.resolve()},r_.prototype.isRunning=function(){return 0!==this._running.length},r_.prototype._assignNodePositions=function(t,e,r){if(!t||r){var i=t?new Uint32Array(t.indexes):void 0,n=this._graph.nodeList(i);return Promise.resolve(n)}for(var o=t.indexes,a=t.x,s=t.y,u=this._graph.nodeList(new Uint32Array(o)),l=i_(t),d=0;d<l.length;d++)l[d]={x:a[d],y:s[d]};return u.setAttributes(l,e)},r_);function r_(t){var f=Zp.call(this)||this;return f._running=[],f._onTaskUpdate=function(t,e,r,i,n,o){var a=o.duration,s=o.onSync,u=o.onUpdate,l=o.dryRun,d=o.locate;if(s&&f._dom.setTimeout(function(){return s(r,f._modules,i)},a),n){var h=n(r,f._modules,i);f._events.fire(be.LAYOUT_COMPUTED,{type:be.LAYOUT_COMPUTED,name:e,positions:h}),u&&u(r,h,i);var c=f._assignNodePositions(h,a,l);i||(d&&f._animateCamera(h,d,o.duration),c.then(function(){return t.fire(Kp,h)}))}else i||t.fire(Kp,r)},f._onTaskComplete=function(t,e,r,i,n,o,a){for(var s=0;s<f._running.length;s++){if(f._running[s]===t){f._running.splice(s,1);break}}i.onEnd&&e&&i.onEnd(e,f._modules),n.skipTextDrawing&&f._dom.setTimeout(function(){return f._graphics.showTexts()},50);var u=f._graph.nodeList(new Uint32Array(a.indexes)),l=n.dryRun&&e?r:n_(u,f._graph),d=u.getId(),h={before:i_(a),current:i_(l)};f._events.fire(be.LAYOUT_END,{type:be.LAYOUT_END,name:i.name,positions:h,ids:d}),f._dom.setTimeout(function(){n.onEnd&&n.onEnd(e),o({name:i.name,positions:h,ids:d})})},f._onTaskStart=function(t,e,r){e.skipTextDrawing&&f._graphics.hideTexts();var i=n_(f._graph.getNodes(e.nodes),f._graph),n=i.ids;r.setData(i),f._events.fire(be.LAYOUT_START,{type:be.LAYOUT_START,name:t.name,ids:n,task:r})},f._modules=t,f._dom=t.dom,f._events=t.events,f._graph=t.graph,f._graphics=t.graphics,f._tasks=t.tasks,f._locate=t.locate,f._camera=t.camera,f._layouts={},f._events.register([be.LAYOUT_START,be.LAYOUT_END,be.LAYOUT_COMPUTED]),f._events.on(be.CLEAR_GRAPH,function(){return f.stop()}),f}function i_(t){for(var e=t.x,r=t.y,i=t.indexes.length,n=new Array(i),o=0;o<i;o++)n[o]={x:e[o],y:r[o]};return n}function n_(t,e){var r=t._indexes,i=e.getNodeAttribute("x").getMultiple(r),n=e.getNodeAttribute("y").getMultiple(r);return{ids:t.getId(),indexes:r,x:i,y:n}}function o_(value){return"number"==typeof value&&isFinite(value)}var a_=(s_.prototype.onUpdate=function(t){this._onUpdateHandlers.push(t)},s_.prototype.getPropertyInfo=function(){return this._info},s_.prototype.getPath=function(){return this._path.slice()},s_.prototype.destroy=function(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)},s_);function s_(t,e,r){var i=this,n=r.path,o=r.filter,a=r.unwindArrays;this._module=t,this._isNode=e,this._path=n||[],this._filter=o,this._unwindArrays=a,this._onUpdateHandlers=[],this._triggerUpdate=function(t){for(var e=0;e<i._onUpdateHandlers.length;++e)i._onUpdateHandlers[e](t)},this._info=t.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}var u_=(Object.defineProperty(l_.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),l_.prototype.onPropertyAdded=function(t){return this._onAddHandlers.push(t),this},l_.prototype.onPropertyRemoved=function(t){return this._onRemoveHandlers.push(t),this},l_.prototype.onPropertyUpdated=function(t){return this._onUpdateHandlers.push(t),this},l_.prototype.getPath=function(){return this._path.slice()},l_.prototype.getProperties=function(){return this._propertyList.slice()},l_.prototype.getPropertyInfo=function(t){var e=this._properties[t];return e?e.info:null},l_.prototype.destroy=function(){var n=this;V(this._properties,function(t,e){var r=t.handler,i=n._path.concat([e]);n._module.unwatchPropertyInformation(n._isNode,i,r,n._filter,n._unwindArrays)}),this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[];var t=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(t,1)},l_.prototype.updateSubPropertiesToWatch=function(t,e){if(t===this._isNode)for(var r=e.getData(this._path),i=0;i<r.length;i++){var n=r[i];if(B(n))for(var o=Object.keys(n),a=0;a<o.length;a++)this._addSubPropertyToWatch(o[a])}},l_.prototype._addSubPropertyToWatch=function(t){var e=this;if(!this._properties[t]){var r=this._path.concat([t]),i=function(){return e._triggerPropertyUpdate(t)},n=this._unwindArrays,o=this._isNode,a=this._filter,s=this._module.watchPropertyInformation(o,r,i,a,n);this._properties[t]={handler:i,info:s},this._triggerPropertyUpdate(t)}},l_.prototype._triggerPropertyUpdate=function(t){var e=this._properties[t].info,r=this._propertyList.indexOf(t),i=-1!==r,n="undefined"!==e.getType();!i&&n?(this._propertyList.push(t),this._triggerHandlers("_onAddHandlers",t,e),this._triggerHandlers("_onUpdateHandlers",t,e)):i&&!n?(this._propertyList.splice(r,1),this._triggerHandlers("_onUpdateHandlers",t,e),this._triggerHandlers("_onRemoveHandlers",t,e)):i&&n&&this._triggerHandlers("_onUpdateHandlers",t,e)},l_.prototype._triggerHandlers=function(t,e,r){for(var i=this[t],n=0,o=i.length;n<o;n++)i[n](e,r)},l_);function l_(t,e,r){var i=r.path,n=r.filter,o=r.unwindArrays;this._module=t,this._isNode=e,this._path=i,this._filter=n,this._unwindArrays=o,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}var d_=(h_.prototype.setWatcher=function(t){this._watcher=t},h_.prototype.isNode=function(){return this._watcher.isNode},h_.prototype.getPath=function(){return this._watcher.property.slice()},h_.prototype.getBoundaries=function(){var t=this._watcher.boundaries;return t?{min:t.min,max:t.max}:null},h_.prototype.getValues=function(){return this._watcher.values.keys()},h_.prototype.getValueCount=function(value){return this._watcher.values.get(value)||0},h_.prototype.getCount=function(){return this._watcher.total},h_.prototype.getType=function(){return 0<this._watcher.any?"any":0<this._watcher.numbers?"number":"undefined"},h_);function h_(){}function c_(t){return"number"==typeof t&&isNaN(t)}var f_=(g_.prototype.set=function(t,value){var e=this._getIndex(t);return-1===e?(this._keys.push(t.slice()),this._values.push(value),!0):(this._values[e]=value,!1)},g_.prototype.get=function(t){var e=this._getIndex(t);return-1===e?void 0:this._values[e]},g_.prototype.has=function(t){return-1!==this._getIndex(t)},g_.prototype.delete=function(t){var e=this._getIndex(t);return-1!==e&&(this._keys.splice(e,1),this._values.splice(e,1),!0)},g_.prototype.keys=function(){return this._keys.map(function(t){return t.slice()})},g_.prototype.values=function(){return this._values.slice()},g_.prototype._getIndex=function(t){for(var e=0;e<this._keys.length;e++){var r=this._keys[e];if(r.length===t.length){for(var i=!0,n=0;n<t.length;n++){var o=r[n],a=t[n];if(!(o===a||c_(o)&&c_(a))){i=!1;break}}if(i)return e}}return-1},Object.defineProperty(g_.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),g_);function g_(){this._keys=[],this._values=[]}var p_=(__.prototype.clear=function(){return this._arrays=new f_,this._map.clear()},__.prototype.delete=function(t){return M(t)?this._arrays.delete(t):this._map.delete(t)},__.prototype.get=function(t){return M(t)?this._arrays.get(t):this._map.get(t)},__.prototype.set=function(t,value){return M(t)?this._arrays.set(t,value):this._map.set(t,value),this},__.prototype.keys=function(){return x(So(this._map),this._arrays.keys())},__.prototype.values=function(){return x(wo(this._map),this._arrays.values())},Object.defineProperty(__.prototype,"size",{get:function(){return this._map.size+this._arrays.size},enumerable:!0,configurable:!0}),__);function __(){this._map=new Map,this._arrays=new f_}var v_,m_=(b(y_,v_=Ee),y_.prototype.watchNodeObjectProperty=function(t){return this._watchObjectProperty(!0,T_(t))},y_.prototype.watchEdgeObjectProperty=function(t){return this._watchObjectProperty(!1,T_(t))},y_.prototype.watchNodeNonObjectProperty=function(t){return this._watchNonObjectProperty(!0,T_(t))},y_.prototype.watchEdgeNonObjectProperty=function(t){return this._watchNonObjectProperty(!1,T_(t))},y_.prototype.watchPropertyInformation=function(t,e,r,i,n){var o=this._findWatcher(t,e,i,n)||this._createWatcher(t,e,i,n);return r&&o.onChange.push(r),o.info},y_.prototype.unwatchPropertyInformation=function(t,e,r,i,n){var o=this._findWatcher(t,e,i,n);if(o){var a=o.onChange,s=a.indexOf(r);if(-1!==s&&(a.splice(s,1),0===a.length)){var u=this._propertyWatchers.indexOf(o);this._propertyWatchers.splice(u,1)}}},y_.prototype._watchObjectProperty=function(t,e){var r=new u_(this,t,e);return this._objectPropertyWatchers.push(r),r.updateSubPropertiesToWatch(t,this._graph[t?"getNodes":"getEdges"](e.filter)),r},y_.prototype._watchNonObjectProperty=function(t,e){return new a_(this,t,e)},y_.prototype._findWatcher=function(t,e,r,i){for(var n=0;n<this._propertyWatchers.length;++n){var o=this._propertyWatchers[n];if(o.isNode===t&&o.filter===r&&o.unwindArrays===i&&E_(o.property,e))return o}return null},y_.prototype._createWatcher=function(t,e,r,i){var n={isNode:t,property:e,numbers:0,any:0,total:0,values:new p_,boundaries:null,onChange:[],filter:r,unwindArrays:i,info:new d_};return n.info.setWatcher(n),S_(n,this._graph[t?"getNodes":"getEdges"](r).getData(e)),this._propertyWatchers.push(n),n},y_);function y_(t){var e,r=t.graph,i=t.events,m=v_.call(this)||this;return m._onExcludedStateChange=function(t){for(var e=t.elements,r=!t.value,i=0,n=m._propertyWatchers.length;i<n;i++){var o=m._propertyWatchers[i];o.isNode===e.isNode&&"visible"===o.filter&&((r?S_:w_)(o,e.getData(o.property)),x_(o))}},m._onDataChange=function(t){for(var e=t.isNode,s=t.changes,r=0;r<m._propertyWatchers.length;++r){var i=(p=m._propertyWatchers[r]).property,n="all"===p.filter;if(p.isNode===e)for(var o=0;o<s.length;++o){var a=s[o],u=A_(a.property||[],i);if(u){var l=a.nodes||a.edges,d=[],h=[];if(l)for(var c=0;c<l.size;++c){var f=l.get(c);(n||f.isVisible())&&(d.push(H(a.newValues[c],u)),h.push(H(a.previousValues[c],u)))}d.length&&(S_(p,d),w_(p,h),x_(p))}}}r=0;for(var g=m._objectPropertyWatchers.length;r<g;r++){var p,_=(p=m._objectPropertyWatchers[r]).path,v=function(t){var e=s[t],r=e.property,i=e.nodes,n=e.edges,o=i||n;if(o){var a=o.isNode;(!r||r.length<=_.length+1&&_.every(function(t,e){return t===r[e]}))&&p.updateSubPropertiesToWatch(a,o)}};for(o=0;o<s.length;++o)v(o)}},m._onElementsAdded=function(t){for(var e=t.nodes||t.edges,r=0;r<m._propertyWatchers.length;++r){var i=m._propertyWatchers[r];if(i.isNode===e.isNode){var n=e.getData(i.property);n.length&&(S_(i,n),x_(i))}}for(r=0;r<m._objectPropertyWatchers.length;r++)m._objectPropertyWatchers[r].updateSubPropertiesToWatch(e.isNode,e)},m._onElementsRemoved=function(t){for(var e=t.nodes||t.edges,r=0;r<m._propertyWatchers.length;++r){var i=m._propertyWatchers[r],n="all"===i.filter;if(i.isNode===e.isNode&&n){var o=e.getData(i.property);o.length&&(w_(i,o),x_(i))}}},m._onGraphClear=function(){m._propertyWatchers.forEach(function(t){t.numbers=0,t.any=0,t.total=0,t.boundaries=null,t.values.clear()})},m._graph=r,m._propertyWatchers=[],m._objectPropertyWatchers=[],i.on(((e={})[be.EXCLUDED_STATE_CHANGE]=m._onExcludedStateChange,e[be.UPDATE_NODE_DATA+" "+be.UPDATE_EDGE_DATA]=m._onDataChange,e[be.ADD_NODES+" "+be.ADD_EDGES]=m._onElementsAdded,e[be.REMOVE_NODES+" "+be.REMOVE_EDGES]=m._onElementsRemoved,e[be.CLEAR_GRAPH]=m._onGraphClear,e)),m}function b_(value){return null==value?[]:R(value)}function x_(t){for(var e=0;e<t.onChange.length;++e)t.onChange[e](t.info)}function E_(t,e){if(t.length===e.length){for(var r=0;r<t.length;++r)if(t[r]!==e[r])return;return 1}}function A_(t,e){if(t.length>e.length)return null;for(var r=0;r<t.length;++r)if(t[r]!==e[r])return null;return e.slice(r)}function S_(t,e,r){for(var i=t.values,n=!r&&t.unwindArrays,o=0;o<e.length;++o){var value=e[o];if(r||void 0===value||(t.total+=1),n&&Array.isArray(value))S_(t,value,!0);else{var a=i.get(value);a?i.set(value,a+1):(i.set(value,1),o_(value)?(t.boundaries?value<t.boundaries.min?t.boundaries.min=value:value>t.boundaries.max&&(t.boundaries.max=value):t.boundaries={min:value,max:value},t.numbers+=1):void 0!==value&&(t.any+=1))}}}function w_(t,e,r){for(var i=t.values,n=!r&&t.unwindArrays,o=t.boundaries,a=!1,s=0;s<e.length;++s){var value=e[s];if(r||void 0===value||--t.total,n&&Array.isArray(value))a=a||w_(t,value,!0);else{var u=i.get(value);1<u?i.set(value,u-1):(i.delete(value),o_(value)?(--t.numbers,!o||o.min!==value&&o.max!==value||(a=!0)):void 0!==value&&--t.any)}}return!r&&a&&(t.boundaries=function(t){for(var e=null,r=null,i=0;i<t.length;++i){var value=t[i];o_(value)&&((null==e||value<e)&&(e=value),(null==r||r<value)&&(r=value))}return null==e||null==r?null:{min:e,max:r}}(i.keys())),a}function T_(t){return"object"!=typeof t||null===t||Array.isArray(t)?{path:b_(t),filter:"visible",unwindArrays:!1}:{path:b_(t.path),filter:"all"===(t.filter||"visible")?"all":"visible",unwindArrays:!!t.unwindArrays}}var C_,M_=(b(I_,C_=Ee),Object.defineProperty(I_.prototype,"x",{get:function(){return this._position.x||0},enumerable:!0,configurable:!0}),Object.defineProperty(I_.prototype,"y",{get:function(){return this._position.y||0},enumerable:!0,configurable:!0}),I_.prototype._later=function(){return this._dom.afterNextFrame()},I_.prototype.move=function(t){var r=this,i=t.x,n=t.y;return void 0!==i&&void 0!==n?this._dom.afterNextFrame().then(function(){var t=i-r.x,e=n-r.y;return r._events.fire(be.VIRTUAL_MOVE,{x:i,y:n,dx:t,dy:e}),r._later()}):Promise.resolve()},I_.prototype.down=function(t){var e=this,r=void 0===t?{}:t,i=r.x,n=r.y,o=r.button,a=void 0===o?$f.LEFT:o;return this.move({x:i,y:n}).then(function(){return e._events.fire(be.VIRTUAL_DOWN,{x:e.x,y:e.y,button:a}),e._events.fire(be.VIRTUAL_MOVE,{x:e.x,y:e.y,dx:0,dy:0,button:a}),e._later()})},I_.prototype.up=function(t){var e=this,r=void 0===t?{}:t,i=r.x,n=r.y,o=r.button,a=void 0===o?$f.LEFT:o;return this.move({x:i,y:n}).then(function(){return e._events.fire(be.VIRTUAL_UP,{x:i,y:n,button:a}),e._later()})},I_.prototype.click=function(t){var e=this,r=void 0===t?{}:t,i=r.x,n=r.y,o=r.button,a=void 0===o?$f.LEFT:o;return this.move({x:i,y:n}).then(function(){return e._events.fire(be.VIRTUAL_CLICK,{x:i,y:n,button:a}),e._later()})},I_.prototype.rightClick=function(t){var e=this,r=void 0===t?{}:t,i=r.x,n=r.y,o=r.button,a=void 0===o?$f.RIGHT:o;return this.move({x:i,y:n}).then(function(){return e._events.fire(be.VIRTUAL_CLICK,{x:i,y:n,button:a}),e._later()})},I_.prototype.doubleClick=function(t){var e=this,r=void 0===t?{}:t,i=r.x,n=r.y,o=r.button,a=void 0===o?$f.LEFT:o;return this.move({x:i,y:n}).then(function(){return e._events.fire(be.VIRTUAL_DOUBLE_CLICK,{x:i,y:n,button:a}),e._later()})},I_.prototype.drag=function(t,e){var r=this;return this.down(t).then(function(){return r.move(e)}).then(function(){return r.up(e)})},I_.prototype.wheel=function(t){var e=this,r=t.x,i=t.y,n=t.delta;return this.move({x:r,y:i}).then(function(){return e._events.fire(be.VIRTUAL_WHEEL,{x:r,y:i,delta:n}),e._later()})},I_);function I_(t){var e=t.position,r=t.dom,i=t.events,n=C_.call(this)||this;return n._dom=r,n._events=i,n._position=e,n._events.register([be.VIRTUAL_DOWN,be.VIRTUAL_UP,be.VIRTUAL_MOVE,be.VIRTUAL_CLICK,be.VIRTUAL_DOUBLE_CLICK,be.VIRTUAL_WHEEL]),n}function L_(t,e,r,i,n,o){var a=St(),s=o.graphToScreenCoordinates(t),u=o.graphToScreenCoordinates(e);n.beginPath(),n.moveTo(s.x*a,s.y*a),n.lineTo(u.x*a,u.y*a),n.strokeStyle=i,n.lineWidth=r,n.stroke()}function N_(t,e,r,i){for(var n,o,a=0,s=t.length-1;a<s;)n=(a+s)/2|0,o=Math.abs(e[t[n]]-r),Math.abs(e[t[1+n]]-r)<=o?a=1+n:s=n;return i?s:t[s]}function O_(t,e,r,i,n,o,a){for(var s,u,l=0,d=t.length;l<d;l++)for(var h=0;h<d;h++)if(l!==h){var c=t[l],f=t[h];h<l&&(s=f,f=c,c=s);var g=e[c],p=e[f],_=o.get(c),v=o.get(f);if(g+_<i-n&&i+n<p-v&&Math.abs(Math.abs(g+_-(i-n))-Math.abs(p-v-(i+n)))<=a)return{a:c,b:r,c:f,current:r,target:u=g+_+Math.abs(p-v-(g+_))/2,points:[g+_,u-n,u+n,p-v]};if(g+_<i-n&&p+v<i-n&&Math.abs(Math.abs(g+_-(p-v))-Math.abs(Math.max(g+_,p+v)-(i-n)))<=a)return{a:c,b:f,c:r,current:r,target:u=p+_+Math.abs(Math.abs(g+_-(p-v)))+n,points:[g+_,p-v,p+v,u-n]};if(i+n<g-_&&i+n<p-v&&Math.abs(Math.abs(g+_-(p-v))-Math.abs(Math.min(g-_,p-v)-(i+n)))<=a)return{a:r,b:c,c:f,current:r,target:u=g-_-Math.abs(Math.abs(g+_-(p-v)))-n,points:[u+n,g-_,g+_,p-v]}}return null}var k_,R_,F_={enabled:!1,tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}};(R_=k_=k_||{})[R_.NONE=0]="NONE",R_[R_.CENTER=1]="CENTER",R_[R_.LEFT=2]="LEFT",R_[R_.RIGHT=3]="RIGHT",R_[R_.TOP=4]="TOP",R_[R_.BOTTOM=5]="BOTTOM";var D_,P_=(b(z_,D_=Ee),z_.prototype.enable=function(t){var n=this;this._enabled||(this._options=Q(t,F_),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._events.on(be.NODES_DRAG_START,this._onNodeDragStart),this._events.on(be.NODES_DRAG_END,this._onNodeDragEnd),this._settings.update({"interactions.drag.onBeforeDrag":function(t,e,r,i){return n._onBeforeDrag(e,r,i)}}))},z_.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._onNodeDragStart),this._events.removeListener(this._onNodeDragEnd),this._graphics.removeCanvas(this._canvas),this._settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)},z_.prototype.enabled=function(){return this._enabled},z_.prototype._onBeforeDrag=function(t,e,r){if(this._node){var i=r[0];this._scan(i),this._node.setAttributes(i)}},z_.prototype._cacheViewportData=function(){var t=this._camera,e=t.screenToGraphCoordinates({x:0,y:0}),r=t.screenToGraphCoordinates({x:t.width,y:t.height});if(this._nodes=this._spatial.getNodesByBoundingBox(e.x,e.y,r.x,r.y),null!=this._node){var i=this._node._index,n=Array.from(this._nodes._indexes);n.splice(n.indexOf(i),1);var o=this._graph.getNodeAttribute("radius"),a=this._graph.getNodeAttribute("x"),s=this._graph.getNodeAttribute("y"),u=a.buffer(),l=s.buffer(),d=X(n.slice(),a),h=X(n.slice(),s),c={},f={};this._gridResolution=Number(this._node.getAttribute("radius"));for(var g=this._gridResolution,p=0,_=n.length;p<_;p++){var v=d[p],m=h[p],y=u[v]/g|0,b=l[m]/g|0;c[y]||(c[y]=[]),f[b]||(f[b]=[]),c[y].push(v),f[b].push(m)}this._nodesByX=d,this._nodesByY=h,this._xGrid=c,this._yGrid=f,this._xList=a,this._yList=s,this._X=u,this._Y=l,this._R=o}},z_.prototype._scan=function(t){if(An(this._canvas,this._ctx),null!=this._node){var e,r,i,n,o,a,s,u,l=this._node._index,d=t.x,h=t.y,c=this._r,f=this._options,g=this._xList,p=this._yList,_=this._R,v=this._X,m=this._Y,y=this._camera.zoom,b=Math.min(c,this._options.tolerance/y),x=2*c*f.sideSnapDistanceFactor,E=f.guidelineWidth,A=f.guidelineColor,S=l,w=l,T=null,C=!1,M=!1;if(S=N_(this._nodesByX,v,d),w=N_(this._nodesByY,m,h),Math.abs(v[S]-d)>f.centerSnapDistance&&(S=l),Math.abs(m[w]-h)>f.centerSnapDistance&&(w=l),this._xsnap=k_.NONE,S!==l){e=this._vguideline.start,r=this._vguideline.end,i=v[u=S],n=m[u],T=_.get(u),s=Math.abs(d-i);var I=Math.abs(d-c-(i-T)),L=Math.abs(d+c-(i+T));s<Math.max(c,T)&&(n<h?(e.y=n-T,r.y=h+c):(e.y=n+T,r.y=h-c),(N=Math.min(I,s,L))===s?(e.x=r.x=i,r.y=h,e.y=n,this._xsnap=k_.CENTER):Math.abs(h-n)<T+c+x&&(N===I?(e.x=r.x=i-T,this._xsnap=k_.LEFT):(e.x=r.x=i+T,this._xsnap=k_.RIGHT)),N<b&&(C=!0)),this._xsnap!==k_.NONE&&L_(e,r,E,A,this._ctx,this._camera)}if(this._ysnap=k_.NONE,w!==l){e=this._hguideline.start,r=this._hguideline.end,i=v[u=w],n=m[u],T=_.get(u),s=Math.abs(h-n);var N,O=Math.abs(h-c-(n-T)),k=Math.abs(h+c-(n+T));s<Math.max(c,T)&&(i<d?(e.x=i-T,r.x=d+c):(e.x=i+T,r.x=d-c),(N=Math.min(O,s,k))===s?(e.y=r.y=n,r.x=d,e.x=i,this._ysnap=k_.CENTER):Math.abs(d-i)<T+c+x&&(N===O?(e.y=r.y=n-T,this._ysnap=k_.TOP):(e.y=r.y=n+T,this._ysnap=k_.BOTTOM)),N<b&&(M=!0)),this._ysnap!==k_.NONE&&L_(e,r,E,A,this._ctx,this._camera)}if(null!=T&&f.preferredDistance.enabled){var R=f.preferredDistance.ratio,F=Math.min(f.preferredDistance.tolerance/y,c),D=Math.max(c,T);if(S===l||this._xsnap!==k_.NONE&&C)w!==l&&(this._ysnap===k_.NONE||!M)&&(i=v[u=w],n=m[u],T=_.get(u),(a=Math.abs(h-n)-(c+T)*(1+R))<=F&&-F<=a)&&(P=h<n?-1:1,e=this._hguideline.start,r=this._hguideline.end,e.x=i-D,r.x=i+D,e.y=r.y=n,L_(e,r,E,A,this._ctx,this._camera),e.x=d-D,r.x=d+D,e.y=r.y=n+P*(1+R)*(c+T),L_(e,r,E,A,this._ctx,this._camera),this._ysnap=k_.CENTER,M=!0);else if(i=v[u=S],n=m[u],T=_.get(u),(o=Math.abs(d-i)-(c+T)*(1+R))<=F&&-F<=o){var P=d<i?-1:1;e=this._vguideline.start,r=this._vguideline.end,e.x=r.x=i+P*(1+R)*(c+T),e.y=n-D,r.y=n+D,e.x=r.x=i,L_(e,r,E,A,this._ctx,this._camera),e.y=h-D,r.y=h+D,e.x=r.x=i+P*(1+R)*(c+T),L_(e,r,E,A,this._ctx,this._camera),this._xsnap=k_.CENTER,C=!0}}if(f.neighbours.enabled){var z=this._gridResolution,B=d/z|0,U=h/z|0,V=this._xGrid,j=this._yGrid,G=[],H=[].concat(j[U-1]||G,j[U]||G,j[1+U]||G),q=[].concat(V[B-1]||G,V[B]||G,V[1+B]||G),W=void 0;1<H.length&&(X(H,g),(W=O_(H,v,l,d,c,_,b))&&(this._drawNeighbourGuidelines(W,t,!1),C=!1)),1<q.length&&!W&&(X(q,p),(W=O_(q,m,l,h,c,_,b))&&(this._drawNeighbourGuidelines(W,t,!0),M=!1))}(C||M)&&this._snap(t,!C,!M)}},z_.prototype._drawNeighbourGuidelines=function(t,e,r){var i,n,o=t.a,a=t.b,s=t.c,u=t.points,l=t.target,d={x:0,y:0},h={x:0,y:0},c=this._R,f=this._X,g=this._Y,p=c.getMultiple([o,a,s]),_=p[0],v=p[1],m=p[2],y=this._options.neighbours,b=y.offset,x=y.lineWidth,E=y.lineColor;n=r?(e.y=l,_=-_,v=-v,m=-m,i=h.x=d.x=Math.min(f[o]+_,f[a]+v,f[s]+m)-b,f):(e.x=l,i=h.y=d.y=Math.max(g[o]+_,g[a]+v,g[s]+m)+b,g);var A=r?"y":"x",S=r?"x":"y";d[A]=u[0],h[A]=u[1],L_(d,h,x,E,this._ctx,this._camera),d[A]=u[2],h[A]=u[3],L_(d,h,x,E,this._ctx,this._camera),d[A]=u[0],d[S]=i-b/2,h[A]=u[0],d[S]=n[o]+_,L_(d,h,x,E,this._ctx,this._camera),d[A]=u[1],d[S]=i-b/2,h[A]=u[1],d[S]=n[a]+v,L_(d,h,x,E,this._ctx,this._camera),d[A]=u[2],d[S]=i-b/2,h[A]=u[2],d[S]=n[a]+v,L_(d,h,x,E,this._ctx,this._camera),d[A]=u[3],d[S]=i-b/2,h[A]=u[3],d[S]=n[s]+m,L_(d,h,x,E,this._ctx,this._camera)},z_.prototype._snap=function(t,e,r){var i,n=this._xsnap,o=this._ysnap;e||n===k_.NONE||(i=this._vguideline.end,n===k_.LEFT?t.x=i.x+this._r:n===k_.RIGHT?t.x=i.x-this._r:t.x=i.x),r||o===k_.NONE||(i=this._hguideline.end,o===k_.TOP?t.y=i.y+this._r:o===k_.BOTTOM?t.y=i.y-this._r:t.y=i.y)},z_);function z_(t){var e=t.graph,r=t.graphics,i=t.spatial,n=t.camera,o=t.events,a=t.settings,s=D_.call(this)||this;return s._options=j(F_),s._enabled=!1,s._ysnap=k_.NONE,s._xsnap=k_.NONE,s._node=null,s._nodes=null,s._r=0,s._vguideline={start:{x:0,y:0},end:{x:0,y:0}},s._hguideline={start:{x:0,y:0},end:{x:0,y:0}},s._gridResolution=0,s._onNodeDragStart=function(t){var e=t.nodes;1===e.size&&(s._node=e.get(0),s._cacheViewportData(),s._r=Number(s._node.getAttribute("radius")))},s._onNodeDragEnd=function(){s._node=null,An(s._canvas,s._ctx)},s._graph=e,s._graphics=r,s._spatial=i,s._settings=a,s._events=o,s._camera=n,s._options=j(F_),s._enabled=!1,s._canvas=En(),s._ctx=s._canvas.getContext("2d"),s}var B_=(U_.prototype.getId=function(){return this._id},U_.prototype.whenApplied=function(){return this._whenApplied},U_.prototype.refresh=function(){return this._module.refreshRule(this._id)},U_.prototype.getIndex=function(){return this._module.getRuleIndex(this._id)},U_.prototype.setIndex=function(t){return this._module.setRuleIndex(this._id,t)},U_.prototype.update=function(t){return this._module.updateRule(this._id,t)},U_.prototype.getDefinition=function(){return this._module.getRuleDefinition(this._id)},U_.prototype.destroy=function(){return this._module.destroyRule(this._id)},U_);function U_(t,e,r){var i=this;this._module=t,this._id=e,this._whenApplied=r.then(function(){return i})}var V_,j_=(b(G_,V_=Ee),G_.prototype._get=function(t){for(var e=0;e<this._rules.length;++e){var r=this._rules[e];if(r.id===t)return r.index=e,r}throw new Error("calling a method on a destroyed style rule")},G_.prototype._updatePriorities=function(){for(var t=0;t<this._rules.length;++t){var e=3+.001*t;this._rules[t].attributeLayer.update({priority:e})}},G_.prototype.addRule=function(t){void 0===t&&(t={});var e=this._idCounter++,r=this._graphics.addAttributeLayer(I({name:"rule("+e+")"},H_(t))),i=this._dom.afterNextFrame(),n=new B_(this,e,i),o={id:e,attributeLayer:r,wrapper:n};return this._rules.push(o),this._updatePriorities(),n},G_.prototype.getRuleIndex=function(t){var e=this._get(t);return null==e.index?null:e.index},G_.prototype.setRuleIndex=function(t,e){var r=this._get(t),i=Xe(e,0,this._rules.length-1);return this._rules.splice(r.index,1),this._rules.splice(i,0,r),this._updatePriorities(),this._dom.afterNextFrame()},G_.prototype.updateRule=function(t,e){var r=this._get(t),i=Object.assign({fullOverwrite:e.fullOverwrite},H_(e));return r.attributeLayer.update(i),this._dom.afterNextFrame()},G_.prototype.getRuleDefinition=function(t){return H_(this._get(t).attributeLayer.getDefinition())},G_.prototype.destroyRule=function(t){var e=this._get(t);return e.attributeLayer.destroy(),this._rules.splice(e.index,1),this._dom.afterNextFrame()},G_.prototype.refreshRule=function(t){return this._get(t).attributeLayer.updateAll(),this._dom.afterNextFrame()},G_.prototype.refreshAllRules=function(){for(var t=0;t<this._rules.length;t++)this._rules[t].attributeLayer.updateAll();return this._dom.afterNextFrame()},G_.prototype.getRuleList=function(){return this._rules.map(function(t){return t.wrapper})},G_);function G_(t){var e=t.graphics,r=t.dom,i=V_.call(this)||this;return i._idCounter=1,i._rules=[],i._graphics=e,i._dom=r,i._rules=[],i}function H_(t){return{nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeSelector:t.nodeSelector,edgeSelector:t.edgeSelector,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput}}var q_,W_={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(t){return t.nodes.setSelected(!0)},bothExtremities:!1},X_=(b(Y_,q_=Ee),Y_.prototype.enable=function(t){return void 0===t&&(t={}),this._enabled||(this._enabled=!0,this._captor.setDetectionEnabled(!1),this._options=Q(t,W_),this._graphics.addCanvas(this._canvas),Ut(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition()),this._events.fire(be.LASSO_ENABLED)),this},Y_.prototype.disable=function(){return this._enabled&&(this._enabled=!1,this._captor.setDetectionEnabled(!0),this._graphics.removeCanvas(this._canvas),this._events.fire(be.LASSO_DISABLED)),this},Y_.prototype.enabled=function(){return this._enabled},Y_.prototype.savePoint=function(t,e,r){var i=St(),n=this._ctx,o=this._options,a=this._points;if(this._bbox.addPoint(t,e),n.clearRect(0,0,this._canvas.width,this._canvas.height),a.push({x:t,y:e}),r){var s=a[0];n.lineWidth=o.strokeWidth,n.lineJoin="bevel",n.strokeStyle=o.strokeColor,n.fillStyle=o.fillColor,n.beginPath(),n.moveTo(s.x*i,s.y*i);for(var u=1;u<a.length;++u){var l=a[u];n.lineTo(l.x*i,l.y*i)}n.stroke(),o.fillColor&&n.fill()}},Y_.prototype.filterByExtremities=function(t,n){var o=this._graph.getEdgeAttribute("source"),a=this._graph.getEdgeAttribute("target");return t.filter(function(t){var e=t._index,r=o.get(e),i=a.get(e);return n[r]&&n[i]})},Y_);function Y_(t){var e=t.locate,r=t.graphics,i=t.captor,n=t.graph,o=t.spatial,a=t.interactions,s=t.events,h=q_.call(this)||this;return h._enabled=!1,h._points=[],h._bbox=new aa,h._onStart=function(t){var e=t.x,r=t.y;h._bbox.reset(),h.savePoint(e,r,!1)},h._onStop=function(){var t=h._bbox,e=t.minX,r=t.minY,i=t.maxX,n=t.maxY,o=h._spatial.queryProjected(e,r,i,n),a=o.nodes,s=o.edges,u={},l=a.filter(function(t){var e=t.isVisible(),r=t.getAttribute("detectable"),i=e&&r&&h._locate.isNodeInPolygon(t,h._points);return u[t._index]=i}),d=s.filter(function(t){var e=t.isVisible(),r=t.getAttribute("detectable");return e&&r&&h._locate.isEdgeInPolygon(t,h._points)});h._options.bothExtremities&&(d=h.filterByExtremities(d,u)),h._ctx.clearRect(0,0,h._canvas.width,h._canvas.height),h._points=[],h.disable(),h._options.callback({nodes:l,edges:d})},h._locate=e,h._graph=n,h._graphics=r,h._captor=i,h._interactions=a,h._spatial=o,h._events=s,h._options=j(W_),h._canvas=En(),h._ctx=h._canvas.getContext("2d"),h._events.register([be.LASSO_ENABLED,be.LASSO_DISABLED]),h._interaction=h._interactions.onDrag({priority:"lasso",check:function(){return h._enabled},onStart:h._onStart,onProgress:function(t){var e=t.x,r=t.y;return h.savePoint(e,r,!0)},onStop:h._onStop}),h}var Z_,K_={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(t){var e=t.nodes,r=t.edges;e.size?e.setSelected(!0):r.setSelected(!0)},bothExtremities:!1},Q_=(b(J_,Z_=X_),J_.prototype.enable=function(t){return Z_.prototype.enable.call(this,Q(t,K_))},J_.prototype._formatRectangle=function(t){var e=this._start.x,r=this._start.y,i=t.x,n=t.y,o=Math.abs(e-i),a=Math.abs(r-n),s=e<i?e:i,u=r<n?r:n;return this._rectangle.reset().addPoint(s,u).addPoint(s+o,u+a)},J_.prototype._refreshRectangle=function(t){var e=this._formatRectangle(t),r=e.minX,i=e.minY,n=e.width,o=e.height,a=St();An(this._canvas,this._ctx),this._ctx.strokeRect(r*a,i*a,n*a,o*a),this._options.fillColor&&this._ctx.fillRect(r*a,i*a,n*a,o*a)},J_);function J_(t){var u=Z_.call(this,t)||this;return u._onStart=function(t){var e=t.x,r=t.y;u._rectangle.reset(),u._start={x:e,y:r},u._ctx.fillStyle=u._options.fillColor,u._ctx.strokeStyle=u._options.strokeColor,u._ctx.lineWidth=u._options.strokeWidth},u._onStop=function(){var t=u._captor.getCursorPosition(),n=u._formatRectangle(t),e=u._spatial.queryProjected(n.minX,n.minY,n.maxX,n.maxY),r=e.nodes,i=e.edges,o={},a=r.filter(function(t){var e=t.isVisible(),r=t.getAttribute("detectable"),i=e&&r&&u._locate.isNodeInRectangle(t,n);return o[t._index]=i}),s=i.filter(function(t){var e=t.isVisible(),r=t.getAttribute("detectable");return e&&r&&u._locate.isEdgeInRectangle(t,n)});u._options.bothExtremities&&(s=u.filterByExtremities(s,o)),An(u._canvas,u._ctx),u.disable(),u._options.callback({nodes:a,edges:s})},u._options=j(K_),u._canvas=En(),u._ctx=u._canvas.getContext("2d"),u._enabled=!1,u._rectangle=new aa,u._interaction=u._interactions.onDrag({priority:"lasso",disableDetection:!0,check:function(){return u._enabled},onStart:u._onStart,onProgress:function(t){var e=t.x,r=t.y;return u._refreshRectangle({x:e,y:r})},onStop:u._onStop}),u}function $_(t,e,r,i,n,o,a,s){void 0===n&&(n=0),void 0===o&&(o=Math.sin(n)),void 0===a&&(a=Math.cos(n)),void 0===s&&(s=[0,0,0,0]);var u,l,d,h,c,f,g,p,_=r/2,v=i/2,m=t+_,y=e+v;return 0===n?(s[0]=t,s[1]=e,s[2]=t+r,s[3]=e+i):(c=g=u=m+(d=-_)*a-(h=-v)*o,f=p=l=y+d*o+h*a,(u=m+(d=-_)*a-(h=v)*o)<c?c=u:g<u&&(g=u),(l=y+d*o+h*a)<f?f=l:p<l&&(p=l),(u=m+(d=_)*a-(h=v)*o)<c?c=u:g<u&&(g=u),(l=y+d*o+h*a)<f?f=l:p<l&&(p=l),(u=m+(d=_)*a-(h=-v)*o)<c?c=u:g<u&&(g=u),(l=y+d*o+h*a)<f?f=l:p<l&&(p=l),s[0]=c,s[1]=f,s[2]=g,s[3]=p),s}function tv(t,e,r,i,n){void 0===n&&(n=0);var o=r/2,a=i/2,s=t+o,u=e+a;if(0===n)return[{x:t,y:e},{x:t+r,y:e},{x:t+r,y:e+i},{x:t,y:e+i}];var l,d,h=Math.sin(n),c=Math.cos(n);return[{x:s+(l=-o)*c-(d=-a)*h,y:u+l*h+d*c},{x:s+(l=-o)*c-(d=a)*h,y:u+l*h+d*c},{x:s+(l=o)*c-(d=a)*h,y:u+l*h+d*c},{x:s+(l=o)*c-(d=-a)*h,y:u+l*h+d*c}]}function ev(t,e,r,i){void 0===e&&(e=0),void 0===r&&(r=1),void 0===i&&(i=ws.slice());var n=r*Math.sin(e),o=r*Math.cos(e);return i[0]=t[0]+n,i[1]=t[1]+o,i[2]=t[2]+n,i[3]=t[3]+o,i}function rv(t,e,r,i,n,o,a,s){return o<=i&&e<=s&&n<=r&&t<=a}var iv={left:-1,right:1,top:0,bottom:0,center:0},nv={left:0,right:0,top:-1,bottom:1,center:0},ov={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},av={left:-.5,right:-.5,top:-1,bottom:0,center:-.5};var sv={x1:0,y1:0,x2:0,y2:0},uv={x:0,y:0},lv={x:0,y:0},dv=Math.PI/2;function hv(t,e,r,i){void 0===i&&(i="#ff0000"),e.strokeStyle=i,e.lineWidth=1,e.beginPath();for(var n=St(),o=0,a=t.length;o<a;o++){var s=r.graphToScreenCoordinates(t[o]);0===o?e.moveTo(s.x*n,s.y*n):e.lineTo(s.x*n,s.y*n)}e.closePath(),e.stroke()}function cv(e,t,r,i,n,o){e.clearRect(0,0,t.width,t.height);for(var a=0,s=i.length;a<s;a+=6)u=i.slice(a,a+4),l=e,d=r,void 0===(h="#aaaaaa")&&(h="#22ff00"),hv([[u[0],u[1]],[u[2],u[1]],[u[2],u[3]],[u[0],u[3]]].map(function(t){return{x:t[0],y:t[1]}}),l,d,h);var u,l,d,h;for(a=0;a<n.length;a+=5){hv(tv(n[a],n[a+1],n[a+2],n[a+3],n[a+4]),e,r,"green")}o.forEach(function(t){return hv(t,e,r,"red")})}var fv,gv=["x","y","radius","width","layer","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"].reduce(function(t,e){return t.add(e),t},new Set),pv=(b(_v,fv=Ee),_v.prototype.getTextsBoundingBox=function(){this._updateLabels();for(var t=this._rects,e=this._textBBoxes,r=new aa,i=this._graphics.getNodeAttributes(),n=this._graphics.getEdgeAttributes(),o=i.excluded,a=n.excluded,s=0;s<t.length;s++){var u=5*s,l=1===e[6*s+4],d=e[6*s+4];if(!(l?o.get(d):a.get(d))){var h=$_(t[u],t[1+u],t[2+u],t[3+u],t[4+u]),c=h[0],f=h[1],g=h[2],p=h[3];r.addPoint(c,f).addPoint(g,p)}}return r},_v.prototype.setRate=function(t){var e=this;this._updateDebounced=this._sync.debounceIdle(function(t){return e._updateLabels(t)},t)},_v.prototype.forceEnable=function(){this._forceEnabled=!0},_v.prototype.update=function(){this._update()},_v.prototype.forceUpdate=function(){this._updateLabels()},_v.prototype._enable=function(){this._enabled=!0,this._update()},_v.prototype._disable=function(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1},_v.prototype._onCameraMove=function(){this._update()},_v.prototype._updateLabels=function(t){if(void 0===t&&(t=this._camera.getZoom()),this._settings.get("texts.preventOverlap")){var e=this._graphics.getNodeAttributes(),r=this._graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];var i=this._textQuad.clear(),n=this._camera.getAngle(),o=this._camera.getProjectedScreenBounds(.25),a="bottomUp"===this._settings.get("texts.removalStrategy"),s={angle:n,zoom:t,screen:o,sin:Math.sin(n),cos:Math.cos(n)},u={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects},l=this._spatial.queryRaw(o[0],o[1],o[2],o[3]),d=l.nodes,h=l.edges;if(d.length+h.length!==0){var c=this._captor.getPointedElement(),f=null,g=null;null!==c&&(c.isNode?f=c._index:g=c._index),function(t,e,r,i,n,o,a,s){for(var u,l,d=a.remove.nodes,h=a.remove.edges,c=a.redraw.nodes,f=r.angle,g=r.zoom,p=r.sin,_=r.cos,v=i.x,m=i.y,y=i.radius,b=i.layer,x=i.innerStroke.width,E=i.outerStroke.width,A=i.scalingMethod,S=i.text.content,w=i.text.position,T=i.text.size,C=i.text.font,M=i.text.style,I=i.text.maxLineLength,L=i.text.scaling,N=i.text.scale,O=i.text.minVisibleSize,k=i.text.padding,R=i.text.margin,F=i.animationDuration,D=i.textHidden,P=i.excluded,z=[],B=0;B<t.length;B++){var U=t[B];(z[X=b.get(U)- -1]=z[X]||[]).push(U)}null!==s&&z[z.length-1]&&z[z.length-1].unshift(s);for(var V=[0,0,0,0],j=[0,0,0,0,0],G=a.bboxes,H=a.rects,q=a.intersects,W=z.length-1;0<=W;W--){var X;if(X=z[W])for(B=0;B<X.length;B++){u=X[B];var Y=F.get(u),Z=S.get(u);if(null!==Z&&""!==Z&&0===Y){var K=y.get(u),Q=O.get(u);if(1!==P.get(u))if(2*K*g<Q)0===D.get(u)&&d.push(u);else{"fixed"===A.get(u)&&(K/=g);var J=v.get(u),$=m.get(u);"number"==typeof Z&&(Z=Z.toString());for(var tt=!L.get(u),et=w.get(u),rt=k.get(u),it=N.get(u),nt=+(tt?T.get(u):it*K),ot=M.get(u),at=C.get(u),st=xa(Z,I.get(u)),ut=st.lines,lt=st.data,dt=rt+x.get(u)+E.get(u)+R.get(u),ht=iv[et],ct=nv[et],ft=n(lt[0],at,ot,nt).width,gt=1;gt<ut;gt++)ft=Math.max(ft,n(lt[gt],at,ot,nt).width);var pt=ut*nt*1,_t=ft/2/g,vt=pt/2/g,mt=dt/g,yt=ov[et]*ft,bt=av[et]*pt;tt&&(yt/=g,bt/=g),yt=yt+ht*mt+_t+ht*K,bt=bt+ct*mt+vt+ct*K,$_(J-_t,$-vt,ft/g,pt/g,-f,p,-_,V),j[0]=J-_t,j[1]=$-vt,j[2]=ft/g,j[3]=pt/g,j[4]=f;var xt=_*yt-p*bt,Et=p*yt+_*bt;V[0]+=xt,V[1]+=Et,V[2]+=xt,V[3]+=Et,j[0]+=xt,j[1]+=Et;var At=e.query(V[0],V[1],V[2],V[3]);if(0!==At.length){for(var St=!1,wt=tv(j[0],j[1],j[2],j[3],j[4]),Tt=0;Tt<At.length;Tt++){var Ct=At[Tt],Mt=5*Ct,It=tv(H[Mt],H[1+Mt],H[2+Mt],H[3+Mt],H[4+Mt]);if(nh(wt,It)){if(q.push(wt,It),St=!0,!o)break;e.remove(Ct),1===G[6*Ct+4]?d.push(G[6*Ct+5]):h.push(G[6*Ct+5])}}if(St&&!o){d.push(u);continue}}c.push(u),l=G.length/6,G.push(V[0],V[1],V[2],V[3],1,u),e.insert(l,V[0],V[1],V[2],V[3]),H.push(j[0],j[1],j[2],j[3],j[4])}else d.push(u)}}}}(d,i,s,e,this._measureText,a,u,f),function(t,e,r,i,n,o,a,s,u){for(var l,d,h=s.remove.nodes,c=s.remove.edges,f=s.redraw.edges,g=r.angle,p=r.zoom,_=n.x,v=n.y,m=n.radius,y=Math.PI,b=i.source,x=i.target,E=i.scalingMethod,A=i.width,S=i.curvature,w=i.layer,T=i.text.content,C=i.text.scaling,M=i.text.size,I=i.text.font,L=i.text.style,N=i.text.scale,O=i.text.maxLineLength,k=i.text.margin,R=i.text.minVisibleSize,F=i.animationDuration,D=[],P=0;P<t.length;P++){var z=t[P];(D[q=w.get(z)- -1]=D[q]||[]).push(z)}null!==u&&D[D.length-1]&&D[D.length-1].unshift(u);for(var B=[0,0,0,0],U=[0,0,0,0,0],V=s.bboxes,j=s.rects,G=s.intersects,H=D.length-1;0<=H;H--){var q;if(q=D[H])for(P=0;P<q.length;P++){l=q[P];var W=F.get(l),X=T?T.get(l):"";if(null!==X&&""!==X&&!W){var Y=b.get(l),Z=x.get(l),K=A.get(l),Q=S.get(l);if(!(K*p<R.get(l))){"fixed"===E.get(l)&&(K/=p);var J=(_.get(Y)+_.get(Z))/2,$=(v.get(Y)+v.get(Z))/2;X=X?X.toString():"";var tt=!C.get(l),et=N.get(l),rt=I.get(l),it=+(tt?M.get(l):et*K),nt=L.get(l),ot=O.get(l),at=k.get(l),st=_.get(Y),ut=v.get(Y),lt=_.get(Z),dt=v.get(Z),ht=void 0,ct=Y===Z;if(ct)ht=y/4-g,vs(st,ut,Q,m.get(Y),0,sv),Iu(.5,st,ut,lt,dt,sv.x1,sv.y1,sv.x2,sv.y2,lv),J=lv.x,$=lv.y,at/=-p;else{if(st===lt&&ut===dt)continue;ht=cu(st,ut,lt,dt)-g,0!==Q&&(ht=cu(st,ut,lt,dt)-g,_s(st,ut,lt,dt,Q,uv),Cu(.5,st,ut,lt,dt,uv.x,uv.y,lv),J=lv.x,$=lv.y)}var ft=at+4,gt=xa(X,ot);if(gt){for(var pt=gt.lines,_t=gt.data,vt=+o(_t[0],rt,nt,it).width,mt=1;mt<pt;mt++)vt=Math.max(vt,+o(_t[mt],rt,nt,it).width);var yt=pt*it,bt=vt/p/2,xt=yt/p/2,Et=Math.abs(ht)<dv?1:-1,At=ct?yt/p+K/2:Et*(ft/p+K/2+xt);U[0]=J-bt,U[1]=$-xt,U[2]=J+bt,U[3]=$+xt,U[4]=ht+g,ev(U,-(ht+g),-At,U),U[2]=U[2]-U[0],U[3]=U[3]-U[1],$_(J-bt,$-xt,2*bt,2*xt,ht=y-ht-g,void 0,void 0,B),ev(B,ht,At,B);var St=e.query(B[0],B[1],B[2],B[3]);if(St.length){for(var wt=!1,Tt=tv(U[0],U[1],U[2],U[3],U[4]),Ct=0;Ct<St.length;Ct++){var Mt=St[Ct],It=5*Mt,Lt=tv(j[It],j[1+It],j[2+It],j[3+It],j[4+It]);if(nh(Tt,Lt)){if(wt=!0,G.push(Tt,Lt),!a)break;e.remove(Mt),1===V[6*Mt+4]?h.push(V[6*Mt+5]):c.push(V[6*Mt+5])}}if(wt&&!a){c.push(l);continue}}f.push(l),d=V.length/6,V.push(B[0],B[1],B[2],B[3],0,l),e.insert(d,B[0],B[1],B[2],B[3]),j.push(U[0],U[1],U[2],U[3],U[4])}}}}}}(h,i,s,r,e,this._measureText,a,u,g),this._clearOverlaps(u),this._settings.get("texts.debug")&&this.drawAll()}}},_v.prototype._clearOverlaps=function(t){var e=this._graph.nodeList,r=this._graph.edgeList,i=this._graphics,n=e(new Uint32Array(t.remove.nodes)),o=r(new Uint32Array(t.remove.edges)),a=e(new Uint32Array(t.redraw.nodes)),s=r(new Uint32Array(t.redraw.edges));i.setTextHidden(n,!0),i.setTextHidden(o,!0),i.setTextHidden(a,!1),i.setTextHidden(s,!1),this._events.fire("labelCollisionsRemoved",t)},_v.prototype._reset=function(){this._graphics.resetTextHidden()},_v.prototype.drawAll=function(){this._canvas&&this._ctx&&cv(this._ctx,this._canvas,this._camera,this._textBBoxes,this._rects,this._intersects)},_v);function _v(t,e){var r,i=t.graph,n=t.graphics,o=t.camera,a=t.events,s=t.settings,u=t.sync,l=t.spatial,d=t.captor,h=fv.call(this)||this;return h._textBBoxes=[],h._rects=[],h._enabled=!1,h._intersects=[],h._onZoomStart=F(function(t){var e=t.startZoom,r=t.endZoom;h._enabled&&r<e&&h._updateLabels(r)},80),h._onAttributesChanged=function(t){x(t.edgeAttributes,t.nodeAttributes).some(function(t){return gv.has(t)})&&h._update()},h._onItemsAdded=function(t){var e=t.nodes||t.edges;(h._enabled||h._forceEnabled)&&h._settings.get("texts.preventOverlap")&&h._graphics.setTextHidden(e,!0)},h._onToggle=function(t){return t?h._update():h._reset(),h},h._update=function(){(h._enabled||h._forceEnabled)&&h._updateDebounced()},h._toggleDebug=function(t){t?(h._canvas=En(),h._graphics.addCanvas(h._canvas),h._ctx=h._canvas.getContext("2d"),h._update()):h._canvas&&(h._graphics.removeCanvas(h._canvas),h._canvas=h._ctx=null)},h._measureText=function(t,e,r,i){return h._engine.measureText(t,e,r,i)},h._graph=i,h._graphics=n,h._camera=o,h._events=a,h._settings=s,h._sync=u,h._spatial=l,h._captor=d,h._engine=n.getGraphicsEngine(),h._textQuad=new Gf(function(t){var e=6*t;return h._textBBoxes.slice(e,6+e)},5),e.forceEnableTextOverlapRemoval&&h.forceEnable(),h._events.register(["labelCollisionsRemoved"]),h.setRate(200),s.register("texts.preventOverlap",!0,h._onToggle),s.register("texts.debug",!1,h._toggleDebug),s.register("texts.removalStrategy","topDown"),a.on(((r={})[[be.ADD_NODES,be.ADD_EDGES].join(" ")]=h._onItemsAdded,r[be.LAYOUT_END]=function(){return h._updateLabels()},r[[be.VIEW_CHANGED,be.HOVER,be.UNHOVER].join(" ")]=h._update,r[be.UPDATE_ATTRIBUTES]=h._onAttributesChanged,r[be.SET_CONTAINER]=function(t){if(t.element)return h._enable();h._disable()},r[be.START_ZOOM]=h._onZoomStart,r)),h}function vv(){}function mv(){return!1}var yv,bv,xv=(Ev.prototype._startInteraction=function(t,e){t.onStart&&t.onStart(e),t.onStop&&(this._current=t).disableDetection&&this._captor.setDetectionEnabled(!1)},Ev.prototype._stopCurrentInteraction=function(t){this._current&&this._current.disableDetection&&this._captor.setDetectionEnabled(!0),this._current&&this._current.onStop&&this._current.onStop(t),this._current=void 0},Ev.prototype._forceStartInteraction=function(t,e){this._current&&this._stopCurrentInteraction(e),this._startInteraction(t,e)},Ev.prototype._createWrapper=function(e){var r=this;return{start:function(t){return r._forceStartInteraction(e,t)}}},Ev.prototype._addInteraction=function(t,e){var r=this._interactionsByStartEvent[t];return r?r.push(e):(this._interactionsByStartEvent[t]=[e],this._events.on(t,this._onStartInteractionEvent)),this._createWrapper(e)},Ev.prototype._createProgressiveInteraction=function(t,e,r,i){var n={priority:Av(i.priority),check:i.check||mv,onStart:i.onStart||vv,onProgress:i.onProgress||vv,onStop:i.onStop||vv,disableDetection:!!i.disableDetection,progressEventName:e,stopEventName:r};return this._boundProgressEvents[e]||(this._boundProgressEvents[e]=!0,this._events.on(e,this._onProgressInteractionEvent)),this._boundStopEvents[r]||(this._boundStopEvents[r]=!0,this._events.on(r,this._onStopInteractionEvent)),this._addInteraction(t,n)},Ev.prototype._createNonProgressiveInteraction=function(t,e){return this._addInteraction(t,{priority:Av(e.priority),check:e.check||mv,onStart:e.handler||vv,onProgress:void 0,onStop:void 0,disableDetection:!1,progressEventName:void 0,stopEventName:void 0})},Ev.prototype.onDrag=function(t){return this._createProgressiveInteraction(be.DRAG_START,be.DRAG_PROGRESS,be.DRAG_END,t)},Ev.prototype.onGesture=function(t){return this._createProgressiveInteraction(be.GESTURE_START,be.GESTURE_PROGRESS,be.GESTURE_END,t)},Ev.prototype.onClick=function(t){return this._createNonProgressiveInteraction(be.CLICK,t)},Ev.prototype.onDoubleClick=function(t){return this._createNonProgressiveInteraction(be.DOUBLE_CLICK,t)},Ev.prototype.onHover=function(t){return this._createNonProgressiveInteraction(be.HOVER,t)},Ev.prototype.onUnhover=function(t){return this._createNonProgressiveInteraction(be.UNHOVER,t)},Ev.prototype.onMouseWheel=function(t){return this._createNonProgressiveInteraction(be.WHEEL,t)},Ev.prototype.onMouseDown=function(t){return this._createNonProgressiveInteraction(be.DOWN,t)},Ev.prototype.onMouseUp=function(t){return this._createNonProgressiveInteraction(be.UP,t)},Ev.prototype.onMouseMove=function(t){return this._createNonProgressiveInteraction(be.MOVE,t)},Ev);function Ev(t){var a=this,e=t.captor,r=t.events;this._onStartInteractionEvent=function(t,e){if(!a._current){for(var r,i=0,n=a._interactionsByStartEvent[e];i<n.length;i++){var o=n[i];o.check(t)&&(!r||o.priority>=r.priority)&&(r=o)}r&&a._startInteraction(r,t)}},this._onProgressInteractionEvent=function(t,e){a._current&&a._current.progressEventName===e&&a._current.onProgress&&a._current.onProgress(t)},this._onStopInteractionEvent=function(t,e){a._current&&a._current.stopEventName===e&&a._stopCurrentInteraction(null)},this._captor=e,this._events=r,this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}function Av(t){return"string"==typeof t?xr.indexOf(t):"number"!=typeof t||isNaN(t)?0:t}(bv=yv=yv||{}).MOUSE="mouse",bv.TOUCH="touch";var Sv,wv=[be.VIRTUAL_UP,be.MOUSE_UP,be.TOUCH_UP].join(" "),Tv=[be.VIRTUAL_DOWN,be.MOUSE_DOWN,be.TOUCH_DOWN].join(" "),Cv=[be.VIRTUAL_MOVE,be.MOUSE_MOVE,be.TOUCH_MOVE].join(" "),Mv=[be.VIRTUAL_CLICK,be.MOUSE_CLICK,be.TOUCH_TAP].join(" "),Iv=[be.VIRTUAL_DOUBLE_CLICK,be.MOUSE_DOUBLE_CLICK,be.TOUCH_DOUBLE_TAP].join(" "),Lv=[be.VIRTUAL_WHEEL,be.MOUSE_WHEEL].join(" "),Nv=(b(Ov,Sv=Ee),Ov.prototype.triggerUnhover=function(){this._hover=!1,this._hoveredElt=null},Ov.prototype.triggerDetection=function(){this._detectElement(this._position.x,this._position.y),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)},Ov.prototype.getElementAt=function(t,e){var r=t.x,i=t.y;return this._detectElementAt(r,i,e)},Ov.prototype.getPointedElement=function(){return this._hoveredElt},Ov.prototype.getDraggedElement=function(){return this._draggedElt},Ov.prototype.isAnyButtonPressed=function(){return this._buttons[$f.LEFT].isPressed||this._buttons[$f.RIGHT].isPressed||this._buttons[$f.MIDDLE].isPressed},Ov.prototype.isAnyButtonDragging=function(){return this._buttons[$f.LEFT].isDragging||this._buttons[$f.RIGHT].isDragging||this._buttons[$f.MIDDLE].isDragging},Ov.prototype.isButtonPressed=function(t){return this._buttons[t].isPressed},Ov.prototype.isLeftPressed=function(){return this.isButtonPressed($f.LEFT)},Ov.prototype.getCursorPosition=function(){return{x:this._position.x,y:this._position.y}},Ov.prototype.getCursorInformation=function(){return{x:this._position.x,y:this._position.y,target:this._hoveredElt}},Ov.prototype.setDetectionEnabled=function(value){this._disabledCounter=Math.max(0,this._disabledCounter+(value?-1:1))},Ov.prototype._resetCurrent=function(t,e){for(var r in this._buttons){var i=this._buttons[r];i.isDragging&&this._events.fire(be.DRAG_END,{domEvent:null,x:t,y:e,button:r,target:this._draggedElt}),i.isPressed=!1,i.isDragging=!1}this._hover&&this._hoveredElt&&this._events.fire(be.UNHOVER,{domEvent:null,x:t,y:e,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null},Ov.prototype._onMove=function(t){var e=t.domEvent,r=t.x,i=t.y,n=t.source,o=this._setPointerPosition(r,i),a=o.dx,s=o.dy;for(var u in this._events.fire(be.MOVE,{domEvent:e,x:r,y:i,dx:a,dy:s,source:n}),this._buttons){var l=this._buttons[u];if(l.isPressed)if(l.isDragging){var d=this._getStoredDXY();a+=d.dx,s+=d.dy,this._events.fire(be.DRAG_PROGRESS,{domEvent:e,x:r,y:i,dx:a,dy:s,button:u,source:n,target:this._draggedElt})}else l.isDragging=!0,this._hoveredElt&&this._hover&&(this._events.fire(be.UNHOVER,{domEvent:e,x:r,y:i,source:n,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(a,s),this._events.fire(be.DRAG_START,{domEvent:e,x:r,y:i,button:u,source:n,target:this._draggedElt})}e&&!this._graphics.getDomElement().contains(e.target)||this._detectElement(r,i),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._events.fire(be.UNHOVER,{domEvent:e,x:r,y:i,source:n,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._events.fire(be.HOVER,{domEvent:e,x:r,y:i,source:n,target:this._hoveredElt})))},Ov.prototype._onDocumentMove=function(t){var e=t.domEvent,r=t.x,i=t.y,n=t.source;for(var o in this._buttons)if(this._buttons[o].isDragging){var a=this._setPointerPosition(r,i),s=a.dx,u=a.dy;this._events.fire(be.DRAG_PROGRESS,{domEvent:e,x:r,y:i,dx:s,dy:u,button:o,source:n,target:this._draggedElt})}},Ov.prototype._onDocumentUp=function(t){var e=t.domEvent,r=t.x,i=t.y,n=t.source,o=t.button;if(null!=o&&this._buttons[o].isDragging){this._events.fire(be.DRAG_END,{domEvent:e,x:r,y:i,button:o,source:n,target:this._draggedElt});var a=this._buttons[o];a.isDragging=!1,a.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}},Ov.prototype._onDown=function(t){var e=t.domEvent,r=t.x,i=t.y,n=t.button,o=t.source;if(null!=n){this._detectElement(r,i),this._elt!==this._hoveredElt&&this._resetCurrent(r,i);var a=this._buttons[n];this._hoveredElt=this._elt,a.isPressed=!0,this._events.fire(be.DOWN,{domEvent:e,x:r,y:i,button:n,source:o,target:this._hoveredElt})}},Ov.prototype._onDoubleClick=function(t){var e=t.domEvent,r=t.x,i=t.y,n=t.button,o=t.source;null!=n&&(Dv(e,"doubleclick")||this._events.fire(be.DOUBLE_CLICK,{domEvent:e,x:r,y:i,button:n,source:o,target:this._hoveredElt}))},Ov.prototype._onUp=function(t){var e=t.domEvent,r=t.x,i=t.y,n=t.button,o=t.source;if(null!=n){var a=this._buttons[n];a.isPressed&&(a.isDragging&&(this._events.fire(be.DRAG_END,{domEvent:e,x:r,y:i,button:n,source:o,target:this._draggedElt}),a.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),a.isPressed=!1,this._detectElement(r,i),this._events.fire(be.UP,{domEvent:e,x:r,y:i,button:n,source:o,target:this._elt}),this.isAnyButtonPressed()||this._hover||o===yv.TOUCH||(this._hoveredElt=this._elt,this._hoveredElt&&(this._events.fire(be.HOVER,{domEvent:e,x:r,y:i,source:o,target:this._hoveredElt}),this._hover=!0)))}},Ov.prototype._onClick=function(t){var e=t.domEvent,r=t.x,i=t.y,n=t.button,o=t.source;Dv(e,"click")||this._events.fire(be.CLICK,{domEvent:e,x:r,y:i,button:n,source:o,target:this._hoveredElt})},Ov.prototype._onWheel=function(t){var e=t.domEvent,r=t.x,i=t.y,n=t.delta,o=t.source;this._position.x=r,this._position.y=i,this._events.fire(be.WHEEL,{domEvent:e,x:r,y:i,delta:n,source:o,target:this._hoveredElt})},Ov.prototype._storeDXY=function(t,e){this._accDx=t,this._accDy=e},Ov.prototype._getStoredDXY=function(){var t=this._accDx,e=this._accDy;return this._accDx=0,this._accDy=0,{dx:t,dy:e}},Ov.prototype._setPointerPosition=function(t,e){var r=t-this._prevX,i=e-this._prevY;return this._position.x=t,this._position.y=e,this._prevX=t,this._prevY=e,this._accDx=0,this._accDy=0,{dx:r,dy:i}},Ov.prototype._detectElement=function(t,e,r){this._elt=this._detectElementAt(t,e,r)},Ov.prototype._detectElementAt=function(t,e,r){if(0!==this._disabledCounter)return null;var i=this._settings,n=i.get("detect.enableSpatialIndex"),o=i.get("detect.nodeErrorMargin"),a=i.get("detect.edgeErrorMargin"),s=i.get("detect.nodes"),u=i.get("detect.edges"),l=null,d=[],h=[];if(!r&&n&&(s||u)){var c=i.get("detect.spatialIndexMarginRatio"),f=Math.max(o*c,a*c),g=this._spatial.queryRawProjected(t-f,e-f,t+f,e+f);d=g.nodes,h=g.edges}return s&&(l=this._graphics.detectNode({x:t,y:e,indexes:d,margin:o,texts:!!i.get("detect.nodeTexts")})),!l&&u&&(l=this._graphics.detectEdge({x:t,y:e,indexes:h,margin:a,texts:!!i.get("detect.edgeTexts")})),l},Ov);function Ov(t){var e,r,i=t.dom,n=t.events,o=t.graphics,a=t.spatial,s=t.settings,u=t.position,l=Sv.call(this)||this;return l._elt=null,l._hoveredElt=null,l._draggedElt=null,l._hover=!1,l._disabledCounter=0,l._accDx=0,l._accDy=0,l._prevX=0,l._prevY=0,l._buttons=((e={})[$f.LEFT]={isPressed:!1,isDragging:!1},e[$f.MIDDLE]={isPressed:!1,isDragging:!1},e[$f.RIGHT]={isPressed:!1,isDragging:!1},e),l._onGraphChanged=function(){l._resetCurrent(l._position.x,l._position.y),l._timeout||(l._timeout=l._dom.setTimeout(function(){l._onMove({x:l._position.x,y:l._position.y,source:null,domEvent:null}),l._timeout=null},0))},l._dom=i,l._graphics=o,l._events=n,l._settings=s,l._spatial=a,l._position=u,n.register([be.MOVE,be.DOWN,be.UP,be.CLICK,be.DOUBLE_CLICK,be.HOVER,be.UNHOVER,be.WHEEL,be.DRAG_START,be.DRAG_PROGRESS,be.DRAG_END,be.GESTURE_START,be.GESTURE_PROGRESS,be.GESTURE_END]),s.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",7).register("detect.enableSpatialIndex",!0).register("detect.spatialIndexMarginRatio",20),n.on(((r={})[[be.REMOVE_NODES,be.REMOVE_EDGES,be.CLEAR_GRAPH].join(" ")]=l._onGraphChanged,r[Cv]=function(t,e){var r=t.domEvent,i=t.x,n=t.y;l._onMove({domEvent:r,x:i,y:n,source:kv(e)})},r[Tv]=function(t,e){var r=t.domEvent,i=t.x,n=t.y,o=t.button,a=void 0===o?$f.LEFT:o;l._onDown({domEvent:r,x:i,y:n,button:a,source:kv(e)})},r[wv]=function(t,e){var r=t.domEvent,i=t.x,n=t.y,o=t.button,a=void 0===o?$f.LEFT:o;l._onUp({domEvent:r,x:i,y:n,button:a,source:kv(e)})},r[Mv]=function(t,e){var r=t.domEvent,i=t.x,n=t.y,o=t.button,a=void 0===o?$f.LEFT:o;l._onClick({domEvent:r,x:i,y:n,button:a,source:kv(e)})},r[Iv]=function(t,e){var r=t.domEvent,i=t.x,n=t.y,o=t.button,a=void 0===o?$f.LEFT:o;l._onDoubleClick({domEvent:r,x:i,y:n,button:a,source:kv(e)})},r[Lv]=function(t){var e=t.domEvent,r=t.x,i=t.y,n=t.delta;l._onWheel({domEvent:e,x:r,y:i,delta:n,source:yv.MOUSE})},r.touchStartGesture=function(t){return n.fire(be.GESTURE_START,t)},r.touchProgressGesture=function(t){return n.fire(be.GESTURE_PROGRESS,t)},r.touchEndGesture=function(t){return n.fire(be.GESTURE_END,t)},r[be.DOCUMENT_MOUSE_MOVE]=function(t,e){var r=t.domEvent,i=t.x,n=t.y;l._onDocumentMove({domEvent:r,x:i,y:n,source:kv(e)})},r[be.DOCUMENT_MOUSE_UP]=function(t,e){var r=t.domEvent,i=t.x,n=t.y,o=t.button,a=void 0===o?$f.LEFT:o;l._onDocumentUp({domEvent:r,x:i,y:n,source:kv(e),button:a})},r)),l}function kv(t){return 0===t.indexOf(yv.TOUCH)?yv.TOUCH:yv.MOUSE}var Rv=!1,Fv={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function Dv(t,e){return t&&(t.type===Fv[e].trigger&&(Rv=!0),t.type===Fv[e].duplicate&&Rv&&(Rv=!1,1))}var Pv,zv=(b(Bv,Pv=Ee),Bv);function Bv(t){t.graph;var e=t.graphics,r=t.camera,i=t.selection,n=t.events,o=t.captor,a=t.individualAttributes,s=t.interactions,u=t.classes,l=t.settings,d=Pv.call(this)||this;return d._dragged=null,d._start=[],d._end=[],d._shouldDrag=function(t){var e=t.target,r=t.button===$f.LEFT,i=d._settings.get("interactions.drag.enabled"),n=null!==e&&e.isNode&&!0===e.getAttribute("draggable");return!!(r&&i&&n)},d._onDragStart=function(t){var e=t.x,r=t.y,i=t.target;i.isSelected()?d._dragged=d._selection.getSelectedNodes().filter(function(t){return t.getAttribute("draggable")}):d._dragged=i.toList(),d._dragged&&(d._start=d._dragged.getPosition(),d._end=j(d._start),d._onBeforeDrag=d._settings.get("interactions.drag.onBeforeDrag"),d._startDrag=d._camera.screenToGraphCoordinates({x:e,y:r}),d._dragged.addClass(cr),d._events.fire(be.NODES_DRAG_START,{nodes:d._dragged}),d._graphics.addCursorStyle(d._settings.get("interactions.drag.cursor")))},d._onDrag=function(){if(d._dragged&&d._startDrag){for(var t=d._captor.getCursorInformation(),e=t.x,r=t.y,i=d._dragged._indexes,n=d._camera.screenToGraphCoordinates({x:e,y:r}),o=n.x-d._startDrag.x,a=n.y-d._startDrag.y,s=0;s<i.length;++s){var u=d._start[s],l=d._end[s];l.x=u.x+o,l.y=u.y+a}d._onBeforeDrag&&d._onBeforeDrag(d._dragged,e,r,d._end),d._settings.get("interactions.drag.applyResult")&&d._attributes.setMultipleAttributes(d._dragged,d._end,void 0,["x","y"]),d._events.fire(be.NODES_DRAG_PROGRESS,{nodes:d._dragged,dx:o,dy:a})}},d._onDragEnd=function(){d._dragged&&(d._dragged.removeClass(cr),d._graphics.removeCursorStyle(d._settings.get("interactions.drag.cursor")),d._events.fire(be.NODES_DRAG_END,{nodes:d._dragged,start:d._start,end:d._end}),d._dragged=null,d._start=[],d._end=[])},d._camera=r,d._graphics=e,d._selection=i,d._events=n,d._settings=l,d._captor=o,d._attributes=a,d._interactions=s,u.createClass({name:cr,isBuiltin:!0,nodeAttributes:{layer:3}}),n.register([be.NODES_DRAG_START,be.NODES_DRAG_PROGRESS,be.NODES_DRAG_END]),l.register("interactions.drag.enabled",!0),l.register("interactions.drag.cursor","move"),l.register("interactions.drag.onBeforeDrag",void 0),l.register("interactions.drag.applyResult",!0),d._interactions.onDrag({priority:"drag",disableDetection:!0,check:d._shouldDrag,onStart:d._onDragStart,onProgress:d._onDrag,onStop:d._onDragEnd}),d}var Uv,Vv={color:"#00C3FF",radius:7,cursorOnHover:"grab",cursorOnDrag:"grabbing"},jv=(b(Gv,Uv=Ee),Gv.prototype.onMounted=function(t){t.events.onEdgesSelected(this._refreshHandles),t.events.onEdgesUnselected(this._refreshHandles)},Gv.prototype.enable=function(t){this._enabled||(this._options=I(I({},Vv),t),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._refreshHandles())},Gv.prototype.disable=function(){this._enabled&&(this._interaction.stop&&this._interaction.stop(),this._graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._restoreSettings(),this._graphics.removeCanvas(this._canvas),this._rewirableClass.clearEdges(),this._enabled=!1)},Gv.prototype.enabled=function(){return this._enabled},Gv.prototype._restoreSettings=function(){this._prevSettings&&(this._settings.update(this._prevSettings),this._prevSettings=void 0)},Gv.prototype._disableCursorOnHover=function(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._graphics.removeCursorStyle(this._options.cursorOnHover))},Gv.prototype._enableCursorOnHover=function(){this._hoverHandle||(this._hoverHandle=!0,this._graphics.addCursorStyle(this._options.cursorOnHover))},Gv.prototype._displayMovedEdges=function(){var d=this;if(this._movedEdges){var t=this._x,e=this._y,h=this._ctx,c=St(),f={x:t,y:e},g=this._camera.getZoom();this._movedEdges.forEach(function(t,e){var r=d._edgeColors[e],i=t.getSource(),n=t.getTarget(),o=d._getPointedNode(),a=n===d._startNode?i:n,s=Number(t.getAttribute("width"))*g,u=a.getPositionOnScreen(),l=o?o.getPositionOnScreen():f;a.addClass(hr),h.beginPath(),h.moveTo(u.x*c,u.y*c),h.lineTo(l.x*c,l.y*c),h.strokeStyle=r,h.lineWidth=s*c,h.stroke()})}},Gv.prototype._getPointedNode=function(){var t=this._captor.getPointedElement();return t&&t.isNode?t:null},Gv);function Gv(t){var e,r=t.classes,i=t.graphics,n=t.camera,o=t.captor,a=t.selection,s=t.events,u=t.settings,l=t.interactions,c=Uv.call(this)||this;return c._canvas=En(),c._ctx=c._canvas.getContext("2d"),c._hoverHandle=!1,c._grabHandle=!1,c._x=0,c._y=0,c._enabled=!1,c._onDragStart=function(){if(c._movedEdges){c._nodesToHighlight=c._nodesToHighlight.filter(function(t){return t!==c._startNode}),c._movedEdges.setExcluded(!0);var t=c._options.cursorOnDrag;c._prevSettings=c._settings.update({edgeHover:!1,cursor:{default:t,node:t,edge:t}})}},c._onDragEnd=function(){if(c._movedEdges){c._restoreSettings();var e=c._getPointedNode();e&&c._movedEdges.forEach(function(t){t.getTarget()===c._startNode?t.setTarget(e):t.setSource(e)}),c._movedEdges.setExcluded(!1),c._movedEdges.setSelected(!0),c._movedEdges=null,c._refreshHandles()}},c._refreshHandles=function(){if(c._enabled&&!c._movedEdges){var t=c._selection.getSelectedEdges();c._nodesToHighlight=t.getExtremities().dedupe(),c._rewirableClass.clearEdges(),c._rewirableClass.add(t),c._refreshCanvas()}},c._shouldInteractionStart=function(t){var e=t.target;if(!(c._enabled&&e&&e.isNode&&c._hoverHandle))return!1;var r=e.getAdjacentEdges().filter(function(t){return t.isSelected()});return!!r.size&&(c._movedEdges=r,c._edgeColors=c._movedEdges.getAttribute("color"),c._startNode=e,!0)},c._refreshCanvas=function(){if(c._enabled&&c._nodesToHighlight){var o=c._captor.getCursorPosition(),t=c._getPointedNode(),a=c._camera.zoom,s=c._canvas.getContext("2d"),u=St(),e=c._options.color,l=c._options.radius,d=2*l*u;s.clearRect(0,0,c._canvas.width,c._canvas.height),c._displayMovedEdges(),s.fillStyle=e,s.strokeStyle=e;var h=!1;if(c._nodesToHighlight.forEach(function(t){var e=t.getPositionOnScreen(),r=e.x,i=e.y,n=Number(t.getAttribute("radius"))*("fixed"===t.getAttribute("scalingMethod")?1:a);l<n&&(s.fillRect((r-l)*u,(i-l)*u,d,d),distance(r,i,o.x,o.y)<l&&(h=!0))}),c._movedEdges){var r=t?t.getPositionOnScreen():o;s.fillRect((r.x-l)*u,(r.y-l)*u,d,d)}h?c._enableCursorOnHover():c._disableCursorOnHover()}},c._captor=o,c._camera=n,c._graphics=i,c._selection=a,c._events=s,c._settings=u,c._interactions=l,c._classes=r,c._rewirableClass=c._classes.createClass({name:fr,isBuiltin:!0,edgeAttributes:{layer:4}}),c._events.on(((e={})[be.CAMERA_MOVE]=c._refreshCanvas,e[be.MOVE]=c._refreshCanvas,e[be.NODES_DRAG_PROGRESS]=c._refreshCanvas,e[be.DOWN]=function(){c._hoverHandle&&(c._grabHandle=!0)},e[be.UP]=function(){return c._grabHandle=!1},e)),c._interaction=c._interactions.onDrag({priority:"rewiring",check:c._shouldInteractionStart,onStart:c._onDragStart,onProgress:function(t){var e=t.x,r=t.y;c._x=e,c._y=r},onStop:c._onDragEnd}),c}var Hv,qv={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},Wv=(b(Xv,Hv=Ee),Xv.prototype.onMounted=function(t){t.events.onNodesSelected(this._onSelectionChange),t.events.onNodesUnselected(this._onSelectionChange)},Xv.prototype._enableCursor=function(){this._cursorEnabled||(this._graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)},Xv.prototype._disableCursor=function(){this._cursorEnabled&&(this._graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)},Xv.prototype._detectBoundingBoxes=function(s,u){var l=this;if(this._enabled&&!this._nodeBeingResized&&this._nodesToHighlight){var d=this._options.handleSize/2,h=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight(function(t,e,r){var i=e.x+r-d-h,n=e.x+r+d+h,o=e.y-r-d-h,a=e.y-r+d+h;i<=s&&s<=n&&o<=u&&u<=a&&(l._pointedNode=t)}),this._pointedNode?this._enableCursor():this._disableCursor()}},Xv.prototype._forEachNodeToHighlight=function(i){var n=this;this._nodesToHighlight&&this._nodesToHighlight.forEach(function(t){var e=t.getPositionOnScreen(),r=n._getTotalOnScreenRadius(t);i(t,e,r)})},Xv.prototype._displayHandles=function(){var d=this;if(this._enabled&&this._nodesToHighlight){var t=this._canvas,h=this._ctx,e=t.width,r=t.height,c=St(),i=this._options,f=i.color,g=i.lineWidth,p=i.handleSize,_=0;if(h.clearRect(0,0,e,r),this._nodeBeingResized){var n=this._getTotalOnScreenRadius(this._nodeBeingResized),o=this._nodeBeingResized.getPositionOnScreen();_=Math.max(this._x-(o.x+n),-(this._y-(o.y-n)))/2}this._additionalRadiuses=[],this._forEachNodeToHighlight(function(t,e,r){var i=0;if(d._nodeBeingResized){i=_;var n=-r+Number(t.getAttribute("innerStroke.width"))+Number(t.getAttribute("outerStroke.width"))+g/2+1;i=i<n?n:d._snap(t,i),d._additionalRadiuses.push(i);var o=t.getAttribute("shape"),a=d._engine.getShapePoints(o),s=e.x+i,u=e.y-i,l=r+i;d._displayNodePreview(h,c,s,u,l,a)}h.strokeStyle=f,h.fillStyle=f,h.lineWidth=g,h.strokeRect((e.x-r)*c,(e.y-r-2*i)*c,2*(i+r)*c,2*(i+r)*c),h.fillRect((e.x+r+2*i-p/2)*c,(e.y-r-2*i-p/2)*c,p*c,p*c)})}},Xv.prototype._displayNodePreview=function(t,e,r,i,n,o){if(r*=e,i*=e,n*=e,t.beginPath(),1===o.length)t.arc(r,i,n,0,2*Math.PI);else for(var a=0;a<o.length;++a){var s=o[a],u=r+s.x*n,l=i+s.y*n;0===a?t.moveTo(u,l):t.lineTo(u,l)}t.fillStyle=this._options.previewColor,t.fill()},Xv.prototype._getTotalOnScreenRadius=function(t){return Number(t.getAttribute("radius"))*this._camera.zoom+Number(t.getAttribute("innerStroke.width"))+Number(t.getAttribute("outerStroke.width"))+this._options.lineWidth/2},Xv.prototype._snap=function(t,e){var r=this,i=this._spatial.getNodesInScreenByDistance(t).filter(function(t){return!t.isSelected()}).slice(0,this._options.nbNodesToSnapTo),n=this._ctx,o=this._getTotalOnScreenRadius(t),a=o+e,s=this._options.snappingRatio,u=a/o,l=Math.round(Je(u,s)),d=o*Math.pow(s,l),h=null;if(i.forEach(function(t){var e=r._getTotalOnScreenRadius(t);Math.abs(e-a)<=Math.abs(d-a)&&(d=e,h=t)}),h){n.save(),n.strokeStyle=this._options.sizeIndicatorColor,n.lineWidth=this._options.sizeIndicatorThickness;var c=h.getAttribute("radius");this._displaySizeIndicator(t,d),i.filter(function(t){return t.getAttribute("radius")===c}).forEach(function(t){return r._displaySizeIndicator(t)}),n.restore()}return d-o},Xv.prototype._displaySizeIndicator=function(t,e){var r=this._ctx,i=St(),n=t.getPositionOnScreen(),o=this._getTotalOnScreenRadius(t),a=e||o,s=e?e-o:0,u=s-this._options.sizeIndicatorOffset-(e?Number(t.getAttribute("innerStroke.width"))+Number(t.getAttribute("outerStroke.width")):0),l=n.x-a+u|0,d=n.y-a-s|0,h=n.y+a-s|0,c=this._options.sizeIndicatorWidth;r.beginPath(),r.moveTo((l-c)*i,d*i),r.lineTo((l+c)*i,d*i),r.moveTo(l*i,d*i),r.lineTo(l*i,h*i),r.moveTo((l-c)*i,h*i),r.lineTo((l+c)*i,h*i),r.stroke()},Xv.prototype.enable=function(t){var e;this._enabled||(this._options=I(I({},qv),t),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._events.on(((e={})[[be.CAMERA_MOVE,be.NODES_DRAG_PROGRESS].join(" ")]=this._displayHandlesHandler,e[[be.MOVE,be.DOWN].join(" ")]=this._moveHandler,e)),this._enabled=!0)},Xv.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._displayHandlesHandler),this._events.removeListener(this._moveHandler),this._graphics.removeCanvas(this._canvas),this._disableCursor(),this._reset())},Xv.prototype._reset=function(){this._enabled=!1,this._nodesToHighlight=null,this._options=I({},qv),this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]},Xv.prototype.enabled=function(){return this._enabled},Xv);function Xv(t){var e=t.dom,r=t.interactions,i=t.camera,n=t.events,o=t.graphics,a=t.spatial,s=t.selection,u=Hv.call(this)||this;return u._enabled=!1,u._nodesToHighlight=null,u._cursorEnabled=!1,u._x=0,u._y=0,u._additionalRadiuses=[],u._onSelectionChange=function(){u._enabled&&(u._nodesToHighlight=u._selection.getSelectedNodes(),u._displayHandles())},u._displayHandlesHandler=function(){return u._displayHandles()},u._moveHandler=function(t){var e=t.x,r=t.y;u._dom.setTimeout(function(){return u._detectBoundingBoxes(e,r)})},u._dom=e,u._interactions=r,u._events=n,u._camera=i,u._dom=e,u._spatial=a,u._graphics=o,u._selection=s,u._engine=u._graphics.getGraphicsEngine(),u._canvas=En(),u._ctx=u._canvas.getContext("2d"),u._interactions.onDrag({priority:"resizing",disableDetection:!0,check:function(){return!(!u._enabled||!u._pointedNode)},onStart:function(t){var e=t.x,r=t.y;u._x=e,u._y=r,u._nodeBeingResized=u._pointedNode},onProgress:function(t){var e=t.x,r=t.y;u._x=e,u._y=r,u._displayHandles()},onStop:function(){u._nodesToHighlight&&u._nodesToHighlight.forEach(function(t,e){var r=u._additionalRadiuses[e]/u._camera.zoom;t.setAttributes({radius:Number(t.getAttribute("radius"))+r,x:t.getPosition().x+r,y:t.getPosition().y-r})}),u._pointedNode=null,u._nodeBeingResized=null,u._displayHandles()}}),u}var Yv,Zv,Kv,Qv={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:function(){return!0},onNodeCreated:function(){},onEdgeCreated:function(){},onComplete:function(){}},Jv=(b($v,Yv=Ee),$v.prototype._onStart=function(t){t&&(this._cursorEnabled=!0,this._startNode=t,this._startPos=t.getPosition(),this._graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._graphics.allocateGraphicsEngineBlockId())},$v.prototype._onMove=function(t,e){null!==this._startNode&&(this._endPos=this._camera.screenToGraphCoordinates({x:t,y:e}),this._drawLine())},$v.prototype._onStop=function(){if(null!==this._startNode){var t=this._options,e=t.condition,r=t.onNodeCreated,i=t.onEdgeCreated,n=t.onComplete,o=t.createNodes,a=this._captor.getPointedElement(),s=null,u=null;this._graphics.releaseGraphicsEngineBlockId(this._blockId),!a&&o&&(u=a=this._graph.addNode({attributes:{x:this._endPos.x,y:this._endPos.y}}),r&&r(u)),a&&(u||!e||e(this._startNode,a))&&(s=this._graph.addEdge({source:this._startNode.getId(),target:a.getId()}),i&&i(s)),n&&(this._events.fire(be.CONNECT_NODES,{source:this._startNode,target:a,edge:s}),n(this._startNode,a,s||void 0)),this.disable()}},$v.prototype._drawLine=function(){this._group.reset(1,!1,this._depth);var t=this._group.nextAndReset().end;t.pieceId=Gi,t.shape="line",t.x1=this._startPos.x,t.y1=this._startPos.y,t.x2=this._endPos.x,t.y2=this._endPos.y,t.fillColor=this._options.strokeColor,t.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(t.dashLength=3,t.gapLength=1),this._engine.storeGroup(this._blockId,this._group),this._dom.refresh()},$v.prototype.enable=function(t){return void 0===t&&(t={}),this._enabled||(this._options=I(I({},Qv),t),this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorInformation())),this},$v.prototype.disable=function(){return this._enabled&&(this._enabled=!1,this._settings.update(this._prevSettings),this._cursorEnabled&&this._graphics.removeCursorStyle(this._options.cursorStyle)),this},$v.prototype.enabled=function(){return this._enabled},$v);function $v(t){var e=t.dom,r=t.camera,i=t.captor,n=t.graph,o=t.graphics,a=t.interactions,s=t.events,u=t.settings,l=Yv.call(this)||this;return l._enabled=!1,l._blockId=0,l._cursorEnabled=!1,l._dom=e,l._camera=r,l._captor=i,l._graph=n,l._graphics=o,l._interactions=a,l._events=s,l._settings=u,l._engine=l._graphics.getGraphicsEngine(),l._group=l._engine.createGroup(),l._depth=rd(0).edgeBody,l._events.register([be.CONNECT_NODES]),l._interaction=l._interactions.onDrag({priority:"connectNodes",check:function(t){var e=t.target,r=t.button,i=void 0===r?"left":r;return l._enabled&&"left"===i&&e&&e.isNode},onStart:function(t){var e=t.target;return l._onStart(e)},onProgress:function(t){var e=t.x,r=t.y;return l._onMove(e,r)},onStop:function(){return l._onStop()}}),l._events.on(be.CLEAR_GRAPH,function(){return l.disable()}),l}var tm,em=["top","bottom","left","right","cssDefined"],rm={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},im={position:"top",autoAdjust:!0,delay:100},nm={hover:{node:function(t){var e=t.target;return e&&e.isNode},edge:function(t){var e=t.target;return e&&!e.isNode}},click:((Zv={})[$f.LEFT]={node:function(t){var e=t.target;return t.button===$f.LEFT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===$f.LEFT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===$f.LEFT&&!e}},Zv[$f.RIGHT]={node:function(t){var e=t.target;return t.button===$f.RIGHT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===$f.RIGHT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===$f.RIGHT&&!e}},Zv),doubleClick:((Kv={})[$f.LEFT]={node:function(t){var e=t.target;return t.button===$f.LEFT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===$f.LEFT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===$f.LEFT&&!e}},Kv[$f.RIGHT]={node:function(t){var e=t.target;return t.button===$f.RIGHT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===$f.RIGHT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===$f.RIGHT&&!e}},Kv)},om=(b(am,tm=Ee),am.prototype.hide=function(){this._hideTooltip(!0)},am.prototype.isShown=function(){return!!this._tooltip},am.prototype.refresh=function(){this._refreshTooltip()},am.prototype.show=function(t,e){var r=void 0===e?{}:e,i=r.position,n=void 0===i?"top":i,o=r.autoAdjust,a=void 0===o||o,s=r.className,u=r.x,l=void 0===u?0:u,d=r.y,h=void 0===d?0:d;this._showTooltip(t,{position:n,autoAdjust:a,className:s},{x:l,y:h})},am.prototype.setHandler=function(t,e,r){var i=I(I({},im),r);i.position&&-1===em.indexOf(i.position)&&(i.position="top"),this._handlers[t]={handler:e,condition:H(nm,t),settings:i}},am.prototype._hideTooltip=function(t){if(this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null),t&&(this._currentHandlerName=null),this._tooltip){var e=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._events.fire(be.TOOLTIP_HIDE,{tooltip:e})}},am.prototype._createInteraction=function(n,o){var a=this;return void 0===o&&(o=!1),{priority:"tooltip",check:function(t){var e=sm(n,t),r=a._handlers[e];return!(o&&a._connectNodes.enabled()||(!r||!r.condition(t))&&(o||!a._currentHandlerName||a._isHover||null===a._tooltip))},handler:function(t){var e=t.target,r=t.x,i=t.y;a._hideTooltip(!1),a._isHover=o,a._elt=e,a._x=r,a._y=i,a._currentHandlerName=sm(n,t),a._refreshTooltip()}}},am.prototype._refreshTooltip=function(){var e=this;if(this._currentHandlerName){var t=this._handlers[this._currentHandlerName];if(t){var r=t.settings,i=t.handler,n=this._elt;if(n){var o=n.isNode?"node":"edge";if(-1===this._currentHandlerName.indexOf(o))return}var a=i(n);Promise.resolve(a).then(function(t){e._schedule(function(){return e._showTooltip(t,r)},r.delay)})}}else this._hideTooltip(!1)},am.prototype._schedule=function(t,e){var r=this;this._timeout&&this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){r._timeout=null,t()},e)},am.prototype._showTooltip=function(t,e,r){this._hideTooltip(!1);var i=e.position,n=e.className,o=e.autoAdjust,a=this._x,s=this._y,u=this._elt,l=this._dom.getDimensions(),d=0,h=0;if(r&&(a=r.x,s=r.y,u=null),"string"==typeof t)this._tooltip=function(t){return ht?document.createElement(t):At()}("div"),this._tooltip.innerHTML=t;else{if(!Bt(t))throw new Error("invalid tooltip "+t+", expected HTML string or HTML element");this._tooltip=t}var c=this._tooltip;if(n&&this._tooltip.classList.add(n),"cssDefined"!==i&&(c.style.position="absolute"),this._dom.appendElement(c),u&&u.isNode){var f=u,g=f.getPositionOnScreen(),p=Number(f.getAttribute("radius"))*("fixed"===f.getAttribute("scalingMethod")?1:this._camera.getZoom())+Number(f.getAttribute("innerStroke.width"))+Number(f.getAttribute("outerStroke.width"));a=g.x,s=g.y,h=d=p}var _=c.offsetWidth/2,v=c.offsetHeight/2;if(d+=_,h+=v,i&&"cssDefined"!==i){var m=rm[i],y=m.x,b=m.y;if(o){var x=a+d*m.x,E=s+h*m.y;(x-_<0||x+_>=l.width)&&("left"===i||"right"===i?y*=-1:y=x-_<0?(_-x+1)/d:(l.width-(x+_)-1)/d),(E-v<0||E+v>=l.height)&&("top"===i||"bottom"===i?b*=-1:b=E-v<0?(v-E+1)/h:(l.height-(E+v)-1)/h)}c.style.left=a+d*y-_+"px",c.style.top=s+h*b-v+"px"}this._events.fire(be.TOOLTIP_SHOW,{tooltip:c})},am);function am(t){var e,r=t.dom,i=t.connectNodes,n=t.interactions,o=t.camera,a=t.events,s=tm.call(this)||this;return s._x=0,s._y=0,s._dom=r,s._connectNodes=i,s._interactions=n,s._camera=o,s._events=a,s._handlers={},s._currentHandlerName=null,s._tooltip=null,s._isHover=!1,s._events.register(["showTooltip","hideTooltip"]),s._events.on(((e={})[be.UP+" "+be.DRAG_START]=function(){s._isHover||s._hideTooltip(!1)},e[be.UNHOVER]=function(){s._isHover&&s._hideTooltip(!1)},e[be.CLEAR_GRAPH]=function(){return s._hideTooltip(!1)},e)),s._interactions.onHover(s._createInteraction("hover",!0)),s._interactions.onClick(s._createInteraction("click")),s._interactions.onDoubleClick(s._createInteraction("doubleClick")),s}function sm(t,e){var r=e.button,i=e.target;return t+(r?"."+r:"")+"."+(null!==i?i.isNode?"node":"edge":"background")}var um,lm={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},dm=Object.keys(lm).reduce(function(t,e){var r=lm[e];return t[r]||(t[r]=[]),t[r].push(e),t},{}),hm=(b(cm,um=Ee),cm.prototype.setIdleTimeout=function(t){if(!isFinite(t)||t<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=t},cm.prototype.resetKeys=function(){for(var t=0;t<this._pressed.length;t++)this._pressed[t]&&(this._pressed[t]=!1,this._events.fire("keyUp",{key:lm[t],code:t}))},cm.prototype.onKeyPress=function(t,e){var r=this,i=[];if("number"==typeof t)i=[t];else if("string"==typeof t)i=t.split(" ");else{if(!Array.isArray(t))throw new TypeError(t+" is not a number, string or array");i=t}if(0===i.length)throw new Error("the array should contain at least one element");var n=i.map(function(t){if("number"==typeof t)return[t];if("string"!=typeof t)throw new TypeError(t+" is not a valid key identifier");var e=dm[t];if(!e)throw new Error(t+" is not a valid key identifier");return e}),o=n.pop(),a={keys:n,handler:e};o&&o.forEach(function(t){r._binds[t]||(r._binds[t]=[]),r._binds[t].push(a)})},cm.prototype.isPressed=function(t){var e=this;if("number"==typeof t)return this._pressed[t];if("string"==typeof t){var r=dm[t];if(r)return r.some(function(t){return e._pressed[t]})}return!1},cm);function cm(t){var e=t.dom,r=t.events,a=um.call(this)||this;return a._onBlur=function(){return a.resetKeys()},a._onKeyUp=function(t){var e=t.keyCode||t.which;a._pressed[e]=!1,a._events.fire("keyUp",{domEvent:t,key:lm[e],code:e})},a._onKeyDown=function(t){var e=t.keyCode||t.which,r=a._binds[e];if(!a._pressed[e]){if(a._pressed[e]=!0,r)for(var i=0,n=r;i<n.length;i++){var o=n[i];o.keys.every(function(t){return t.some(function(t){return a._pressed[t]})})&&o.handler({domEvent:t})}a._events.fire("keyDown",{domEvent:t,key:lm[e],code:e})}},a._events=r,a._events.register(["keyUp","keyDown"]),a._binds=[],a._pressed=[],e.addWindowEventListener("keydown",a._onKeyDown),e.addWindowEventListener("keyup",a._onKeyUp),e.addWindowEventListener("visibilitychange",a._onBlur),e.addWindowEventListener("blur",a._onBlur,!1),a._idleTimeout=4e3,a._prevEventTimeStamp=Zt(),a._events.onAnyEvent(function(){var t=Zt();t-a._prevEventTimeStamp>a._idleTimeout&&a.resetKeys(),a._prevEventTimeStamp=t}),a}var fm=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],gm=Math.PI,pm=2*Math.PI,_m=Math.cos(gm/2-pm/5),vm=Math.cos(gm/2-pm/5*2),mm=Math.cos(gm/2-pm/5*3),ym=Math.cos(gm/2-pm/5*4),bm=Math.sin(-gm/2+pm/5),xm=Math.sin(-gm/2+pm/5*2),Em=Math.sin(-gm/2+pm/5*3),Am=Math.sin(-gm/2+pm/5*4),Sm=1.6,wm=3,Tm=.9,Cm=.31,Mm=1/3,Im=[8,3],Lm=[3,3],Nm={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:function(t){return t[t.length-1]}},Om=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function km(t){var e=["K","M","B","T","P","E","Z","Y"];if(9999<t){for(var r=0;r<e.length&&999<t;)t/=1e3,r++;return(Rm(t,3)+e[r-1]).toString()}return Rm(t,4).toString()}function Rm(t,e){void 0===e&&(e=3);var r=4===e?10:1;return t<10?Math.round(100*t*r)/(100*r):t<100?Math.round(10*t*r)/(10*r):t<1e3?Math.round(t*r)/r:Math.round(t)}function Fm(t){return t.innerMargin+(t.titleFontSize+t.fontSize)*Sm}function Dm(c,t,e){var r,i,f=t.getContext("2d"),n=e.x,o=e.y,a=e.height,g=e.isNode,p=e.styleProperty,s=e.title,_=e.mapping,v=e.iconFont,m=e.iconFontStyle;i=a,function(t,e,r,i,n,o,a,s,u){t.setLineDash([]),t.beginPath(),t.moveTo(e+o,r),t.lineTo(e+i-o,r),t.quadraticCurveTo(e+i,r,e+i,r+o),t.lineTo(e+i,r+n-o),t.quadraticCurveTo(e+i,r+n,e+i-o,r+n),t.lineTo(e+o,r+n),t.quadraticCurveTo(e,r+n,e,r+n-o),t.lineTo(e,r+o),t.quadraticCurveTo(e,r,e+o,r),t.closePath(),t.fillStyle=a,t.fill(),t.strokeStyle=s,t.lineWidth=u,t.stroke()}(f,n,o,(r=c).widgetWidth,i,r.borderRadius,r.backgroundColor,r.borderColor,r.borderWidth),function(t,e,r,i,n){Pm(t,e.fontFamily,e.titleFontSize,e.titleFontColor,e.titleTextAlign);var o="center"===e.titleTextAlign,a=e.widgetWidth-2*e.innerMargin,s=t.measureText(r).width,u=i+(o?e.widgetWidth/2:e.innerMargin),l=n+e.titleFontSize/2+e.innerMargin;if(a<s){var d=a/s,h=(r.length*d|0)-2;r=r.substr(0,h)+""}t.fillText(r,u,l)}(f,c,s,n,o);var u,y=c.fontSize*Sm,b=c.fontSize/2*Sm*Tm,x=c.fontSize*wm,E=c.fontSize,l=(u=g?1:wm,c.fontSize*u),A=o+Fm(c),S=n+c.innerMargin+l/2,w=n+2*c.innerMargin+l,d=U(_),T=function r(t){return Array.isArray(t)?t.reduce(function(t,e){return t&&r(e)},!0):"undefined"===t||!isNaN(Number(t))}(d),C=c.fontColor,M=c.shapeColor,h=Object.keys(_);if(T&&(h.sort(function(t,e){return Qe(_[e])-Qe(_[t])}),"radius"===p||"width"===p)){var I=function r(t){return Array.isArray(t)?t.reduce(function(t,e){return Math.min(t,r(e))},1/0):isNaN(t)?1/0:+t}(d),L=function r(t){return Array.isArray(t)?t.reduce(function(t,e){return Math.max(t,r(e))},-1/0):isNaN(t)?-1/0:+t}(d),N=Math.round((I+L)/2);return(g?Bm:Um)(c,f,n,A,I,N,L,M)}h.forEach(function(t){var e,r,i,n,o,a,s,u,l,d,h=_[t];"color"===p&&(g?zm(f,S,A,b,t):(r=S,i=A,n=x,o=E,a=t,(e=f).fillStyle=a,e.fillRect(r-n/2,i-o/2,n,o))),"shape"===p&&(g?function(t,e,r,i,n,o){switch(t.fillStyle=o,n){case"square":return t.fillRect(e-i,r-i,2*i,2*i);case"circle":return zm(t,e,r,i,o);case"cross":return function(t,e,r,i){t.fillRect(e-i,r-i*Cm,2*i,2*i*Cm),t.fillRect(e-i*Cm,r-i,2*i*Cm,2*i)}(t,e,r,i);case"diamond":return function(t,e,r,i){t.beginPath(),t.moveTo(e-i,r),t.lineTo(e,r-i),t.lineTo(e+i,r),t.lineTo(e,r+i),t.fill()}(t,e,r,i);case"equilateral":return function(t,e,r,i){t.beginPath(),t.moveTo(e,r-i),t.lineTo(e+_m*i,r+bm*i),t.lineTo(e+vm*i,r+xm*i),t.lineTo(e+mm*i,r+Em*i),t.lineTo(e+ym*i,r+Am*i),t.fill()}(t,e,r,i);case"star":(function(t,e,r,i){t.beginPath(),t.moveTo(e,r-i),t.lineTo(e+vm*i,r+xm*i),t.lineTo(e+ym*i,r+Am*i),t.lineTo(e+_m*i,r+bm*i),t.lineTo(e+mm*i,r+Em*i),t.fill()})(t,e,r,i)}}(f,S,A,b,t,M):function(t,e,r,i,n,o,a){t.fillStyle=a,"line"===o&&t.fillRect(e-i/2,r-n/4,i,n/2);if("arrow"===o)return function(t,e,r,i,n){t.fillRect(e-i/2,r-n/4,i*(1-Mm),n/2),t.beginPath(),t.moveTo(e+i*(1-Mm-.5),r-n/2),t.lineTo(e+i*(1-Mm-.5),r+n/2),t.lineTo(e+i/2,r),t.fill()}(t,e,r,i,n);if("dashed"===o||"dotted"===o)return function(t,e,r,i,n,o,a){t.beginPath(),t.moveTo(e-i/2,r),t.lineTo(e+i/2,r),t.strokeStyle=o,t.lineWidth=n/2,t.setLineDash("dashed"===a?Im:Lm),t.stroke()}(t,e,r,i,n,a,o);if("tapered"===o)(function(t,e,r,i,n){t.beginPath(),t.moveTo(e-i/2,r-n/2),t.lineTo(e-i/2,r+n/2),t.lineTo(e+i/2,r),t.fill()})(t,e,r,i,n)}(f,S,A,x,E,t,M)),"icon.content"===p&&(u=S,l=A,d=t,Pm(s=f,v,2*b,C,"center",m),s.fillText(d,u,l)),"image"!==p&&"image.url"!==p||function(t,e,r,i,n){if("undefined"==typeof Image)return;t._imgStore||(t._imgStore={});var o=t._imgStore[n];if(o)return t.drawImage(o,e-i,r-i,2*i,2*i);(o=new Image).src=n,o.onload=function(){t.drawImage(o,e-i,r-i,2*i,2*i)},t._imgStore[n]=o}(f,S,A,b,t),function(t,e,r,i,n,o){var a=n.join();if(o)if(1===n.length)a=km(n[0]);else{var s=Qe(n),u=Ke(n);a=km(s)+" - "+km(u)}Pm(t,e.fontFamily,e.fontSize,e.fontColor),t.fillText(a,r,i)}(f,c,w,A,h,T),A+=y})}function Pm(t,e,r,i,n,o){void 0===n&&(n="left"),void 0===o&&(o="normal");t.textAlign=n,t.textBaseline="middle",t.fillStyle=i,t.font=o+" "+r+'px "'+e+'"'}function zm(t,e,r,i,n){t.beginPath(),t.arc(e,r,i,0,2*gm),t.fillStyle=n,t.fill()}function Bm(t,e,r,i,n,o,a,s){for(var u,l,d,h,c,f,g=.7*t.fontSize,p=3*g,_=(g+p)/2,v=r+t.innerMargin+p,m=v+p+t.innerMargin,y=i+2*p-.5*t.innerMargin,b=t.circleStrokeWidth,x=0,E=[g,_,p];x<E.length;x++){var A=E[x];l=v,d=y-A,h=A,c=s,f=b,(u=e).beginPath(),u.arc(l,d,h,0,pm),u.strokeStyle=c,u.lineWidth=f,u.stroke()}Pm(e,t.fontFamily,t.fontSize,t.fontColor,"left"),e.fillText(km(n),m,y+g-2*g),e.fillText(km(o),m,y+g-2*_),e.fillText(km(a),m,y+g-2*p)}function Um(t,e,r,i,n,o,a,s){var u=(t.widgetWidth-2*t.innerMargin)/3,l=t.fontSize,d=i-t.innerMargin/2,h=d+2*l,c=r+t.innerMargin;e.fillStyle=s,e.fillRect(c,d-l/2,1+u,l),e.fillRect(c+u,d-l/3,1+u,l/1.5),e.fillRect(c+2*u,d-l/6,u,l/3),Pm(e,t.fontFamily,t.fontSize,t.fontColor,"center"),e.fillText(km(a),c+.5*u,h),e.fillText(km(o),c+1.5*u,h),e.fillText(km(n),c+2.5*u,h)}function Vm(e,r,t){var i={width:r.width,height:r.height},n=!1;return i.width&&i.height&&t&&((n="top"===e.position||"bottom"===e.position?function(t,e,r,i){r=r.slice();for(var n=e.widgetWidth+e.outerMargin,o=Math.floor((t.width-e.outerMargin)/n),a=t.height-e.outerMargin,s=new Array(Math.min(o,r.length)),u=r.length,l=0,d=0,h=0,c=0,f=0;f<u;++f){(S=r[f]).isNode?(l+=1,d+=S.height):(h+=1,c+=S.height)}var g=d+c,p=d/g,_=c/g,v=Math.round(p*o),m=Math.round(_*o);l<v?v=l:h<m&&(v=o-h);if(0===o)return!1;for(f=0;f<s.length;f++)s[f]={content:[],height:0,isNode:f<v};for(f=0;f<u;++f){var y=Gm(r);jm(r[y],s,e),r.splice(y,1)}s.every(function(t){return 1===t.content.length})?s.sort(Xm):s.sort(Wm);var b=e.outerMargin;for(f=0;f<s.length;++f){var x=s[f];if(x.height>a)return!1;x.content.sort(qm);for(var E=0,A=0;A<x.content.length;++A){var S;(S=x.content[A]).x=b,S.y=i?t.height-E-S.height-e.outerMargin:E+e.outerMargin,E+=S.height+e.outerMargin}b+=n}return!0}(i,e,t,"bottom"===e.position):function(t,e,r,i){var n=e.widgetWidth+e.outerMargin,o=Math.floor((t.width-e.outerMargin)/n),a=t.height,s=e.outerMargin,u=i?e.outerMargin:t.width-n,l=1;r=r.slice().sort(Hm);for(var d=0;d<r.length;++d){var h=r[d];if(s+h.height>a){if(s===e.outerMargin)return!1;s=e.outerMargin,l+=1,i?u+=n:u-=n}h.x=u,h.y=s,s+=h.height}return l<=o}(i,e,t,"left"===e.position))&&t.forEach(function(t){return Dm(e,r,t)}),n)}function jm(t,e,r){for(var i=null,n=0;n<e.length;++n){var o;(o=e[n]).isNode!==t.isNode&&1!==e.length||!(null===i||o.height<e[i].height)||(i=n)}null!=i&&((o=e[i]).content.push(t),o.height+=t.height+r.outerMargin)}function Gm(t){for(var e=0,r=1;r<t.length;++r)t[r].height>t[e].height&&(e=r);return e}function Hm(t,e){return t.isNode!==e.isNode?t.isNode?-1:1:t.title<=e.title?-1:1}function qm(t,e){return t.height-e.height}function Wm(t,e){return t.isNode!==e.isNode?t.isNode?-1:1:e.height-t.height}function Xm(t,e){return t.isNode!==e.isNode?t.isNode?-1:1:t.content[0].title<=e.content[0].title?-1:1}var Ym,Zm=(b(Km,Ym=Ee),Km.prototype.enable=function(t){void 0===t&&(t={});var e=this._settings;return this._settings=I(I({},Nm),t),this._mustRefresh=!this._enabled||!this._sameOptions(e,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._graphics.addCanvas(this._canvas),this.refresh())},Km.prototype._afterNextUpdate=function(){var e=this;return new Promise(function(t){return e._promises.push(t)})},Km.prototype._formatSettings=function(t,e){var r=I(I({},Nm),t);return Om.forEach(function(t){return r[t]*=e}),r},Km.prototype.disable=function(){return this._enabled&&(this._enabled=!1,this._graphics.removeCanvas(this._canvas)),Promise.resolve()},Km.prototype.enabled=function(){return this._enabled},Km.prototype.refresh=function(){return this._mustRefresh=!0,this._dom.refresh(),this._afterNextUpdate()},Km.prototype.destroy=function(){this._enabled=!1,this._mustRefresh=!1,this._settings=I({},Nm),this._promises=[]},Km.prototype.getOptions=function(){return this._enabled?I({},this._settings):I({},Nm)},Km.prototype.getCurrentOptions=function(){return this._settings},Km.prototype._sameOptions=function(r,i){return r===i||Object.keys(r).reduce(function(t,e){return t&&r[e]===i[e]},!0)},Km.prototype._drawOnCanvas=function(t,e,r){var i=this._formatSettings(t,r);Vm(i,e,this._computeWidgetList(i))},Km.prototype.exportOnCanvas=function(t,e){return this._drawOnCanvas(e,t,1)},Km.prototype._computeWidgetList=function(n){var o=this,a=[];return fm.forEach(function(t){var e=t.name,r=t.isNode,i=o._computeWidget(n,e,r);i&&a.push(i)}),a},Km.prototype._computeWidget=function(t,e,r){var i=this._computePropertyMapping(t,e,r);if(i){if("icon.content"!==e)return i;var n=this._getRulesForAttribute(r,"icon.font"),o=this._getRulesForAttribute(r,"icon.style"),a=null,s=null;if(n.length||(a="Arial",s="normal"),"string"==typeof n[0]&&(a=n[0],s=o[0]),a&&s)return i.iconFont=a,i.iconFontStyle=s,i}return null},Km.prototype._computePropertyMapping=function(t,e,r){var i,n,o,a,s,u,l,d=this._getRulesForAttribute(r,e)[0],h=d&&d.mapping,c=h&&h.getValues(r);if(h&&c){var f=h.getField(),g={};return V(c,function(t,e){void 0!==t&&"undefined"!==e&&(g[t]=g[t]||[],g[t].push(e))}),0===Object.keys(g).length?null:{isNode:r,title:t.titleFunction(f),styleProperty:e,dataProperty:f,mapping:g,height:(i=g,n=e,o=r,s=(a=t).outerMargin+Fm(a),u=a.fontSize*Sm,l=s-.8*a.innerMargin,"radius"===n||"width"===n?l+u*(o?3:2):l+Object.keys(i).length*u)}}return null},Km.prototype._getRulesForAttribute=function(r,i){return this._styleRules.getRuleList().map(function(t){var e=t.getDefinition();return H(r?e.nodeAttributes:e.edgeAttributes,i)}).filter(function(t){return t}).sort(function(t,e){return t.mapping&&e.mapping?0:t.mapping?-1:1})},Km);function Km(t){var e,r=t.graphics,i=t.dom,n=t.events,o=t.styleRules,a=Ym.call(this)||this;return a._enabled=!1,a._mustRefresh=!1,a._promises=[],a._graphics=r,a._dom=i,a._events=n,a._styleRules=o,a._canvas=En(),a._ctx=a._canvas.getContext("2d"),a._events.on(((e={})[be.NEW_FRAME]=function(){if(a._enabled&&a._mustRefresh){a._ctx.clearRect(0,0,a._canvas.width,a._canvas.height),a._drawOnCanvas(a._settings,a._canvas,St());var t=a._promises;a._promises=[],t.forEach(function(t){return t()}),a._mustRefresh=!1}},e[be.RESIZE+" "+be.RELOAD_FONTS]=function(){a._mustRefresh=!0},e)),a}var Qm,Jm={layer:3,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},$m={layer:3,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},ty=(b(ey,Qm=Ee),ey.prototype.setRate=function(t){this._delay=t},ey.prototype.updateNodeAttributes=function(t,e){this._hoverClass.update({nodeAttributes:t,fullOverwrite:e}),this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},ey.prototype.updateEdgeAttributes=function(t,e){this._hoverClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},ey.prototype.getHoverClassDefinition=function(){return this._hoverClass.getDefinition()},ey.prototype.onMounted=function(t){function e(){r._hoverExtremityHighlightedClass.clearNodes(),r._hoverClass.getEdges().getExtremities().addClass(lr)}var r=this;this._classes.onEdgeClassAdded(ur,e),this._classes.onEdgeClassRemoved(ur,e)},ey.prototype._registerSettings=function(){var e=this;this._settings.register("cursor.node","pointer",function(value,t){e._hovered&&e._hovered.isNode&&(e._graphics.removeCursorStyle(t),e._graphics.addCursorStyle(value))}),this._settings.register("cursor.edge","pointer",function(value,t){e._hovered&&!e._hovered.isNode&&(e._graphics.removeCursorStyle(t),e._graphics.addCursorStyle(value))}),this._settings.register("nodeHover",!0,function(value){!value&&e._hovered&&e._hovered.isNode&&e._unhover(e._hovered)}),this._settings.register("edgeHover",!0,function(value){value||!e._hovered||e._hovered.isNode||e._unhover(e._hovered)})},ey.prototype._updateExtremityHighlightLayer=function(){var t=this._hoverClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})},ey.prototype._removeTimeout=function(){this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null)},ey.prototype._hover=function(t){var e=this,r=t.isNode?"nodeHover":"edgeHover";this._settings.get(r)&&!this._graphics.isAnimating()&&(this._removeTimeout(),this._timeout=this._dom.setTimeout(function(){e._graphics.isAnimating()||(e._setElementHighlight(!0,t),e._hovered=t),e._timeout=null},this._delay))},ey.prototype._unhover=function(t){this._removeTimeout(),this._hovered===t&&(this._setElementHighlight(!1,t),this._hovered=null)},ey.prototype._setElementHighlight=function(t,e){var r=this._settings.get(e.isNode?"cursor.node":"cursor.edge");t?(this._graphics.addCursorStyle(r),e.addClass(ur)):(this._graphics.removeCursorStyle(r),e.removeClass(ur)),e.isNode&&t&&this._graph.getAttribute(e.isNode,"textHidden").set(e._index,!1)},ey);function ey(t){var e,r=t.dom,i=t.classes,n=t.captor,o=t.graph,a=t.graphics,s=t.settings,u=t.events,l=Qm.call(this)||this;return l._delay=100,l._manualTriggerDetection=!1,l._hovered=null,l._onAnimate=function(t){t.duration&&(l._manualTriggerDetection=!0,l._resetHover())},l._onBeforeNewFrame=function(){if(l._manualTriggerDetection&&!l._graphics.isAnimating()){l._manualTriggerDetection=!1,l._captor.triggerDetection();var t=l._captor.getPointedElement();t&&l._hover(t)}},l._onClear=function(){l._hovered=null,l._timeout&&l._dom.clearTimeout(l._timeout)},l._resetHover=function(){l._hovered&&(l._unhover(l._hovered),l._captor.triggerUnhover()),l._timeout&&(l._dom.clearTimeout(l._timeout),l._timeout=null)},l._dom=r,l._graph=o,l._graphics=a,l._settings=s,l._captor=n,l._events=u,l._classes=i,l._registerSettings(),l._hoverExtremityHighlightedClass=l._classes.createClass({name:lr,isBuiltin:!0,nodeAttributes:Jm}),l._hoverClass=l._classes.createClass({name:ur,isBuiltin:!0,nodeAttributes:Jm,edgeAttributes:$m}),l._events.on(((e={})[be.HOVER]=function(t){var e=t.target;return e&&l._hover(e)},e[be.UNHOVER]=function(t){var e=t.target;return e&&l._unhover(e)},e[be.ANIMATE]=l._onAnimate,e[be.BEFORE_NEW_FRAME]=l._onBeforeNewFrame,e[be.MOUSE_LEAVE]=l._resetHover,e[be.CLEAR_GRAPH]=l._onClear,e)),l}var ry=function(){this.x=0,this.y=0},iy=(ny.prototype.getValue=function(t,e){var r=t.isNode,i=r?this._nodeMapping:this._edgeMapping;i.valid||(i.values=this._computeMapping(r),i.valid=!0);var n=t.getData(this._field);return Array.isArray(n)?"color"===e?n.map(function(t){return i.values[t]}):i.values[n[0]]:i.values[n]},ny.prototype.markAsInvalid=function(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1},ny.prototype.getValues=function(t){return t?this._nodeMapping.values:this._edgeMapping.values},ny.prototype.getField=function(){return this._field},ny);function ny(t,e){this._nodeMapping={valid:!1,values:{}},this._edgeMapping={valid:!1,values:{}},this._computeMapping=e,this._field=t}function oy(t,e,r){var i=(e?t.getNodes():t.getEdges()).getData(r),n={};return i.forEach(function(value){if(!Array.isArray(value))return n[value]=1;value.forEach(function(t){return n[t]=1})}),"undefined"in n&&delete n[void 0],Object.keys(n).sort()}function ay(t,e,r,i){for(var n=r.values,o=void 0===n?{}:n,a=r.fallback,s=oy(t,i,e),u={},l=0,d=0;d<s.length;++d){var value=s[d];value in o?u[value]=o[value]:(u[value]=a[l],l=(l+1)%a.length)}return u}function sy(t,e,r,i){for(var n=r.fallback,o=r.stops,a=void 0===o?{}:o,s=r.values,u=r.reverse,l=oy(t,i,e),d=1/0,h=-1/0,c=0;c<l.length;c++){o_(value=+l[c])&&(d=Math.min(d,value),h=Math.max(h,value),l[c]=value)}var f={};if(!isFinite(d)){for(c=0;c<l.length;c++)f[l[c]]=n;return f}var g=function(t,e){var r=e.nbSlices,i=e.minValue,n=e.maxValue;if(Array.isArray(t))return t.slice();for(var o=t.min,a=void 0===o?i:o,s=t.max,u=((void 0===s?n:s)-a)/r,l=[],d=1;d<r;++d)l.push(a+u*d);return l}(a,{nbSlices:Array.isArray(s)?s.length:s.nbSlices,minValue:d,maxValue:h}),p=function(t,e){if(Array.isArray(t))return t;for(var r=t.min,i=t.max,n=e.length+1,o=(i-r)/e.length,a=[],s=0;s<n;s++)a.push(r+s*o);return a}(s,g);u&&p.reverse();for(c=0;c<l.length;++c){var value=l[c];if(isFinite(value)){for(var _=0;_<g.length&&g[_]<=value;)_+=1;f[value]=p[_]}else f[value]=n}return f}var uy,ly=(b(dy,uy=Ee),dy.prototype.createMapping=function(t){var e=void 0===t?{field:""}:t,r=e.field,i=e.values,n=void 0===i?{}:i,o=e.fallback,a=void 0===o?void 0:o;if(r=R(r),Array.isArray(a)?0===a.length&&(a=[void 0]):a=[a],!B(n))throw new Error('"mapping" should be an object');return this._createMappingFunction(ay,r,{values:n,fallback:a})},dy.prototype.createSlices=function(t){var e=void 0===t?{field:"",values:[]}:t,r=e.field,i=e.fallback,n=void 0===i?void 0:i,o=e.stops,a=void 0===o?{}:o,s=e.values,u=e.reverse,l=void 0!==u&&u;if(r=R(r),Array.isArray(s)||s.nbSlices||(s.nbSlices=7),Array.isArray(a)&&Array.isArray(s)&&a.length!==s.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction(sy,r,{fallback:n,stops:a,values:s,reverse:l})},dy.prototype._createMappingFunction=function(e,r,i){var n=this,o=new iy(r,function(t){return e(n._graph,r,i,t)});function t(t,e,r){return o.getValue(t,r)}return this._mappingList.push(o),t.mapping=o,t},dy.prototype.createTemplate=function(t){if("string"!=typeof t)throw new TypeError('"template" should be a string');for(var i=[],e=0,r=!1;!r;){var n=-1,o=t.indexOf("{{",e);-1!==o&&(n=t.indexOf("}}",o+2)),-1!==n?(i.push(t.substring(e,o)),i.push(t.substring(o+2,n)),e=n+2):(i.push(t.slice(e)),r=!0)}return function(t){for(var e=i[0],r=1;r<i.length;r+=2)e+=t.getData(i[r]),e+=i[r+1];return e}},dy);function dy(t){var e,r=t.graph,i=t.events,n=t.styleRules,o=t.legend,a=uy.call(this)||this;return a._mappingList=[],a._graph=r,a._styleRules=n,a._events=i,a._legend=o,a._events.on(((e={})[[be.ADD_NODES,be.ADD_EDGES,be.UPDATE_NODE_DATA,be.UPDATE_EDGE_DATA,be.REMOVE_NODES,be.BEFORE_REMOVE_EDGES,be.EXCLUDED_STATE_CHANGE,be.CLEAR_GRAPH].join(" ")]=function(){if(a._mappingList.length){for(var t=0;t<a._mappingList.length;++t)a._mappingList[t].markAsInvalid();a._styleRules.refreshAllRules(),a._legend.refresh()}},e)),a}var hy=(cy.prototype.getDuration=function(){return this._duration},cy.prototype.setDuration=function(t){void 0!==t&&(this._duration=t)},cy.prototype.getRemovalDuration=function(){return this._removalDuration},cy.prototype.setRemovalDuration=function(t){void 0!==t&&(this._removalDuration=t)},cy.prototype.getContext=function(){return this._context},cy.prototype.setContext=function(t){this._context=t},cy.prototype.getError=function(){return this._error},cy.prototype.setError=function(t){this._error=t},cy.prototype.getOgma=function(){return this._ogma},cy.prototype.resolve=function(){this._resolveFunction(this)},cy.prototype.reject=function(){var t=this._error;return this._error=null,this._rejectFunction(t)},cy.prototype.getName=function(){throw new Error("type not set")},cy.prototype.getId=function(){return this._id},cy.prototype.whenApplied=function(){return this._whenApplied},cy.prototype.isEnabled=function(){return this.enabled},cy.prototype.setEnabled=function(t){this.enabled=t},cy.prototype.initialize=function(t){var e=t.id,r=t.ogma;this._id=e,this._ogma=r,this.resetContext()},cy.prototype.enable=function(t){return this._ogma.modules.transformations.enable(this,t)},cy.prototype.disable=function(t){return this._ogma.modules.transformations.disable(this,t)},cy.prototype.toggle=function(t){return this.enabled?this.disable(t):this.enable(t)},cy.prototype.getIndex=function(){return this._ogma.modules.transformations.getIndex(this)},cy.prototype.setIndex=function(t){var e=this;return this._ogma.modules.transformations.setIndex(this,t).then(function(){return e})},cy.prototype.destroy=function(t){return this._ogma.modules.transformations.remove(this,t||0)},cy.prototype.refresh=function(){return this._ogma.modules.transformations.refresh()},cy.prototype.resetContext=function(){this._context={virtualNodes:this._ogma.nodeList(),virtualEdges:this._ogma.edgeList()}},cy.prototype.run=function(){throw new Error("run function not implemented")},cy.prototype.cleanup=function(){throw new Error("cleanup function not implemented")},cy.prototype.undo=function(){throw new Error("undo function not implemented")},cy);function cy(t){var r=this,e=t.duration,i=t.enabled;this._duration=e||0,this._removalDuration=e||0,this.enabled=!1,this.shouldUndo=!1,this.shouldDo=!1!==i,this._error=null,this._whenApplied=new Promise(function(t,e){r._resolveFunction=t,r._rejectFunction=e})}var fy,gy,py,_y=(b(vy,fy=hy),vy.prototype.run=function(){var t=this._ogma,e=this._duration,r=this._getNodesToFilter(t),i=this._getEdgesToFilter(t,r);return Promise.all([r.addClass(_r,e),i.addClass(_r,e)]).then(function(){return r.setExcluded(!0),i.setExcluded(!0),{nodes:r,edges:i,virtualNodes:null,virtualEdges:null}})},vy.prototype.undo=function(){var t=this._duration,e=this._context,r=e.nodes,i=e.edges;return r.setExcluded(!1),i.setExcluded(!1),r.addClass(_r),i.addClass(_r),Promise.all([r.removeClass(_r,t),i.removeClass(_r,t)])},vy.prototype.resetContext=function(){fy.prototype.resetContext.call(this),this._context=I(I({},this._context),{nodes:this._ogma.nodeList(),edges:this._ogma.edgeList()})},vy.prototype.cleanup=function(){return Promise.resolve()},Object.defineProperty(vy.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),vy);function vy(t){var e=fy.call(this,t)||this;return e._getNodesToFilter=t.getNodesToFilter,e._getEdgesToFilter=t.getEdgesToFilter,e}(py=gy=gy||{}).NodeFilter="node-filter",py.EdgeFilter="edge-filter",py.NodeCollapsing="node-collapsing",py.VirtualProperties="virtual-properties",py.NeighborGeneration="neighbor-generation",py.NeighborMerging="neighbor-merging",py.NodeGrouping="node-grouping",py.EdgeGrouping="edge-grouping";var my,yy=(b(by,my=_y),by.prototype.getName=function(){return gy.NodeFilter},by);function by(t){var e=t.criteria;return my.call(this,I(I({},t),{getNodesToFilter:function(t){return t.getNodes().filter(function(t){return!e||!e(t)})},getEdgesToFilter:function(t,e){return e.getAdjacentEdges()}}))||this}var xy,Ey=(b(Ay,xy=_y),Ay.prototype.getName=function(){return gy.EdgeFilter},Ay);function Ay(e){return xy.call(this,I(I({},e),{getNodesToFilter:function(t){return t.createNodeList()},getEdgesToFilter:function(t){return t.getEdges().filter(function(t){return!e.criteria||!e.criteria(t)})}}))||this}function Sy(t){return"object"!=typeof t?{criteria:t,enabled:!0,duration:0}:t}var wy,Ty=(b(Cy,wy=Ee),Cy.prototype.addNodeFilter=function(t){return this._transformations.add(new yy(Sy(t)))},Cy.prototype.addEdgeFilter=function(t){return this._transformations.add(new Ey(Sy(t)))},Cy);function Cy(t){var e=t.transformations,r=wy.call(this)||this;return r._transformations=e,r}var My=(Iy.prototype.destroy=function(){var r=this;Object.keys(this).forEach(function(t){var e=r[t];e instanceof Ee&&e.destroy(r._ogma)})},Iy);function Iy(t,r){var i=this;this._ogma=t,"webgl"===Vh&&iu.cacheInitData(iu.createInitData()),this.settings=new ec,this.events=new Xh,this.dom=new Te(this,r.dimensions),this.animations=new zg(this),this.camera=new Rh(this),this.graph=new wi(this,t),this.data=new Le(this),this.graphics=new jh(this,t),this.individualAttributes=new Jh(this),this.algorithms=new Ep(this),this.position=new ry,this.touch=new dg(this),this.mouse=new ag(this),this.virtualMouse=new M_(this),this.spatial=new Kf(this),this.captor=new Nv(this),this.interactions=new xv(this),this.classes=new ac(this),this.cameraInteractions=new wh(this,!!r.debug),this.hover=new ty(this),this.keyboard=new hm(this),this.selection=new Ag(this),this.styleRules=new j_(this),this.legend=new Zm(this),this.sync=new Tg(this),this.rules=new ly(this),this.transformations=new vg(this,t),this.filters=new Ty(this),this.locate=new eg(this),this.drag=new zv(this),this.grouping=new gg(this),this.pulses=new kg(this),this.curvatureManager=new wp(this),this.tasks=new Wp(this),this.layouts=new e_(this),this.watcher=new m_(this),this.rectangleSelect=new Q_(this),this.labels=new pv(this,r),this.brand=new Yg(this),this.lasso=new X_(this),this.rewiring=new jv(this),this.resizing=new Wv(this),this.snapping=new P_(this),this.connectNodes=new Jv(this),this.tooltip=new om(this),this.geo=new Jg(this),t.onReady(function(){Object.keys(i).forEach(function(t){var e=i[t];e instanceof Ee&&e.onMounted(i._ogma,r)})})}function Ly(t){this._ogma=t}var Ny,Oy=(b(ky,Ny=Ly),ky);function ky(){var o=null!==Ny&&Ny.apply(this,arguments)||this;return o.shortestPath=function(t){return o._ogma.modules.algorithms.shortestPath(t)},o.hasCycle=function(t){var e=void 0===t?{}:t,r=e.nodes,i=e.edges;return null!==o.detectCycle({nodes:r,edges:i})},o.getAllSimpleCycles=function(t){var e=void 0===t?{}:t,r=e.nodes,i=e.edges;return r=r||o._ogma.getNodes(),i=i||r.getAdjacentEdges({bothExtremities:!0}),o._ogma.modules.algorithms.getAllSimpleCycles(r,i)},o.detectCycle=function(t){var e=void 0===t?{}:t,r=e.nodes,i=e.edges;r=r||o._ogma.getNodes(),i=i||r.getAdjacentEdges({bothExtremities:!0});var n=o._ogma.modules.algorithms.detectCycle(r,i);return n.size?n:null},o.minimumSpanningTree=function(t){var e=void 0===t?{}:t,r=e.nodes,i=e.edges,n=e.edgeCostFunction;return o._ogma.modules.algorithms.minimumSpanningTree(r,i,n)},o}var Ry=(Fy.prototype.getHoveredElement=function(){return this.modules.captor.getPointedElement()},Fy.prototype.getPointerInformation=function(){return this.modules.captor.getCursorInformation()},Fy);function Fy(){}var Dy,Py=(b(zy,Dy=Ly),zy);function zy(){var d=null!==Dy&&Dy.apply(this,arguments)||this;return d.wait=function(e){return new Promise(function(t){return setTimeout(t,e)})},d.initRandomGraph=function(t){return d._ogma.generate.random(t).then(d._ogma.setGraph).then(function(){return d._ogma.view.locateGraph()}).then(function(){return d._ogma.view.afterNextFrame()})},d.initGrid=function(t){var e=Math.ceil(Math.sqrt(t));return d._ogma.generate.grid({rows:e,columns:e}).then(function(t){return d._ogma.setGraph(t)}).then(function(){return d._ogma.view.locateGraph()})},d.initLine=function(t){return d._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:t?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),d._ogma.view.locateGraph()},d.initSingleNode=function(){return d._ogma.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),d._ogma.view.locateGraph()},d.initContinuousRenderLoop=function(t){var e=void 0===t?{}:t,r=e.triggerKey,i=void 0===r?"r":r,n=e.start,o=void 0===n||n,a=function(){o&&d._ogma.modules.dom.beforeNextFrame().then(a)};document.addEventListener("keydown",function(t){t.key===i&&(o=!o,a())}),a()},d.appendToBody=function(){var t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.bottom="0",t.style.right="0",document.body.appendChild(t),d._ogma.setContainer(t)},d.loadFile=function(t){return(t.endsWith(".gexf")?d._ogma.parse.gexfFromUrl(t):d._ogma.parse.jsonFromUrl(t)).then(function(t){return d._ogma.setGraph(t)}).then(function(){return d._ogma.view.locateGraph()}).then(function(){return d._ogma.view.afterNextFrame()})},d.enableLasso=function(t){d._ogma.events.onDragStart(function(){d._ogma.keyboard.isKeyPressed("ctrl")&&d._ogma.tools.lasso.enable(t)})},d.randomizeGraph=function(t){var e=void 0===t?{}:t,r=e.minX,i=void 0===r?0:r,n=e.minY,o=void 0===n?0:n,a=e.maxX,s=void 0===a?500:a,u=e.maxY,l=void 0===u?500:u;return d._ogma.getNodes().setAttributes(d._ogma.getNodes().map(function(){return{x:i+Math.random()*(s-i),y:o+Math.random()*(l-o)}}))},d}var By=(Uy.prototype.setContainer=function(t){this.modules.dom.setContainer(t)},Uy.prototype.getContainer=function(){return this.modules.dom.getContainer()},Uy);function Uy(){}var Vy,jy=(b(Gy,Vy=Ly),Gy.prototype.onKeyPress=function(t,e){return this._ogma.modules.keyboard.onKeyPress(t,e),this._ogma},Gy);function Gy(){var r=null!==Vy&&Vy.apply(this,arguments)||this;return r.removeListener=function(t){r._ogma.modules.events.removeListener(t)},r.onNodesAdded=function(t){return r._ogma.modules.events.on(be.ADD_NODES,t),r._ogma},r.onBeforeNodesRemoved=function(t){return r._ogma.modules.events.on(be.BEFORE_REMOVE_NODES,t),r._ogma},r.onNodesRemoved=function(t){return r._ogma.modules.events.on(be.REMOVE_NODES,t),r._ogma},r.onEdgesAdded=function(t){return r._ogma.modules.events.on(be.ADD_EDGES,t),r._ogma},r.onBeforeEdgesRemoved=function(t){return r._ogma.modules.events.on(be.BEFORE_REMOVE_EDGES,t),r._ogma},r.onEdgesRemoved=function(t){return r._ogma.modules.events.on(be.REMOVE_EDGES,t),r._ogma},r.onNodesClassAdded=function(t,e){return r._ogma.modules.classes.onNodeClassAdded(t,e),r._ogma},r.onNodesClassRemoved=function(t,e){return r._ogma.modules.classes.onNodeClassRemoved(t,e),r._ogma},r.onEdgesClassAdded=function(t,e){return r._ogma.modules.classes.onEdgeClassAdded(t,e),r._ogma},r.onEdgesClassRemoved=function(t,e){return r._ogma.modules.classes.onEdgeClassRemoved(t,e),r._ogma},r.onNodeDragStart=function(t){return r._ogma.modules.events.on(be.NODES_DRAG_START,t),r._ogma},r.onNodeDragProgress=function(t){return r._ogma.modules.events.on(be.NODES_DRAG_PROGRESS,t),r._ogma},r.onNodeDragEnd=function(t){return r._ogma.modules.events.on(be.NODES_DRAG_END,t),r._ogma},r.onDrop=function(t){return r._ogma.modules.events.on(be.DROP,t),r._ogma},r.onNodesSelected=function(t){return r.onNodesClassAdded(dr,t)},r.onNodesUnselected=function(t){return r.onNodesClassRemoved(dr,t)},r.onEdgesSelected=function(t){return r.onEdgesClassAdded(dr,t)},r.onEdgesUnselected=function(t){return r.onEdgesClassRemoved(dr,t)},r.onNodeDataChange=function(t){return r._ogma.modules.events.on(be.UPDATE_NODE_DATA,t),r._ogma},r.onEdgeDataChange=function(t){return r._ogma.modules.events.on(be.UPDATE_EDGE_DATA,t),r._ogma},r.onMouseMove=function(t){return r._ogma.modules.events.on(be.MOVE,t),r._ogma},r.onMouseButtonDown=function(t){return r._ogma.modules.events.on(be.DOWN,t),r._ogma},r.onMouseButtonUp=function(t){return r._ogma.modules.events.on(be.UP,t),r._ogma},r.onClick=function(t){return r._ogma.modules.events.on(be.CLICK,t),r._ogma},r.onDoubleClick=function(t){return r._ogma.modules.events.on(be.DOUBLE_CLICK,t),r._ogma},r.onMouseWheel=function(t){return r._ogma.modules.events.on(be.WHEEL,t),r._ogma},r.onHover=function(t){return r._ogma.modules.events.on(be.HOVER,t),r._ogma},r.onUnhover=function(t){return r._ogma.modules.events.on(be.UNHOVER,t),r._ogma},r.onDragStart=function(t){return r._ogma.modules.events.on(be.DRAG_START,t),r._ogma},r.onDragProgress=function(t){return r._ogma.modules.events.on(be.DRAG_PROGRESS,t),r._ogma},r.onDragEnd=function(t){return r._ogma.modules.events.on(be.DRAG_END,t),r._ogma},r.onGestureStart=function(t){return r._ogma.modules.events.on(be.GESTURE_START,t),r._ogma},r.onGestureProgress=function(t){return r._ogma.modules.events.on(be.GESTURE_PROGRESS,t),r._ogma},r.onGestureEnd=function(t){return r._ogma.modules.events.on(be.GESTURE_END,t),r._ogma},r.onRendererStateChange=function(t){return r._ogma.modules.events.on(be.RENDERER_STATE_CHANGE,t),r._ogma},r.onZoomProgress=function(t){return r._ogma.modules.events.on(be.CAMERA_ZOOM,t),r._ogma},r.onViewChanged=function(t){return r._ogma.modules.events.on(be.VIEW_CHANGED,t),r._ogma},r.onNodesConnected=function(t){return r._ogma.modules.events.on(be.CONNECT_NODES,t),r._ogma},r.onGeoModeEnabled=function(t){return r._ogma.modules.events.on(be.GEO_ENABLED,t),r._ogma},r.onGeoModeDisabled=function(t){return r._ogma.modules.events.on(be.GEO_DISABLED,t),r._ogma},r.onGeoModeLoaded=function(t){return r._ogma.modules.events.on(be.GEO_LOADED,t),r._ogma},r.onLayoutStart=function(t){return r._ogma.modules.events.on(be.LAYOUT_START,t),r._ogma},r.onLayoutComplete=function(t){return r._ogma.modules.events.on(be.LAYOUT_END,t),r._ogma},r.onLayoutComputed=function(t){return r._ogma.modules.events.on(be.LAYOUT_COMPUTED,t),r._ogma},r.onTooltipShown=function(t){return r._ogma.modules.events.on(be.TOOLTIP_SHOW,t),r._ogma},r.onTooltipHidden=function(t){return r._ogma.modules.events.on(be.TOOLTIP_HIDE,t),r._ogma},r}function Hy(t){return t instanceof vi?t.getId():t}function qy(t){return t instanceof Qr?t.getId():t}function Wy(t){return t instanceof yi?t.getId():t instanceof vi?[t.getId()]:M(t)?t.map(Hy):[Hy(t)]}function Xy(t){return t instanceof $r?t.getId():t instanceof Qr?[t.getId()]:M(t)?t.map(qy):[qy(t)]}function Yy(t,e,r){if(null!=t){if(Array.isArray(t))return t[0];if(e&&r){if("source"===t)return Yy(r.color.get(e.getSource()._index));if("target"===t)return Yy(r.color.get(e.getTarget()._index))}return t}}function Zy(t){return null==t?null:"string"==typeof t||"number"==typeof t?""+t:t&&Zy(t.content)}var Ky=["color","radius","shape","text.content","x","y"],Qy=["color","width","shape.body","text.content"];function Jy(t){return{nodes:t.nodes.map(function(t){var e=t.id,r=t.attributes,i=void 0===r?{}:r,n=t.data,o=i.color,a=i.radius,s=i.shape,u=i.text;return{id:e,x:i.x,y:i.y,color:Yy(o),size:a,shape:s,text:Zy(u),data:n}}),edges:t.edges.map(function(t){var e=t.id,r=t.source,i=t.target,n=t.attributes,o=void 0===n?{}:n,a=t.data,s=o.color,u=o.width,l=o.text,d=o.shape;return{id:e,source:r,target:i,color:Yy(s),size:u,shape:function(t){if(null!=t)return"string"==typeof t?t:t.style||"line"}(d),text:Zy(l),data:a}})}}var $y="visible";function tb(t,e,r,i){var n,o,a,s,u=(o=i,(n=e)?Wy(n):"object"==typeof o?Wy(o.nodes):o||$y),l=(s=i,(a=r)?Xy(a):"object"==typeof s?Xy(s.edges):s||$y);return{nodes:t.getNodes(u),edges:t.getEdges(l)}}function eb(t,e){var r=e.nodeAttributes,i=e.edgeAttributes,n=e.nodes,o=e.edges,a=e.filter,s=e.nodeData,u=e.edgeData,l=tb(t,n,o,a);return{nodes:l.nodes.toJSON({attributes:r,data:s}),edges:l.edges.toJSON({attributes:i,data:u})}}function rb(s,t,e){var r,i,n,o,a,u=e.styles,l=e.nodes,d=e.edges,h=e.filter,c=e.nodeData,f=e.edgeData,g="all"!==u?{nodes:["x","y"],edges:[]}:{nodes:Ky,edges:Qy},p=eb(s,{nodeAttributes:g.nodes,edgeAttributes:g.edges,nodes:l,edges:d,filter:h,nodeData:c,edgeData:f});if("original"===u){for(var _=(r=t,i=tb(s,l,d,h),n=i.nodes,o=i.edges,a=r.getOriginalAttributes(),{nodes:n.reduce(function(t,e){return t[e.getId()]={x:a.nodes.x.get(e._index),y:a.nodes.y.get(e._index),color:Yy(a.nodes.color.get(e._index)),radius:a.nodes.radius.get(e._index),shape:a.nodes.shape.get(e._index),text:{content:a.nodes.text.content.get(e._index)}},t},{}),edges:o.reduce(function(t,e){return t[e.getId()]={color:Yy(a.edges.color.get(e._index)),width:a.edges.width.get(e._index),shape:{type:a.edges.shape.body.get(e._index)},text:{content:a.edges.text&&a.edges.text.content&&a.edges.text.content.get(e._index)}},t},{})}),v=0,m=p.nodes;v<m.length;v++){var y=m[v];null!=y.id&&(y.attributes=_[y.id])}for(var b=0,x=p.edges;b<x.length;b++){var E=x[b];null!=E.id&&(E.attributes=_[E.id])}}return"all"===u&&p.edges.forEach(function(t){var e=t.source,r=t.target,i=t.attributes;if(i){var n=s.getNode(e);if("source"===i.color&&n){var o=n.getAttribute("color");i.color=Array.isArray(o)?o[0]:o}var a=s.getNode(r);if("target"===i.color&&a){o=a.getAttribute("color");i.color=Array.isArray(o)?o[0]:o}}}),Jy(p)}function ib(value,t){return null==value||Array.isArray(value)&&!value.length?t:value}function nb(t){return"string"==typeof t}function ob(t,i,a,s,u){var l="edges"===i,d={};return t.forEach(function(n,t){var e=u.get(t),r=L(ib(a(e),i));if(!r.every(nb))throw Error("The tab "+i+" function returned an invalid value.");var o=L(s(n.data,r));r.forEach(function(t,e){var r=ib(o[e],{}),i=Lo(I(I({internal___id:n.id},l?{internal___source:n.source,internal___target:n.target}:{}),r)).reduce(function(t,e){var r=e.path,value=e.value;return t[r.join(".")]=value,t},{});d[t]=d[t]||[],d[t].push(i)})}),d}function ab(t){if(!t.length)return[];for(var r=function(t){for(var e=I({},t[0]),r=0,i=t;r<i.length;r++)for(var n=i[r],o=0,a=Object.keys(n);o<a.length;o++){var s=a[o];s in e||(e[s]=void 0)}return Object.keys(e)}(t),i=[r],e=function(e){i.push(r.map(function(t){return e[t]}))},n=0,o=t;n<o.length;n++){e(o[n])}return i[0]=i[0].map(function(t){return t.replace("internal___","")}),i}function sb(l,d,h){for(var c=new No,f=d?1:3,g=[],t=function(t){var e=l[t],r=new Array(f),i=e.data;if(h){var n={};h.forEach(function(t){var e=R(t),value=function(t,e){for(var r=0;r<e.length;++r){if(null==t)return;t=t[e[r]]}return t}(i,e);!function(t,e,value){for(var r=0;r<e.length-1;++r){var i=e[r],n=t[i];void 0===n&&(n={},t[i]=n),t=n}t[e[e.length-1]]=value}(n,e,value)}),i=n}var o=Lo(i);r[0]=e.id,d||(r[1]=e.source,r[2]=e.target);for(var a=0;a<o.length;++a){var s=o[a],u=s.path,value=s.value;u.length&&(c.has(u)?r[c.get(u)]=value:(c.set(u,f),r[f]=value,f++))}g.push(r)},e=0;e<l.length;++e)t(e);var r=[];return r.push("id"),d||(r.push("source"),r.push("target")),c.keys().forEach(function(t){return r.push(t[t.length-1])}),g.unshift(r),g.forEach(function(t){return t.length=f}),g}var ub,lb={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:function(t){return t},edgeData:function(t){return t},styles:"none"},db=(b(hb,ub=Ly),hb);function hb(){var p=null!==ub&&ub.apply(this,arguments)||this;return p.run=function(t){var e=Q("string"==typeof t?{what:t}:t,lb),r=e.what,i=e.dataProperties,n=e.nodes,o=e.edges,a=e.separator,s=e.textSeparator,u=e.download,l=e.nodeData,d=e.edgeData,h=e.filename,c=e.filter,f=rb(p._ogma.modules.graph,p._ogma.modules.individualAttributes,{styles:"none",nodes:n,edges:o,filter:c,nodeData:l,edgeData:d});try{var g=function(t,e){var r=e.what,i=e.separator,n=e.textSeparator,o=e.dataProperties,a=new RegExp(""+n,"g");function s(t){return t=function(t){if(t instanceof Date)return t.toISOString();return""+t}(t),t=n+t.replace(a,"\\$&")+n}if(n&&'"'!==n&&"'"!==n)throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+n);if("nodes"!==r&&"edges"!==r)throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');var u="nodes"===r;return sb(u?t.nodes:t.edges,u,o).map(function(t){return t.map(function(value){return s(value)})}).map(function(t){return t.join(i)}).join("\n")}(f,{what:r,separator:a,textSeparator:s,dataProperties:i});return u&&Mt(g,h,"text"),Promise.resolve(g)}catch(t){return Promise.reject(t)}},p}var cb,fb={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:function(t){return t},edgeData:function(t){return t},filter:"visible"},gb=(b(pb,cb=Ly),pb);function pb(){var f=null!==cb&&cb.apply(this,arguments)||this;return f.run=function(t){void 0===t&&(t={});var e=Q(t,fb),r=e.styles,i=e.nodes,n=e.edges,o=e.download,a=e.filename,s=e.creator,u=e.description,l=e.filter,d=e.nodeData,h=e.edgeData,c=function(t,e){var r,u=new Ri,l=Jo(),d={},s={},h=0,c=0,i=l.createElement("gexf");i.setAttribute("xmlns","http://www.gexf.net/1.2draft"),i.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),i.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),i.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),i.setAttribute("version","1.2");var n=l.createElement("meta");if(n.setAttribute("lastmodifieddate",Kt()),e.creator){var o=l.createElement("creator");r=l.createTextNode(""+e.creator),o.appendChild(r),n.appendChild(o)}if(e.description){var a=l.createElement("description");r=l.createTextNode(""+e.description),a.appendChild(r),n.appendChild(a)}var f=l.createElement("graph");f.setAttribute("mode","static");var g=l.createElement("nodes");t.nodes.forEach(function(t){var e=l.createElement("node");if(e.setAttribute("id",String(t.id)),t.text&&e.setAttribute("label",Gt(t.text)),mb(t.data)){var i=yb(t.data),n=l.createElement("attvalues");Object.keys(i).forEach(function(t){t in d||(d[t]={id:h,type:"integer"},h++);var e=i[t];d[t].type=vb(e,d[t].type);var r=l.createElement("attvalue");r.setAttribute("for",d[t].id),r.setAttribute("value",Gt(e)),n.appendChild(r)}),e.appendChild(n)}if(t.color){var r=u.parseColor(t.color);if(r){var o=l.createElement("viz:color");o.setAttribute("r",_b(r[0])),o.setAttribute("g",_b(r[1])),o.setAttribute("b",_b(r[2])),o.setAttribute("a",r[3]),e.appendChild(o)}}var a=l.createElement("viz:position");if(a.setAttribute("x",t.x),a.setAttribute("y",-t.y),e.appendChild(a),t.size){var s=l.createElement("viz:size");s.setAttribute("value",t.size),e.appendChild(s)}g.appendChild(e)});var p=l.createElement("attributes");p.setAttribute("class","node"),Object.keys(d).forEach(function(t){var e=l.createElement("attribute");e.setAttribute("id",d[t].id),e.setAttribute("title",t),e.setAttribute("type",d[t].type),p.appendChild(e)});var _=l.createElement("edges");t.edges.forEach(function(t){var e=l.createElement("edge");if(e.setAttribute("id",t.id.toString()),e.setAttribute("source",t.source),e.setAttribute("target",t.target),t.size&&e.setAttribute("weight",t.size),t.text&&e.setAttribute("label",Gt(t.text)),mb(t.data)){var i=yb(t.data),n=l.createElement("attvalues");Object.keys(i).forEach(function(t){t in s||(s[t]={id:c,type:"integer"},c++);var e=i[t];s[t].type=vb(e,s[t].type);var r=l.createElement("attvalue");r.setAttribute("for",s[t].id),r.setAttribute("value",Gt(e)),n.appendChild(r)}),e.appendChild(n)}if(t.color){var r=u.parseColor(t.color);if(r){var o=l.createElement("viz:color");o.setAttribute("r",_b(r[0])),o.setAttribute("g",_b(r[1])),o.setAttribute("b",_b(r[2])),o.setAttribute("a",r[3]),e.appendChild(o)}}if(t.size){var a=l.createElement("viz:size");a.setAttribute("value",t.size),e.appendChild(a)}_.appendChild(e)});var v=l.createElement("attributes");return v.setAttribute("class","edge"),Object.keys(s).forEach(function(t){var e=l.createElement("attribute");e.setAttribute("id",s[t].id),e.setAttribute("title",t),e.setAttribute("type",s[t].type),v.appendChild(e)}),f.appendChild(p),f.appendChild(v),f.appendChild(g),f.appendChild(_),i.appendChild(n),i.appendChild(f),l.appendChild(i),'<?xml version="1.0" encoding="UTF-8"?>'+l.serialize()}(rb(f._ogma.modules.graph,f._ogma.modules.individualAttributes,{styles:r,nodes:i,edges:n,filter:l,nodeData:d,edgeData:h}),{creator:s,description:u});return o&&Mt(c,a,"text"),Promise.resolve(c)},f}function _b(value){return Math.round(255*value)}function vb(t,e){if("integer"===e&&"number"==typeof t){if(t%1!=0)return"float"}else if("number"!=typeof t)return"boolean"==typeof t?"boolean":"string";return e}function mb(value){return"object"==typeof value&&null!==value&&value.constructor===Object}function yb(t,e){return void 0===e&&(e={}),V(t,function(value,t){mb(value)?yb(value,e):e[t]=value}),e}var bb,xb={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:function(t){return t},edgeData:function(t){return t},filter:"visible"},Eb=(b(Ab,bb=Ly),Ab);function Ab(){var f=null!==bb&&bb.apply(this,arguments)||this;return f.run=function(t){void 0===t&&(t={});var e=Q(t,xb),r=e.styles,i=e.nodes,n=e.edges,o=e.download,a=e.filename,s=e.graphId,u=e.directedEdges,l=e.filter,d=e.nodeData,h=e.edgeData,c=function(t,o){var n=new Ri,a=ta();function s(t){return n.toHexa(t)}function u(t,e){var r,i=(r=e,n.parseColor(r));i&&(t.r=i[0],t.g=i[1],t.b=i[2])}function l(t,e,r,i,force){r=r||{};var n=a.createElement(e);for(var o in r)if(r.hasOwnProperty(o)){var value=r[o];void 0!==value&&n.setAttribute(o,value)}return void 0===i&&!force||("[object Object]"===Object.prototype.toString.call(i)&&(i=JSON.stringify(i)),n.appendChild(a.createTextNode(i))),t.appendChild(n),n}var d=["id","source","target"],h=["size","x","y","shape","text","color"],c={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};o.noStyles&&(delete c.color,delete c.r,delete c.g,delete c.b,delete c.a,delete c.shape,h.pop());var f=[],g=[];function e(e,r){var i={id:e.id};h.forEach(function(t){var value=e[t];"y"===t&&value&&(value=-parseFloat(value)),void 0!==value&&(i[("edge"===r?"edge_":"")+t]=value,"color"===t&&u(i,value))}),V(e.data||{},function(value,t){-1===h.indexOf(t)&&-1===d.indexOf(t)&&(c[t]?c[t].for!==r&&(c[t].for="all"):c[t]={for:r,type:"string"},i[t]=value)}),"edge"===r?(i.source=e.source,i.target=e.target,g.push(i)):f.push(i)}t.nodes.forEach(function(t){return e(t,"node")}),t.edges.forEach(function(t){return e(t,"edge")});var r=l(a,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});V(c,function(value,t){"node"!==value.for&&"all"!==value.for||l(r,"key",{"attr.name":t,"attr.type":value.type,for:"node",id:t}),"edge"!==value.for&&"all"!==value.for||l(r,"key",{"attr.name":t,"attr.type":value.type,for:"edge",id:"edge_"+t})}),l(r,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),l(r,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var p=l(r,"graph",{edgedefault:o.directedEdges||void 0===o.directedEdges?"directed":"undirected",id:o.graphId?o.graphId:"G","parse.nodes":t.nodes.length,"parse.edges":t.edges.length,"parse.order":"nodesfirst"});return f.forEach(function(t){var e=l(p,"node",{id:t.id});!function(t,e){var r=l(t,"data",{key:"nodegraphics"}),i=l(r,"y:ShapeNode");l(i,"y:Geometry",{x:e.x,y:e.y,width:e.size,height:e.size}),o.noStyles||l(i,"y:Fill",{color:s(e.color),transparent:!1});l(i,"y:NodeLabel",null,e.text||""),l(i,"y:Shape",{type:e.shape})}(e,t),V(t,function(value,t){-1===d.indexOf(t)&&l(e,"data",{key:t},value,!0)})}),g.forEach(function(t){var e,r,i,n=l(p,"edge",{id:t.id,source:t.source,target:t.target});e=t,r=l(n,"data",{key:"edgegraphics"}),i=l(r,"y:PolyLineEdge"),l(i,"y:LineStyle",{type:e.edge_type,color:o.noStyles?void 0:s(e.edge_color),width:e.edge_size}),l(i,"y:EdgeLabel",null,e.edge_label),V(t,function(value,t){-1===d.indexOf(t)&&l(n,"data",{key:t},value,!0)})}),'<?xml version="1.0" encoding="UTF-8"?>\n'+$o(a)}(rb(f._ogma.modules.graph,f._ogma.modules.individualAttributes,{styles:r,nodes:i,edges:n,filter:l,nodeData:d,edgeData:h}),{graphId:s,directedEdges:u,noStyles:"none"===r});return o&&Mt(c,a,"text"),Promise.resolve(c)},f}var Sb,wb={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:function(t){return t},edgeData:function(t){return t},filter:"visible",pretty:!1,download:!0,filename:"graph.json"},Tb=(b(Cb,Sb=Ly),Cb);function Cb(){var c=null!==Sb&&Sb.apply(this,arguments)||this;return c.run=function(t){void 0===t&&(t={});var e=Q(t,wb),r=e.nodeAttributes,i=e.edgeAttributes,n=e.nodeData,o=e.edgeData,a=e.filter,s=e.pretty,u=e.download,l=e.filename,d=eb(c._ogma.modules.graph,{nodeAttributes:r,edgeAttributes:i,filter:a,nodeData:n,edgeData:o}),h=s?JSON.stringify(d,null," "):JSON.stringify(d);return u&&Mt(h,l,"text"),Promise.resolve(h)},c}function Mb(t,e){void 0===e&&(e={});var r=t.view.get(),i="number"==typeof e.margin?e.margin:0,n={pixelRatio:1,angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1};if(e.width&&e.height?(n.width=e.width,n.height=e.height):(n.width=r.width,n.height=r.height),e.clip)n.zoom=r.zoom,n.x=r.x,n.y=r.y;else{var o=t.getNodes(e.filter),a=o.getBoundingBox().computeForZoom(r.zoom).extend(aa.fromValues(o.getAttribute("x"),o.getAttribute("y"),o.map(function(t){return t.getAttribute("radius")+t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width")})));if(e.texts){var s=t.modules.labels.getTextsBoundingBox();s.isValid()&&a.extend(s)}if(null==e.width||!isFinite(e.width)||null==e.height||!isFinite(e.height)){var u=t.view.graphToScreenCoordinates(a.bottomLeft()),l=t.view.graphToScreenCoordinates(a.topRight()),d=l.x-u.x,h=l.y-u.y,c=Math.min(n.width/d,n.height/h);n.width=d*c,n.height=h*c}n.x=a.cx,n.y=a.cy,n.width=Math.max(n.width,2*i+1),n.height=Math.max(n.height,2*i+1),n.zoom=Math.min((n.width-2*i)/a.width,(n.height-2*i)/a.height)}return t.modules.geo.isEnabled()?n.backgroundColor=null:void 0!==e.background&&(n.backgroundColor=e.background),n}function Ib(t,e,r,i,n){void 0===n&&(n=!1);var o=I(I({},r),{renderBackground:!1,hideImages:n,angle:r.angle||0,currentTime:Zt(),isBufferDisplayable:function(t){return e.texts||!Yl(t)}}),a={};if(!1===e.badges){var s={text:null,image:null};a.badges={topLeft:s,topRight:s,bottomRight:s,bottomLeft:s}}var u=t.styles.getClass(gr);return u&&u.update({nodeAttributes:a}),t.modules.graphics.export(i,o,e.filter||$y,e)}var Lb,Nb=(b(Ob,Lb=Ly),Ob);function Ob(){var e=null!==Lb&&Lb.apply(this,arguments)||this;return e.png=function(t){return void 0===t&&(t={}),Vb(e._ogma,t,"png")},e.jpg=function(t){return void 0===t&&(t={}),Vb(e._ogma,t,"jpg")},e.tiff=function(t){return void 0===t&&(t={}),Vb(e._ogma,t,"tiff")},e.gif=function(t){return void 0===t&&(t={}),Vb(e._ogma,t,"gif")},e}function kb(t){return{download:!0,filter:"visible",filename:"graph."+t,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,images:!0,textWatermark:{content:"",fontFamily:"Arial",fontSize:48,fontStyle:void 0,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:void 0,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0}}var Rb={png:kb("png"),jpg:kb("jpg"),tiff:kb("tiff"),gif:kb("gif")};function Fb(e){var r=e.canvas,i=e.parameters;return i.textWatermark.content&&Wb(r,i.textWatermark,jb,Gb),i.imageWatermark.url?Dt(i.imageWatermark.url).then(function(t){return t&&(i.imageWatermark.content=t,Wb(r,i.imageWatermark,qb,Hb)),e}):e}function Db(t){var e=t.ogma,r=t.canvas,i=t.parameters,n=e.modules.legend,o=null;return void 0===i.legend&&(o=!!n.enabled()&&n.getCurrentOptions()),!0===i.legend&&(o={}),o&&n.exportOnCanvas(r,o),t}function Pb(i){var t=i.ogma,n=i.view;return t.modules.geo.isEnabled()?t.modules.geo.exportBackground(n).then(function(t){var e=Ub(i.view),r=e.getContext("2d");return r.drawImage(t,(n.width-t.width)/2,(n.height-t.height)/2),r.drawImage(i.canvas,0,0),i.canvas=e,i}):i}function zb(e){var r=e.ogma,i=e.parameters,t=e.canvas,n=e.view,o=t.getContext("2d");return Ib(r,i,n,"canvas",!i.images).then(function(t){try{return t.getContext("2d").getImageData(0,0,1,1),o.drawImage(t,0,0),e}catch(t){return Tr(t),Ib(r,i,n,"canvas",!0).then(function(t){return o.drawImage(t,0,0),e})}})}function Bb(t){var e=t.canvas,r=t.parameters,i=t.type,n=e.toDataURL("image/"+i);return r.download&&Mt(n,r.filename,"dataURL"),n}function Ub(t){var e=t.width,r=t.height,i=En();return i.width=e,i.height=r,i}function Vb(t,e,r){var i=Q(e,Rb[r]);null===i.background&&(i.background=t.modules.graphics.getTransparentBackgroundColor());var n=Mb(t,i),o={ogma:t,parameters:i,canvas:Ub(n),view:n,type:r};return Promise.resolve(o).then(Pb).then(zb).then(Fb).then(Db).then(Bb)}function jb(t,e,r,i){t.textAlign="center",t.textBaseline="middle",t.fillText(e,r,i)}function Gb(t,e,r){return{width:t.measureText(e).width,height:r}}function Hb(t,e,r,i,n){return{width:void 0===i?e.width:i,height:void 0===n?e.height:n}}function qb(t,e,r,i,n,o){t.drawImage(e,r-n/2,i-o/2,n,o)}function Wb(t,e,r,i){if(e){if("object"!=typeof e)e={content:e};else if(!e.content)return;var n=e.fontFamily,o=e.fontSize,a=e.fontStyle,s=e.fontColor,u=e.repeat,l=e.angle,d=e.alpha,h=e.space,c=e.content,f=t.getContext("2d"),g=t.width,p=t.height,_=void 0===e.x?g/2:e.x,v=void 0===e.y?p/2:e.y,m=e.height,y=e.width;l=l/180*Math.PI,Sn(f,n,o,a),f.fillStyle=s,f.globalAlpha=d;var b=i(f,c,o,y,m);if(u){var x=b.width+h,E=b.height+h,A=Math.sqrt(g*g+p*p);f.save(),f.translate(0,0),f.rotate(l);for(var S=0;S<A;S+=x)for(var w=0;w<A;w+=E)r(f,c,S,w,b.width,b.height),0!==w&&r(f,c,S,-w,b.width,b.height);f.restore()}else f.save(),f.translate(_,v),f.rotate(l),r(f,c,0,0,b.width,b.height),f.restore()}}var Xb,Yb=(b(Zb,Xb=Ly),Zb);function Zb(){var e=null!==Xb&&Xb.apply(this,arguments)||this;return e.run=function(t){return void 0===t&&(t={}),function(e,t){var n=Q(t,Kb),r=n.background,i=n.filename,o=n.download,a=e.modules.graphics;null===r&&(n.background=a.getTransparentBackgroundColor());var s=Mb(e,n);return Ib(e,n,s,"svg",!n.images).then(function(t){return t.removeAttribute("pointer-events"),t.setAttribute("version","1.1"),t.setAttributeNS(Ot,"xmlns",Nt),t.setAttributeNS(Ot,"xmlns:xlink",kt),t}).then(function(t){return function(t,e,r){for(var i=e.childNodes[2],n=i.childNodes,o={},a=r.prefix,s=0;s<n.length;s++){var u=(E=n[s]).getAttribute(ks);null!=u&&(o[u]=o[u]||[],o[u].push(E))}var l=Object.keys(o),d=t.modules.graph,h=d.getNodeAttribute("id"),c=d.getEdgeAttribute("id"),f=Rt("g",{class:a+"-edges"}),g=Rt("g",{class:a+"-nodes"});for(s=0;s<l.length;s++){var p=l[s],_="n"===p.charAt(0),v=parseInt(p.substring(1)),m=o[p],y=Gt((_?h:c).get(v).toString()),b=Rt("g");b.setAttribute("data-"+(_?"node":"edge")+"-id",y),b.setAttribute("class",a+"-"+(_?"node":"edge"));for(var x=0;x<m.length;x++){var E=m[x];b.appendChild(E),E.removeAttribute(ks)}(_?g:f).appendChild(b)}return i.appendChild(f),i.appendChild(g),e}(e,t,n)}).then(function(t){return e=n,r=function(t){for(var e=[].concat(Array.prototype.slice.call(t.getElementsByTagName("text")||[])),r=[],i={},n=0;n<e.length;n++){var o=e[n].parentNode.getAttribute("font-family");if("string"==typeof o)for(var a=o.split(","),s=0;s<a.length;s++){var u=a[s].replace(/['"]/g,"");""===u||i[u]||(i[u]=!0,r.push(u))}}return{list:r,map:i}}(i=t).map,mo().then(function(t){return t.filter(function(t){return r[t.name]})}).then(function(t){return yo(t,!!e.embedFonts)}).then(function(t){if(0!==t.length){for(var e=Rt("style"),r=0;r<t.length;r++)e.appendChild(Ft(t[r]));i.childNodes[0].appendChild(e)}return i});var i,e,r}).then(function(t){var e='<?xml version="1.0" encoding="utf-8"?>'+$o(t);return o&&Mt(e,i,"text/xml"),e})}(e._ogma,t)},e}var Kb={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,images:!0,badges:!0,embedFonts:!1,clip:!1,margin:10,prefix:"ogma"};var Qb,Jb={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0},$b=(b(tx,Qb=Ly),tx);function tx(){var p=null!==Qb&&Qb.apply(this,arguments)||this;return p.run=function(t){void 0===t&&(t={}),"string"==typeof t&&(t={what:t});var e=Q(t,Jb),r=e.what,i=e.nodes,n=e.edges,o=e.tab,a=void 0===o?{nodes:function(){return"nodes"},edges:function(){return"edges"}}:o,s=e.download,u=e.filename,l=e.dataProperties,d=e.filter,h=e.nodeData,c=e.edgeData;a.nodes||(a.nodes=function(){return"nodes"}),a.edges||(a.edges=function(){return"edges"});var f=rb(p._ogma.modules.graph,p._ogma.modules.individualAttributes,{styles:"none",nodes:i,edges:n,filter:d,nodeData:function(t){return t},edgeData:function(t){return t}}),g=function(t,e,r){var i=e.what,n=e.tabFunctions,o=e.tabContentFunctions,a=C("XLSX")||C("xlsx",{throwOnError:!0});if(!a)throw Error('The xlsx exports requires the "xlsx" peer dependency to be associated');var s=new rx;if(i){if("nodes"!==i&&"edges"!==i)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+i);"nodes"===i&&(t.edges=[]),"edges"===i&&(t.nodes=[])}for(var u={},l=0,d=["nodes","edges"];l<d.length;l++)for(var h=d[l],c=ob(t[h],h,n[h],o[h],r[h]),f=0,g=Object.keys(c);f<g.length;f++){var p=g[f];u[p]=x(u[p]||[],c[p])}for(var _=0,v=Object.keys(u);_<v.length;_++){p=v[_];s.SheetNames.push(p),s.Sheets[p]=ex(a,ab(u[p]))}return Ct([function(t){for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),i=0;i!==t.length;++i)r[i]=255&t.charCodeAt(i);return e}(a.write(s,{bookType:"xlsx",bookSST:!1,type:"binary"}))])}(f,{what:r,tabFunctions:a,tabContentFunctions:{nodes:h||function(t){return tt(q(t||{}),l)},edges:c||function(t){return tt(q(t||{}),l)}}},{nodes:p._ogma.modules.graph.getNodes(f.nodes.map(function(t){return t.id})),edges:p._ogma.modules.graph.getEdges(f.edges.map(function(t){return t.id}))});return s&&Mt(g,u,"blob"),Promise.resolve(g)},p}function ex(t,e){for(var r,i={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!==e.length;++o)for(var a=e[o],s=0;s!==a.length;++s){var value=a[s];n.s.r>o&&(n.s.r=o),n.s.c>s&&(n.s.c=s),n.e.r<o&&(n.e.r=o),n.e.c<s&&(n.e.c=s);var u={v:void 0===(r=value)?"":r instanceof Date?r.toISOString():""+r};i[t.utils.encode_cell({c:s,r:o})]=u}return n.s.c<1e7&&(i["!ref"]=t.utils.encode_range(n)),i}var rx=function(){this.SheetNames=[],this.Sheets={}};var ix,nx=(b(ox,ix=Ly),ox);function ox(t){var e=ix.call(this,t)||this;return e.csv=function(t){return new db(e._ogma).run(t)},e.xlsx=function(t){return new $b(e._ogma).run(t)},e.gexf=function(t){return new gb(e._ogma).run(t)},e.graphml=function(t){return new Eb(e._ogma).run(t)},e.json=function(t){return new Tb(e._ogma).run(t)},e.svg=function(t){return new Yb(e._ogma).run(t)},e.png=function(t){return new Nb(e._ogma).png(t)},e.tiff=function(t){return new Nb(e._ogma).tiff(t)},e.jpg=function(t){return new Nb(e._ogma).jpg(t)},e.gif=function(t){return new Nb(e._ogma).gif(t)},t.styles.createClass({name:gr,isBuiltin:!0}),e}var ax={configure:function(t){var e,r=void 0===t?{}:t,i=r.children,n=void 0===i?2:i,o=r.height,a=void 0===o?3:o;if(!("number"==typeof(e=n)&&isFinite(e)&&0<e&&e))throw new TypeError('Invalid argument: "children" is not a positive number, was '+n);if(!Hu(a))throw new TypeError('Invalid argument: "height" is not a positive number, was '+a);return{children:n,height:a}},generate:function(t){var e=t.children,r=t.height;r+=1;for(var i=Math.pow(e,r),n=[],o=[],a=1,s=0,u=0,l=0;l<r;++l){for(var d=i/(a+1)/1.5,h=0;h<a;++h){var c=s++;if(n.push({id:c,attributes:{x:(h+1)*d*10,y:20*l}}),l!==r-1)for(var f=0;f<e;++f)o.push({id:u,source:c,target:c*e+f+1}),u+=1}a*=e}return{nodes:n,edges:o}}};var sx={configure:function(t){var e=void 0===t?{}:t,r=e.nodes,i=void 0===r?40:r,n=e.m0,o=void 0===n?5:n,a=e.m,s=void 0===a?1:a,u=e.scale,l=void 0===u?100:u;if(!Gu(i)||i<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+i);if(!Gu(o)||i<=o)throw new TypeError("Invalid argument: options.m0 is not a number < "+i+", was "+o);if(!Gu(o)||o<=s)throw new TypeError("Invalid argument: options.m is not a number <= "+o+", was "+s);if(!Gu(l)||l<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:i,m0:o,m:s,scale:l}},generate:function(t){for(var e=t.scale,r=t.nodes,i=t.m0,n=t.m,o={nodes:[],edges:[]},a={},s=[],u=e/10,l=0,d=0;d<i;d++)o.nodes.push({id:d,attributes:{x:Math.random()*u,y:Math.random()*u}}),s[d]=0;for(d=0;d<i;d++)for(var h=d+1;h<i;h++){a[(v={id:l++,source:d,target:h}).source+"-"+v.target]=v,o.edges.push(v),s[d]++,s[h]++}for(d=i;d<r;d++){o.nodes.push({id:d,attributes:{x:Math.random()*e,y:Math.random()*e}});var c=s[d]=0;for(h=0;h<d;h++)c+=s[h];for(var f=0,g=0;g<n;g++){var p=Math.random(),_=0;for(h=0;h<d;h++)if(!a[d+"-"+h]&&!a[h+"-"+d]&&p<=(_=1===d?1:_+s[h]/c+f/(d-g))){var v;f+=s[h]/c,a[(v={id:l++,source:d,target:h}).source+"-"+v.target]=v,o.edges.push(v),s[d]++,s[h]++;break}}}return o}};var ux={configure:function(t){var e=void 0===t?{}:t,r=e.nodes,i=void 0===r?20:r,n=e.edges,o=e.p,a=e.scale,s=void 0===a?100:a;if(!Gu(i)||i<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+i);if(void 0!==n&&void 0!==o)throw new TypeError("Invalid argument: choose between options.edges and options.p");return void 0===n&&void 0===o&&(o=.1),void 0===o&&(o=-1),void 0===n&&(n=-1),{nodes:i,p:o,edges:n,scale:s}},generate:function(t){var e={nodes:[],edges:[]},r=t.nodes,i=t.p,n=t.scale;if(0<=i)for(var o=0,a=0;a<r;a++){e.nodes.push({id:a,attributes:{x:Math.random()*n,y:Math.random()*n}});for(var s=0;s<a;s++)Math.random()<i&&e.edges.push({id:o++,source:a,target:s})}else{var u=[],l=t.edges;for(a=0;a<r;a++){e.nodes.push({id:a,attributes:{x:100*Math.random(),y:100*Math.random()}});for(s=a+1;s<r;s++)u.push({source:a,target:s})}for(o=u.length-1,a=0;a<l;a++){var d=u.splice(Math.floor(Math.random()*o),1)[0];d.id=a,e.edges.push(d),o--}}return e}},lx=5,dx=10,hx=10,cx=2.7,fx=.2;function gx(t){return Math.pow(cx,t)*dx}function px(t){return lx+gx(t)/hx}var _x={configure:function(t){var e=t.depth,r=void 0===e?3:e,i=t.breadth,n=void 0===i?3:i,o=t.nbNodes;return void 0!==o?(n=5,r=Math.ceil(Math.log(o)/Math.log(5))):o=-1,{depth:r,breadth:n,nbNodes:o}},generate:function(t){var e=t.depth,r=t.breadth,i=t.nbNodes,n={id:0,attributes:{x:0,y:0,radius:px(e+1)}},o={nodes:[n],edges:[]};return function t(e,r,i,n,o){if(0===i)return o;var distance=gx(i);var a=px(i);var s=a*fx;var u=-Math.PI;var l=2*Math.PI/r;var d=n.attributes.x||0;var h=n.attributes.y||0;for(var c=0;c<r;++c){var f=Math.cos(u),g=Math.sin(u),p={id:o,attributes:{x:d+distance*f,y:h+distance*g,radius:a}},_={id:o,source:n.id,target:o,attributes:{width:s}};e.nodes.push(p),e.edges.push(_),o=t(e,r,i-1,p,o+1),u+=l}return o}(o,r,e,n,1),void 0!==i&&0<=i&&(o.nodes=o.nodes.slice(0,i),o.edges=o.edges.slice(0,Math.max(i-1,0))),o}};var vx={configure:function(t){var e=void 0===t?{}:t,r=e.rows,i=void 0===r?4:r,n=e.columns,o=void 0===n?4:n,a=e.columnDistance,s=void 0===a?20:a,u=e.rowDistance,l=void 0===u?20:u,d=e.xmin,h=void 0===d?0:d,c=e.ymin;return{rows:i,columns:o,columnDistance:s,rowDistance:l,xmin:h,ymin:void 0===c?0:c}},generate:function(t){for(var e=t.rows,r=t.columns,i=t.columnDistance,n=t.rowDistance,o=t.xmin,a=t.ymin,s={nodes:[],edges:[]},u=0,l=0;l<e;++l)for(var d=0;d<r;++d){var h=l*r+d;s.nodes.push({id:h,attributes:{x:o+d*i,y:a+l*n}}),d!==r-1&&(s.edges.push({id:u,source:h,target:l*r+d+1}),u++),l!==e-1&&(s.edges.push({id:u,source:h,target:(l+1)*r+d}),u++)}return s}};var mx={configure:function(t){var e=void 0===t?{}:t,r=e.nodes,i=void 0===r?10:r,n=e.edges,o=void 0===n?10:n,a=e.texts,s=void 0!==a&&a,u=e.scale;return{nodes:i,edges:o,texts:s,scale:void 0===u?100:u}},generate:function(t){for(var e=t.nodes,r=t.edges,i=t.texts,n=t.scale,o=[],a=[],s=0;s<e;s++)o.push({id:s,attributes:{x:Math.random()*n,y:Math.random()*n,text:i?"Node "+s:void 0}});for(s=0;s<r;s++)a.push({id:s,source:Math.random()*e|0,target:Math.random()*e|0,attributes:{text:i?"Edge "+s:void 0}});return{nodes:o,edges:a}}};var yx={configure:function(t){var e=void 0===t?{}:t,r=e.nodes,i=void 0===r?50:r,n=e.width,o=void 0===n?100:n,a=e.height,s=void 0===a?100:a,u=e.x,l=void 0===u?0:u,d=e.y,h=void 0===d?0:d;if(!isFinite(i)||i<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:i,width:o,height:s,x:l,y:h}},generate:function(t){var e=t.nodes,r=t.x,i=t.y,n=t.width,o=t.height,a=r-n/2,s=i-o/2;return{nodes:new Array(e).fill(0).map(function(t,e){return{id:e,attributes:{x:a+Math.random()*n,y:s+Math.random()*o}}}),edges:new Array(e-1).fill(0).map(function(t,e){return{id:e,source:Math.floor(Math.sqrt(e)),target:e+1}})}}};var bx,xx={configure:function(t){var e=void 0===t?{}:t,r=e.length,i=void 0===r?5:r,n=e.scale;return{length:i,scale:void 0===n?100:n}},generate:function(t){var e=t.length,r=t.scale,i={nodes:[],edges:[]};if(e<=0)return i;i.nodes.push({id:0,attributes:{x:Math.random()*r,y:Math.random()*r}});for(var n=1;n<e;++n)i.nodes.push({id:n,attributes:{x:Math.random()*r,y:Math.random()*r}}),i.edges.push({id:n-1,source:n-1,target:n});return i}},Ex=(b(Ax,bx=Ly),Ax);function Ax(){var t=null!==bx&&bx.apply(this,arguments)||this;return t.balancedTree=function(t){return Promise.resolve(ax.generate(ax.configure(t)))},t.barabasiAlbert=function(t){return Promise.resolve(sx.generate(sx.configure(t)))},t.erdosRenyi=function(t){return Promise.resolve(ux.generate(ux.configure(t)))},t.flower=function(t){return Promise.resolve(_x.generate(_x.configure(t)))},t.grid=function(t){return Promise.resolve(vx.generate(vx.configure(t)))},t.path=function(t){return Promise.resolve(xx.generate(xx.configure(t)))},t.random=function(t){return Promise.resolve(mx.generate(mx.configure(t)))},t.randomTree=function(t){return Promise.resolve(yx.generate(yx.configure(t)))},t}var Sx,wx=(b(Tx,Sx=Ly),Tx);function Tx(){var i=null!==Sx&&Sx.apply(this,arguments)||this;return i.enable=function(t){return i._ogma.modules.geo.enable(t)},i.disable=function(t){return i._ogma.modules.geo.disable(t)},i.setOptions=function(t){return i._ogma.modules.geo.setOptions(t)},i.getOptions=function(){return i._ogma.modules.geo.getOptions()},i.getMap=function(){return i._ogma.modules.geo.getMap()},i.enabled=function(){return i._ogma.modules.geo.isEnabled()},i.getCenter=function(){return i._ogma.modules.geo.getCenter()},i.getView=function(){return i._ogma.modules.geo.getView()},i.getZoom=function(){return i._ogma.modules.geo.getZoom()},i.setZoom=function(t){return i._ogma.modules.geo.setZoom(t)},i.setView=function(t,e,r){return i._ogma.modules.geo.setView(t,e,r)},i.setCenter=function(t,e){return i._ogma.modules.geo.setCenter(t,e)},i.toggle=function(t){return i._ogma.modules.geo.toggle(t)},i.resetCoordinates=function(){return i._ogma.modules.geo.resetCoordinates()},i.getUnprojectedCoordinates=function(t){return i._ogma.modules.geo.getUnprojectedCoordinates(i._ogma.getNodes(t))},i}function Cx(t,e,r,i){var n;void 0===i&&(i={}),Array.isArray(r)||r instanceof(e?yi:$r)||(r=[r]);var o=i.virtual,a=void 0!==o&&o,s={elementsToRemove:t.getElements(e,r),virtual:a};t.fireEvent(be.REQUEST_ELEMENTS_TO_DELETE,s);var u=(a?{elementsToRemove:r}:s).elementsToRemove;if(!u.size)return Promise.resolve();u=u.dedupe();var l=t.storage.fetch(e),d=l.getFlexArray("removed");u=u.filter(function(t){return 0===d.get(t._index)}),e&&Cx(t,!1,u.getAdjacentEdges({filter:"all"}),i);var h=u._indexes,c=t.getCacheLists(e);if(We(l.getFlexArray("virtual").getMultiple(h))!==(a?h.length:0))throw new Error("Attempting to remove virtual elements; you should not do that");var f=((n={virtual:a})[e?"nodes":"edges"]=u,n);if(t.fireEvent(e?be.BEFORE_REMOVE_NODES:be.BEFORE_REMOVE_EDGES,f),c.visible.invalidList(),c.all.invalidList(),a||c.raw.invalidList(),t.setExcluded(u,!0),d.setMultiple(h,1),!e)for(var g=0;g<h.length;++g)t.topology.removeFromAdjacencyList(h[g]);return l.removeElements(h),t.setIndexFreeStep(1),t.fireEvent(e?be.REMOVE_NODES:be.REMOVE_EDGES,f),Promise.resolve()}var Mx=(Ix.prototype.addNodes=function(t,e){return Ei(this.modules.graph,!0,t,e)},Ix.prototype.addEdges=function(t,e){return Ei(this.modules.graph,!1,t,e)},Ix.prototype.addNode=function(t,e){return xi(this.modules.graph,!0,t,e)},Ix.prototype.addEdge=function(t,e){return xi(this.modules.graph,!1,t,e)},Ix.prototype.removeNodes=function(t,e){return Cx(this.modules.graph,!0,t,e)},Ix.prototype.removeEdges=function(t,e){return Cx(this.modules.graph,!1,t,e)},Ix.prototype.removeNode=function(t,e){return Cx(this.modules.graph,!0,[t],e)},Ix.prototype.removeEdge=function(t,e){return Cx(this.modules.graph,!1,[t],e)},Ix.prototype.getNodes=function(t){return this.modules.graph.getNodes(t)},Ix.prototype.getEdges=function(t){return this.modules.graph.getEdges(t)},Ix.prototype.getNode=function(t){return this.modules.graph.getNode(t)},Ix.prototype.getEdge=function(t){return this.modules.graph.getEdge(t)},Ix.prototype.clearGraph=function(){this.modules.graph.clear()},Ix.prototype.setGraph=function(t,e){return this.modules.graph.clear(),this.addGraph(t,e)},Ix.prototype.addGraph=function(t,e){return r=this.modules.graph,n=e,a=(i=t).nodes,s=void 0===a?[]:a,u=i.edges,l=void 0===u?[]:u,void 0===n&&(n={}),n.batchSize?Ei(r,!0,s,n).then(function(t){return o=t,Ei(r,!1,l,n)}).then(function(t){return{nodes:o,edges:t}}):Promise.resolve({nodes:Ai(r,!0,s,n),edges:Ai(r,!1,l,n)});var r,i,n,o,a,s,u,l},Ix.prototype.createNodeList=function(){return this.getNodes([])},Ix.prototype.createEdgeList=function(){return this.getEdges([])},Ix.prototype.getConnectedComponents=function(t){return void 0===t&&(t={}),this.modules.graph.getConnectedComponents(this.getNodes(t.filter),t)},Ix.prototype.getConnectedComponentByNode=function(t,e){var r=this.modules.graph.getNode(t);if(void 0===r)throw new Error("getComponentByNode: cannot find node "+t);return this.modules.graph.getConnectedComponentByNode(r,e)[0]},Ix);function Ix(){}var Lx=(Nx.prototype.reloadFonts=function(){this.modules.graphics.reloadFonts()},Nx);function Nx(){}function Ox(t){return t.charCodeAt(0)}var kx=Ox(" "),Rx=Ox("<"),Fx=Ox(">"),Dx=Ox('"'),Px=Ox("\n"),zx=Ox("\r"),Bx=Ox("/"),Ux=Ox("\\"),Vx=Ox("a"),jx=Ox("z"),Gx=Ox("A"),Hx=Ox("Z"),qx=Ox("0"),Wx=Ox("9"),Xx=Ox(":"),Yx=-1,Zx=-2,Kx=-3,Qx=-4;function Jx(t,e,r,i){var n=i.length;if(r-e===n){for(var o=0;o<n;++o)if(t[e+o]!==i[o])return;return 1}}function $x(t,e,r,i){for(var n=t.length,o=0;o<n;++o)if(Jx(e,r,i,t[o]))return o;return t.push(e.slice(r,i)),n}function tE(t,e,r){var i=rE(e,r),n=e[i];if(n===Fx||n===Bx)return i;var o=i;i=iE(e,i);for(var a,s,u,l=(a=e,s=o,u=i,$x(t.attributes,a,s,u));e[i]!==Dx;)++i;for(o=++i;(n=e[i])!==Dx;)n===Ux&&++i,++i;return t.tokens.push(Kx,l,o,i),i+1}function eE(t){return t===kx||t===Px||t===zx}function rE(t,e){for(;eE(t[e]);)++e;return e}function iE(t,e){for(;r=t[e],Vx<=r&&r<=jx||Gx<=r&&r<=Hx||r===Xx||qx<=r&&r<=Wx;)++e;var r;return e}function nE(t,e){var r=["return {","  id: undefined,","  attributes: {","    text: undefined,","    color: undefined,","    "+(t?"radius":"width")+": undefined",t?"  ,x: undefined":"",t?"  ,y: undefined":"","  },"];t||r.push("  source: undefined,","  target: undefined,");var i=Object.keys(e);i.length&&r.push("  data: {");for(var n=0;n<i.length;++n){var o=e[i[n]],a=o.title;r.push('  "'+a+'": '+(void 0!==o.default?JSON.stringify(o.default):void 0)+(n===i.length-1?"":","))}return i.length&&r.push("}"),r.push("};"),new Function(r.join("\n"))}function oE(t){return-1===t.indexOf("\\")?t:t=t.replace(/\\"/g,'"')}function aE(t){if(-1===t.indexOf("<gexf"))throw new Error("not a GEXF file");var e=function(t){for(var e=new Int32Array(t.length),r=0,i=t.length;r<i;++r)e[r]=t.charCodeAt(r);return e}(t),r=function(t,e){for(var r,i,n={tags:[],attributes:[],tokens:[]},o=n.tokens,a=rE(t,e);a<t.length;){var s=t[a];if(s===Rx){if(t[a=rE(t,++a)]===Bx)for(o.push(Zx);t[++a]!==Fx;);else{a=iE(t,r=a);var u=$x(n.tags,t,r,a);for(o.push(Yx,u),s=t[a];s!==Fx&&s!==Bx;)s=t[a=tE(n,t,a)];if(s===Bx)for(o.push(Zx);t[++a]!==Fx;);}a+=1}else{for(r=a;t[++a]!==Rx;);for(i=a-1;eE(t[i]);)--i;o.push(Qx,r,i+1)}a=rE(t,a)}return n}(e,t.indexOf("<gexf ")),i={},n={};r.tags.forEach(function(t,e){var r=String.fromCharCode.apply(null,t);i[r]=e}),r.attributes.forEach(function(t,e){var r=String.fromCharCode.apply(null,t);n[r]=e});for(var o=i.attributes,a=i.attribute,s=i.node,u=i.edge,l=i.default,d=i["viz:position"],h=i["viz:size"],c=i["viz:color"],f=i.attvalue,g=n.class,p=n.id,_=n.type,v=n.title,m=n.label,y=n.source,b=n.target,x=n.x,E=n.y,A=n.r,S=n.g,w=n.b,T=n.a,C=n.value,M=n.for,I=n.weight,L={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5},N=0,O=r.tokens,k=O.length,R=new Array(16),F=0,D=0,P=0,z=!0,B={},U={},V="",j="",G="",H=void 0,q={attributes:{}},W=0,X=0,Y=0,Z=1,K="",Q=void 0,J=!1,$=!0,tt=null,et=null,rt=[],it=[],nt=0,ot={};N<k;){var at=O[N];if(at===Yx)D=F,F=O[N+1],R[P]=F,P+=1,F===s?(q=(tt=tt||nE(!0,B))(),$=!0,ot=B):F===u&&(q=(et=et||nE(!1,U))(),$=!1,ot=U),N+=2;else if(at===Zx){if(V&&F===a){ot=z?B:U;var st=L[j];(value=H)&&(1===st?value=+value:2===st?value=0|+value:3===st?value="true"===value:5===st&&(value=value.split(" ").filter(function(t){return t}))),ot[V]={title:G||V,default:value,type:st},j=G=V="",H=void 0}else if(F===s&&4===P)J&&q.attributes&&(q.attributes.color="rgba("+W+", "+X+", "+Y+", "+Z+")",Y=X=W=0,J=!(Z=1)),q.id||(q.id=++nt),rt.push(q);else if(F===u&&4===P)q.id||(q.id=++nt),it.push(q);else if(F===f&&6===P&&K){var ut=($?B:U)[K];if(ut){if(void 0===Q)Q=ut.default;else(st=ut.type)&&(1===st?Q=+Q:2===st?Q=0|+Q:3===st?Q="true"===Q:5===st?Q=Q.split(" ").filter(function(t){return t}).map(function(t){return oE(t)}):"string"==typeof e&&(Q=oE(Q)));q.data[ot[K].title]=Q}K="",Q=null}F=D,D=R[--P-2],N+=1}else if(at===Kx){var lt=O[N+1],value=t.substring(O[N+2],O[N+3]);if(F===o)lt===g&&(z="edge"!==value&&"edges"!==value);else if(F===a)lt===p?V=value:lt===_?j=value:lt===v&&(G=value);else if(F!==s&&F!==u||4!==P)if(F===d&&5===P){if(lt===x)q.attributes.x=parseFloat(value);else if(lt===E){var dt=parseFloat(value);q.attributes.y=0===dt?dt:-dt}}else F===c&&5===P?(J=!0,lt===A?W=parseInt(value):lt===S?X=parseInt(value):lt===w?Y=parseInt(value):lt===T&&(Z=parseFloat(value))):F===h&&5===P?lt===C&&($?q.attributes.radius=+value:q.attributes.width=+value):F===f&&6===P&&(lt===M||lt===p?K=value:lt===C&&(Q=value));else lt===p?q.id=value:lt===m?q.attributes.text=value:lt===y?q.source=value:lt===b?q.target=value:lt===I&&(q.attributes.width=+value);N+=4}else{if(at!==Qx)throw new Error("at index "+N+": token "+at);value=t.substring(O[N+1],O[N+2]);F===l&&(H=value),N+=3}}return{nodes:rt,edges:it}}function sE(t,e){for(var r=0,i=e;r<i.length;r++){var n=i[r];if(t[n])return uE(t[n])}}function uE(t){if("string"==typeof t||isFinite(t))return String(t);return String(t.id||t._id)}function lE(t){var e=[],r=[];return function e(r,i,n){if(r&&"object"==typeof r){if(Array.isArray(r))return r.forEach(function(t){return e(t,i,n)});if("vertex"===(s=r).type||"vertex"===s._type||s.inE||s.outE||s._inE||s._outE){var o={};r.properties&&Object.keys(r.properties).forEach(function(t){o[t]=r.properties[t][0].value});var t=uE(r);for(var a in i.push({id:t,data:{id:r.id+"",categories:[r.label],properties:o}}),r)"properties"!==a&&e(r[a],i,n)}else{var s,u;if("edge"===(u=r).type||"edge"===u._type||u.inV||u.outV||u._outV||u._inV)for(var a in t=uE(r),n.push({id:t,source:sE(r,["inV","_inV"]),target:sE(r,["outV","_outV"]),data:{id:t,type:r.label,properties:r.properties||{}}}),r)"properties"!==a&&e(r[a],i,n);else Object.keys(r).forEach(function(t){return e(r[t],i,n)})}}}("string"==typeof t?JSON.parse(t):t,e,r),{nodes:e,edges:r}}function dE(t,e,r){r=r||e,e in t&&(t.attributes[r]=t[e])}function hE(t,e){void 0===e&&(e=function(t){return t});for(var r=e(JSON.parse(t)),i=r.nodes||[],n=r.edges||[],o=0;o<i.length;o++){var a=i[o];a.attributes||(a.attributes={}),"string"==typeof a.size&&(a.size=+a.size),"string"==typeof a.x&&(a.x=+a.x),"string"==typeof a.y&&(a.y=+a.y),dE(a,"x"),dE(a,"y"),dE(a,"size","radius"),dE(a,"color"),dE(a,"text")}for(o=0;o<n.length;o++){var s=n[o];s.attributes||(s.attributes={}),"string"==typeof s.size&&(s.size=+s.size),dE(s,"size","width"),dE(s,"color"),dE(s,"text")}return{nodes:i,edges:n}}function cE(t,e){for(var r=0,i=0;i<20;++i){var n=r+t[i]+e[i];r=+(10<=n),t[i]=n%10}}function fE(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}var gE=new(fE.prototype.int64ToString=function(t){var e=t.low,r=t.high;if(0===e&&0===r)return"0";!function(t,e,r){for(var i=0;i<32;++i)r[i]=+!!(t&1<<i);for(i=0;i<32;++i)r[i+32]=+!!(e&1<<i)}(e,r,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0);var i=(this._decimalPowerOfTwo[0]=1)===this._binaryNumber[63];i&&function(t){for(var e=0;e<64;++e)t[e]^=1;for(e=0;e<64&&!(t[e]^=1);++e);}(this._binaryNumber);for(var n=0;n<64;++n)this._binaryNumber[n]&&cE(this._decimalNumber,this._decimalPowerOfTwo),cE(this._decimalPowerOfTwo,this._decimalPowerOfTwo);var o=[],a=this._decimalNumber.length-1;for(i&&o.push("-");!this._decimalNumber[a];)--a;for(n=a;0<=n;--n)o.push(String(this._decimalNumber[n]));return o.join("")},fE);function pE(t){return gE.int64ToString(t)}function _E(t){return"object"==typeof t&&"high"in t&&"low"in t}var vE=function(t){return"start"in t&&"end"in t&&"type"in t},mE=function(t){return"segments"in t};function yE(e,t,r,i){var n,o,a;t&&(Array.isArray(t)?t.forEach(function(t){return yE(e,t,r,i)}):mE(t)?(n=e,o=r,a=i,t.segments.forEach(function(t){yE(n,t.start,o,a),yE(n,t.end,o,a),yE(n,t.relationship,o,a)})):(function(t){if("object"!=typeof t||null===t)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");for(var e,r=0,i=Object.keys(t.properties);r<i.length;r++){var n=i[r],o=t.properties[n];_E(o)&&(t.properties[n]=pE(o))}if(void 0!==t.identity&&(_E(t.identity)&&(t.identity=pE(t.identity)),"start"in(e=t)&&"end"in e)){var a=t.start.identity||t.start,s=t.end.identity||t.end;_E(a)&&(t.start=pE(a)),_E(s)&&(t.end=pE(s))}}(t),vE(t)?i.has(t.identity)||(i.add(t.identity),e.edges.push({id:t.identity,source:t.start,target:t.end,data:{neo4jType:t.type,neo4jProperties:t.properties}})):r.has(t.identity)||(r.add(t.identity),e.nodes.push({id:t.identity,attributes:{x:100*Math.random(),y:100*Math.random()},data:{neo4jLabels:t.labels,neo4jProperties:t.properties}}))))}var bE,xE=(b(EE,bE=Ly),EE);function EE(){var t=null!==bE&&bE.apply(this,arguments)||this;return t.gexf=function(t){return Promise.resolve(aE(t))},t.gexfFromUrl=function(t){return zt(t).then(function(t){return aE(t)})},t.janus=function(t){return Promise.resolve(lE(t))},t.json=function(t,e){return Promise.resolve(hE(t,e))},t.jsonFromUrl=function(t,e){return zt(t).then(function(t){return hE(t,e)})},t.neo4j=function(t){return Promise.resolve((r="string"==typeof(e=t)?JSON.parse(e):e,i={nodes:[],edges:[]},n=new Set,o=new Set,r.records.forEach(function(t){t._fields.forEach(function(t){yE(i,t,n,o)})}),i));var e,r,i,n,o},t}var AE=(SE.prototype.fetch=function(t){return zt(t)},SE);function SE(){}var wE,TE=(b(CE,wE=Ly),CE);function CE(){var e=null!==wE&&wE.apply(this,arguments)||this;return e.isKeyPressed=function(t){return e._ogma.modules.keyboard.isPressed(t)},e.resetKeys=function(){e._ogma.modules.keyboard.resetKeys()},e}function ME(t,e){return t-e}var IE={configure:function(t,e){var r=e.graph,i=e.data;if(void 0===t.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');var n,o,a=I(I({},t),{centralNode:(n=r,(o=t.centralNode)instanceof vi?o:n.getNode(o))}),s=a.centralNode,u=a.nodes,l=r.getNode(s);if(void 0===l)throw new Error('concentric layout: "centralNode" parameter is not valid');var d=l._index,h=l.getPosition(),c=h.x,f=h.y,g=u.getAttribute("layoutable"),p=r.getNodes(u)._indexes,_=Array.from(p.filter(function(t,e){return g[e]}));-1===_.indexOf(d)&&_.push(d);var v=r.getNodeAttribute("radius").getMultiple(p),m=function(t,e,r,i){if(e)return"random"===e?"random":"radius"===e?i.slice():"degree"===e?r.getDegree():t.getProperty(r,e)}(i,a.sortBy,u,v),y=_.reduce(function(t,e,r){return t[e]=r,t},{}),b=_.map(function(t,e){return e}),x=new Set;t.edges.getExtremities()._indexes.forEach(function(t){x.add(t)});var E=_.map(function(t){return r.topology.getAdjacentElements(!0,new Uint32Array([t])).filter(function(t){return x.has(t)}).map(function(t){return y[t]})});return{sourceNodeIndex:_.indexOf(d),centerX:"number"==typeof a.centerX?a.centerX:c,centerY:"number"==typeof a.centerY?a.centerY:f,list:_,indexes:b,size:_.length,totalSize:_.length,attributes:{adjacentNodes:E,size:v},sortAttr:m,clockwise:void 0===a.clockwise||a.clockwise,circleHopRatio:a.circleHopRatio||5,allowOverlap:!!a.allowOverlap}},context:function(){return{dijkstra:function(a,s,u,t,e){var l=Math.pow(2,31)-1,d=new Int32Array(t),h=new Int32Array(t),c=new Int8Array(t);d.fill(l),h.fill(-1);for(var r=0;r<t;++r){var i=s[r];void 0!==i&&(d[i]=l,h[i]=-1)}for(var f=d[e]=0,n=function(){var t=l;f=-1;for(var e=0;e<u;++e){var r=s[e],i=d[r];!c[r]&&i<t&&(t=i,c[f=r]=1)}if(-1<f){var n=a[f],o=t+1;n.forEach(function(t){var e=d[t];o<e&&(d[t]=o,h[t]=f)})}};-1!==f;)n();return d},determinePropertyType:function(e,t,r){return t.some(function(t){return"number"!==e[t]})?"string":"number"}}},update:function(h,t){for(var e=h.attributes,r=h.indexes,i=h.size,n=h.sourceNodeIndex,c=h.centerX,f=h.centerY,o=h.sortAttr,a=e.adjacentNodes,g=e.size,p=new Array(h.totalSize),_=new Array(h.totalSize),s=t.dijkstra(a,r,h.size,h.totalSize,n),u=0,v={},l=0;l<i;l++){var d=g[r[l]];u<d&&(u=d)}var m=u*h.circleHopRatio,y=0,b=0,x=Math.PI/9;for(l=0;l<i;l++){var E=r[l],distance=s[E],A=v[distance];A||(A=[],v[distance]=A),A.push(E)}var S,w,T,C=(w=r,T=t,"random"===(S=o)?function(){return Math.random()-.5}:S?"number"===T.determinePropertyType(S,w,w.length)?function(t,e){return S[t]-S[e]}:function(t,e){return S[t]<S[e]?-1:1}:void 0),M="random"===o||o;return Object.keys(v).sort(function(t,e){return parseInt(t)-parseInt(e)}).forEach(function(t,e){var r=v[t],i=r.length,n=0,o=b,a=2*Math.PI/i;if(0!==e&&!h.allowOverlap){var s;2*Math.PI*y<(s=2*(n+=r.reduce(function(t,e){return t+g[e]},0))*Math.SQRT2)&&(y+=s/(2*Math.PI)-y)}M&&(r.sort(C),h.clockwise||r.reverse());for(var u=0;u<i;u++){var l=r[u];p[l]=Math.cos(o)*y+c,_[l]=Math.sin(o)*y+f;var d=g[l];o+=a*(h.allowOverlap?1:d/n*i)}y+=m,b+=x}),{x:p,y:_,indexes:h.list}},isRunning:function(){return!1},onSync:function(t){return{indexes:t.indexes,x:t.x,y:t.y}}},LE={imports:{minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,distance:distance,circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,removeRadialOverlap:removeRadialOverlap,quadraticInOut:bl,calculateRadii:up},configure:function(t,e){var r=e.graph,i=t.nodes,n=i.size;function o(t,e){return null!=t&&isFinite(t)?t:e}if(void 0===t.centralNode)throw new Error('radial layout: missing parameter "centralNode"');var a=r.getNode(t.centralNode);if(void 0===a)throw new Error('radial layout: parameter "centralNode" is not valid');t.radiusRatio=o(t.radiusRatio,Math.SQRT2),t.radiusDelta=o(t.radiusDelta,0),t.nodeGap=o(t.nodeGap,10),t.repulsion=n*o(t.repulsion,1);var s=a.getPosition(),u=o(t.centerX,s.x),l=o(t.centerY,s.y),d=a._index;i.includes(a)||(i=i.concat(a.toList()));var h=i._indexes,c=i.getAttribute("layoutable");(h=h.filter(function(t,e){return c[e]||t===d})).sort(ME);var f=h.length,g=function(t,e,r){for(var i=t.slice().sort(ME),n=[],o=0,a=e.length;o<a;o++){for(var s=[],u=e[o],l=!1,d=0,h=u.length;d<h;d++){var c=u[d];-1!==k(i,c)&&(c===r&&(l=!0),s.push(c))}0!==s.length&&n[l?"unshift":"push"](s.sort(ME))}return n}(h,r.getConnectedComponents(i,{internalIndexes:!0}),d),p=r.degrees(h),_=new Float32Array(r.getNodeAttribute("x").getMultiple(h)),v=new Float32Array(r.getNodeAttribute("y").getMultiple(h)),m=r.getNodeAttribute("radius").getMultiple(h),y=r.getEdges()._indexes,b=r.getEdgeAttribute("source").getMultiple(y),x=r.getEdgeAttribute("target").getMultiple(y),E=r.getAdjacencyList({internalIndexes:!0,weight:1,indexes:h});return{centerIndex:d,centerIndexPos:0,cx:u,cy:l,D:null,indexes:h,components:g,normIndexes:null,radii:null,rings:null,x:_,y:v,degree:p,size:f,attributes:{size:m,adjacency:E,weights:x.map(function(){return 1}),sources:b,targets:x},sortAttr:null,allowOverlap:!!t.allowOverlap,nodeGap:t.nodeGap,radiusRatio:t.radiusRatio,radiusDelta:t.radiusDelta,repulsion:t.repulsion,randomize:!("randomize"in t)||!!t.randomize,renderSteps:!!t.renderSteps,epsilon:o(t.epsilon,.001),maxSteps:o(t.maxIterations,100),iterationsPerRender:o(t.iterationsPerRender,20),step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:function(){return{data:null,gridPlacement:function(t,e,r){void 0===r&&(r=8);for(var i=t.length,n=new Float32Array(i),o=new Float32Array(i),a=0,s=0,u=t.length;s<u;s++){var l=e[t[s]];a<l&&(a=l)}var d=a*r,h=Math.ceil(Math.sqrt(i)),c=Math.ceil(i/h),f=-Math.floor((c-1)*d/2),g=-Math.floor((h-1)*d/2);for(s=0;s<h;s++)for(var p=0;p<c;p++)n[s*c+p]=f+p*d,o[s*c+p]=g+s*d;return{x:n,y:o}},connectComponents:function(a,s,u,l,d,h){var c;function f(t,value){var e=new Uint32Array(t.length+1);return e.set(t),e[t.length]=value,e}for(var t=function(t){var e=a[t],i=0,n=0;e.forEach(function(t,e){var r=d.get(t);null!=r&&i<r&&(n=e,i=r)}),c=e[n];var r=s[h.get(c)];r.weights=r.weights||[],r.nodes=f(r.nodes,u),r.weights.push(l);var o=s[h.get(u)];o.weights=o.weights||[],o.nodes=f(o.nodes,c),o.weights.push(l)},e=1;e<a.length;e++)t(e)},correctSubgraphsDistances:function(t,e,i,n,r){for(var o=Array.prototype.reduce.call(t[i],function(t,e,r){return r!==i&&e<n&&t<e&&(t=e),t},0),a=n-o-1,s=1;s<e.length;s++)for(var u=e[s],l=0,d=u.length;l<d;l++){var h=r.get(u[l]);null!=h&&(t[i][h]-=a,t[h][i]-=a)}},initialize:function(i,n){(i.data=n).step=0;var o=new Map,a=new Map;n.normIndexes=n.indexes.reduce(function(t,e,r){return t[r]=r,o.set(e,r),a.set(e,n.degree[r]),i.data&&e===n.centerIndex&&(i.data.centerIndexPos=r),t},new Uint32Array(n.indexes.length));var t=n.centerIndexPos,e=n.components[0].length;i.connectComponents(n.components,n.attributes.adjacency,n.centerIndex,e,a,o);var r=johnson({sources:n.attributes.sources,targets:n.attributes.targets,weights:n.attributes.weights,indexes:n.indexes,adjacency:n.attributes.adjacency,undirected:!0});i.correctSubgraphsDistances(r,n.components,t,e,o);for(var s=(n.D=r)[t],u=Object.create(null),l=0,d=n.normIndexes.length;l<d;l++)if(l!==t){var h=s[l];u[h]=u[h]||[],u[h].push(n.normIndexes[l])}n.rings=u,n.radii=up(t,n.rings,n.attributes.size,n.nodeGap,n.radiusRatio,n.radiusDelta)},removeOverlaps:function(t,e){if(t.data){var r=t.data.centerIndexPos,i=e.attributes.size,n=e.rings,o=e.x[r],a=e.y[r];for(var s in n){var u=n[s],l=distance(o,a,e.x[u[0]],e.y[u[0]]);removeRadialOverlap({X:e.x,Y:e.y,sizes:i,indexes:u,center:[o,a],R:l,gap:e.nodeGap,inPlace:!0})}}}}},update:function(e,t){var r,i=(e=e||t.data).indexes,n=e.centerIndex;e.x=e.x||new Float32Array(e.size),e.y=e.y||new Float32Array(e.size),-1===e.step&&t.initialize(t,e);function o(t){return e.radii&&e.radii[t]||1}var a=e.repulsion;if(0===e.step&&e.randomize&&(r=t.gridPlacement(e.indexes,e.attributes.size),e.x=r.x,e.y=r.y),!e.converged)for(var s=e.maxSteps,u=e.iterationsPerRender,l=e.step,d=Math.min(l+u,s),h=e.D,c=e.x,f=e.y,g=e.size,p=e.centerIndexPos,_=e.normIndexes;l<=d&&!e.converged;){var v=bl(Math.min(l,s)/s);e.step=l++,r=stressMinimizationStep(h,c,f,g,p,a,v,_,o),e.x=r.x,e.y=r.y,e.prevStress=e.stress,e.stress=constrainedStress(h,c,f,g,p,a,v,_),e.converged=e.converged||Math.abs(e.stress-e.prevStress)<=e.epsilon}if(e.converged)if(e.overlapRemoved||e.allowOverlap){e.done=!0;var m=e.rings||{};e.rings=Object.keys(m).reduce(function(t,e){return t[e]=m[e].map(function(t){return i[t]}),t},{})}else t.removeOverlaps(t,e,n),e.overlapRemoved=!0;return e},isRunning:function(t){var e=t.data;return!!e&&(!e.converged||!e.allowOverlap&&!e.done)},onSync:function(t){if(t.renderSteps||t.done)return NE(t)},onEnd:function(t,e){return NE(t)}};function NE(t){for(var e=t.x,r=t.y,i=t.indexes.length,n=e[t.centerIndexPos]-t.cx,o=r[t.centerIndexPos]-t.cy,a=0;a<i;a++)e[a]-=n,r[a]-=o;return{indexes:t.indexes,x:e,y:r}}
/**
  * @preserve
  * @linkurious/force-layout@0.4.0
  * Ogma general-purpose force-directed layout
  */
function OE(){return function(){var e=function(t){var i,e=(i=4022871197,function(t){t=t.toString();for(var e=0;e<t.length;e++){var r=.02519603282416938*(i+=t.charCodeAt(e));r-=i=r>>>0,i=(r*=i)>>>0,i+=4294967296*(r-=i)}return 2.3283064365386963e-10*(i>>>0)});this.c=1,this.s0=e(" "),this.s1=e(" "),this.s2=e(" "),this.s0-=e(String(t)),this.s0<0&&(this.s0+=1),this.s1-=e(String(t)),this.s1<0&&(this.s1+=1),this.s2-=e(t),this.s2<0&&(this.s2+=1),e=null};function r(t){return new e(t.toString()).next()}e.prototype.next=function(){var e=this;return function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)}},e.prototype.nextDouble=function(){var t=this.next();return function(){return t()+11102230246251565e-32*(2097152*t()|0)}},e.prototype.nextInt32=function(){var t=this.next();return function(){return 4294967296*t()|0}};var at=r(42);function f(t){at=r(t)}function U(){return 1e-6*(at()-.5)}var d=function(t){return t.x},h=function(t){return t.y},c=function(t){return t.r};function V(t,e,r,i){void 0===e&&(e=d),void 0===r&&(r=h),void 0===i&&(i=c);for(var n,o=function(t){for(var e=t.length-1;0<=e;e--){var r=Math.floor(Math.random()*(e+1));r=Math.max(Math.min(r,e),0);var i=t[e];t[e]=t[r],t[r]=i}return t}(t.slice()),a=o.length,s=[],u=0;u<a;){var l=o[u];n&&p(n,e(l),r(l),i(l))?u++:(n=_(s=g(s,l,e,r,i),e,r,i),u=0)}return n}function g(t,e,r,i,n){var o=r(e),a=i(e),s=n(e),u={x:o,y:a,r:s};if(w(u,t,r,i,n))return[e];for(var l=0;l<t.length;++l){var d=t[l],h=r(d),c=i(d),f=n(d);if(!S(u,h,c,f)&&w(T(h,c,f,o,a,s),t,r,i,n))return[t[l],e]}for(var g=0;g<t.length-1;g++)for(var p=g+1;p<t.length;p++){var _=t[g],v=t[p],m=r(_),y=i(_),b=n(_),x=r(v),E=i(v),A=n(v);if(!S(T(m,y,b,x,E,A),o,a,s)&&!S(T(m,y,b,o,a,s),x,E,A)&&!S(T(x,E,A,o,a,s),m,y,b)&&w(C(m,y,b,x,E,A,o,a,s),t,r,i,n))return[t[g],t[p],e]}throw new Error}function S(t,e,r,i){var n=t.r-i,o=e-t.x,a=r-t.y;return 0<=n&&o*o+a*a<n*n}function p(t,e,r,i){var n=t.r-i+1e-6,o=e-t.x,a=r-t.y;return 0<n&&o*o+a*a<n*n}function w(t,e,r,i,n){for(var o=0;o<e.length;++o){var a=e[o];if(!p(t,r(a),i(a),n(a)))return}return 1}function _(t,e,r,i){return 1===t.length?(n=e(t[0]),o=r(t[0]),a=i(t[0]),{x:n,y:o,r:a}):2===t.length?T(e(t[0]),r(t[0]),i(t[0]),e(t[1]),r(t[1]),i(t[1])):C(e(t[0]),r(t[0]),i(t[0]),e(t[1]),r(t[1]),i(t[1]),e(t[2]),r(t[2]),i(t[2]));var n,o,a}function T(t,e,r,i,n,o){var a=i-t,s=n-e,u=o-r,l=Math.sqrt(a*a+s*s);return{x:(t+i+a/l*u)/2,y:(e+n+s/l*u)/2,r:(l+r+o)/2}}function C(t,e,r,i,n,o,a,s,u){var l=t-i,d=t-a,h=e-n,c=e-s,f=o-r,g=u-r,p=t*t+e*e-r*r,_=p-i*i-n*n+o*o,v=p-a*a-s*s+u*u,m=d*h-l*c,y=(h*v-c*_)/(2*m)-t,b=(c*f-h*g)/m,x=(d*_-l*v)/(2*m)-e,E=(l*g-d*f)/m,A=b*b+E*E-1,S=2*(r+y*b+x*E),w=y*y+x*x-r*r,T=-(A?(S+Math.sqrt(S*S-4*A*w))/(2*A):w/S);return{x:t+y+b*T,y:e+x+E*T,r:T}}for(var i=[0,1],n=[0,2],t=4;t<65535;t<<=2)for(var o=0,a=i.length;o<a;o++)i.push(i[o]|t),n.push((i[o]|t)<<1);function E(t,e){return(n[255&e]|i[255&t])+65536*(n[e>>8&255]|i[t>>8&255])+4294967296*(n[e>>16&255]|i[t>>16&255])}function A(t,e){var r=t^e,i=65535^r,n=65535^(t|e),o=t&(65535^e),a=r|i>>1,s=r>>1^r,u=n>>1^i&o>>1^n,l=r&n>>1^o>>1^o;s=(r=a)&(i=s)>>2^i&(r^i)>>2,u^=r&(n=u)>>2^i&(o=l)>>2,l^=i&n>>2^(r^i)&o>>2,s=(r=a=r&r>>2^i&i>>2)&(i=s)>>4^i&(r^i)>>4,u^=r&(n=u)>>4^i&(o=l)>>4,l^=i&n>>4^(r^i)&o>>4,u^=(r=a=r&r>>4^i&i>>4)&(n=u)>>8^(i=s)&(o=l)>>8;var d=t^e,h=(i=(l^=i&n>>8^(r^i)&o>>8)^l>>1)|65535^(d|(r=u^u>>1));return((h=1431655765&((h=858993459&((h=252645135&((h=16711935&(h|h<<8))|h<<4))|h<<2))|h<<1))<<1|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&(d|d<<8))|d<<4))|d<<2))|d<<1)))>>>0}var M=new Uint32Array(1024);function I(t,e,r,i){this.left=null,this.right=null,this.data=null,this.code=t,this.data=e,this.left=r,this.right=i}var L,s,v=Math.clz32||function(t){for(var e=1<<31,r=0;r<31;r+=1){if(e&t)return r;e>>>=1}return 32};function N(t,e,r,i){var n=e[t[r]],o=e[t[i]];if(n===o)return r;for(var a,s,u=v(n^o),l=r,d=i-r;(a=l+(d=d+1>>1))<i&&(s=e[t[a]],u<v(n^s)&&(l=a)),1<d;);return l}(s=L=L||{})[s.HILBERT=1]="HILBERT",s[s.MORTON=0]="MORTON";var j,G,H,q,W,X,Y,Z,K,m=function(t,e){void 0===e&&(e={});var r=e.getX,i=e.getY,n=e.bucketSize;void 0===n&&(n=0);var o=e.sfc;void 0===o&&(o=L.HILBERT),this.bucketSize=0,this._root=null;var a=t.length,s=new Uint32Array(a),u=1/0,l=1/0,d=-1/0,h=-1/0;this._x=r,this._y=i;var c=o===L.HILBERT?A:E;this._project=c;for(var f=new Uint32Array(a),g=0;g<a;g++){var p=t[g],_=r(p),v=i(p);_<u&&(u=_),v<l&&(l=v),d<_&&(d=_),h<v&&(h=v),f[g]=g}this._minX=u,this._minY=l,this._maxX=d,this._maxY=h;var m=65535/Math.max(d-u,1),y=65535/Math.max(h-l,1);this._hw=m,this._hh=y;for(var b=0;b<a;b++){var x=t[b];s[b]=c(m*(r(x)-u),y*(i(x)-l))}!function(t,e){for(var r=new Uint32Array(e.length),i=0;i<1024;i++)M[i]=0;for(var n=0;n<e.length;n++){var o=e[n];M[255&o]++,M[256+(o>>8&255)]++,M[512+(o>>16&255)]++,M[768+(o>>24&255)]++}for(var a=0;a<4;a++)for(var s=0,u=0,l=256*a,d=0;d<256;d++)s=M[d+l],M[d+l]=u,u+=s;for(var h=0;h<e.length;h++){var c=e[h];r[M[255&c]++]=h}for(var f=0;f<e.length;f++){var g=r[f],p=e[g];t[M[256+(p>>8&255)]++]=g}for(var _=0;_<e.length;_++){var v=t[_],m=e[v];r[M[512+(m>>16&255)]++]=v}for(var y=0;y<e.length;y++){var b=r[y],x=e[b];t[M[768+(x>>24&255)]++]=b}}(f,s),this._root=0===n?function(t,e,r,i,n){for(var o=new I(null,null,null,null),a=[o],s=[i,n];0!==a.length;){var u=s.pop(),l=s.pop(),d=a.pop();if(u-l==0)d.code=r[l],d.data=t[e[l]];else{var h=N(e,r,l,u);l<=(d.code=h)&&(d.left=new I(null,null,null,null),a.push(d.left),s.push(l,h)),h<u&&(d.right=new I(null,null,null,null),a.push(d.right),s.push(h+1,u))}}return o}(t,f,s,0,a-1):function(t,e,r,i,n,o){for(var a=new I(null,null,null,null),s=[a],u=[i,n];0!==s.length;){var l=u.pop(),d=u.pop(),h=s.pop();if(l-d<o){for(var c=new Array(l-d+1),f=d,g=0;f<=l;f++,g++)c[g]=t[e[f]];h.code=r[d],h.data=c}else{var p=N(e,r,d,l);d<=(h.code=p)&&(h.left=new I(null,null,null,null),s.push(h.left),u.push(d,p)),p<l&&(h.right=new I(null,null,null,null),s.push(h.right),u.push(p+1,l))}}return a}(t,f,s,0,a-1,n),this.bucketSize=n},u={root:{configurable:!0}};u.root.get=function(){return this._root},m.prototype.inOrder=function(t,e){for(var r=this._root,i=[],n=!1;!n;)if(r)i.push(r),r=r.left;else if(0!==i.length){if(r=i.pop(),t.call(e,r))break;r=r.right}else n=!0;return this},m.prototype.preOrder=function(t,e){for(var r=[this._root];0!==r.length;){var i=r.pop();t.call(e,i)||(i.right&&r.push(i.right),i.left&&r.push(i.left))}return this},m.prototype.postOrder=function(t,e){var r,i=[],n=this._root;do{for(;n;)n.right&&i.push(n.right),i.push(n),n=n.left;n=i.pop(),r=i.length-1,n=n.right&&i[r]===n.right?(i[r]=n).right:(t.call(e,n),null)}while(0!==i.length);return this},m.prototype.map=function(e,r){var i=[];return this.inOrder(function(t){i.push(e.call(r,t))}),i},m.prototype.height=function(){return function t(e){return e?1+Math.max(t(e.left),t(e.right)):0}(this._root)},m.prototype.toString=function(t){void 0===t&&(t=function(t){return t.code.toString()});var e=[];return function t(e,r,i,n,o){if(e){n(r+(i?"^-- ":"|-- ")+o(e)+"\n");var a=r+(i?"    ":"|   ");e.left&&t(e.left,a,!1,n,o),e.right&&t(e.right,a,!0,n,o)}}(this._root,"",!0,function(t){return e.push(t)},t),e.join("")},m.prototype.size=function(){var t=0;return this.preOrder(function(){t++}),t},m.prototype.destroy=function(){return this._root=null,this},Object.defineProperties(m.prototype,u);var Q=0;function y(t,e,r,i){var n=i.X,o=i.Y,a=i.R,s=i.bucketSize;Q=t,null===r&&(r=new m(e,{getX:H,getY:q,bucketSize:s})).postOrder(j);for(var u=e.length,l=0;l<u;l++)X=e[l],Y=n[X],Z=o[X],K=a[X],r.preOrder(G);return r}var x,k,R,F,D,P,z,B,J;function b(t,e,r,i){for(var n=r.sources,o=r.targets,a=r.X,s=r.Y,u=r.R,l=r.fx,d=r.fy,h=r.degrees,c=r.weights,f=i.edgeStrength,g=i.edgeLength,p=0;p<e.length;p++){var _=e[p],v=n[_],m=o[_],y=h[v]+1,b=h[m]+1,x=f*c[_],E=a[m]+l[m]-a[v]-l[v]||U(),A=s[m]+d[m]-s[v]-d[v]||U(),S=E*E+A*A,w=Math.sqrt(S),T=g+u[v]+u[m];if(!(w<=T)){var C=T-w,M=1/Math.min(y,b),I=Math.min(1,t*x*(C*C/S)*M);E*=I,A*=I;var L=b/(b+y);l[v]+=E*L,d[v]+=A*L,l[m]-=E*(1-L),d[m]-=A*(1-L)}}}function O(t,e,r,i,n){var o=i.X,a=i.Y,s=i.R,u=i.fx,l=i.fy,d=i.bucketSize;if(0===n.elasticity)return r;r||(r=new m(e,{getX:x,getY:k,bucketSize:d})).postOrder(F);for(var h=0;h<e.length;h++)P=e[h],z=o[P]+u[P],B=a[P]+l[P],J=s[P],r.preOrder(D);return r}y.initialize=function(t,e,r){var i=t.length,n=e.X,o=e.Y,a=e.R,s=e.degrees,u=e.pinned,l=e.masses,d=e.nodeIds,h=r.scaling,c=r.defaultRadius,f=r.bucketSize;e.bucketSize=void 0===f?Math.floor(Math.log(i)):f;for(var g,b,x,E,A,S,p=1/0,_=1/0,v=-1/0,m=-1/0,y=Math.PI*(3-Math.sqrt(5)),w=0;w<t.length;w++){var T=t[w],C=T.x,M=T.y,I=T.r,L=T.mass;if(isNaN(C)||isNaN(M)){var N=5*Math.sqrt(w),O=w*y;C=N*Math.cos(O),M=N*Math.sin(O)}n[w]=C,o[w]=M,a[w]=I||c,u[w]=T.pinned?1:0,l[w]=void 0===L?(1+s[w])*h:L,d[w]=w,C<p&&(p=C),M<_&&(_=M),v<C&&(v=C),m<M&&(m=M)}if(1<t.length&&(v-p==0||m-_==0))for(var k=(p+v)/2,R=(_+m)/2,F=0;F<i;F++)if(!u[F]){var D=5*Math.sqrt(F),P=F*y,z=k+D*Math.cos(P),B=R+D*Math.sin(P);(n[F]=z)<p&&(p=z),(o[F]=B)<_&&(_=B),v<z&&(v=z),m<B&&(m=B)}H=function(t){return n[t]},q=function(t){return o[t]},W=function(t){return a[t]},b=(g=e).X,x=g.Y,E=g.R,A=g.masses,S=g.bucketSize,j=function(t){var e,r=0,i=0,n=0,o=0,a=t.data;if(null!==a)if(0!==S){var s=a,u=V(s,H,q,W);r=u.x,i=u.y,n=u.r;for(var l=0;l<s.length;l++)o+=A[s[l]]}else r=b[a],i=x[a],n=E[a],o=A[a];else if(t.left&&t.right){var d=t.left.cx,h=t.left.cy,c=t.right.cx,f=t.right.cy,g=t.left.r,p=t.right.r,_=c-d,v=f-h,m=p-g,y=Math.sqrt(_*_+v*v);r=(d+c+_/y*m)/2,i=(h+f+v/y*m)/2,n=(y+g+p)/2,o=t.left.mass+t.right.mass}else r=(e=t.left||t.right).cx,i=e.cy,n=e.r,o=e.mass;t.cx=r,t.cy=i,t.r=n,t.mass=o},G=function(t,e){var c=t.fx,f=t.fy,g=t.X,p=t.Y,_=t.R,v=t.masses,m=t.bucketSize,y=e.charge,b=e.theta;e.friction;return function(t){var e=0,r=0,i=0,n=Y-t.cx||U(),o=Z-t.cy||U(),a=n*n+o*o,s=K+t.r,u=t.data;if(null!==u){if(u===X)return!1;if(0!==m)for(var l=u,d=0;d<l.length;d++){var h=l[d];h!==X&&(a=(n=Y-g[h]||U())*n+(o=Z-p[h]||U())*o,s=K+_[h],a<1&&(a=Math.sqrt(+a)),e=y*v[h],r=Q*e/a,c[X]+=n*r,f[X]+=o*r)}else a<1&&(a=Math.sqrt(+a)),e=y*t.mass,r=Q*e/a,c[X]+=n*r,f[X]+=o*r}else if((i=s/b)*i<a)return a<1&&(a=Math.sqrt(+a)),e=y*t.mass,r=Q*e/a,c[X]+=n*r,f[X]+=o*r,!0}}(e,r)},b.initialize=function(t,e){for(var r=e.edgeIds,i=e.sources,n=e.targets,o=e.degrees,a=e.weights,s=0;s<t.length;s++){var u=t[s],l=u.source,d=u.target,h=u.weight;void 0===h&&(h=1),i[s]=l,n[s]=d,a[s]=h,o[l]++,o[d]++,a[r[s]=s]=void 0===h?1:h}};function $(t,e,r,i){for(var n=r.pinned,o=r.X,a=r.Y,s=r.fx,u=r.fy,l=i.gravity,d=i.cx,h=i.cy,c=0,f=0,g=e.length,p=0;p<g;p++)c+=o[p],f+=a[p];c=c/g-d,f=f/g-h;for(var _=0;_<g;_++){var v=e[_];n[v]||(o[v]-=c,a[v]-=f)}for(var m=0;m<g;m++){var y=e[m],b=d-o[y]||U(),x=h-a[y]||U(),E=l*t;s[y]+=b*E,u[y]+=x*E}}function tt(t,e){return void 0===e&&(e=1),function(t){for(var e=0,r=0,i=0,n=t;i<n.length;i+=1){var o=n[i];e+=o.w*o.h,r=Math.max(r,o.w)}t.sort(function(t,e){return e.h-t.h});for(var a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}],s=0,u=0,l=0,d=t;l<d.length;l+=1)for(var h=d[l],c=a.length-1;0<=c;c--){var f=a[c];if(!(h.w>f.w||h.h>f.h)){if(h.x=f.x,h.y=f.y,u=Math.max(u,h.y+h.h),s=Math.max(s,h.x+h.w),h.w===f.w&&h.h===f.h){var g=a.pop();c<a.length&&(a[c]=g)}else h.h===f.h?(f.x+=h.w,f.w-=h.w):(h.w===f.w||a.push({x:f.x+h.w,y:f.y,w:f.w-h.w,h:h.h}),f.y+=h.h,f.h-=h.h);break}}}(t.map(function(t){return t.w+=t.maxr+e,t.h+=t.maxr+e,t}).sort(function(t,e){return t.w*t.h-e.w*e.h}))}O.initialize=function(t,e,r){var i,v,m,y,b,n,o,w,T,C,M,I,L,N,O,a=e.X,s=e.Y,u=e.R;x=function(t){return a[t]},k=function(t){return s[t]},R=function(t){return u[t]},v=(i=e).X,m=i.Y,y=i.R,b=i.bucketSize,F=function(t){var e,r,i,n,o=t.data;if(null!==o)if(0!==b){var a=V(o,x,k,R);e=a.x,r=a.y,i=a.r}else e=v[o],r=m[o],i=y[o];else if(t.left&&t.right){var s=t.left.cx,u=t.left.cy,l=t.right.cx,d=t.right.cy,h=t.left.r,c=t.right.r,f=l-s,g=d-u,p=c-h,_=Math.sqrt(f*f+g*g);e=(s+l+f/_*p)/2,r=(u+d+g/_*p)/2,i=(_+h+c)/2}else(n=t.left||t.right)&&(e=n.cx,r=n.cy,i=n.r);t.cx=e,t.cy=r,t.r=i},o=r,w=(n=e).X,T=n.Y,C=n.R,M=n.fx,I=n.fy,L=n.bucketSize,N=o.elasticity,O=o.margin,D=function(t){var e=t.data;if(null===e){var r=t.cx-z,i=t.cy-B,n=t.r+J;return n*n<r*r+i*i}if(0!==L)for(var o=e,a=0;a<o.length;a++){var s=o[a];if(P<s){var u=C[s],l=z-w[s]-M[s],d=B-T[s]-I[s],h=J+u+O,c=l*l+d*d;if(c<h*h){0===l&&(c+=(l=U())*l),0===d&&(c+=(d=U())*d);var f=Math.sqrt(c),g=(h-f)*N/f,p=u/h;M[P]+=l*g*p,I[P]+=d*g*p,M[s]-=l*g*(1-p),I[s]-=d*g*(1-p)}}}else{var _=t.data;if(P<_){var v=C[_],m=z-w[_],y=B-T[_],b=J+v+O,x=m*m+y*y;if(x<b*b){0===m&&(x+=(m=U())*m),0===y&&(x+=(y=U())*y);var E=Math.sqrt(x),A=(b-E)*N/E,S=v/b;M[P]+=m*A*S,I[P]+=y*A*S,M[_]-=m*A*(1-S),I[_]-=y*A*(1-S)}}}}},$.initialize=function(t,e,r){var i=e.X,n=e.Y,o=r.cx,a=r.cy,s=t.length;if(void 0===o||void 0===a){o=a=0;for(var u=0;u<s;u++)o+=i[u],a+=n[u];o/=s,a/=s}r.cx=o,r.cy=a};var et=function(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0};function st(t,e){return(t+e)*(t+e+1)/2+e}function rt(t,M,I){var e=t.edgeIds,r=t.sources,i=t.targets,u=t.pinned,L=t.degrees,N=t.X,O=t.Y,k=t.R;void 0===M&&(M=0),void 0===I&&(I=.5);for(var l={},R={},n=0,o=e;n<o.length;n+=1){var a=o[n],s=r[a],d=i[a];s!==d&&(l[s]=l[s]||{},l[d]=l[d]||{},l[s][d]=!0,l[d][s]=!0)}Object.keys(l).forEach(function(t){var e,r,i=Number(t),n=Object.keys(l[Number(i)]);if(2===n.length){var o=n[0],a=n[1],s=(e=Number(o),r=Number(a),e<r?e*r+Math.pow(r-e-1,2)/4:e*r+Math.pow(e-r-1,2)/4);s in R||(R[s]=[Number(a),Number(o)]),u[i]||R[s].push(i)}}),Object.keys(R).forEach(function(t){var e=R[Number(t)],r=e[0],i=e[1],n=e.slice(2);if(1!==n.length){var o=N[r],a=O[r],s=N[i],u=O[i],l=L[r],d=.25+.5*l/(l+L[i]),h=o+(s-o)*d,c=a+(u-a)*d,f=-(u-a),g=s-o,p=Math.sqrt(Math.pow(o-s,2)+Math.pow(a-u,2));f=-2*f/p,g=-2*g/p;var _=Math.acos(f/Math.sqrt(f*f+g*g));0<M&&(_<M||_>Math.PI-M&&_<=Math.PI?(f=2*Math.cos(Math.PI-M),g=2*Math.sin(Math.PI-M)):(_>2*Math.PI-M||_>=Math.PI&&_<Math.PI+M)&&(f=2*Math.cos(M),g=2*Math.sin(M)));var v=0,m=1;n.sort(function(t,e){return k[e]-k[t]});var y=0,b=0,x=Math.max(k[n[0]],k[n[1]])/2;n.length%2==1&&(v=1,h-=f*x,c-=g*x);for(var E=1+I,A=0;A<n.length;A++){var S=(v+A)%2,w=n[A],T=2<=A?k[w]:x,C=(S?y:b)+T;N[w]=h+f*m*C,O[w]=c+g*m*C,S?y+=T*E:b+=T*E,m=-m}}})}function it(t,e,r,i){var n=r.X,o=r.Y,a=r.R,s=r.components,u=r.pinned,l=r.degrees,d=r.sources,h=r.targets,c=r.edgeIds,f=i.update,g=i.onUpdate,p=i.placement,_=i.placementOffset,v=i.alignSiblings,m=i.siblingsMinAngle,y=i.siblingsOffset;if(v&&(rt({X:n,Y:o,R:a,degrees:l,pinned:u,sources:d,targets:h,edgeIds:c},m,y),f(t,n,o)),p){var b=function(t,e,r,i){for(var n=0,o=[],a=0,s=i;a<s.length;a+=1){for(var u=s[a],l=new et,d=0,h=u;d<h.length;d+=1){var c=h[d];l.add(c,t[c],e[c],r[c])}o.push(l.measure()),u.length>o[n].ids.length&&(n=o.length-1)}return{boxes:o,biggest:n}}(n,o,a,s),x=b.boxes,E=b.biggest;if("spiral"===p)!function(t,e,r,i,n){void 0===e&&(e=20);for(var o=0,a=t;o<a.length;o+=1){var s=a[o],u=V(s.ids,function(t){return r[t]},function(t){return i[t]},function(t){return n[t]}),l=u.x,d=u.y,h=u.r;s.cx=l,s.cy=d,s.radius=h+e}for(var c=t.slice().sort(function(t,e){return t.radius-e.radius}),f=c.map(function(t){return{x:t.cx,y:t.cy,r:t.radius}}),g=c.pop(),p=3*Math.PI/2,_=g.radius,v=2*Math.PI,m=g.cx,y=g.cy,b=[g],x=function(){var i=c[c.length-1],t=_+i.radius,n=m+Math.cos(p)*t,o=y+Math.sin(p)*t;b.some(function(t){var e=t.cx-n,r=t.cy-o;return Math.sqrt(e*e+r*r)<t.radius+i.radius})?_+=1:(i.x=n-i.w/2,i.y=o-i.h/2,i.cx=n,i.cy=o,f[c.length-1].x=n,f[c.length-1].y=o,b.push(c.pop()),p+=(2*i.radius+1)/t*1%v)};0!==c.length;)x()}(x,_,n,o,a);else{if("box"!==p)return;tt(x,_)}for(var A=x[E].xmin-x[E].x,S=x[E].ymin-x[E].y,w=0,T=x;w<T.length;w+=1)for(var C=T[w],M=C.xmin,I=C.ymin,L=M-C.x-A,N=I-C.y-S,O=0,k=C.ids;O<k.length;O+=1){var R=k[O];n[R]-=L,o[R]-=N}f(t,n,o),g()}}function nt(p,_,t,e,v,r){var m,y=t.X,b=t.Y,x=t.R,E=t.degrees,A=t.nodeIds,S=t.edgeIds,i=t.layers,n=t.layer,w=t.cluster,T=t.masses,o=t.weights,a=t.sources,s=t.targets,C=e.cx,M=e.cy,I=e.nextTick,u=e.cancelTick,L=e.update,N=e.onUpdate,O=e.batch,k=e.maxIterations,l=e.steps,R=e.minMovement,F=i.slice(),D=0;function P(){u(m),L(p,y,b),N(),r(D)}for(var z={},d=0;d<_.length;d++)z[Number(_[d].id)||d]=d;for(var h=new Map,c=0;c<S.length;c++){var f=S[c];h.set(st(a[f],s[f]),f)}for(var g=0;g<i.length;g++){for(var B=i[g],U=g,V=0;V<B.length;V++){var j=B[V],G=w[j];-1!==G&&(T[G]+=T[j])}for(var H=0;H<_.length;H++){var q=_[H],W=Number(q.id)||H,X=q.source,Y=q.target,Z=o[z[W]];if(n[X]===U&&n[Y]===U){var K=w[X],Q=w[Y];if(K!==Q){var J=h.get(st(K,Q));void 0!==J&&(o[J]+=Z)}}}}A.length=0,S.length=0,k=1/0;var $,tt,et=1,rt=0,it=1-Math.pow(.1,1/l/2),nt=(et-.1)/l,ot=.5;return m=setTimeout(function t(){var e=v(et+=(rt-et)*it,A,S),r=et<=ot||e<R;if(0===D||r){var i=F.pop();if(i){$&&(tt=$.reduce(function(t,e){return Math.max(t,C-y[e],M-b[e])},0)),A.push.apply(A,i);for(var n=0;n<i.length;n++){var o=i[n],a=w[o];if(-1!==a){var s=1<E[o]?2:1,u=x[a]+x[o];T[a]-=T[o],y[o]=y[a]+s*u*(2*at()-1),b[o]=b[a]+s*u*(2*at()-1)}else $&&(y[o]=C+2*tt*(1-2*at()),b[o]=M+2*tt*(1-2*at()))}$=i;for(var l=A.reduce(function(t,e){return t[e]=!0,t},{}),d=S.length=0;d<_.length;d++){var h=_[d],c=h.source,f=h.target,g=h.id;l[c]&&l[f]&&S.push(z[Number(g)])}r=!1,et=0===F.length?.2:.1+2*nt,ot=.1}}D%O==0&&(L(p,y,b),N()),++D>=k||r?P():m=I(t)}),{done:!1,stop:function(){return P(),this},get iterations(){return D}}}function ot(t,e,r){var i=r.X,n=r.Y,o=r.fx,a=r.fy,s=r.pinned,u=r.layer,l=(r.masses,r.layers),d=r.surfaces,h=r.movements;h.fill(0);for(var c=0,f=t.length,g=1/0,p=1/0,_=-1/0,v=-1/0,m=0;m<f;m++){var y=t[m],b=o[y]*=e,x=a[y]*=e;if(s[y])o[y]=a[y]=0;else{var E=u[y],A=b,S=x,w=i[y],T=n[y];if(1e4<A||1e4<S){var C=Math.sqrt(A*A+S*S);S/=C,A/=C}i[y]+=A,n[y]+=S;var M=Math.sqrt(A*A+S*S);w<g&&(g=w),T<p&&(p=T),g<w&&(_=w),p<T&&(v=T),h[E-1]+=M,c+=E*M}}for(var I=_-g,L=v-p,N=0;N<l.length;N++){for(var O=l[N].length,k=1/0,R=1/0,F=-1/0,D=-1/0,P=0;P<O;P++){var z=i[P],B=n[P];z<k&&(k=z),B<R&&(R=B),F<z&&(F=z),D<B&&(D=B)}var U=F-k,V=D-R,j=Math.max(1,Math.sqrt(Math.pow(U,2)+Math.pow(V,2)));d[N]=j;var G=h[N]/O;h[N]=G/(I*L)}return c}et.prototype.add=function(t,e,r,i){this.ids.push(t),e-i<this.xmin&&(this.xmin=e-i),r-i<this.ymin&&(this.ymin=r-i),e+i>this.xmax&&(this.xmax=e+i),r+i>this.ymax&&(this.ymax=r+i),i>this.maxr&&(this.maxr=i),this.mx+=i*e,this.my+=i*r,this.m+=i},et.prototype.measure=function(t){return void 0===t&&(t=0),this.w=this.xmax-this.xmin+2*t,this.h=this.ymax-this.ymin+2*t,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this};var l=0,ut="undefined"==typeof window,lt="undefined"!=typeof performance&&performance.now?performance:Date,dt=ut?function(t){var e=lt.now(),r=Math.max(0,16-(e-l)),i=setTimeout(function(){return t(e+r)},r);return l=e+r,i}:window.requestAnimationFrame,ht=ut?function(t){return clearTimeout(t)}:window.cancelAnimationFrame;function ct(t,e,r){for(var i=0;i<t.length;i++){var n=t[i];n.x=e[i],n.y=r[i]}}function ft(){}function gt(t){for(var e in void 0===t&&(t={}),this.onUpdate=ft,this.update=ct,this.nextTick=dt,this.cancelTick=ht,this.onEnd=ft,this.charge=10,this.maxIterations=300,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=3,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=1,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=300,this.scaling=1,this.defaultRadius=1,this.autoStop=pt,"autoStop"in t?t.autoStop&&("boolean"==typeof t.autoStop?t.autoStop=pt:t.autoStop=Object.assign({},t.autoStop,pt)):t.steps,t)void 0!==t[e]&&(this[e]=t[e])}var pt={movementRatio:.1,surfaceRatio:.0025};function _t(value){for(var t=0,e=this.length;t<e;t++)this[t]=value;return this}var vt=Int32Array.prototype.fill||_t,mt=Uint8Array.prototype.fill||_t;function yt(t,e,r){!function(t,e,r){for(var i=r.sources,n=r.targets,o=r.degrees,a=r.nodeIds,s=r.edgeIds,u={},l=0;l<t.length;l++)u[l]=a[l]=l;for(var d=0;d<e.length;d++){var h=e[d],c=h.source,f=h.target,g=u[c],p=u[f];s[d]=d,i[d]=g,n[d]=p,o[g]++,o[p]++}}(t,e,r),function(t){for(var e=t.nodeIds,r=t.edgeIds,i=t.sources,n=t.targets,o=t.degrees,a=t.layer,s=t.layers,u=t.component,l=t.components,d=t.cluster,h=t.parent,c=0,f=1,g=new Uint32Array(e.length),p=0;p<e.length;p++)g[p]=o[p];for(var _=new Array(e.length),v=0;v<r.length;v++){var m=r[v],y=i[m],b=n[m];_[y]=_[y]||[],_[b]=_[b]||[],_[y].push(b),_[b].push(y)}var x=new Uint8Array(e.length),E=new Uint8Array(e.length);vt.call(h,-1);for(var A=0,S=0;S<e.length;S++)if(0===x[S]){for(var w=[S];0!==w.length;){var T=w.pop();0===x[T]&&(w.push.apply(w,_[T]),x[T]=1,u[T]=A)}A++}for(var C=new Array(e.length),M=0;M<e.length;M++)a[M]=0,C[M]=M;for(;0!==C.length;){for(var I=[],L=[],N=0;N<C.length;N++)g[C[N]]<=c&&(I.push(N),L.push(C[N]));for(var O=0;O<L.length;O++){var k=L[O];E[k]=c,a[k]=f;var R=_[k];if(R)for(var F=0;F<R.length;F++)g[R[F]]--}for(var D=0;D<L.length;D++){var P=L[D],z=_[P];if(z)for(var B=0;B<z.length;B++){var U=z[B],V=a[U];if(void 0===V||f<V){h[P]=U;break}}}I.reverse();for(var j=0;j<I.length;j++)C.splice(I[j],1);if(f+=1,0<C.length){for(var G=1/0,H=0;H<C.length;H++){var q=g[C[H]];q<G&&(G=q)}c+1<=G&&(c=G,f=1)}}mt.call(x,0);for(var W=0;W<e.length;W++){var X=e[W],Y=a[X];if(-1===h[X]||a[h[X]]===Y){var Z=[X];for(mt.call(x,0);0!==Z.length;){var K=Z.pop();if(!x[K]){if(a[K]>Y){h[X]=K;break}var Q=_[K];x[K]=1,Q&&Z.push.apply(Z,Q)}}}}for(var J=0;J<e.length;J++){var $=e[J],tt=u[$];l[tt]=l[tt]||[],l[tt].push($);var et=a[$]-1;s[et]=s[et]||[],s[et].push($),d[$]=h[$]}}(r)}function bt(t){this.bucketSize=0;var e=t.nodes.length,r=t.edges.length;f(e+r),this.X=new Array(e),this.Y=new Array(e),this.R=new Array(e),this.fx=new Float32Array(e),this.fy=new Float32Array(e),this.vx=new Float32Array(e),this.vy=new Float32Array(e),this.pinned=new Uint8Array(e),this.masses=new Float32Array(e),this.weights=new Float32Array(r),this.lengths=new Float32Array(r),this.sources=new Uint16Array(r),this.targets=new Uint16Array(r),this.degrees=new Uint32Array(e),this.layer=new Uint32Array(e),this.parent=new Int32Array(e),this.cluster=new Int32Array(e),this.component=new Uint16Array(e),this.components=[],this.layers=[],this.nodeIds=new Array(e),this.edgeIds=new Array(r),yt(t.nodes,t.edges,this),this.movements=new Array(this.layers.length).fill(0),this.surfaces=new Array(this.layers.length).fill(0),this.movementsPrev=new Array(this.layers.length).fill(0),this.surfacesPrev=new Array(this.layers.length).fill(0)}function xt(t){this.promise=new Promise(t)}xt.prototype.then=function(t){return this.promise.then(t)},xt.prototype.stop=function(){return this.simulation.stop(),this},xt.prototype.iterations=function(){return this.simulation.iterations()};var Et={euler:function(t,e,r){for(var i=r.X,n=r.Y,o=r.fx,a=r.fy,s=r.vx,u=r.vy,l=r.masses,d=r.pinned,h=0,c=0,f=t.length,g=0;g<f;g++){var p=t[g],_=l[p],v=o[p]/_,m=a[p]/_;s[p]+=1/8*v,u[p]+=1/8*m;var y=.2*s[p]*(1/8)+.5*v*(1/8)*(1/8),b=.2*u[p]*(1/8)+.5*m*(1/8)*(1/8);o[p]=a[p]=0,d[p]||(i[p]+=y,n[p]+=b,h+=Math.abs(y)*_,c+=Math.abs(b)*_)}return(h*h+c*c)/f},verlet:ot,leapfrog:function(t,e,r){for(var i=r.X,n=r.Y,o=r.fx,a=r.fy,s=r.vx,u=r.vy,l=r.pinned,d=r.masses,h=t.length,c=0,f=0;f<h;f++){var g=t[f],p=d[g],_=o[g]/p,v=a[g]/p,m=s[g]+_,y=u[g]+v,b=+m,x=+y;1e4<b&&(b=.1),1e4<x&&(x=.1),s[g]=e*(m+s[g])/2,u[g]=e*(y+u[g])/2,o[g]=a[g]=0,l[g]||(i[g]+=b,n[g]+=x),c+=.5*(b*b+x*x)}return c}};function force(i,t){var e,r,n=this;void 0===t&&(t={});function o(t){return void 0===t&&(t={nodes:[],edges:[]}),e=t.nodes,r=t.edges,f(st(e.length,r.length)),new bt(t)}function a(t){return void 0===t&&(t={}),new gt(t)}var s=o(i),u=a(t);b.initialize(r,s),y.initialize(e,s,u),O.initialize(e,s,u),$.initialize(e,s,u);function l(t,e,r){return c&&(c.destroy(),c=null),e.length<=1?0:(c=y(t,e,c,s),b(t,r,s,u),0!==u.elasticity&&O(0,e,c,s,u),$(t,e,s,u),h(e,u.inertia,s))}var d,h=Et[u.integrator]||ot,c=null;return{setOptions:function(t){return void 0===t&&(t={}),u=a(t),n},setGraph:function(t){var e=t.nodes,r=t.edges;return s=o(i),b.initialize(r,s),y.initialize(e,s,u),O.initialize(e,s,u),$.initialize(e,s,u),n},start:function(){return d=(u.multilevel?nt:function(l,t,e,r,d,i){function h(){O=!0,n(c),C(),i(I)}var c,f=e.X,g=e.Y,p=e.nodeIds,_=e.edgeIds,v=e.layers,m=e.movements,y=e.movementsPrev,b=e.surfaces,x=e.surfacesPrev,E=r.nextTick,n=r.cancelTick,A=r.batch,S=r.steps,w=r.minMovement,T=r.update,C=r.onUpdate,M=r.autoStop,I=0,L=1,N=1-Math.pow(.05,1/S),O=!1,k=!1,R=function(){var t=d(L+=(.001-L)*N,p,_),e=v.length,r=!1,i=!1;if(M){r=i=!0;for(var n=M.movementRatio,o=M.surfaceRatio,a=0;a<e;a++)r&&Math.abs(1-b[a]/x[a])>o&&(r=!1),i&&Math.abs(1-m[a]/y[a])>n&&(i=!1)}r&&i&&!k&&(N=1-Math.pow(.001,1/Math.max(10,I)),k=!0);var s=O||L<.05||0!==t&&t<=w;if(I%A==0&&(T(l,f,g),C()),++I>=S||s)return h();for(var u=0;u<e;u++)y[u]=m[u],x[u]=b[u];c=E(R)};return c=setTimeout(R),{done:!1,stop:function(){return h(),this},get iterations(){return I}}})(e,r,s,u,l,function(t){d.done||it(e,0,s,u),u.onEnd(t),d.done=!0}),this},iterations:function(){return d.iterations},data:function(){return s},stop:function(){return d&&d.stop(),this},step:function(t){return void 0===t&&(t=1),l(t,s.nodeIds,s.edgeIds),u.update(e,s.X,s.Y),this}}}return force.run=function(e,r){var i,t=new xt(function(t){r.onEnd=t,i=force(e,r).start()});return t.simulation=i,t.stop=function(){return i.stop(),t},t.iterations=function(){return i.iterations()},t},force}().apply(this,arguments)}var kE={imports:{force:OE},configure:function(t,e){var r=e.graph,i=t.nodes._indexes,n=r.getNodeAttribute("x").getMultiple(i),o=r.getNodeAttribute("y").getMultiple(i),a=r.getNodeAttribute("radius").getMultiple(i),s=r.getNodeAttribute("layoutable").getMultiple(i),u=t.edges,l=[],d=[],h={};void 0===t.edgeStrength&&(t.edgeStrength=.75),null==t.gravity&&(t.gravity=.05),null==t.siblingsOffset&&(t.siblingsOffset=0),null==t.theta&&(t.theta=.62),t.autoStop=!!t.autoStop,t.alignSiblings=!!t.alignSiblings;for(var c=t.radiusRatio||1.25,f=0;f<t.nodes._indexes.length;f++){var g=t.nodes._indexes[f];h[g]=f,l.push({id:f,x:n[f],y:o[f],r:a[f]*c,pinned:!s[f]})}u.forEach(function(t){var e=h[t.getSource()._index],r=h[t.getTarget()._index];e!==r&&void 0!==e&&void 0!==r&&d.push({source:e,target:r})});var p=K(I({},t));return delete p.nodes,delete p.edges,{graph:{nodes:l,edges:d},options:p,indexes:t.nodes._indexes,done:!1,x:n,y:o}},update:function(t,i){if(!i.simulation){i.graph=t.graph,i.options=t.options,i.indexes=t.indexes,t.options.nextTick=function(t){return t()},t.options.update=function(t,e,r){i.x=e,i.y=r},t.options.onEnd=function(){return i.done=!0};var e=OE(t.graph,t.options).start(),r=e.data(),n=r.X,o=r.Y;i.simulation=e,i.x=n,i.y=o}return{graph:i.graph,indexes:i.indexes,x:i.x,y:i.y}},context:function(){return{done:!1,graph:null,x:null,y:null,indexes:null}},isRunning:function(t){return!t.done},onSync:function(t){return{indexes:t.indexes,x:t.x,y:t.y}}};var RE=10;function FE(t,e,distance){for(var r,i,n=1/0,o=0,a=e.length;o<a;o++){var s=e[o],u=e[(o+1)%a],l=mu(t[0],t[1],s[0],s[1],u[0],u[1]);l<n&&(n=l,r=s,i=u)}return function(t,e,r,i,n,o,distance){var a=yu(t,e,r,i,n,o),s=-(i-o),u=r-n,l=Math.sqrt(s*s+u*u);return s/=l,u/=l,[a.x-distance*s,a.y-distance*u]}(t[0],t[1],r[0],r[1],i[0],i[1],distance)}function DE(t,e,r){var i=e.duration,n=void 0===i?0:i,o=e.margin,a=void 0===o?5:o,s=e.referenceNodes,u=e.nodes,l=s;!l||l instanceof yi||(l=t.getNodes(l));var d=l||u.inverse(),h=d.getPosition().map(function(t){return[t.x,t.y]}),c=r,f=u.getBoundingBox(),g=d.getBoundingBox();g.pad(g.maxScaledSize);var p,_,v,m,y,b,x,E,A,S=minDisk(c.map(function(t){return t.x}),c.map(function(t){return t.y}),u.getAttribute("radius").map(Number)),w=S[0],T=S[1],C=S[2]+g.maxScaledSize+a,M=0,I=0;if(function(t,e,r,i){for(var n=0;n<t.length;n++){var o=t[n],a=o[0],s=o[1],u=Math.abs(a-e),l=Math.abs(s-r);if(u+l<=i)return 1;if(!(i<u||i<l)&&u*u+l*l<=i*i)return 1}}(h,w,T,C))if(d.size<=3){if(xd(w,T,S[2],g.minX,g.minY,g.maxX,g.maxY)){var L=function(t,e,r){for(var i,n=gu(r.cx,r.cy,t,e,r.minX,r.minY,r.maxX,r.maxY),o=1/0,a={x:r.maxX,y:e},s=0,u=n;s<u.length;s++){var l=u[s];(i=distance(t,e,l.x,l.y))<o&&(o=i,a=l)}return a}(w,T,g);p=distance(g.cx,g.cy,L.x,L.y);var N=(y=g.cx,b=g.cy,x=L.x,E=L.y,{x:y+(A=(p+C)/p)*(x-y),y:b+A*(E-b)});M=N.x-w,I=N.y-T}}else{var O=new rp(h.slice()).triangulate(),convexhull=3<h.length?np(h):(v=(_=g).bottomLeft(),m=_.topRight(),[[v.x,v.y],[v.x,m.y],[m.x,m.y],[m.x,v.y]]),k=op(d.getPosition(),RE,C,O,convexhull);L=FE([w,T],convexhull,C);if(0<k.length){for(var R=Math.pow(w-L[0],2)+Math.pow(T-L[1],2),F=0,D=k;F<D.length;F++){var P=D[F];M=w-P[0],I=T-P[1],(p=M*M+I*I)<R&&(R=p,L=P.slice(0,2))}M=L[0]-w,I=L[1]-T}else M=L[0]-f.cx,I=L[1]-f.cy}var z={layoutName:"incremental",ids:u.getId(),positions:{before:c,current:c}};if(M||I){var B=c.map(function(t){return t.x+=M,t.y+=I,t});if(e.locate){"boolean"==typeof e.locate&&(e.locate={});var U=t.modules.locate.layoutDataBoundingBox({x:h.map(function(t){return t[0]}).concat(B.map(function(t){return t.x})),y:h.map(function(t){return t[1]}).concat(B.map(function(t){return t.y})),indexes:t.getNodes()._indexes}),V=t.modules.locate.computeConfigForBounds(U,e.locate);t.modules.camera.setView(V,{duration:n,easing:e.locate.easing,ignoreZoomLimits:!0})}return z.positions.current=B,u.setAttributes(B,n).then(function(){return z})}return u.setAttributes(c,n).then(function(){return z})}function PE(t,e,r){var i=Yp(e.modules.graph,t);if("boolean"!=typeof i.incremental&&"margin"in i.incremental&&!isFinite(i.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");var n,o,a,s,u=j(i);return"boolean"!=typeof i.incremental&&(u.margin=i.incremental.margin,u.referenceNodes=i.incremental.referenceNodes),u.centralNode&&!u.centralNode.getAttribute("layoutable")?function(r,t,i){var e=t.nodes,n=t.duration,o=t.centralNode,a=e,s=a.reduce(function(t,e){return t[e._index]=!0,t},{}),u=r.getNodes();if(t.focusOnGroupShape)return i({nodes:a,duration:0}).then(function(){var t=a.concat(o),e=t.getAttribute("layoutable");return t.setAttributes({layoutable:!1}),i({nodes:r.getNodes(),duration:n}).then(function(){return t.setAttributes(e)})});var l=j(t);return delete l.centralNode,l.incremental=!1,l.nodes=u,l.nodeMass=function(t,e){return(e+1)*(s[t._index]?1:2)},i(l)}(e,u,r):(n=e,a=r,(s=j(o=u)).duration=0,s.dryRun=!0,s.locate=!1,delete s.incremental,a(s).then(function(t){return DE(n,o,t.positions.current)}))}var zE={configure:function(t,e){var r,i=e.graph,n=e.camera,o=(e.graphics,t.nodes._indexes),a=t.edges._indexes,s={},u={},l=o.length,d=a.length,h=i.getObjectList(!0),c=i.getObjectList(!1);(t.nodes||t.edges)&&(delete(t=j(t)).nodes,delete t.edges);var f=i.getNodeAttribute("innerStroke.width").getMultiple(o),g=i.getNodeAttribute("outerStroke.width").getMultiple(o),p=i.degrees(o),_=i.getNodeAttribute("x").getMultiple(o),v=i.getNodeAttribute("y").getMultiple(o),m=i.getNodeAttribute("radius").getMultiple(o),y=i.nodeList(o).getAttribute("layoutable"),b="function"==typeof t.nodeMass?t.nodeMass:function(t,e,r){return e+1};delete t.nodeMass;var x="function"==typeof t.edgeWeight?t.edgeWeight:function(t){return 1};delete t.edgeWeight,isFinite(t.scalingRatio)||delete t.scalingRatio;var E=o.reduce(function(t,e,r){return y[r]||(t[e]=!0),t},{}),A=0,S=0,w=0,T=n.getZoom();for(r=0;r<o.length;++r){var C=o[r],M=_[r],I=v[r],L=m[r]+(f[r]+g[r])/T;s[C]={id:C,x:M,y:I,degree:p[r],size:L,pinned:!!E[C],mass:b(h.get(C),p[r],r)},w=Math.max(L,w)}if(1<l)for(r=0;r<l;r++){var N=s[o[r]];A+=N.x,S+=N.y}var O={x:A/=l,y:S/=l},k=i.edgeList(a),R=k.getSource()._indexes,F=k.getTarget()._indexes;for(r=0;r<d;r++){var D=a[r],P=R[r],z=F[r];s[P]&&s[z]&&(u[D]={source:P,target:z},u[D].weight=x(c.get(D)))}return{nodes:s,edges:u,maxSize:w,config:K(t),barycentre:O}},context:function(){return{}},update:function(t,e){var Z,r,i,n;e.W?Z=e.W:(Z={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},e.W=Z,i=(r=t).config,n=function(t,e){var r,i,n,o,a=t.nodes,s=t.edges,u=t.maxSize,l=Object.keys(t.nodes),d=Object.keys(t.edges),h=l.length*Z.ppn,c=d.length*Z.ppe,f={},g=Math.pow(10,Math.log(Math.max(u,1))-6),p=g/2,_=Math.random,v=e.randomizeFactor||1;o="locally"===e.randomize?function(t){return t+_()*v}:"globally"===e.randomize?function(t){return _()*v}:function(t){return t+_()*g-p};var m=new Float32Array(h),y=new Float32Array(c);for(r=i=0,n=l.length;r<n;r++){var b=l[r],x=a[b],E=x.x,A=x.y;x.pinned||(E=o(E),A=o(A)),f[b]=i,m[i]=E,m[i+1]=A,m[i+2]=0,m[i+3]=0,m[i+4]=0,m[i+5]=0,m[i+6]=x.mass,m[i+7]=1,m[i+8]=x.size,m[i+9]=x.pinned||0,i+=Z.ppn}for(r=i=0,n=d.length;r<n;r++){b=d[r];var S=s[b];y[i]=f[S.source],y[i+1]=f[S.target],y[i+2]=S.weight||0,i+=Z.ppe}return{nodes:m,edges:y}}(r,i),e.NodeMatrix=n.nodes,e.EdgeMatrix=n.edges,Z.nodesLength=e.NodeMatrix.length,Z.edgesLength=e.EdgeMatrix.length,Z.settings=function(t,e){for(var r in t)e[r]=t[r];return e}(t.config,Z.settings),e.nodes=t.nodes,e.edges=t.edges,e.barycentre=t.barycentre);var K,Q=e.NodeMatrix,J=e.EdgeMatrix;function o(){var t,e,r,i,n,o,a,s,u,l,d,h,c,f,g,distance,p;for(r=0;r<Z.nodesLength;r+=Z.ppn)Q[r+4]=Q[r+2],Q[r+5]=Q[r+3],Q[r+2]=0,Q[r+3]=0;if(Z.settings.outboundAttractionDistribution){for(r=u=0;r<Z.nodesLength;r+=Z.ppn)u+=Q[r+6];u/=Z.nodesLength}if(Z.settings.barnesHutOptimize){var _=1/0,v=-1/0,m=1/0,y=-1/0,b=void 0,x=void 0,E=void 0,A=void 0;for(K=[],r=0;r<Z.nodesLength;r+=Z.ppn)_=Math.min(_,Q[r+0]),v=Math.max(v,Q[r+0]),m=Math.min(m,Q[r+1]),y=Math.max(y,Q[r+1]);var S=v-_,w=y-m;for(w<S?y=(m-=(S-w)/2)+S:v=(_-=(w-S)/2)+w,K[0]=-1,K[1]=(_+v)/2,K[2]=(m+y)/2,K[3]=Math.max(v-_,y-m),K[4]=-1,K[5]=-1,K[6]=0,K[7]=0,t=1,r=K[8]=0;r<Z.nodesLength;r+=Z.ppn)for(e=0,E=Z.MAX_SUBDIVISION_RETRIES;;){if(!(0<=K[e+5])){if(K[e+0]<0){K[e+0]=r;break}if(K[e+5]=t*Z.ppr,a=K[e+3]/2,s=K[e+5],K[s+0]=-1,K[s+1]=K[e+1]-a,K[s+2]=K[e+2]-a,K[s+3]=a,K[s+4]=s+Z.ppr,K[s+5]=-1,K[s+6]=0,K[s+7]=0,K[s+8]=0,s+=Z.ppr,K[s+0]=-1,K[s+1]=K[e+1]-a,K[s+2]=K[e+2]+a,K[s+3]=a,K[s+4]=s+Z.ppr,K[s+5]=-1,K[s+6]=0,K[s+7]=0,K[s+8]=0,s+=Z.ppr,K[s+0]=-1,K[s+1]=K[e+1]+a,K[s+2]=K[e+2]-a,K[s+3]=a,K[s+4]=s+Z.ppr,K[s+5]=-1,K[s+6]=0,K[s+7]=0,K[s+8]=0,s+=Z.ppr,K[s+0]=-1,K[s+1]=K[e+1]+a,K[s+2]=K[e+2]+a,K[s+3]=a,K[s+4]=K[e+4],K[s+5]=-1,K[s+6]=0,K[s+7]=0,K[s+8]=0,t+=4,b=Q[K[A=e+0]+0]<K[e+1]?Q[K[A]+1]<K[e+2]?K[e+5]:K[e+5]+Z.ppr:Q[K[A]+1]<K[e+2]?K[e+5]+2*Z.ppr:K[e+5]+3*Z.ppr,K[e+6]=Q[K[A]+6],K[e+7]=Q[K[A]+0],K[e+8]=Q[K[A]+1],K[b+0]=K[e+0],K[e+0]=-1,b===(x=Q[r+0]<K[e+1]?Q[r+1]<K[e+2]?K[e+5]:K[e+5]+Z.ppr:Q[r+1]<K[e+2]?K[e+5]+2*Z.ppr:K[e+5]+3*Z.ppr)){if(E--){e=b;continue}E=Z.MAX_SUBDIVISION_RETRIES;break}K[x+0]=r;break}b=Q[r+0]<K[e+1]?Q[r+1]<K[e+2]?K[e+5]:K[e+5]+Z.ppr:Q[r+1]<K[e+2]?K[e+5]+2*Z.ppr:K[e+5]+3*Z.ppr,K[e+7]=(K[e+7]*K[e+6]+Q[r+0]*Q[r+6])/(K[e+6]+Q[r+6]),K[e+8]=(K[e+8]*K[e+6]+Q[r+1]*Q[r+6])/(K[e+6]+Q[r+6]),K[e+6]+=Q[r+6],e=b}}if(Z.settings.barnesHutOptimize)for(l=Z.settings.scalingRatio,r=0;r<Z.nodesLength;r+=Z.ppn)for(e=0;;)if(0<=K[e+5]){if(distance=Math.sqrt((Q[r+0]-K[e+7])*(Q[r+0]-K[e+7])+(Q[r+1]-K[e+8])*(Q[r+1]-K[e+8])),2*K[e+3]/distance<Z.settings.barnesHutTheta){if(d=Q[r+0]-K[e+7],h=Q[r+1]-K[e+8],Z.settings.adjustSizes?0<distance?(p=l*Q[r+6]*K[e+6]/distance/distance,Q[r+2]+=d*p,Q[r+3]+=h*p):distance<0&&(p=-l*Q[r+6]*K[e+6]/distance,Q[r+2]+=d*p,Q[r+3]+=h*p):0<distance&&(p=l*Q[r+6]*K[e+6]/distance/distance,Q[r+2]+=d*p,Q[r+3]+=h*p),K[e+4]<0)break;e=K[e+4];continue}e=K[e+5]}else{if(0<=K[e+0]&&K[e+0]!==r&&(d=Q[r+0]-Q[K[e+0]+0],h=Q[r+1]-Q[K[e+0]+1],distance=Math.sqrt(d*d+h*h),Z.settings.adjustSizes?0<distance?(p=l*Q[r+6]*Q[K[e+0]+6]/distance/distance,Q[r+2]+=d*p,Q[r+3]+=h*p):distance<0&&(p=-l*Q[r+6]*Q[K[e+0]+6]/distance,Q[r+2]+=d*p,Q[r+3]+=h*p):0<distance&&(p=l*Q[r+6]*Q[K[e+0]+6]/distance/distance,Q[r+2]+=d*p,Q[r+3]+=h*p)),K[e+4]<0)break;e=K[e+4]}else for(l=Z.settings.scalingRatio,i=0;i<Z.nodesLength;i+=Z.ppn)for(n=0;n<i;n+=Z.ppn)d=Q[i+0]-Q[n+0],h=Q[i+1]-Q[n+1],Z.settings.adjustSizes?0<(distance=Math.sqrt(d*d+h*h)-Q[i+8]-Q[n+8])?(p=l*Q[i+6]*Q[n+6]/distance/distance,Q[i+2]+=d*p,Q[i+3]+=h*p,Q[n+2]+=d*p,Q[n+3]+=h*p):distance<0&&(p=100*l*Q[i+6]*Q[n+6],Q[i+2]+=d*p,Q[i+3]+=h*p,Q[n+2]-=d*p,Q[n+3]-=h*p):0<(distance=Math.sqrt(d*d+h*h))&&(p=l*Q[i+6]*Q[n+6]/distance/distance,Q[i+2]+=d*p,Q[i+3]+=h*p,Q[n+2]-=d*p,Q[n+3]-=h*p);for(s=Z.settings.gravity/Z.settings.scalingRatio,l=Z.settings.scalingRatio,r=0;r<Z.nodesLength;r+=Z.ppn)d=Q[r+(p=0)],h=Q[r+1],distance=Math.sqrt(d*d+h*h),Z.settings.strongGravityMode?0<distance&&(p=l*Q[r+6]*s):0<distance&&(p=l*Q[r+6]*s/distance),Q[r+2]-=d*p,Q[r+3]-=h*p;for(l=+(Z.settings.outboundAttractionDistribution?u:1),o=0;o<Z.edgesLength;o+=Z.ppe)i=J[o+0],n=J[o+1],a=J[o+2],g=Math.pow(a,Z.settings.edgeWeightInfluence),d=Q[i+0]-Q[n+0],h=Q[i+1]-Q[n+1],Z.settings.adjustSizes?(distance=Math.sqrt(d*d+h*h)-Q[i+8]-Q[n+8],Z.settings.linLogMode?Z.settings.outboundAttractionDistribution?0<distance&&(p=-l*g*Math.log(1+distance)/distance/Q[i+6]):0<distance&&(p=-l*g*Math.log(1+distance)/distance):Z.settings.outboundAttractionDistribution?0<distance&&(p=-l*g/Q[i+6]):0<distance&&(p=-l*g)):(distance=Math.sqrt(d*d+h*h),Z.settings.linLogMode?Z.settings.outboundAttractionDistribution?0<distance&&(p=-l*g*Math.log(1+distance)/distance/Q[i+6]):0<distance&&(p=-l*g*Math.log(1+distance)/distance):p=Z.settings.outboundAttractionDistribution?(distance=1,-l*g/Q[i+6]):(distance=1,-l*g)),0<distance&&(Q[i+2]+=d*p,Q[i+3]+=h*p,Q[n+2]-=d*p,Q[n+3]-=h*p);var force,T,C,M,I=0;if(Z.settings.adjustSizes)for(r=0;r<Z.nodesLength;r+=Z.ppn)Q[r+9]||((force=Math.sqrt(Q[r+2]*Q[r+2]+Q[r+3]*Q[r+3]))>Z.maxForce&&(Q[r+2]=Q[r+2]*Z.maxForce/force,Q[r+3]=Q[r+3]*Z.maxForce/force),T=Q[r+6]*Math.sqrt((Q[r+4]-Q[r+2])*(Q[r+4]-Q[r+2])+(Q[r+5]-Q[r+3])*(Q[r+5]-Q[r+3])),C=Math.sqrt((Q[r+4]+Q[r+2])*(Q[r+4]+Q[r+2])+(Q[r+5]+Q[r+3])*(Q[r+5]+Q[r+3]))/2,M=.1*Math.log(1+C)/(1+Math.sqrt(T)),c=Q[r+0],f=Q[r+1],Q[r+0]=Q[r+0]+Q[r+2]*(M/Z.settings.slowDown),Q[r+1]=Q[r+1]+Q[r+3]*(M/Z.settings.slowDown),d=Q[r+0],h=Q[r+1],I+=distance=Math.sqrt((d-c)*(d-c)+(h-f)*(h-f)));else for(r=0;r<Z.nodesLength;r+=Z.ppn)Q[r+9]||(T=Q[r+6]*Math.sqrt((Q[r+4]-Q[r+2])*(Q[r+4]-Q[r+2])+(Q[r+5]-Q[r+3])*(Q[r+5]-Q[r+3])),C=Math.sqrt((Q[r+4]+Q[r+2])*(Q[r+4]+Q[r+2])+(Q[r+5]+Q[r+3])*(Q[r+5]+Q[r+3]))/2,M=Q[r+7]*Math.log(1+C)/(1+Math.sqrt(T)),Q[r+7]=Math.min(1,Math.sqrt(M*(Q[r+2]*Q[r+2]+Q[r+3]*Q[r+3])/(1+Math.sqrt(T)))),c=Q[r+0],f=Q[r+1],Q[r+0]=Q[r+0]+Q[r+2]*(M/Z.settings.slowDown),Q[r+1]=Q[r+1]+Q[r+3]*(M/Z.settings.slowDown),d=Q[r+0],h=Q[r+1],I+=distance=Math.sqrt((d-c)*(d-c)+(h-f)*(h-f)));if(Z.iterations++,Z.settings.autoStop&&(Z.converged=Z.iterations>Z.settings.maxIterations||I/Z.nodesLength<Z.settings.avgDistanceThreshold,Z.converged&&Z.settings.alignNodeSiblings)){var L,N,O={},k={};for(o=0;o<Z.edgesLength;o+=Z.ppe)(i=J[o+0])!==(n=J[o+1])&&(O[i]=O[i]||{},O[n]=O[n]||{},O[i][n]=!0,O[n][i]=!0);Object.keys(O).forEach(function(t){var e=~~t;2==(N=Object.keys(O[e])).length&&((L=N[0]+";"+N[1])in k||(L=N[1]+";"+N[0],k[L]||(k[L]=[~~N[1],~~N[0]])),k[L].push(e))});var R,F,D,P,z,B,U,V,j,G,H,q,W,X,Y=Z.settings.nodeSiblingsAngleMin;Object.keys(k).forEach(function(t){if(F=k[t].shift(),D=k[t].shift(),1!=(R=k[t].filter(function(t){return!Q[t+9]})).length){var e,r,i,n,o,a,s,u,l,d,h,c,f,g;if(B=Q[F+0],U=Q[F+1],V=Q[D+0],j=Q[D+1],P=Object.keys(O[F]).length,z=Object.keys(O[D]).length,H={x:(i=B)+(V-i)*(o=(.75-(r=.25))*(P/(P+z)-(e=0))/(1-e)+r),y:(n=U)+(j-n)*o},q={xi:-((l=j)-(s=U)),yi:(u=V)-(a=B),xiPrime:l-s,yiPrime:-(u-a)},d=V-B,h=j-U,G=Math.sqrt(d*d+h*h),f=G,W={x:((c=q).xiPrime-c.xi)/f,y:(c.yiPrime-c.yi)/f},g=W,X=Math.acos(g.x/Math.sqrt(g.x*g.x+g.y*g.y)),2*Y>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");0<Y&&(X<Y||X>Math.PI-Y&&X<=Math.PI?W={x:2*Math.cos(Math.PI-Y),y:2*Math.sin(Math.PI-Y)}:(X>2*Math.PI-Y||X>=Math.PI&&X<Math.PI+Y)&&(W={x:2*Math.cos(Y),y:2*Math.sin(Y)}));var p=0,_=1,v=1;R.length%2==1&&(v=0,p=1);for(var m=0;m<R.length;m++)Q[R[m]+0]=H.x+_*W.x*v*(p||2<=m?Z.settings.nodeSiblingsScale:2*Z.settings.nodeSiblingsScale/3),Q[R[m]+1]=H.y+_*W.y*v*(p||2<=m?Z.settings.nodeSiblingsScale:2*Z.settings.nodeSiblingsScale/3),_=-_,v+=(m+p)%2}})}}return function(){if(Z.settings.autoStop)for(;!Z.converged;)o();else for(var t=0===Z.iterations?Z.settings.startingIterations:Z.iterations+Z.settings.iterationsPerRender;Z.iterations!==t;)o();return{nodes:function(t){for(var e=Object.keys(t),r={},i=0;i<Q.length;i+=Z.ppn){var n=e[i/Z.ppn];r[n]={id:n,x:Q[i+0],y:Q[i+1],pinned:Q[i+9]}}return r}(e.nodes),barycentre:e.barycentre}}()},isRunning:function(t){return!t.W.settings.autoStop},onSync:function(t,e){var r,i,n,o,a,s,u,l,d=t.nodes,h=t.barycentre,c=e.graph,f=Object.keys(d),g=f.length,p=0,_=0,v=new Array(g),m=new Array(g),y=new Array(g),b=new Array(g),x=c.getAttributes(!0,["x","y"]),E=x[0],A=x[1];for(r=0;r<g;r++)n=d[i=f[r]],l=parseInt(i),v[r]=l,b[r]=n.pinned,a=n.pinned?(o=E.get(l),A.get(l)):(o=n.x,n.y),p+=m[r]=o,_+=y[r]=a;for(s=p/g-h.x,u=_/g-h.y,r=0;r<g;r++)b[r]||(m[r]-=s,y[r]-=u);return{indexes:v,x:m,y:y}}},BE=function(t){return t.reduce(function(t,e){return t[e]=!0,t},{})};function UE(t,e){for(var r=[t],i=BE(r),n=[t];r.length;)for(var o=0,a=e[r.shift()];o<a.length;o+=1){var s=a[o];i[s]||(i[s]=!0,n.push(s),r.push(s))}return n}function VE(t){return t.reduce(function(t,e){return t[e.source]=t[e.source]||[],t[e.target]=t[e.target]||[],t[e.source].push(""+e.target),t[e.target].push(""+e.source),t},{})}function jE(n,t){var o=Math.max(Math.min(t||10,100),1)/1e3;return function(t,e){var r=Math.abs(t.layer-e.layer),i=[e,t].reduce(function(t,e){return t+(ZE(e)?1:o)},0);return r?2*r*n:i*n}}function GE(t){return t.reduce(function(t,e){return t+function(t,e){for(var r=[],i=arguments.length-2;0<i--;)r[i]=arguments[i+2];for(var n=e,o=0,a=r;o<a.length;o+=1){var s=a[o];if(!n[s])return t;n=n[s]}return n}(ZE(e)?.5:0,e,"data","radius")},0)/t.length}function HE(t,e,r){var i=r||VE(e||[]);return t.filter(function(t){return!(t.id in i)})}function qE(t,e){var r=BE(e);return t.filter(function(t){return!(t in r)})}function WE(t,n){t.forEach(function(t,i){t.forEach(function(t,e,r){n(t,e,r,i)})})}function XE(e){return Object.keys(e).map(function(t){return e[t]})}function YE(r,i){return Object.keys(r).reduce(function(t,e){return t[e]=i(r[e],e,r),t},{})}function ZE(t){return!!t.data}function KE(t,e){return{id:t,data:e,children:[]}}function QE(t,e,l){var d=e.reduce(function(t,e){return t[e.source]=t[e.source]||[],t[e.source].push(e),t},{});var i=t.reduce(function t(e,r){var i=e.visited,n=e.stack,o=e.result;if(i[r.id])return e;i[r.id]=n[r.id]=1;for(var a=0,s=d[r.id]||[];a<s.length;a+=1){var u=s[a];n[u.target]?o.push(u):t(e,l[u.target])}return delete n[r.id],e},{visited:{},stack:{},result:[]}).result.reduce(function(t,e){var r=e.source,i=e.target;return t[r]=t[r]||{},t[r][i]=1,t},{});return e.map(function(t){var e=t.source,r=t.target;return i[e]&&i[e][r]?{source:r,target:e}:t})}function JE(t,e){e.forEach(function(t){return t._median=[]}),t.forEach(function(e,r){e.children.filter(function(t){return t.layer>e.layer}).forEach(function(t){t._median.push(r)})}),e.forEach(function(t,e){t.children.forEach(function(){return t._median.push(e)})}),e.forEach(function(t){return t._median=function(t){if(t.sort(function(t,e){return t-e}),0===t.length)return 0;var e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2}(t._median)||0}),e.sort(function(t,e){return t._median-e._median}),e.forEach(function(t){return delete t._median})}var $E="up",tA="down",eA="left",rA="right",iA=Number.POSITIVE_INFINITY;function nA(t){for(var e=0,r=[$E,tA];e<r.length;e+=1){t(r[e])}}function oA(t){for(var e=0,r=[eA,rA];e<r.length;e+=1){t(r[e])}}function aA(){return function(t,s){var n,r,e,d,h,i,o=(n={},WE(t,function(t){n[t.id]||(n[t.id]={successors:[],ancestors:[]});for(var e=0,r=t.children;e<r.length;e+=1){var i=r[e];n[i.id]||(n[i.id]={successors:[],ancestors:[]}),i.layer>t.layer&&(n[t.id].successors.push(i),n[i.id].ancestors.push(t)),i.layer<t.layer&&(n[t.id].ancestors.push(i),n[i.id].successors.push(t))}}),{getSuccessors:function(t){return n[t.id].successors},getAncestors:function(t){return n[t.id].ancestors}}),u=o.getSuccessors,g=o.getAncestors,a=(r={},WE(t,function(t,e){r[t.id]=e}),r),p=(d=u,h=function(t){var e=t.id;return a[e]},i=(e=t).length,e.reduce(function(t,o,e){var r=t.prevLayer,a=t.conflicts;if(!e||i-2<e)return{prevLayer:r,conflicts:a};var s=0,u=o.length,l=o[u-1];return o.forEach(function(t,e){var r=function(t){if(ZE(t))return d(t).find(ZE)}(t),i=r?h(r):u-1;if(r||t===l)for(var n=function(){var r=o[s];d(r).forEach(function(t){var e=h(t);(e<0||i<e)&&(a[r.id]=a[r.id]||{},a[r.id][t.id]=!0)}),s++};s<=e;)n()}),{prevLayer:o,conflicts:a}},{prevLayer:e[0],conflicts:{}}).conflicts),_={};nA(function(o){var a=o===$E?t:[].concat(t).reverse();oA(function(t){t===rA&&(a=a.map(function(t){return[].concat(t).reverse()}));var e,l,d,h,c,f,r=s,i=(l=p,d=o===$E?g:u,h={},c={},f={},WE(e=a,function(t,e){h[t.id]=t.id,c[t.id]=t.id,f[t.id]=e}),e.forEach(function(t){var u=-1;t.forEach(function(t){var e,r,i=d(t).sort(function(t,e){return f[t.id]-f[e.id]});if(i.length)for(var n=(i.length-1)/2,o=0,a=[Math.floor(n),Math.ceil(n)];o<a.length;o+=1){var s=i[a[o]];c[t.id]===t.id&&(r=s,!(l[(e=t).id]&&l[e.id][r.id]||l[r.id]&&l[r.id][e.id])&&u<f[s.id]&&(c[s.id]=t.id,h[t.id]=h[s.id],c[t.id]=h[t.id],u=f[s.id]))}})}),{roots:h,aligns:c}),n=function(t,a,s,u){var l={},d={},i={},h={},c={},f={},g={};WE(t,function(t,e,r){l[t.id]=t,d[t.id]=iA,i[t.id]=e,c[t.id]=r[e-1]||t,f[t.id]=t,g[t.id]=0});var p=3500,_=p/10;return t.forEach(function(t){t.filter(function(t){return a[t.id]===t.id}).forEach(function(t){return function t(e,r){void 0===r&&(r=0);if(null==h[e.id]){h[e.id]=0;for(var i=e,n=!1;!n;){if(null!=c[i.id]){var o=f[a[c[i.id].id]];if(g[o.id]>_||p<r)return;t(o,r+1),g[o.id]++,l[e.id]===e&&(l[e.id]=l[o.id]),l[e.id]!==l[o.id]?d[l[o.id].id]=Math.min(d[l[o.id].id],h[e.id]-h[o.id]-u(e,c[e.id])):h[e.id]=Math.max(h[e.id],h[o.id]+u(e,c[e.id]))}i=f[s[i.id]],n=i===e}}}(t)})}),WE(t,function(t){h[t.id]=h[a[t.id]];var e=d[l[a[t.id]].id];t.id===a[t.id]&&isFinite(e)&&(h[t.id]+=e)}),h}(a,i.roots,i.aligns,r);t===rA&&(n=YE(n,function(t){return-t})),_[o+t]=n})});var l,c,f,v,m,y,b,x=(l=_,c=Object.keys(l).reduce(function(t,e){var r=t.alignment,value=t.value,i=XE(l[e]),n=Math.max.apply(Math,i)-Math.min.apply(Math,i);return value<=n?{alignment:r,value:value}:{alignment:e,value:n}},{alignment:null,value:iA}).alignment,l[c]);f=_,m=XE(v=x),y=Math.min.apply(Math,m),b=Math.max.apply(Math,m),nA(function(o){oA(function(t){var e=o+t,r=f[e];if(r!==v){var i=XE(r),n=t===eA?y-Math.min.apply(Math,i):b-Math.max.apply(Math,i);n&&(f[e]=YE(r,function(t){return t+n}))}})});var E,A=YE((E=_)[$E+eA],function(t,i){var n=[];return nA(function(r){oA(function(t){var e=r+t;n.push(E[e][i])})}),n.sort(function(t,e){return t-e}),(n[1]+n[2])/2});return WE(t,function(t){t.x=A[t.id]}),t}}function sA(){return function(t,i){var n=-iA;return t.forEach(function(t){var e=t.filter(ZE);if(1===e.length){e[0].x=.5}else{e.reduce(function(t,e){return e.x=void 0===t?0:t.x+i(t,e),e},void 0);var r=e[e.length-1].x;n=Math.max(n,r),e.forEach(function(t){return t.x/=r})}}),n=Math.max(n,1),WE(t,function(t){return t.x*=n}),t}}function uA(t,e,r,i){this.feasible=r,this.evaluation=e,this.bounded=i,this._tableau=t}var lA=uA;function dA(t,e,r,i,n){lA.call(this,t,e,r,i),this.iter=n}uA.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,r=e.varIndexByRow,i=e.variablesPerIndex,n=e.matrix,o=e.rhsColumn,a=e.height-1,s=Math.round(1/e.precision),u=1;u<=a;u+=1){var l=i[r[u]];if(void 0!==l&&!0!==l.isSlack){var d=n[u][o];t[l.id]=Math.round(d*s)/s}}return t};var hA=dA;function cA(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}dA.prototype=Object.create(lA.prototype),dA.constructor=dA;var fA=cA;function gA(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var r=0;r<e;r+=1)this.reducedCosts[r]=0}cA.prototype.solve=function(){return 0<this.model.getNumberOfIntegerVariables()?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},gA.prototype.copy=function(){var t=new gA(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t},cA.prototype.setOptionalObjective=function(t,e,r){var i=this.objectivesByPriority[t];void 0===i&&(i=new gA(t,Math.max(this.width,e+1)),this.objectivesByPriority[t]=i,this.optionalObjectives.push(i),this.optionalObjectives.sort(function(t,e){return t.priority-e.priority}));i.reducedCosts[e]=r},cA.prototype.initialize=function(t,e,r,i){this.variables=r,this.unrestrictedVars=i,this.width=t,this.height=e;for(var n=new Array(t),o=0;o<t;o++)n[o]=0;this.matrix=new Array(e);for(var a=0;a<e;a++)this.matrix[a]=n.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},cA.prototype._resetMatrix=function(){var t,e,r=this.model.variables,i=this.model.constraints,n=r.length,o=i.length,a=this.matrix[0],s=!0===this.model.isMinimization?-1:1;for(t=0;t<n;t+=1){var u=r[t],l=u.priority,d=s*u.cost;0===l?a[t+1]=d:this.setOptionalObjective(l,t+1,d),e=r[t].index,this.rowByVarIndex[e]=-1,this.colByVarIndex[e]=t+1,this.varIndexByCol[t+1]=e}for(var h=1,c=0;c<o;c+=1){var f,g,p=i[c],_=p.index;this.rowByVarIndex[_]=h,this.colByVarIndex[_]=-1,this.varIndexByRow[h]=_;var v=p.terms,m=v.length,y=this.matrix[h++];if(p.isUpperBound){for(f=0;f<m;f+=1)g=v[f],y[this.colByVarIndex[g.variable.index]]=g.coefficient;y[0]=p.rhs}else{for(f=0;f<m;f+=1)g=v[f],y[this.colByVarIndex[g.variable.index]]=-g.coefficient;y[0]=-p.rhs}}},cA.prototype.setModel=function(t){var e=(this.model=t).nVariables+1,r=t.nConstraints+1;return this.initialize(e,r,t.variables,t.unrestrictedVariables),this._resetMatrix(),this},cA.prototype.getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},cA.prototype.density=function(){for(var t=0,e=this.matrix,r=0;r<this.height;r++)for(var i=e[r],n=0;n<this.width;n++)0!==i[n]&&(t+=1);return t/(this.height*this.width)},cA.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=this.matrix[this.costRowIndex][this.rhsColumn];this.evaluation=Math.round(e*t)/t},cA.prototype.getSolution=function(){var t=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return 0<this.model.getNumberOfIntegerVariables()?new hA(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new lA(this,t,this.feasible,this.bounded)},fA.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},fA.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],r=this.matrix,i=this.rhsColumn,n=this.width-1,o=this.height-1,a=0;;){for(var s=0,u=-this.precision,l=1;l<=o;l++)if(!(!0===this.unrestrictedVars[this.varIndexByRow[l]])){var value=r[l][i];value<u&&(u=value,s=l)}if(0===s)return this.feasible=!0,a;for(var d=0,h=-1/0,c=r[0],f=r[s],g=1;g<=n;g++){var p=f[g];if(!(-this.precision<p&&p<this.precision)&&(!0===this.unrestrictedVars[this.varIndexByCol[g]]||p<-this.precision)){var _=-c[g]/p;h<_&&(h=_,d=g)}}if(0===d)return this.feasible=!1,a;if(t){e.push([this.varIndexByRow[s],this.varIndexByCol[d]]);var v=this.checkForCycles(e);if(0<v.length)throw console.log("Cycle in phase 1"),console.log("Start :",v[0]),console.log("Length :",v[1]),new Error}this.pivot(s,d),a+=1}},fA.prototype.phase2=function(){for(var t,e,r=this.model.checkForCycles,i=[],n=this.matrix,o=this.rhsColumn,a=this.width-1,s=this.height-1,u=this.precision,l=this.optionalObjectives.length,d=null,h=0;;){var c=n[this.costRowIndex];0<l&&(d=[]);for(var f=0,g=u,p=!1,_=1;_<=a;_++)t=c[_],e=!0===this.unrestrictedVars[this.varIndexByCol[_]],0<l&&-u<t&&t<u?d.push(_):e&&t<0?g<-t&&(g=-t,f=_,p=!0):g<t&&(g=t,f=_,p=!1);if(0<l)for(var v=0;0===f&&0<d.length&&v<l;){var m=[],y=this.optionalObjectives[v].reducedCosts;g=u;for(var b=0;b<d.length;b++)t=y[_=d[b]],e=!0===this.unrestrictedVars[this.varIndexByCol[_]],-u<t&&t<u?m.push(_):e&&t<0?g<-t&&(g=-t,f=_,p=!0):g<t&&(g=t,f=_,p=!1);d=m,v+=1}if(0===f)return this.setEvaluation(),h;for(var x=0,E=1/0,A=(this.varIndexByRow,1);A<=s;A++){var S=n[A],w=S[o],T=S[f];if(!(-u<T&&T<u)){if(0<T&&w<u&&-u<w){E=0,x=A;break}var C=p?-w/T:w/T;u<C&&C<E&&(E=C,x=A)}}if(E===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[f],h;if(r){i.push([this.varIndexByRow[x],this.varIndexByCol[f]]);var M=this.checkForCycles(i);if(0<M.length)throw console.log("Cycle in phase 2"),console.log("Start :",M[0]),console.log("Length :",M[1]),new Error}this.pivot(x,f,!0),h+=1}};var pA=[];function _A(t,e,r,i){this.id=t,this.cost=e,this.index=r,this.value=0,this.priority=i}function vA(t,e,r,i){_A.call(this,t,e,r,i)}function mA(t,e){_A.call(this,t,0,e,0)}function yA(t,e){this.variable=t,this.coefficient=e}function bA(t,e,r){return 0===r||"required"===r?null:(e=e||1,r=r||1,!1===t.isMinimization&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,r))}function xA(t,e,r,i){this.slack=new mA("s"+r,r),this.index=r,this.model=i,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function EA(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}fA.prototype.pivot=function(t,e){var r=this.matrix,i=r[t][e],n=this.height-1,o=this.width-1,a=this.varIndexByRow[t],s=this.varIndexByCol[e];this.varIndexByRow[t]=s,this.varIndexByCol[e]=a,this.rowByVarIndex[s]=t,this.rowByVarIndex[a]=-1,this.colByVarIndex[s]=-1,this.colByVarIndex[a]=e;for(var u,l,d,h=r[t],c=0,f=0;f<=o;f++)0!==h[f]&&(h[f]/=i,pA[c]=f,c+=1);h[e]=1/i;this.precision;for(var g=0;g<=n;g++){var p=r[g];if(g!==t&&0!==(u=p[e])){for(l=0;l<c;l++)0!==(d=h[f=pA[l]])&&(p[f]=p[f]-u*d);p[e]=-u/i}}var _=this.optionalObjectives.length;if(0<_)for(var v=0;v<_;v+=1){var m=this.optionalObjectives[v].reducedCosts;if(0!==(u=m[e])){for(l=0;l<c;l++)0!==(d=h[f=pA[l]])&&(m[f]=m[f]-u*d);m[e]=-u/i}}},fA.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var r=e+1;r<t.length;r++){var i=t[e],n=t[r];if(i[0]===n[0]&&i[1]===n[1]){if(r-e>t.length-r)break;for(var o=!0,a=1;a<r-e;a++){var s=t[e+a],u=t[r+a];if(s[0]!==u[0]||s[1]!==u[1]){o=!1;break}}if(o)return[e,r-e]}}return[]},mA.prototype.isSlack=vA.prototype.isInteger=!0,xA.prototype.addTerm=function(t,e){var r=e.index,i=this.termsByVarIndex[r];if(void 0===i)i=new yA(e,t),this.termsByVarIndex[r]=i,this.terms.push(i),!0===this.isUpperBound&&(t=-t),this.model.updateConstraintCoefficient(this,e,t);else{var n=i.coefficient+t;this.setVariableCoefficient(n,e)}return this},xA.prototype.removeTerm=function(t){return this},xA.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;!0===this.isUpperBound&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this},xA.prototype.setVariableCoefficient=function(t,e){var r=e.index;if(-1!==r){var i=this.termsByVarIndex[r];if(void 0===i)this.addTerm(t,e);else if(t!==i.coefficient){var n=t-i.coefficient;!0===this.isUpperBound&&(n=-n),i.coefficient=t,this.model.updateConstraintCoefficient(this,e,n)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},xA.prototype.relax=function(t,e){this.relaxation=bA(this.model,t,e),this._relax(this.relaxation)},xA.prototype._relax=function(t){null!==t&&(this.isUpperBound?this.setVariableCoefficient(-1,t):this.setVariableCoefficient(1,t))},EA.prototype.isEquality=!0,EA.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this},EA.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this},EA.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t},EA.prototype.relax=function(t,e){this.relaxation=bA(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var AA={Constraint:xA,Variable:_A,IntegerVariable:vA,SlackVariable:mA,Equality:EA,Term:yA},SA=AA.SlackVariable;function wA(t,value){this.index=t,this.value=value}fA.prototype.addCutConstraints=function(t){for(var e,r=t.length,i=this.height,n=i+r,o=i;o<n;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=n,this.nVars=this.width+this.height-2;for(var a=this.width-1,s=0;s<r;s+=1){var u=t[s],l=i+s,d="min"===u.type?-1:1,h=u.varIndex,c=this.rowByVarIndex[h],f=this.matrix[l];if(-1===c){for(f[this.rhsColumn]=d*u.value,e=1;e<=a;e+=1)f[e]=0;f[this.colByVarIndex[h]]=d}else{var g=this.matrix[c],p=g[this.rhsColumn];for(f[this.rhsColumn]=d*(u.value-p),e=1;e<=a;e+=1)f[e]=-d*g[e]}var _=this.getNewElementIndex();this.varIndexByRow[l]=_,this.rowByVarIndex[_]=l,this.colByVarIndex[_]=-1,this.variablesPerIndex[_]=new SA("s"+_,_),this.nVars+=1}},fA.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var r=e[t][this.rhsColumn],i=r-Math.floor(r);if(i<this.precision||1-this.precision<i)return!1;var n=this.height;e[n]=e[n-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[n]=o,this.rowByVarIndex[o]=n,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new SA("s"+o,o),e[n][this.rhsColumn]=Math.floor(r);for(var a=1;a<this.varIndexByCol.length;a+=1){if(this.variablesPerIndex[this.varIndexByCol[a]].isInteger){var s=e[t][a],u=Math.floor(s)+Math.max(0,s-Math.floor(s)-i)/(1-i);e[n][a]=u}else e[n][a]=Math.min(0,e[t][a]/(1-i))}for(var l=0;l<this.width;l+=1)e[n][l]-=e[t][l];return!0},fA.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var r=e[t][this.rhsColumn],i=r-Math.floor(r);if(i<this.precision||1-this.precision<i)return!1;var n=this.height;e[n]=e[n-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[n]=o,this.rowByVarIndex[o]=n,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new SA("s"+o,o),e[n][this.rhsColumn]=-i;for(var a=1;a<this.varIndexByCol.length;a+=1){var s=this.variablesPerIndex[this.varIndexByCol[a]],u=e[t][a],l=u-Math.floor(u);s.isInteger?e[n][a]=l<=i?-l:-(1-l)*i/l:e[n][a]=0<=u?-u:u*i/(1-i)}return!0},fA.prototype.applyMIRCuts=function(){for(var t=this.height,e=0;e<t;e+=1)this._addUpperBoundMIRCut(e);for(e=0;e<t;e+=1)this._addLowerBoundMIRCut(e)},fA.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(-1===e){for(var r=this.colByVarIndex[t],i=1;i<this.height;i+=1){var n=this.matrix[i][r];if(n<-this.precision||this.precision<n){e=i;break}}this.pivot(e,r)}return e},fA.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(-1===e){for(var r=this.rowByVarIndex[t],i=this.matrix[r],n=1;n<this.height;n+=1){var o=i[n];if(o<-this.precision||this.precision<o){e=n;break}}this.pivot(r,e)}return e},fA.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),r=0;r<t;r+=1){var i=this.variables[r],n=i.index,o=this.rowByVarIndex[n];if(-1===o)i.value=0;else{var a=this.matrix[o][this.rhsColumn];i.value=Math.round(a*e)/e}}},fA.prototype.updateRightHandSide=function(t,e){var r=this.height-1,i=this.rowByVarIndex[t.index];if(-1===i){for(var n=this.colByVarIndex[t.index],o=0;o<=r;o+=1){var a=this.matrix[o];a[this.rhsColumn]-=e*a[n]}var s=this.optionalObjectives.length;if(0<s)for(var u=0;u<s;u+=1){var l=this.optionalObjectives[u].reducedCosts;l[this.rhsColumn]-=e*l[n]}}else this.matrix[i][this.rhsColumn]-=e},fA.prototype.updateConstraintCoefficient=function(t,e,r){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var i=this._putInBase(t.index),n=this.colByVarIndex[e.index];if(-1===n)for(var o=this.rowByVarIndex[e.index],a=0;a<this.width;a+=1)this.matrix[i][a]+=r*this.matrix[o][a];else this.matrix[i][n]-=r},fA.prototype.updateCost=function(t,e){var r=t.index,i=this.width-1,n=this.colByVarIndex[r];if(-1===n){var o,a=this.matrix[this.rowByVarIndex[r]];if(0===t.priority){var s=this.matrix[0];for(o=0;o<=i;o+=1)s[o]+=e*a[o]}else{var u=this.objectivesByPriority[t.priority].reducedCosts;for(o=0;o<=i;o+=1)u[o]+=e*a[o]}}else this.matrix[0][n]-=e},fA.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,r=this.height,i=this.matrix[r];void 0===i&&(i=this.matrix[0].slice(),this.matrix[r]=i);for(var n=this.width-1,o=0;o<=n;o+=1)i[o]=0;i[this.rhsColumn]=e*t.rhs;for(var a=t.terms,s=a.length,u=0;u<s;u+=1){var l=a[u],d=l.coefficient,h=l.variable.index,c=this.rowByVarIndex[h];if(-1===c)i[this.colByVarIndex[h]]+=e*d;else{var f=this.matrix[c];f[this.rhsColumn];for(o=0;o<=n;o+=1)i[o]-=e*d*f[o]}}var g=t.index;this.varIndexByRow[r]=g,this.rowByVarIndex[g]=r,this.colByVarIndex[g]=-1,this.height+=1},fA.prototype.removeConstraint=function(t){var e=t.index,r=this.height-1,i=this._putInBase(e),n=this.matrix[r];this.matrix[r]=this.matrix[i],this.matrix[i]=n,this.varIndexByRow[i]=this.varIndexByRow[r],this.varIndexByRow[r]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,--this.height},fA.prototype.addVariable=function(t){var e=this.height-1,r=this.width,i=!0===this.model.isMinimization?-t.cost:t.cost,n=t.priority,o=this.optionalObjectives.length;if(0<o)for(var a=0;a<o;a+=1)this.optionalObjectives[a].reducedCosts[r]=0;0===n?this.matrix[0][r]=i:(this.setOptionalObjective(n,r,i),this.matrix[0][r]=0);for(var s=1;s<=e;s+=1)this.matrix[s][r]=0;var u=t.index;this.varIndexByCol[r]=u,this.rowByVarIndex[u]=-1,this.colByVarIndex[u]=r,this.width+=1},fA.prototype.removeVariable=function(t){var e=t.index,r=this._takeOutOfBase(e),i=this.width-1;if(r!==i){for(var n=this.height-1,o=0;o<=n;o+=1){var a=this.matrix[o];a[r]=a[i]}var s=this.optionalObjectives.length;if(0<s)for(var u=0;u<s;u+=1){var l=this.optionalObjectives[u].reducedCosts;l[r]=l[i]}var d=this.varIndexByCol[i];this.varIndexByCol[r]=d,this.colByVarIndex[d]=r}this.varIndexByCol[i]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,--this.width},fA.prototype.log=function(t,force){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var e,r,i,n,o,a,s,u,l,d,h="",c=[" "];for(r=1;r<this.width;r+=1)o=this.varIndexByCol[r],s=" ",u="\t",5<(a=void 0===(n=this.variablesPerIndex[o])?"c"+o:n.id).length?s+=" ":u+="\t",c[r]=s,h+=u+a;console.log(h);var f=this.matrix[this.costRowIndex],g="\t";for(e=1;e<this.width;e+=1)g+="\t",g+=c[e],g+=f[e].toFixed(5);for(g+="\t"+c[0]+f[0].toFixed(5),console.log(g+"\tZ"),i=1;i<this.height;i+=1){for(l=this.matrix[i],d="\t",r=1;r<this.width;r+=1)d+="\t"+c[r]+l[r].toFixed(5);d+="\t"+c[0]+l[0].toFixed(5),o=this.varIndexByRow[i],a=void 0===(n=this.variablesPerIndex[o])?"c"+o:n.id,console.log(d+"\t"+a)}console.log("");var p=this.optionalObjectives.length;if(0<p){console.log("    Optional objectives:");for(var _=0;_<p;_+=1){var v=this.optionalObjectives[_].reducedCosts,m="";for(e=1;e<this.width;e+=1)m+=v[e]<0?"":" ",m+=c[e],m+=v[e].toFixed(5);m+=(v[0]<0?"":" ")+c[0]+v[0].toFixed(5),console.log(m+" z"+_)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},fA.prototype.copy=function(){var t=new fA(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],r=0;r<this.optionalObjectives.length;r++)e[r]=this.optionalObjectives[r].copy();t.optionalObjectives=e;for(var i=this.matrix,n=new Array(this.height),o=0;o<this.height;o++)n[o]=i[o].slice();return t.matrix=n,t},fA.prototype.save=function(){this.savedState=this.copy()},fA.prototype.restore=function(){if(null!==this.savedState){var t,e,r=this.savedState,i=r.matrix;for(this.nVars=r.nVars,this.model=r.model,this.variables=r.variables,this.variablesPerIndex=r.variablesPerIndex,this.unrestrictedVars=r.unrestrictedVars,this.lastElementIndex=r.lastElementIndex,this.width=r.width,this.height=r.height,t=0;t<this.height;t+=1){var n=i[t],o=this.matrix[t];for(e=0;e<this.width;e+=1)o[e]=n[e]}var a=r.varIndexByRow;for(e=0;e<this.height;e+=1)this.varIndexByRow[e]=a[e];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var s=r.varIndexByCol;for(t=0;t<this.width;t+=1)this.varIndexByCol[t]=s[t];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var u=r.rowByVarIndex,l=r.colByVarIndex,d=0;d<this.nVars;d+=1)this.rowByVarIndex[d]=u[d],this.colByVarIndex[d]=l[d];if(0<r.optionalObjectives.length&&0<this.optionalObjectives.length){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var h=0;h<r.optionalObjectives.length;h++){var c=r.optionalObjectives[h].copy();this.optionalObjectives[h]=c,this.optionalObjectivePerPriority[c.priority]=c}}}},fA.prototype.getMostFractionalVar=function(){for(var t=0,e=null,r=null,i=this.model.integerVariables,n=i.length,o=0;o<n;o++){var a=i[o].index,s=this.rowByVarIndex[a];if(-1!==s){var u=this.matrix[s][this.rhsColumn],l=Math.abs(u-Math.round(u));t<l&&(t=l,e=a,r=u)}}return new wA(e,r)},fA.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,r=null,i=this.model.integerVariables,n=i.length,o=0;o<n;o++){var a=i[o],s=a.index,u=this.rowByVarIndex[s];if(-1!==u){var l=this.matrix[u][this.rhsColumn];if(Math.abs(l-Math.round(l))>this.precision){var d=a.cost;d<t&&(t=d,e=s,r=l)}}}return new wA(e,r)},fA.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var r=this.matrix[e][this.rhsColumn];(r-=Math.floor(r))<this.precision&&-r<this.precision&&(t+=1)}return t},fA.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,r=0;r<e;r++){var i=this.rowByVarIndex[t[r].index];if(-1!==i){var n=this.matrix[i][this.rhsColumn];if(Math.abs(n-Math.round(n))>this.precision)return!1}}return!0},fA.prototype.computeFractionalVolume=function(t){for(var e=-1,r=1;r<this.height;r+=1)if(this.variablesPerIndex[this.varIndexByRow[r]].isInteger){var i=this.matrix[r][this.rhsColumn];if(i=Math.abs(i),Math.min(i-Math.floor(i),Math.floor(i+1))<this.precision){if(!t)return 0}else-1===e?e=i:e*=i}return-1===e?0:e};var TA=fA;function CA(t,e,value){this.type=t,this.varIndex=e,this.value=value}function MA(t,e){this.relaxedEvaluation=t,this.cuts=e}function IA(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}fA.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var r=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),.9*r<=this.computeFractionalVolume(!0)&&(e=!1)}},fA.prototype.branchAndCut=function(){for(var t=[],e=0,r=1/0,i=null,n=[],o=0;o<this.optionalObjectives.length;o+=1)n.push(1/0);var a=new MA(-1/0,[]);for(t.push(a);0<t.length;)if(!((a=t.pop()).relaxedEvaluation>r)){var s=a.cuts;if(this.applyCuts(s),e++,!1!==this.feasible){var u=this.evaluation;if(!(r<u)){if(u===r){for(var l=!0,d=0;d<this.optionalObjectives.length&&!(this.optionalObjectives[d].reducedCosts[0]>n[d]);d+=1)if(this.optionalObjectives[d].reducedCosts[0]<n[d]){l=!1;break}if(l)continue}if(!0===this.isIntegral()){if(1===e)return void(this.branchAndCutIterations=e);i=a,r=u;for(var h=0;h<this.optionalObjectives.length;h+=1)n[h]=this.optionalObjectives[h].reducedCosts[0]}else{1===e&&this.save();for(var c=this.getMostFractionalVar(),f=c.index,g=[],p=[],_=s.length,v=0;v<_;v+=1){var m=s[v];m.varIndex===f?"min"===m.type?p.push(m):g.push(m):(g.push(m),p.push(m))}var y=Math.ceil(c.value),b=Math.floor(c.value),x=new CA("min",f,y);g.push(x);var E=new CA("max",f,b);p.push(E),t.push(new MA(u,g)),t.push(new MA(u,p)),t.sort(IA)}}}}null!==i&&this.applyCuts(i.cuts),this.branchAndCutIterations=e};var LA={},NA=AA.Constraint,OA=AA.Equality,kA=AA.Variable,RA=AA.IntegerVariable;function FA(t,e){this.tableau=new fA(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!0,this.checkForCycles=!1}var DA=FA;FA.prototype.minimize=function(){return this.isMinimization=!0,this},FA.prototype.maximize=function(){return this.isMinimization=!1,this},FA.prototype._getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},FA.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(t)},FA.prototype.smallerThan=function(t){var e=new NA(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},FA.prototype.greaterThan=function(t){var e=new NA(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},FA.prototype.equal=function(t){var e=new NA(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var r=new NA(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(r),new OA(e,r)},FA.prototype.addVariable=function(t,e,r,i,n){if("string"==typeof n)switch(n){case"required":n=0;break;case"strong":n=1;break;case"medium":n=2;break;case"weak":n=3;break;default:n=0}var o,a=this.tableau.getNewElementIndex();return null==e&&(e="v"+a),null==t&&(t=0),null==n&&(n=0),r?(o=new RA(e,t,a,n),this.integerVariables.push(o)):o=new kA(e,t,a,n),this.variables.push(o),this.tableau.variablesPerIndex[a]=o,i&&(this.unrestrictedVariables[a]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},FA.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e?(this.constraints.splice(e,1),--this.nConstraints,!0===this.tableauInitialized&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},FA.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this},FA.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(-1!==e)return this.variables.splice(e,1),!0===this.tableauInitialized&&this.tableau.removeVariable(t),this;console.warn("[Model.removeVariable] Variable not present in model")},FA.prototype.updateRightHandSide=function(t,e){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(t,e),this},FA.prototype.updateConstraintCoefficient=function(t,e,r){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(t,e,r),this},FA.prototype.setCost=function(t,e){var r=t-e.cost;return!1===this.isMinimization&&(r=-r),e.cost=t,this.tableau.updateCost(e,r),this},FA.prototype.loadJson=function(t){this.isMinimization="max"!==t.opType;for(var e=t.variables,r=t.constraints,i={},n={},o=Object.keys(r),a=o.length,s=0;s<a;s+=1){var u,l,d=o[s],h=r[d],c=h.equal,f=h.weight,g=h.priority,p=void 0!==f||void 0!==g;if(void 0===c){var _=h.min;void 0!==_&&(u=this.greaterThan(_),i[d]=u,p&&u.relax(f,g));var v=h.max;void 0!==v&&(l=this.smallerThan(v),n[d]=l,p&&l.relax(f,g))}else{u=this.greaterThan(c),i[d]=u,l=this.smallerThan(c),n[d]=l;var m=new OA(u,l);p&&m.relax(f,g)}}for(var y=Object.keys(e),b=y.length,x=t.ints||{},E=t.binaries||{},A=t.unrestricted||{},S=t.optimize,w=0;w<b;w+=1){var T=y[w],C=e[T],M=C[S]||0,I=!!E[T],L=!!x[T]||I,N=!!A[T],O=this.addVariable(M,T,L,N);I&&this.smallerThan(1).addTerm(1,O);var k=Object.keys(C);for(s=0;s<k.length;s+=1){var R=k[s];if(R!==S){var F=C[R],D=i[R];void 0!==D&&D.addTerm(F,O);var P=n[R];void 0!==P&&P.addTerm(F,O)}}}return this},FA.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},FA.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},FA.prototype.isFeasible=function(){return this.tableau.feasible},FA.prototype.save=function(){return this.tableau.save()},FA.prototype.restore=function(){return this.tableau.restore()},FA.prototype.activateMIRCuts=function(t){this.useMIRCuts=t},FA.prototype.debug=function(t){this.checkForCycles=t},FA.prototype.log=function(t){return this.tableau.log(t)};var PA={CleanObjectiveAttributes:function(t){var e,r,i;if("string"==typeof t.optimize){if(t.constraints[t.optimize]){for(r in e=Math.random(),t.variables)t.variables[r][t.optimize]&&(t.variables[r][e]=t.variables[r][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}return t}for(i in t.optimize)if(t.constraints[i])if("equal"===t.constraints[i])delete t.optimize[i];else{for(r in e=Math.random(),t.variables)t.variables[r][i]&&(t.variables[r][e]=t.variables[r][i]);t.constraints[e]=t.constraints[i],delete t.constraints[i]}return t}};function zA(t){return(t.length?function(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},r={opType:"",optimize:"_obj",constraints:{},variables:{}},i={">=":"min","<=":"max","=":"equal"},n="",o=null,a="",s="",u="",l=0;"string"==typeof t&&(t=t.split("\n"));for(var d=0;d<t.length;d++)if(u="__"+d,n=t[d],o=null,e.is_objective.test(n))r.opType=n.match(/(max|min)/gi)[0],(o=n.match(e.parse_lhs).map(function(t){return t.replace(/\s+/,"")}).slice(1)).forEach(function(t){a=null===(a=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:a[0],a=parseFloat(a),s=t.match(e.get_word)[0].replace(/\;$/,""),r.variables[s]=r.variables[s]||{},r.variables[s]._obj=a});else if(e.is_int.test(n))o=n.match(e.parse_int).slice(1),r.ints=r.ints||{},o.forEach(function(t){t=t.replace(";",""),r.ints[t]=1});else if(e.is_constraint.test(n)){var h=n.indexOf(":");(o=(-1===h?n:n.slice(h+1)).match(e.parse_lhs).map(function(t){return t.replace(/\s+/,"")})).forEach(function(t){a=null===(a=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:a[0],a=parseFloat(a),s=t.match(e.get_word)[0],r.variables[s]=r.variables[s]||{},r.variables[s][u]=a}),l=parseFloat(n.match(e.parse_rhs)[0]),n=i[n.match(e.parse_dir)[0]],r.constraints[u]=r.constraints[u]||{},r.constraints[u][n]=l}else e.is_unrestricted.test(n)&&(o=n.match(e.parse_int).slice(1),r.unrestricted=r.unrestricted||{},o.forEach(function(t){t=t.replace(";",""),r.unrestricted[t]=1}));return r}:function(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",r={max:"<=",min:">=",equal:"="},i=new RegExp("[^A-Za-z0-9]+","gi");for(var n in e+=t.opType+":",t.variables)t.variables[n][n]=t.variables[n][n]?t.variables[n][n]:1,t.variables[n][t.optimize]&&(e+=" "+t.variables[n][t.optimize]+" "+n.replace(i,"_"));for(n in e+=";\n",t.constraints)for(var o in t.constraints[n]){for(var a in t.variables)t.variables[a][n]&&(e+=" "+t.variables[a][n]+" "+a.replace(i,"_"));e+=" "+r[o]+" "+t.constraints[n][o],e+=";\n"}if(t.ints)for(n in e+="\n\n",t.ints)e+="int "+n.replace(i,"_")+";\n";if(t.unrestricted)for(n in e+="\n\n",t.unrestricted)e+="unrestricted "+n.replace(i,"_")+";\n";return e})(t)}function BA(){this.Model=DA,this.branchAndCut=LA,this.Constraint=UA,this.Variable=VA,this.Numeral=jA,this.Term=GA,this.Tableau=TA,this.lastSolvedModel=null,this.Solve=function(t,e,r,i){if(i)for(var n in PA)t=PA[n](t);if(!t)throw new Error("Solver requires a model to operate on");t instanceof DA==!1&&(t=new DA(e).loadJson(t));var o=t.solve();if(this.lastSolvedModel=t,o.solutionSet=o.generateSolutionSet(),r)return o;var a={};return a.feasible=o.feasible,a.result=o.evaluation,a.bounded=o.bounded,Object.keys(o.solutionSet).map(function(t){a[t]=o.solutionSet[t]}),a},this.ReformatLP=zA,this.MultiObjective=function(t){return function(t,e){var r,i,n,o,a,s=e.optimize,u=JSON.parse(JSON.stringify(e.optimize)),l=Object.keys(e.optimize),d=0,h={},c="",f={},g=[];for(delete e.optimize,i=0;i<l.length;i++)u[l[i]]=0;for(i=0;i<l.length;i++){for(a in e.optimize=l[i],e.opType=s[l[i]],r=t.Solve(e,void 0,void 0,!0),l)if(!e.variables[l[a]])for(o in r[l[a]]=r[l[a]]?r[l[a]]:0,e.variables)e.variables[o][l[a]]&&r[o]&&(r[l[a]]+=r[o]*e.variables[o][l[a]]);for(c="base",n=0;n<l.length;n++)r[l[n]]?c+="-"+(1e3*r[l[n]]|0)/1e3:c+="-0";if(!h[c]){for(h[c]=1,d++,n=0;n<l.length;n++)r[l[n]]&&(u[l[n]]+=r[l[n]]);delete r.feasible,delete r.result,g.push(r)}}for(i=0;i<l.length;i++)e.constraints[l[i]]={equal:u[l[i]]/d};for(i in e.optimize="cheater-"+Math.random(),e.opType="max",e.variables)e.variables[i].cheater=1;for(i in g)for(o in g[i])f[o]=f[o]||{min:1e99,max:-1e99};for(i in f)for(o in g)g[o][i]?(g[o][i]>f[i].max&&(f[i].max=g[o][i]),g[o][i]<f[i].min&&(f[i].min=g[o][i])):(g[o][i]=0,f[i].min=0);return{midpoint:r=t.Solve(e,void 0,void 0,!0),vertices:g,ranges:f}}(this,t)}}var UA=AA.Constraint,VA=AA.Variable,jA=AA.Numeral,GA=AA.Term;"object"==typeof window&&(window.solver=new BA);var HA=new BA;function qA(t){var i={},e={},n={};t.nodes.forEach(function(r){e[r.id]=1,i[r.id]={opt:r.children.length},r.children.forEach(function(t){var e=r.id+"->"+t.id;n[e]={min:1},i[r.id][e]=-1})}),t.nodes.forEach(function(r){r.children.forEach(function(t){var e=r.id+"->"+t.id;i[t.id].opt--,i[t.id][e]=1})});var r=HA.Solve({optimize:"opt",opType:"max",constraints:n,variables:i,ints:e});return t.nodes.forEach(function(t){t.layer=r[t.id]||0}),t}function WA(t){return t.nodes.forEach(function(t){t.layer=null!=t.data.layer?t.data.layer:t.layer}),t}function XA(t){var u=Object.assign({},{normalization:!0},t),l=qA;return function(t){if(t.nodes.some(function(t){return"layer"in t.data&&t.data.layer<0}))throw new Error("Some nodes have negative layering information");if(!u.normalization&&t.nodes.every(function(t){return"layer"in t.data&&-1<t.data.layer})){var e=[];t.nodes.forEach(function(t){return e[t.data.layer]=1});for(var r=e.findIndex(function(t){return null!=t}),i=0,n=e.slice(r);i<n.length;i+=1){if(null==n[i])throw new Error("The overall layering contains gaps (two non-consecutive layers)")}}t.nodes.some(function(t){return"layer"in t.data&&0===t.data.layer})||WA(l(t));var o,a,s=function(t){if(t.nodes.every(function(t){return t.layer})){var e=1/0;t.nodes.forEach(function(t){e=Math.min(e,t.layer)}),t.nodes.forEach(function(t){t.layer-=e})}return t}(function(t){if(t.nodes.some(function(t){return t.data.sink})){var e=-1/0;t.nodes.forEach(function(t){e=Math.max(e,t.layer)}),t.nodes.forEach(function(t){t.data.sink&&(t.layer=e+1)})}return t}(function(t){var r={};t.nodes.forEach(function(e){r[e.id]=(r[e.id]||[]).concat(e.children),e.children.forEach(function(t){r[t.id]=(r[t.id]||[]).concat([e])})});var e=[];t.nodes.forEach(function(t){0===t.layer&&e.push(t)});var i={},n={};for(t.nodes.forEach(function(t){null!=t.layer&&(n[t.id]=t.layer)});e.length;)for(var o=e.shift().id,a=0,s=r[o];a<s.length;a+=1){var u=s[a];if(!i[u.id]){if(null==n[u.id]){var l=n[o]+1;n[u.id]=l,u.layer=l}i[u.id]=!0,e.push(u)}}return t}(WA(t))));return function(t,e){if(!e.normalization)return;var r=[];t.nodes.forEach(function(t){return r[t.layer]=0});var i=Array.from(r).reduce(function(t,e,r){if(0===r)return t.push(0),t;var i=t[r-1];return null!=e?t.push(i):t.push(i-1),t},[]);t.nodes.forEach(function(t){t.layer+=i[t.layer]})}(s,u),(a=(o=s).nodes.reduce(function(t,e){if(e.data.fixed){if(null==t)return e;if(t.layer>e.layer)return e}return t},null))&&o.nodes.forEach(function(t){t.ref=a.id}),o}}var YA=function(){this.root=null};function ZA(t){var e={x:0,y:0};for(var r in t)e.x+=t[r].x||0,e.y+=t[r].y||0;return e.x/=Object.keys(t).length,e.y/=Object.keys(t).length,e}YA.prototype.fit=function(t){var e=t.length?t[0].w:0,r=t.length?t[0].h:0;this.root={x:0,y:0,w:e,h:r};for(var i=0,n=t;i<n.length;i+=1){var o=n[i],a=this.findNode(this.root,o.w,o.h);o.fit=a?this.splitNode(a,o.w,o.h):this.growNode(o.w,o.h)}},YA.prototype.findNode=function(t,e,r){return t.used?this.findNode(t.right,e,r)||this.findNode(t.down,e,r):e<=t.w&&r<=t.h?t:void 0},YA.prototype.splitNode=function(t,e,r){return t.used=!0,t.down={x:t.x,y:t.y+r,w:t.w,h:t.h-r},t.right={x:t.x+e,y:t.y,w:t.w-e,h:r},t},YA.prototype.growNode=function(t,e){var r=t<=this.root.w,i=e<=this.root.h;return i&&this.root.h>=this.root.w+t?this.growRight(t,e):r&&this.root.w>=this.root.h+e?this.growDown(t,e):i?this.growRight(t,e):r?this.growDown(t,e):void 0},YA.prototype.getNewRoot=function(t,e,r,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=this.root),void 0===i&&(i=this.root),{used:!0,x:0,y:0,w:this.root.w+t,h:this.root.h+e,right:r,down:i}},YA.prototype.growRight=function(t,e){return this.root=this.getNewRoot(t,0,{x:this.root.w,y:0,w:t,h:this.root.h}),this.grow(t,e)},YA.prototype.growDown=function(t,e){return this.root=this.getNewRoot(0,e,void 0,{x:0,y:this.root.h,w:this.root.w,h:e}),this.grow(t,e)},YA.prototype.grow=function(t,e){var r=this.findNode(this.root,t,e);if(r)return this.splitNode(r,t,e)};var KA={down:function(){},up:function(t){t.y=-t.y},left:function(t){var e=t.x;t.x=-t.y,t.y=e},right:function(t){var e=t.x;t.x=t.y,t.y=-e}};function QA(t,e){return null!=t&&0<t?t:e}var JA=1.2,$A=50;function tS(t,e){void 0===e&&(e={});var r=t.slice().sort(function(t,e){return e.r-t.r}),i=Math.sqrt(r.length),n=Math.floor(i),o=Math.ceil(i);n*o<r.length&&(n<o?n++:o++);var a=JA*r.reduce(function(t,e){var r=e.r;return Math.max(t,2*r)},0),s=Math.max(e.nodesGridSeparation||$A,1),u=a*o+s*(o-1),l=a*n+s*Math.max(n-1,0);return r.forEach(function(t,e){var r=e%o,i=Math.floor(e/o);t.x=u*r/o,t.y=l*i/n}),{w:u,h:l}}function eS(t){if(!t||!t.length)throw Error("Cannot stratify empty data");for(var e=0,r=t;e<r.length;e+=1){var i=r[e];if(null==i)throw Error('Node data is "null"');if(null==i.id)throw Error('Node id contains a "null" value')}for(var n=t.map(function(t){return KE(t.id,t)}),o=n.reduce(function(t,e){if(t[e.id])throw Error("The connected component contains id duplicates: "+e.id);return t[e.id]=e,t},{}),a=KE(),s=0,u=n;s<u.length;s+=1){for(var l=u[s],d=0,h=l.data.parentIds;d<h.length;d+=1){var c=h[d],f=o[c];if(!f)throw Error("The node "+l.id+" has a missing parent id "+c);f.children.push(l)}l.data.parentIds.length||a.children.push(l)}return{nodes:function(t){var e={},r=[].concat(t.children),i=[];for(;r.length;){var n=r.pop();e[n.id]||(i.push(n),e[n.id]=1,r.push.apply(r,n.children))}return i}(a)}}var rS=1,iS=1;function nS(t,e){var r=e.decross,i=e.separation,n=e.coord;(0,e.layering)(t);var o,a,s=t.nodes.reduce(function(n,o){return n[o.layer]=n[o.layer]||[],n[o.layer].push(o),o.children=o.children.map(function(t){if(t.layer===o.layer+1)return t;for(var e=t,r=t.layer-1;r>o.layer;r--){var i=KE(o.id+"->"+t.id+"@"+r);i.children=[e],n[r]=n[r]||[],n[r].push(i),e=i}return e}),n},[]);return a=1===(o=s).length?oS:aS,o.forEach(function(t,e){for(var r=0,i=t;r<i.length;r+=1)i[r].y=a(e,o.length)}),function(t,e){var r=e.coord,i=e.decross,n=e.separation;if(t.every(function(t){return 1===t.length}))return t.forEach(function(t){return t[0].x=iS/2});i(t),r(t,n)}(s,{decross:r,coord:n,separation:i}),t.nodes.forEach(function(t){t.data&&(t.children=t.children.filter(function(t){return t.data}))}),t}function oS(){return rS/2}function aS(t,e){return rS*t/(e-1)}function sS(t){return{id:""+t.id,layer:t.layer,sink:t.sink,radius:t.r,fixed:!1===t.layoutable,parentIds:[],ref:null}}function uS(t,e){void 0===e&&(e={});for(var r=(t.edges||[]).filter(function(t){return t.source!==t.target}),i={},n=0,o=t.nodes;n<o.length;n+=1){var a=o[n];i[a.id]=a}var s=QE(t.nodes,r,i),u=function(t,e,r){void 0===r&&(r={});for(var i=VE(e),n=Object.keys(i),o=[];n.length;){var a=UE(n[0],i);o.push(a),n=qE(n,a)}return r.skipSingletons?o:o.concat(HE(t,e,i).map(function(t){return[t.id+""]}))}(t.nodes,s,{skipSingletons:"singleton"===e.packing}),l=s.reduce(function(t,e){return t[e.source]||(t[e.source]=sS(i[e.source])),t[e.target]||(t[e.target]=sS(i[e.target])),t[e.target].parentIds.push(""+e.source),t},{});return{shapes:u.map(function(t){return t.map(function(t){return l[t]||sS(i[t]||{id:t})})}),nLookup:i}}function lS(t,e){void 0===e&&(e={});for(var r=[],i=0,n=t;i<n.length;i+=1){var o=eS(n[i]);r.push(o),nS(o,{decross:function(r){return r.slice(0,r.length-1).forEach(function(t,e){return JE(t,r[e+1])}),r},separation:jE(GE(o.nodes),e.gapDistance),coord:(e.evenDistribution?sA:aA)(),layering:XA(e)})}return r}function dS(t,e){if(!t||!t.nodes)return t;var r,i,n=e||{},o=uS(t,n),a=o.shapes,s=o.nLookup,u=lS(a,n);if("singleton"===n.packing){var l=HE(t.nodes,t.edges),d=tS(l,n);u.push((r=l,i=d,Object.assign({},{nodes:r.map(function(t){return Object.assign({},t,{data:t})}),isFake:!0},i)))}return function(t,p,e){void 0===e&&(e={});for(var _=-1/0,v=-1/0,m=QA(e.nodesSeparation,0),y=QA(e.componentsSeparation,25),b=QA(e.layerSeparation,50),x=[],r=ZA(p),i=t.reduce(function(t,e){return e.nodes.filter(function(t){return t.data&&t.data.fixed}).reduce(function(t,e){var r=p[e.id],i=r.x,n=r.y;return t[e.id]={x:i||0,y:n||0},t},t)},{}),n=function(){var t=A[E],r={},e=t.nodes,i=1==e.length,n=2*GE(e)|5,o=e.reduce(function(t,e){var r=e.x;return Math.min(t,r)},1/0);_=e.reduce(function(t,e){var r=e.x;return Math.max(t,r)},-1/0)-o;for(var a=0,s=e;a<s.length;a+=1){var u=s[a],l=u.x,d=u.y,h=u.id;p[h]&&(i?p[h].x=p[h].y=0:(p[h].x=l-o,p[h].y=d,r[d]=r[d]||[],r[d].push(p[h])))}var c=Math.max(n,b),f=Object.keys(r),g=f.reduce(function(t,e){return Math.max(t,r[e].length-1)},1)*(3+Math.max(1,m));v=(f.length||1)*c,_=Math.max(_,1),t.isFake||f.sort(function(t,e){return t-e}).forEach(function(t,e){r[t].forEach(function(t){t.y=e*c,t.x=t.x/_*g})}),x.push({w:Math.ceil(g)+y,h:Math.ceil(v),dag:t}),v=_=-1/0},E=0,A=t;E<A.length;E+=1)n();if(x.sort(function(t,e){return Math.max(e.w,e.h)-Math.max(t.w,t.h)}),"hierarchy"!==e.packing)(new YA).fit(x);else for(var o=0,a=0,s=x;a<s.length;a+=1){var u=s[a];u.fit={x:o,y:0},o+=u.w}for(var l,d,h=x.reduce(function(t,e){var r=e.h;return Math.max(t,r)},1),c=0,f=x;c<f.length;c+=1)for(var g=f[c],S=g.fit,w=g.dag,T=S||{x:0,y:0},C=T.y/h*50+T.y,M=T.x,I=0,L=w.nodes;I<L.length;I+=1){var N=L[I].id;p[N]&&(p[N].x+=M,p[N].y+=C,l=p[N],(d=e.direction)&&d in KA&&KA[d](l))}var O=ZA(p),k=O.x-r.x,R=O.y-r.y;for(var F in p)p[F].x-=k,p[F].y-=R;for(var D=0,P=x;D<P.length;D+=1){var z=P[D].dag,B=z.nodes[0]&&z.nodes[0].ref,U=0,V=0;if(B&&(U=p[B].x-i[B].x,V=p[B].y-i[B].y),U||V)for(var j=0,G=z.nodes;j<G.length;j+=1){var H=G[j].id;p[H]&&(p[H].x-=U,p[H].y-=V)}}for(var q=0,W=Object.keys(i);q<W.length;q+=1){var X=W[q];p[X].x=i[X].x,p[X].y=i[X].y}}(u,s,n),t}var hS,cS={direction:"TB",nodeDistance:50,levelDistance:50,componentDistance:50,gapWidth:1,arrangeComponents:"fit",gridDistance:50,layer:"layer"},fS={imports:{sequential:dS},configure:function(t,e){var r=e.graph,i=e.data;function n(t,e,r){return void 0===r&&(r=t.getNodes()),e?e instanceof yi?e:t.getNodes(e):r}var o=I(I(I({},cS),t),{nodeList:t.nodes});o.direction=t.direction||cS.direction,o.layerSeparation=o.levelDistance,o.nodesSeparation=o.nodeDistance,o.componentsSeparation=o.componentDistance,o.gapDistance=o.gapWidth,o.packing=o.arrangeComponents;var a=I({},o),s=o.edges,u=o.nodeList;if(-1===["TB","BT","LR","RL"].indexOf(o.direction))throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(-1===["fit","grid","singleLine"].indexOf(o.packing))throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');o.nodesGridSeparation=t.gridDistance||cS.gridDistance;var l=u.getId(),d=u.getAttribute("layoutable").reduce(function(t,value,e){return t[l[e]]=value,t},{}),h=u.getAttributes(["x","y"]).reduce(function(t,value,e){return t[l[e]]=value,t},{}),c=u.getAttribute("radius");if("string"!=typeof a.layer)throw new Error("'layer' should be the valid data field name");for(var f=n(r,o.roots,r.nodeList()),g=i.getProperty(o.nodeList,a.layer),p=0,_=f.map(function(r){var i=-1;return o.nodeList.forEach(function(t,e){t===r&&(i=e)}),i});p<_.length;p++){g[_[p]]=0}var v=n(r,o.sinks,r.nodeList()).toArray().reduce(function(t,e){return t[e.getId()]=!0,t},{}),m=l.map(function(t){return v[t]});return{nodes:l,edges:s.map(function(t){return{id:t.getId(),source:t.getSource().getId(),target:t.getTarget().getId()}}),options:K(o),layoutable:d,radiuses:c,layers:g,sinks:m,coords:h}},context:function(){},update:function(t){var e=t.nodes,r=t.edges,i=t.options,n=t.layoutable,o=t.radiuses,a=t.layers,s=t.sinks,u=t.coords,l=r.filter(function(t){var e=t.source,r=t.target;return e in n&&r in n});return{positions:dS({nodes:e.map(function(t,e){return{id:t,r:o[e],layer:a[e],sink:s[e],layoutable:n[t],x:u[t].x,y:u[t].y}}),edges:l},{packing:{fit:"rect",singleLine:"hierarchy",grid:"singleton"}[i.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[i.direction],layerSeparation:i.layerSeparation,nodesSeparation:i.nodesSeparation,componentsSeparation:i.componentsSeparation,gapDistance:i.gapWidth,nodesGridSeparation:i.nodesGridSeparation,evenDistribution:i.evenDistribution}).nodes}},isRunning:function(){return!1},onSync:function(t,e){var r=t.positions,i=e.graph;return{indexes:r.map(function(t){var e=t.id;return(i.getNode(e)||{_index:-1})._index}),x:r.map(function(t){return t.x}),y:r.map(function(t){return t.y})}}},gS={configure:function(t,e){var r=e.graph,i=e.camera;function n(t){return void 0===t||"number"==typeof t&&isFinite(t)&&0<t}var o,a,s,u,l,d=t.sortBy,h=t,c=h.nodes,f=Array.from(c._indexes),g=f.length,p=function(t,e,r){if(!n(t))throw new TypeError('"rows" should be a positive integer');if(!n(e))throw new TypeError('"cols" should be a positive integer');if(t)return{rows:t,cols:Math.ceil(r/t)};if(e)return{cols:e,rows:Math.ceil(r/e)};var i=Math.ceil(Math.sqrt(r));return{cols:i,rows:Math.ceil(r/i)}}(h.rows,h.cols,g),_=p.rows,v=p.cols,m=(o=d,a=r,s=c,u=f,l=t.sortFallbackValue,"string"!=typeof o?u.map(function(t,e){return e}):"radius"===o?a.getAttribute(!0,"radius").getMultiple(u):"random"===o?u.map(function(){return Math.random()}):s.getData(o).map(function(value){return value||l})),y=c.getAttribute("layoutable"),b=f.reduce(function(t,e,r){return y[r]&&t.push({id:e,attr:m[r]}),t},[]),x=c.getBoundingBox(),E=.65*Math.max(x.maxScaledSize,x.maxFixedSize/i.getZoom()),A=x.minX+E,S=x.maxX-E,w=x.minY+E,T=x.maxY-E;return x.width<E*v*2&&(A=x.cx-E*v+E,S=x.cx+E*v-E),x.height<E*_*2&&(w=x.cy-E*_+E,T=x.cy+E*_-E),{sort:!!d,nodes:b,reverse:!!h.reverse,cols:v,rows:_,minX:A,maxX:S,minY:w,maxY:T}},update:function(t){var e=t.sort,r=t.nodes,i=t.maxX,n=t.minX,o=t.maxY,a=t.minY,s=t.reverse,u=t.rows,l=t.cols;e&&r.sort(function(t,e){var r=t.attr,i=e.attr;return r<i?-1:i<r?1:0}),s&&r.reverse();var d=(i-n)/(l-1),h=(o-a)/(u-1),c=n,f=a;isFinite(d)||(d=0),isFinite(h)||(h=0);var g=0,p=0;return r.forEach(function(t){t.x=c+g*d,t.y=f+p*h,(g+=1)===l&&(p+=1,g=0)}),r},onSync:function(t){return{indexes:t.map(function(t){return t.id}),x:t.map(function(t){return t.x}),y:t.map(function(t){return t.y})}}},pS=(b(_S,hS=Ly),_S);function _S(t){var e,r,i,n,o,a,s,u=hS.call(this,t)||this;return u.stop=function(){return u._ogma.modules.layouts.stop()},u.concentric=((e=t).modules.layouts.register("concentric",IE),function(t){return e.modules.layouts.start("concentric",t)}),u.radial=((r=t).modules.layouts.register("radial",LE),function(t){if(void 0===t.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');if(t.maxIterations=t.maxIterations&&isFinite(t.maxIterations)?Math.floor(t.maxIterations):100,t.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(t.iterationsPerRender=t.iterationsPerRender&&isFinite(t.iterationsPerRender)?Math.floor(t.iterationsPerRender):20,t.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(t.epsilon=t.epsilon&&isFinite(t.epsilon)?t.epsilon:.001,t.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return r.modules.layouts.start("radial",t)}),u.force=((i=t).modules.layouts.register("force",kE),function(t){if(void 0===t&&(t={}),t.incremental)return PE(t,i,i.layouts.force);if(void 0!==t.edgeStrength&&(!isFinite(t.edgeStrength)||t.edgeStrength<0))throw new Error("force layout: edgeStrength must be a positive number");if(void 0!==t.steps&&(!isFinite(t.steps)||t.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(void 0!==t.edgeLength&&(!isFinite(t.edgeLength)||t.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(void 0!==t.gravity&&(!isFinite(t.gravity)||t.gravity<0||1<=t.gravity))throw new Error("force layout: 'gravity' must be between 0 and 1");if(void 0!==t.charge&&!isFinite(t.charge))throw new Error("force layout: 'charge' must be a number");if(void 0!==t.radiusRatio&&(!isFinite(t.radiusRatio)||t.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(void 0!==t.theta&&(!isFinite(t.theta)||t.theta<0||1<t.theta))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(void 0===t.cx&&void 0===t.cy||"number"==typeof t.cx&&"number"==typeof t.cy))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(void 0!==t.siblingsOffset&&!isFinite(t.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return i.modules.layouts.start("force",t)}),u.forceLink=((n=t).modules.layouts.register("forceLink",zE),function(t){return void 0===t&&(t={}),t.incremental?PE(t,n,n.layouts.forceLink):n.modules.layouts.start("forceLink",t)}),u.hierarchical=((o=t).modules.layouts.register("hierarchical",fS),function(t){return void 0===t&&(t={}),t.useWebWorker=!1,o.modules.layouts.start("hierarchical",t)}),u.sequential=((a=t).modules.layouts.register("sequential",fS),function(t){void 0===t&&(t={}),t.useWebWorker=!1;var e=I(I({},t),{evenDistribution:!0});return a.modules.layouts.start("sequential",e)}),u.grid=((s=t).modules.layouts.register("grid",gS),function(t){return void 0===t&&(t={}),s.modules.layouts.start("grid",t)}),u}var vS,mS=(b(yS,vS=Ly),yS);function yS(){var r=null!==vS&&vS.apply(this,arguments)||this;return r.move=function(t){return r._ogma.modules.virtualMouse.move(t)},r.down=function(t){return r._ogma.modules.virtualMouse.down(t)},r.up=function(t){return r._ogma.modules.virtualMouse.up(t)},r.click=function(t){return r._ogma.modules.virtualMouse.click(t)},r.rightClick=function(t){return r._ogma.modules.virtualMouse.rightClick(t)},r.doubleClick=function(t){return r._ogma.modules.virtualMouse.doubleClick(t)},r.drag=function(t,e){return r._ogma.modules.virtualMouse.drag(t,e)},r.wheel=function(t){return r._ogma.modules.virtualMouse.wheel(t)},r}var bS,xS=(b(ES,bS=Ly),ES);function ES(){var e=null!==bS&&bS.apply(this,arguments)||this;return e.map=function(t){return e._ogma.modules.rules.createMapping(t)},e.slices=function(t){return e._ogma.modules.rules.createSlices(t)},e.template=function(t){return e._ogma.modules.rules.createTemplate(t)},e}var AS=(SS.prototype.clearSelection=function(){return this.modules.selection.clear()},SS.prototype.getSelectedNodes=function(){return this.modules.selection.getSelectedNodes()},SS.prototype.getNonSelectedNodes=function(){return this.modules.selection.getNonSelectedNodes()},SS.prototype.getSelectedEdges=function(){return this.modules.selection.getSelectedEdges()},SS.prototype.getNonSelectedEdges=function(){return this.modules.selection.getNonSelectedEdges()},SS);function SS(){}var wS=(TS.prototype.setOptions=function(t){return this.modules.settings.update(t)},TS.prototype.getOptions=function(){return this.modules.settings.get()},TS);function TS(){}var CS,MS=(b(IS,CS=Ly),IS);function IS(){var n=null!==CS&&CS.apply(this,arguments)||this;return n.setNodesVisibility=function(value){return n._ogma.modules.graphics.setNodesVisibility(value)},n.setEdgesVisibility=function(value){return n._ogma.modules.graphics.setEdgesVisibility(value)},n.setNodeTextsVisibility=function(value){return n._ogma.modules.graphics.setNodeTextsVisibility(value)},n.setEdgeTextsVisibility=function(value){return n._ogma.modules.graphics.setEdgeTextsVisibility(value)},n.addRule=function(t){return void 0===t&&(t={}),n._ogma.modules.styleRules.addRule(t)},n.getRuleList=function(){return n._ogma.modules.styleRules.getRuleList()},n.addNodeRule=function(t,e){var r,i;return i=void 0===e?void(r=t):(r=e,t),n.addRule({nodeAttributes:r,nodeSelector:i})},n.addEdgeRule=function(t,e){var r,i;return i=void 0===e?void(r=t):(r=e,t),n.addRule({edgeAttributes:r,edgeSelector:i})},n.getNodeRules=function(){return n.getRuleList().filter(function(t){return void 0===t.getDefinition().edgeAttributes})},n.getEdgeRules=function(){return n.getRuleList().filter(function(t){return void 0===t.getDefinition().nodeAttributes})},n.createClass=function(t){return n._ogma.modules.classes.createClass(t)},n.getClass=function(t){return n._ogma.modules.classes.getClassByName(t)},n.getClassList=function(){return n._ogma.modules.classes.getClassList()},n.setHoveredNodeAttributes=function(t,e){n._ogma.modules.hover.updateNodeAttributes(t,e)},n.setHoveredEdgeAttributes=function(t,e){n._ogma.modules.hover.updateEdgeAttributes(t,e)},n.setSelectedNodeAttributes=function(t,e){return n._ogma.modules.selection.setNodeAttributes(t,!!e)},n.setSelectedEdgeAttributes=function(t,e){return n._ogma.modules.selection.setEdgeAttributes(t,!!e)},n}var LS=(NS.prototype.getNodesByClassName=function(t,e){return this.modules.classes.getClassByName(t,!0).getNodes()},NS.prototype.getEdgesByClassName=function(t,e){return this.modules.classes.getClassByName(t,!0).getEdges()},NS);function NS(){}var OS,kS=(b(RS,OS=Ly),RS);function RS(){var e=null!==OS&&OS.apply(this,arguments)||this;return e.watchNodeObjectProperty=function(t){return e._ogma.modules.watcher.watchNodeObjectProperty(t)},e.watchEdgeObjectProperty=function(t){return e._ogma.modules.watcher.watchEdgeObjectProperty(t)},e.watchNodeNonObjectProperty=function(t){return e._ogma.modules.watcher.watchNodeNonObjectProperty(t)},e.watchEdgeNonObjectProperty=function(t){return e._ogma.modules.watcher.watchEdgeNonObjectProperty(t)},e}var FS,DS=(b(PS,FS=Ly),PS);function PS(){var e=null!==FS&&FS.apply(this,arguments)||this;return e.enable=function(t){return e._ogma.modules.lasso.enable(t),e},e.disable=function(){return e._ogma.modules.lasso.disable(),e},e.enabled=function(){return e._ogma.modules.lasso.enabled()},e}var zS,BS=(b(US,zS=Ly),US);function US(){var e=null!==zS&&zS.apply(this,arguments)||this;return e.enable=function(t){return e._ogma.modules.connectNodes.enable(t),e},e.disable=function(){return e._ogma.modules.connectNodes.disable(),e},e.enabled=function(){return e._ogma.modules.connectNodes.enabled()},e}var VS,jS=(b(GS,VS=Ly),GS);function GS(){var e=null!==VS&&VS.apply(this,arguments)||this;return e.enable=function(t){return e._ogma.modules.legend.enable(t)},e.disable=function(){return e._ogma.modules.legend.disable()},e.enabled=function(){return e._ogma.modules.legend.enabled()},e.getOptions=function(){return e._ogma.modules.legend.getOptions()},e}var HS,qS=(b(WS,HS=Ly),WS);function WS(){var e=null!==HS&&HS.apply(this,arguments)||this;return e.enable=function(t){e._ogma.modules.rectangleSelect.enable(t)},e.disable=function(){e._ogma.modules.rectangleSelect.disable()},e.enabled=function(){return e._ogma.modules.rectangleSelect.enabled()},e}var XS,YS=(b(ZS,XS=Ly),ZS);function ZS(){var e=null!==XS&&XS.apply(this,arguments)||this;return e.enable=function(t){e._ogma.modules.resizing.enable(t)},e.disable=function(){e._ogma.modules.resizing.disable()},e.enabled=function(){return e._ogma.modules.resizing.enabled()},e}var KS,QS=(b(JS,KS=Ly),JS);function JS(){var e=null!==KS&&KS.apply(this,arguments)||this;return e.enable=function(t){e._ogma.modules.rewiring.enable(t)},e.disable=function(){e._ogma.modules.rewiring.disable()},e.enabled=function(){return e._ogma.modules.rewiring.enabled()},e}var $S,tw=(b(ew,$S=Ly),ew);function ew(){var e=null!==$S&&$S.apply(this,arguments)||this;return e.enable=function(t){e._ogma.modules.snapping.enable(t)},e.disable=function(){e._ogma.modules.snapping.disable()},e.enabled=function(){return e._ogma.modules.snapping.enabled()},e}var rw,iw=(b(nw,rw=Ly),nw);function nw(){var r=null!==rw&&rw.apply(this,arguments)||this;return r.onNodeHover=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("hover.node",t,e)},r.onNodeClick=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("click.left.node",t,e)},r.onNodeRightClick=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("click.right.node",t,e)},r.onNodeDoubleClick=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("doubleClick.left.node",t,e)},r.onEdgeHover=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("hover.edge",t,e)},r.onEdgeClick=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("click.left.edge",t,e)},r.onEdgeRightClick=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("click.right.edge",t,e)},r.onEdgeDoubleClick=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("doubleClick.left.edge",t,e)},r.onBackgroundClick=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("click.left.background",t,e)},r.onBackgroundRightClick=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("click.right.background",t,e)},r.onBackgroundDoubleClick=function(t,e){void 0===e&&(e={}),r._ogma.modules.tooltip.setHandler("doubleClick.left.background",t,e)},r.refresh=function(){return r._ogma.modules.tooltip.refresh()},r.isShown=function(){return r._ogma.modules.tooltip.isShown()},r.hide=function(){r._ogma.modules.tooltip.hide()},r.show=function(t,e){return r._ogma.modules.tooltip.show(t,e)},r}var ow,aw=(b(sw,ow=Ly),sw);function sw(){var r=null!==ow&&ow.apply(this,arguments)||this;return r.set=function(t,e){return r._ogma.modules.brand.set(t,e)},r.remove=function(){r._ogma.modules.brand.remove()},r}var uw,lw=(b(dw,uw=Ly),dw);function dw(t){var e=uw.call(this,t)||this;return e.lasso=new DS(t),e.connectNodes=new BS(t),e.legend=new jS(t),e.rectangleSelect=new qS(t),e.resize=new YS(t),e.rewire=new QS(t),e.snapping=new tw(t),e.tooltip=new iw(t),e.brand=new aw(t),e}function hw(t){return!0}function cw(t){return""}function fw(t,e,r){return{}}var gw,pw=(b(_w,gw=hy),_w.prototype._computeNodeGroupId=function(t){if(this._nodeSelector&&this._nodeGroupIdFunction)return this._nodeSelector(t)?this._nodeGroupIdFunction(t):void 0},_w.prototype._computeEdgeGroupId=function(t){if(this._edgeSelector&&this._edgeGroupIdFunction)return this._edgeSelector(t)?this._edgeGroupIdFunction(t):void 0},_w.prototype._addMetaNodes=function(){for(var r=this,t=this._id,o=this._ogma,e=o.getNodes().reduce(function(t,e){return e.getTransformation()===r?t.concat(e.getSubNodes()):t.concat(e.toList())},this._ogma.nodeList()),i=new Map,n=0;n<e.size;++n){var a=e.get(n);if(void 0!==(h=this._computeNodeGroupId(a))){var s=i.get(h);s||(s={id:h,nodes:[]},i.set(h,s)),s.nodes.push(a)}}var u=wo(i),l=u.map(function(t){var e=t.nodes;return o.getNodes(e)}),d=[];for(n=0;n<u.length;++n){var h=u[n].id,c=l[n],f=this._nodeGenerator(c,h,this);void 0===f.id&&(f.id=mw(h,t)),f.position=oh(c.getPosition()),d.push(f)}return o.addNodes(d.map(function(t){return{id:t.id,attributes:t.position}}),{virtual:!0}).then(function(){var r=o.getNodes(d.map(function(t){return t.id}));r.replaceOriginalAttributes(d.map(function(t){return t.attributes}),["x","y","radius"]);for(var t=r.getData(),e=0;e<t.length;e++){var i=t[e],n=d[e];t[e]=void 0===i?n.data:I(I({},n.data),i)}return r.setData(null,t),r.setVisible(!0),o.modules.grouping.setSubElements(r,l),l.forEach(function(t,e){o.modules.grouping.setMetaElement(t,r.get(e))}),r})},_w.prototype._addMetaEdges=function(){for(var t=this._id,o=this._ogma,e=o.getEdges(),r=new Map,i=o.modules.graphics.getAttributesManager().getUsedEdgeAttributes(),n=0;n<e.size;++n){var a=e.get(n);if(void 0!==(m=this._computeEdgeGroupId(a))){var s=this._edgeSource(a),u=this._edgeTarget(a),l=this._groupEdges?vw(m,s.getId(),u.getId(),this._separateEdgesByDirection):String(a.getId());(v=r.get(l))||(v={id:l,source:s,target:u,edges:[]},r.set(l,v)),v.edges.push(a)}}var d,h,c,f,g=wo(r),p=g.map(function(t){var e=t.edges;return o.getEdges(e)}),_=[];for(n=0;n<g.length;++n){var v,m=(v=g[n]).id,y=p[n],b=this._groupEdges?this._edgeGenerator(y,m,this):(c=i,f=void 0,{data:(f=y.get(0)).getData(),attributes:f.getAttributes(c)});if(null!=b.id&&(d=o,h=b.id,null!=d.getEdge(h)))throw Error("The id "+b.id+" returned by the edgeGenerator function is not a unique id.");void 0===b.id&&(b.id=mw(m,t)),b.source=v.source.getId(),b.target=v.target.getId(),_.push(b)}return o.addEdges(_.map(function(t){return{id:t.id,source:t.source,target:t.target}}),{virtual:!0}).then(function(){var r=o.getEdges(_.map(function(t){return t.id}));r.setAttributes(_.map(function(t){return t.attributes}));for(var t=r.getData(),e=0;e<t.length;e++){var i=_[e],n=t[e];t[e]=void 0===n?i.data:I(I({},n),i.data)}return r.setData(null,t),r.setVisible(!0),o.modules.grouping.setSubElements(r,p),p.forEach(function(t,e){o.modules.grouping.setMetaElement(t,r.get(e))}),r})},_w.prototype._removeMetaEdge=function(t){var i=this;t.forEach(function(e){var t=e.getSubEdges();if(t){var r=e.getMetaEdge()||null;i._ogma.modules.grouping.setMetaElement(t,r),r&&i._ogma.modules.grouping.setSubElements(r.toList(),[t.concat((r.getSubEdges()||i._ogma.edgeList()).filter(function(t){return t!==e}))]),t.filter(function(t){return t.getTarget().isVisible()&&t.getSource().isVisible()}).setVisible(!0)}})},_w.prototype._removeMetaNode=function(t){var r=this;t.forEach(function(t){var e=t.getSubNodes();e&&(r._ogma.modules.grouping.setMetaElement(e,null),e.setVisible(!0))})},_w);function _w(t){var e=gw.call(this,t)||this;return e._nodeSelector=t.nodeSelector||hw,e._nodeGroupIdFunction=t.nodeGroupIdFunction||cw,e._nodeGenerator=t.nodeGenerator||fw,e._edgeSelector=t.edgeSelector||hw,e._edgeGroupIdFunction=t.edgeGroupIdFunction||cw,e._edgeGenerator=t.edgeGenerator||fw,e._edgeSource=t.edgeSource,e._edgeTarget=t.edgeTarget,e._separateEdgesByDirection=t.separateEdgesByDirection,e._groupSelfLoopEdges=!!t.groupSelfLoopEdges,e._groupEdges=t.groupEdges,e}function vw(t,e,r,i){var n=e,o=r;return!i&&n.toString()>o.toString()&&(n=r,o=e),t+"["+n+"-"+o+"]"}function mw(t,e){return"gen_grp_"+e+"_"+t}var yw,bw=(b(xw,yw=pw),xw.prototype.getName=function(){return gy.NodeGrouping},Object.defineProperty(xw.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),xw.prototype.resetContext=function(){yw.prototype.resetContext.call(this),this._context=I(I({},this._context),{metaNodes:this._ogma.nodeList(),metaEdges:this._ogma.edgeList(),invalidMetaNodes:this._ogma.nodeList(),invalidMetaEdges:this._ogma.edgeList(),subNodes:this._ogma.nodeList(),subEdges:this._ogma.edgeList(),offsets:[],collapsedSubNodes:this._ogma.nodeList()})},xw.prototype.run=function(){var e,r,u=this,a=this._ogma,l=a.createNodeList(),d=a.createNodeList(),i=a.createEdgeList(),h=[],c=a.modules.grouping,s=[],f=new Set,g=new Set;return this._addMetaNodes().then(function(t){return(e=t).setVisible(!1),u._addMetaEdges()}).then(function(t){return(r=t).setVisible(!1),e.forEach(function(t){var e=t.getSubNodes(),r=t.getPosition(),i=u._showContents(t);if(e){if(i){f.add(t._index);var n=e.getAdjacentEdges({bothExtremities:!0});e.setVisible(!0),n.forEach(function(t){return g.add(t._index)})}else{f.delete(t._index),c.removeVisibleGroup(t),h.push.apply(h,e.getPosition().map(function(t){return t.x=t.x-r.x,t.y=t.y-r.y,t})),l=l.concat(e);for(var o=e.toArray();0!==o.length;){var a=o.pop(),s=a.getSubNodes();s&&c.isVisibleGroup(a)&&(s.setVisible(!1),s.getAdjacentEdges({bothExtremities:!0}).setVisible(!1),o.push.apply(o,s.toArray()))}}d=d.concat(e)}}),i=r.getSubEdges().reduce(function(t,e){var r=e.filter(function(t){if(g.has(t._index))return!1;var e=t.getSource().getMetaNode(),r=t.getTarget().getMetaNode();return!(e&&r&&c.isVisibleGroup(e)&&c.isVisibleGroup(r)&&e===r)});return t.concat(r)},a.createEdgeList()),l.setAttributes(l.getPosition().map(function(t,e){var r=h[e];return t.x-=r.x,t.y-=r.y,t}),u._duration)}).then(function(){l.setVisible(!1),i.setVisible(!1),e.setVisible(!0),r.filter(function(t){return u._groupSelfLoopEdges||t.getSource()!==t.getTarget()}).setVisible(!0)}).then(function(){var o=new Set;e.forEach(function(t){var value,e=f.has(t._index),r=t.getSubNodes();if(r){var i=r.getAdjacentEdges({filter:"all",bothExtremities:!0});if(e){var n=r.reduce(function(t,e){var r=c.getNodeDepth(e);return o.add(e._index),r<t?r:t},0);i.forEach(function(t){return g.add(t._index)}),c.addVisibleGroup(t,-1+n),u._metaNodesIds.has(t.getId())||(u._metaNodesIds.add(t.getId()),s.push(((value=u._onCreated(t,e,r,i))&&"function"===value.then?value:Promise.resolve(value)).then(a.view.afterNextFrame)))}}}),r.forEach(function(t){var e=Math.min(c.getNodeDepth(t.getSource()),c.getNodeDepth(t.getTarget()));t.setAttribute("layer",e)}),i=i.filter(function(t){return!g.has(t._index)}),l=l.filter(function(t){return!o.has(t._index)}),a.modules.graphics.getAttributesManager().update()}).then(function(){return Promise.all(s)}).then(function(){return{metaNodes:e,metaEdges:r,virtualNodes:e,virtualEdges:r,subNodes:d,collapsedSubNodes:l,subEdges:i,offsets:h,invalidMetaNodes:u._context.metaNodes.subtract(e),invalidMetaEdges:u._context.metaEdges.subtract(r)}})},xw.prototype.undo=function(){var t=this,e=this._context,r=e.metaNodes,i=e.metaEdges,n=e.subNodes,o=e.subEdges,a=e.offsets,s=e.collapsedSubNodes,u=this._ogma.getNodes(s.getMetaNode()).getPosition(),l=u.map(function(t,e){return r=t,i=a[e],{x:r.x+i.x,y:r.y+i.y};var r,i}),d=this._ogma.modules.grouping;return n.setVisible(!0),o.setVisible(!0),d.setMetaElement(n,null),d.setMetaElement(o,null),r.setVisible(!1),i.setVisible(!1),r.forEach(function(t){if(!t.getSubNodes()||d.isVisibleGroup(t))d.removeVisibleGroup(t);else for(var e=t.getSubNodes().filter(function(t){return d.isVisibleGroup(t)}).toArray();0!==e.length;){var r=e.pop();if(d.isVisibleGroup(r)){var i=r.getSubNodes();i&&(i.setVisible(!0),i.getAdjacentEdges({bothExtremities:!0,filter:"all"}).setVisible(!0),e.push.apply(e,i.toArray()))}}}),d.setSubElements(r,null),d.setSubElements(i,null),d.resetOffsets(),s.setAttributes(u).then(function(){return t._restorePositions?s.setAttributes(l,t._duration):Promise.resolve(s)})},xw.prototype.cleanup=function(){var t=this._ogma,e=this._context,r=e.metaNodes,i=e.metaEdges,n=e.invalidMetaNodes,o=e.invalidMetaEdges,a=t.modules.graph,s=zr(a,r,function(t){return t.isVisible()&&null!==t.getSubNodes()}),u=zr(a,i,function(t){return t.isVisible()&&null!==t.getSubEdges()});return this._removeMetaNode(n),this._removeMetaEdge(o),e.metaNodes=e.virtualNodes=s.valid,e.metaEdges=e.virtualEdges=u.valid,e.invalidMetaNodes=t.nodeList(),e.invalidMetaEdges=t.edgeList(),Promise.all([function(){return t.modules.grouping.resetOffsets()},t.removeEdges(u.invalid.concat(o),{virtual:!0}),t.removeNodes(s.invalid.concat(n),{virtual:!0})]).then(function(){return Promise.resolve()})},xw);function xw(t){var e=void 0===t?{}:t,r=e.duration,i=e.enabled,n=e.selector,o=void 0===n?hw:n,a=e.groupIdFunction,s=void 0===a?cw:a,u=e.nodeGenerator,l=void 0===u?fw:u,d=e.edgeGenerator,h=void 0===d?fw:d,c=e.separateEdgesByDirection,f=void 0!==c&&c,g=e.groupSelfLoopEdges,p=void 0!==g&&g,_=e.groupEdges,v=void 0===_||_,m=e.restorePositions,y=void 0===m||m,b=e.showContents,x=void 0!==b&&b,E=e.onCreated,A=yw.call(this,{nodeSelector:o,nodeGroupIdFunction:s,nodeGenerator:l,edgeSelector:function(t){return!(!t.getSource().getMetaNode()&&!t.getTarget().getMetaNode())},edgeGroupIdFunction:function(){return""},edgeGenerator:h,edgeSource:function(t){return Ew(t.getSource())},edgeTarget:function(t){return Ew(t.getTarget())},separateEdgesByDirection:f,groupEdges:v,groupSelfLoopEdges:p,duration:r,enabled:i})||this;return A._metaNodesIds=new Set,A._showContents="function"!=typeof x?function(){return x}:x,A._restorePositions=y,A._onCreated=E||function(t,e,r,i){},A}function Ew(t){return t.getMetaNode()||t}var Aw,Sw=(b(ww,Aw=pw),ww.prototype.getName=function(){return gy.EdgeGrouping},Object.defineProperty(ww.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),ww.prototype.resetContext=function(){Aw.prototype.resetContext.call(this),this._context=I(I({},this._context),{metaEdges:this._ogma.edgeList(),subEdges:this._ogma.edgeList(),invalidMetaEdges:this._ogma.edgeList()})},ww.prototype.run=function(){var e,r,i=this;return this._addMetaEdges().then(function(t){return(r=(e=t).getSubEdges().reduce(function(t,value){return t.concat(value)},i._ogma.createEdgeList())).setVisible(!1),{metaEdges:e,subEdges:r,virtualNodes:null,virtualEdges:e,invalidMetaEdges:i._context.metaEdges.subtract(e)}})},ww.prototype.undo=function(){var t=this._context,e=t.metaEdges,r=t.subEdges;return this._removeMetaEdge(e),e.setVisible(!1),r.filter(function(t){return t.getSource().isVisible()&&t.getTarget().isVisible()}).setVisible(!0),e.setVisible(!1),this._context.metaEdges=this._ogma.edgeList(),this._context.subEdges=this._ogma.edgeList(),Promise.resolve()},ww.prototype.cleanup=function(){var t=this,e=this._context,r=e.metaEdges,i=e.invalidMetaEdges,n=zr(this._ogma.modules.graph,r,function(t){return t.isVisible()});return this._ogma.removeEdges(n.invalid.concat(i),{virtual:!0}).then(function(){return t._context.metaEdges=n.valid,t._context.virtualEdges=n.valid,t._context.invalidMetaEdges=t._ogma.edgeList(),Promise.resolve()})},ww);function ww(t){var e=void 0===t?{}:t,r=e.selector,i=void 0===r?hw:r,n=e.duration,o=e.enabled,a=e.groupIdFunction,s=void 0===a?cw:a,u=e.generator,l=void 0===u?fw:u,d=e.separateEdgesByDirection,h=void 0!==d&&d;return Aw.call(this,{nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:i,edgeGroupIdFunction:s,edgeGenerator:l,edgeSource:function(t){return t.getSource()},edgeTarget:function(t){return t.getTarget()},separateEdgesByDirection:h,groupEdges:!0,duration:n,enabled:o})||this}function Tw(t){return null!=t}function Cw(t,e){return{source:t.getId(),target:e.getId()}}var Mw,Iw=(b(Lw,Mw=hy),Lw.prototype.getName=function(){return gy.NeighborGeneration},Lw.prototype.run=function(){for(var value,u=this,t=this._id,l=this._ogma,e=this._duration,r=l.getNodes(),i=new Map,n=0;n<r.size;++n){var o=r.get(n),a=(value=this._generateIds(o),((Array.isArray(value)?value:value?[value]:null)||[]).filter(Tw));if(a)for(var s=0;s<a.length;++s){var d=a[s];(_=i.get(d))||(_=[],i.set(d,_)),_.push(o)}}var h,c,f=new Array(i.size),g=So(i),p=wo(i).map(function(t){return l.getNodes(t)});for(n=0;n<f.length;++n){d=g[n];var _=p[n],v=this._nodeGenerator(d,_);v.id="_gen_"+t+"_"+d;var m=oh(_.getPosition());v.attributes=v.attributes||{},v.attributes.x=m.x,v.attributes.y=m.y,f[n]=v}return l.addNodes(f.map(function(t){return{id:t.id,attributes:t.attributes}}),{virtual:!0}).then(function(t){(h=t).replaceOriginalAttributes(f.map(function(t){return t.attributes}),["x","y"]),h.setData(null,f.map(function(t){return t.data}));for(var e=[],r=0;r<t.size;++r)for(var i=t.get(r),n=p[r],o=0;o<n.size;++o){var a=n.get(o),s=u._edgeGenerator(a,i);s.source||s.target||(s.source=a.getId(),s.target=i.getId()),e.push(s)}return l.addEdges(e,{virtual:!0})}).then(function(t){return c=t,h.setVisible(!0),c.setVisible(!0),h.addClass(pr),c.addClass(pr),Promise.all([h.removeClass(pr,e),c.removeClass(pr,e)])}).then(function(){return{virtualNodes:h,virtualEdges:c}})},Lw.prototype.undo=function(){var t=this._context,e=t.virtualNodes,r=t.virtualEdges;return r&&e?Promise.all([e.addClass(pr,this._duration),r.addClass(pr,this._duration)]).then(function(){e.setVisible(!1),r.setVisible(!1)}):Promise.resolve(this._context)},Lw.prototype.cleanup=function(){var t=this._context,e=t.virtualEdges,r=t.virtualNodes;if(e&&r){var i=r.filter(function(t){return!t.isVisible()}),n=e.filter(function(t){return!t.isVisible()});this._ogma.removeNodes(i,{virtual:!0}),this._ogma.removeEdges(n,{virtual:!0})}return Promise.resolve()},Lw);function Lw(t){var e=Mw.call(this,t)||this,r=t.selector,i=void 0===r?function(){return!0}:r,n=t.neighborIdFunction,o=void 0===n?function(){return null}:n,a=t.nodeGenerator,s=void 0===a?function(){return{}}:a,u=t.edgeGenerator,l=void 0===u?Cw:u;return e._generateIds=function(t){return i&&i(t)&&o(t)||null},e._nodeGenerator=s,e._edgeGenerator=l||Cw,e}var Nw,Ow=(b(kw,Nw=hy),kw.prototype.run=function(){for(var t=this._duration,e=this._ogma,r=e.getNodes().filter(this._selector?this._selector:function(t){return!0}),i=[],n=new Map,o=0;o<r.size;++o)for(var a=r.get(o),s=a.getAdjacentEdges(),u=this._dataFunction(a),l=0;l<s.size;++l){var d=s.get(l),h=d.getSource(),c=d.getTarget();if(h!==c&&void 0!==u){var f=h===a?c:h,g=n.get(f);g||(g=[],n.set(f,g)),g.push(u)}i.push(d)}var p=e.getEdges(i),_=e.getNodes(So(n)),v=wo(n),m=_.getData(),y=new Array(_.size);for(o=0;o<y.length;++o){var b=v[o],x=m[o];for(l=0;l<b.length;++l)x=$(x,b[l]);y[o]=x}return Promise.all([r.addClass(pr,t),p.addClass(pr,t)]).then(function(){return r.setVisible(!1),p.setVisible(!1),_.setData(y),{hiddenNodes:r,hiddenEdges:p,nodesWithDataChange:_,oldDataList:m,virtualNodes:new yi(new Uint32Array,e),virtualEdges:new $r(new Uint32Array,e)}})},kw.prototype.getName=function(){return gy.NeighborMerging},Object.defineProperty(kw.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),kw.prototype.resetContext=function(){Nw.prototype.resetContext.call(this),this._context=I(I({},this._context),{hiddenNodes:this._ogma.nodeList(),hiddenEdges:this._ogma.edgeList(),nodesWithDataChange:this._ogma.nodeList(),oldDataList:[]})},kw.prototype.undo=function(){var t=this._context,e=t.hiddenNodes,r=t.hiddenEdges,i=t.nodesWithDataChange,n=t.oldDataList;return e.setVisible(!0),r.setVisible(!0),e.addClass(pr),r.addClass(pr),Promise.all([e.removeClass(pr,this._duration),r.removeClass(pr,this._duration)]).then(function(){i.setData(n)})},kw.prototype.cleanup=function(){return Promise.resolve()},kw);function kw(t){var e=Nw.call(this,t)||this;return e._selector=t.selector||function(){return!1},e._dataFunction=t.dataFunction||function(){},e}function Rw(t,e){return t.size===e.size&&0<t.filter(function(t){return e.includes(t)}).size}var Fw,Dw=(b(Pw,Fw=hy),Pw.prototype.getName=function(){return gy.NodeCollapsing},Object.defineProperty(Pw.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Pw.prototype.resetContext=function(){Fw.prototype.resetContext.call(this),this._context=I(I({},this._context),{hiddenNodes:this._ogma.nodeList(),hiddenEdges:this._ogma.edgeList()})},Pw.prototype.run=function(){for(var e=this,t=this._ogma,r=this._duration,i=t.getNodes().filter(this._selector),n=i.getAdjacentEdges(),o=[],a=i.map(function(t){return t.getAdjacentNodes().filter(function(t){return!e._selector(t)})}),s=0;s<i.size;s++)for(var u=s;u<i.size;u++){var l=i.get(s),d=i.get(u);if(0<t.modules.graph.getEdgesBetweenTwoNodes(l,d).size&&(a[s].size||a[u].size)&&!Rw(a[s],a[u]))throw Error("addNodeCollapsing: invalid connected nodes ["+l.getId()+"] and ["+d.getId()+"] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.")}for(s=0;s<i.size;++s){var h=i.get(s),c=a[s];for(u=0;u<c.size-1;++u){var f=c.get(u),g=t.modules.graph.getEdgesBetweenTwoNodes(h,f);if(f!==h)for(var p=u+1;p<c.size;++p){var _=c.get(p),v=t.modules.graph.getEdgesBetweenTwoNodes(h,_),m=this._edgeGenerator(h,f,_,g,v);if(m)for(var y=L(m),b=0;b<y.length;++b)o.push(zw(t,y[b],b,h,f,_,g,v))}}}return t.addEdges(o,{virtual:!0}).then(function(t){return t.addClass(pr)}).then(function(t){return Promise.all([t.removeClass(pr,r),i.addClass(pr,r),n.addClass(pr,r)])}).then(function(t){var e=t[0];return i.setVisible(!1),n.setVisible(!1),{virtualEdges:e,virtualNodes:null,hiddenNodes:i,hiddenEdges:n}})},Pw.prototype.undo=function(){var t=this._context,e=t.hiddenNodes,r=t.hiddenEdges,i=this._ogma,n=this._duration,o=this._context.virtualEdges||i.createEdgeList();return e.setVisible(!0),r.setVisible(!0),Promise.all([e.addClass(pr),r.addClass(pr)]).then(function(){return Promise.all([e.removeClass(pr,n),r.removeClass(pr,n),o.addClass(pr,n)])}).then(function(){o.setVisible(!1)})},Pw.prototype.cleanup=function(){var t=this._context.virtualEdges||this._ogma.createEdgeList();return this._ogma.removeEdges(t.filter(function(t){return!t.isVisible()}),{virtual:!0})},Pw);function Pw(t){var e=Fw.call(this,t)||this;return e._selector=t.selector||function(t){return!1},e._edgeGenerator=t.edgeGenerator||function(){return{}},e}function zw(t,e,r,i,n,o,a,s){var u=void 0,l=void 0;if(void 0!==e.source&&(u=t.getNode(e.source))!==n&&u!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid source ["+e.source+"]","expected to be ["+n.getId()+"] or ["+o.getId()+"]"].join("; "));if(void 0!==e.target&&(l=t.getNode(e.target))!==n&&l!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid target ["+e.target+"]","expected to be ["+n.getId()+"] or ["+o.getId()+"]"].join("; "));if(u&&l&&u===l)throw new Error("addNodeCollapsing: edge generator produced RawEdge with same source and target ["+u.getId()+"]");if(u&&!l)l=u===n?o:n;else if(l&&!u)u=l===n?o:n;else if(!u&&!l){for(var d=!0,h=0;h<a.size;++h){a.get(h).getSource()===n&&(d=!1)}for(h=0;h<s.size;++h){s.get(h).getTarget()===o&&(d=!1)}l=d?(u=o,n):(u=n,o)}return u&&l?I(I({},e),{id:"_gen_"+i.getId()+"_"+u.getId()+"_"+l.getId()+"_"+r,source:u.getId(),target:l.getId()}):{}}var Bw,Uw=(b(Vw,Bw=hy),Vw.prototype.getName=function(){return gy.VirtualProperties},Object.defineProperty(Vw.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Vw.prototype.resetContext=function(){Bw.prototype.resetContext.call(this),this._context=I(I({},this._context),{nodes:this._ogma.nodeList(),oldNodesData:[],edges:this._ogma.edgeList(),oldEdgesData:[]})},Vw.prototype.run=function(){var t=this._ogma,e={nodes:null,edges:null,oldNodesData:null,oldEdgesData:null,virtualEdges:null,virtualNodes:null};return this._nodeDataFunction&&(e.nodes=t.getNodes().filter(this._nodeSelector),e.oldNodesData=jw(e.nodes,this._nodeDataFunction)),this._edgeDataFunction&&(e.edges=t.getEdges().filter(this._edgeSelector),e.oldEdgesData=jw(e.edges,this._edgeDataFunction)),Promise.resolve(e)},Vw.prototype.undo=function(){var t=this._context,e=t.nodes,r=t.oldNodesData,i=t.edges,n=t.oldEdgesData;return e&&e.setData(r),i&&i.setData(n),Promise.resolve()},Vw.prototype.cleanup=function(){return Promise.resolve()},Vw);function Vw(t){var e=Bw.call(this,t)||this;return e._nodeSelector=t.nodeSelector||function(t){return!0},e._edgeSelector=t.edgeSelector||function(t){return!0},e._nodeDataFunction=t.nodeDataFunction||null,e._edgeDataFunction=t.edgeDataFunction||null,e}function jw(t,e){for(var r=[],i=0;i<t.size;++i){var n=t.get(i),o=n.getData(),a=$(o,e(n));r.push(o),n.setData(a)}return r}var Gw,Hw=(b(qw,Gw=Ly),qw);function qw(t){var e=Gw.call(this,t)||this;e.getList=function(){return e._ogma.modules.transformations.getList()},e.clear=function(){return e._ogma.modules.transformations.clear()},e.afterNextUpdate=function(){return e._ogma.modules.transformations.whenApplied()};var r,i=(r=t,{addNodeGrouping:function(t){return void 0===t&&(t={}),r.modules.transformations.add(new bw(t))},addEdgeGrouping:function(t){return void 0===t&&(t={}),r.modules.transformations.add(new Sw(t))}}),n=i.addNodeGrouping,o=i.addEdgeGrouping;e.addNodeGrouping=n,e.addEdgeGrouping=o;var a,s=(a=t,{addNodeFilter:function(t){return a.modules.filters.addNodeFilter(t)},addEdgeFilter:function(t){return a.modules.filters.addEdgeFilter(t)},getNodeFilters:function(){return a.modules.transformations.getList().filter(function(t){return t.getName()===gy.NodeFilter})},getEdgeFilters:function(){return a.modules.transformations.getList().filter(function(t){return t.getName()===gy.EdgeFilter})}}),u=s.addNodeFilter,l=s.addEdgeFilter,d=s.getNodeFilters,h=s.getEdgeFilters;e.addNodeFilter=u,e.addEdgeFilter=l,e.getNodeFilters=d,e.getEdgeFilters=h;var c,f=(c=t,{addNeighborGeneration:function(t){return c.modules.transformations.add(new Iw(t))},addNeighborMerging:function(t){return c.modules.transformations.add(new Ow(t))}}),g=f.addNeighborGeneration,p=f.addNeighborMerging;e.addNeighborGeneration=g,e.addNeighborMerging=p;var _,v=(_=t,function(t){return void 0===t&&(t={}),_.modules.transformations.add(new Dw(t))});e.addNodeCollapsing=v;var m,y=(m=t,function(t){return m.modules.transformations.add(new Uw(t))});return e.addVirtualProperties=y,e}var Ww,Xw=(b(Yw,Ww=Ly),Yw);function Yw(){var d=null!==Ww&&Ww.apply(this,arguments)||this;return d.setZoom=function(t,e){return d._ogma.modules.camera.setZoom(t,e)},d.zoomIn=function(t,e){return d._ogma.geo.enabled()?d._ogma.modules.geo.zoomIn():d._ogma.modules.camera.zoomIn(t,e)},d.zoomOut=function(t,e){return d._ogma.geo.enabled()?d._ogma.modules.geo.zoomOut():d._ogma.modules.camera.zoomOut(t,e)},d.getZoom=function(){return d._ogma.modules.camera.getZoom()},d.setCenter=function(t,e){return d._ogma.modules.camera.setCenter(t,e)},d.move=function(t,e){return d._ogma.modules.camera.move(t,e)},d.moveToBounds=function(t,e){if(!(t&&t instanceof aa)){if(!M(t)||4!==t.length)throw new Error("ogma.view.zoomToBounds requires a BoundingBox as a parameter");var r=t[0],i=t[1],n=t[2],o=t[3];t=aa.from({minX:r,minY:i,maxX:n,maxY:o})}return d._ogma.modules.camera.moveToBounds(t,e)},d.moveTo=function(t,e){return d._ogma.modules.camera.moveTo(t,e)},d.getCenter=function(){return d._ogma.modules.camera.getCenter()},d.setAngle=function(t,e){return d._ogma.modules.camera.setAngle(t,e)},d.rotate=function(t,e){return d._ogma.modules.camera.rotate(t,e)},d.getAngle=function(){return d._ogma.modules.camera.getAngle()},d.set=function(t,e){return d._ogma.modules.camera.setView(t,e)},d.get=function(){return d._ogma.modules.camera.getView()},d.graphToScreenCoordinates=function(t){return d._ogma.modules.camera.graphToScreenCoordinates(t)},d.screenToGraphCoordinates=function(t){return d._ogma.modules.camera.screenToGraphCoordinates(t)},d.getImageData=function(){return d._ogma.modules.graphics.getImageData()},d.getElementAt=function(t){return d._ogma.modules.captor.getElementAt(t)},d.getElementsInside=function(t,e,r,i,n){void 0===n&&(n=!0);var o=d._ogma.modules,a=o.spatial,s=o.camera;if(n){var u=s.graphToScreenCoordinates({x:t,y:e}),l=s.graphToScreenCoordinates({x:r,y:i});return a.queryProjected(u.x,u.y,l.x,l.y)}return a.queryProjected(t,e,r,i)},d.beforeNextFrame=function(){return d._ogma.modules.dom.beforeNextFrame()},d.afterNextFrame=function(){return d._ogma.modules.dom.afterNextFrame()},d.setFullScreen=function(value){return d._ogma.modules.dom.setFullScreen(value)},d.isFullScreen=function(){return d._ogma.modules.dom.isFullScreen()},d.forceResize=function(){return d._ogma.modules.dom.forceResize()},d.getSize=function(){return d._ogma.modules.dom.getDimensions()},d.setSize=function(t){if(!t||isNaN(t.width)||isNaN(t.height))throw new Error("Size must follow the format { width: number, height: number }");if(t.width<0)throw new Error("width must be positive");if(t.height<0)throw new Error("height must be positive");return d._ogma.modules.dom.setDimensions(t),Promise.resolve()},d.locateGraph=function(t){return d._ogma.modules.locate.locateGraph(t)},d.locateRawGraph=function(t,e){return d._ogma.modules.locate.locateRawGraph(t,e)},d.getGraphBoundingBox=function(){return d._ogma.modules.locate.getGraphBoundingBox()},d}var Zw=Object.freeze({__proto__:null,circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,circleContainsPoint:yd,circleContainsCircle:bd,circleIntersectsBox:xd,circleLineIntersection:Ed,isPointInLine:du,twoSegmentsIntersect:function(t,e,r,i,n){if(void 0===n&&(n=!1),n&&(hu(t,r)||hu(t,i)||hu(e,r)||hu(e,i)))return!1;var o=(t.y-r.y)*(i.x-r.x)-(t.x-r.x)*(i.y-r.y),a=(e.x-t.x)*(i.y-r.y)-(e.y-t.y)*(i.x-r.x);if(0==a)return!1;var s=o/a,u=(o=(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y))/a;return!(s<=0||1<=s||u<=0||1<=u)},lineAngle:cu,angle:function(t,e,r){var i=cu(t.x,t.y,e.x,e.y)-cu(r.x,r.y,e.x,e.y);return i<0?i+2*Math.PI:i},lineIntersection:function(t,e,r,i,n,o,a,s){var u=(s-o)*(r-t)-(a-n)*(i-e);if(0==u)return null;var l=e-o;return{x:t+(l=((a-n)*l-(s-o)*(t-n))/u)*(r-t),y:e+l*(i-e)}},segmentIntersection:fu,segmentRectangleIntersection:gu,lineLine:pu,lineAABB:_u,distancePointSegment:vu,distToSegmentSquared:mu,getClosestPointOnSegment:yu,getClosestPointOnLine:function(t,e,r,i,n,o){var a=n-r,s=o-i,u=((t-r)*a+(e-i)*s)/(a*a+s*s);return{x:r+a*u,y:i+s*u}},defaultAABB:ws,rotate:Ts,move:function(t,e,r,i){return void 0===r&&(r=0),void 0===i&&(i={x:0,y:0}),i.x=t.x+r*Math.sin(e),i.y=t.y+r*Math.cos(e),i},distance:distance,squaredDistance:Cs,radiansToDegrees:Ms,degreesToRadians:function(t){return t*Math.PI/180},extendBounds:Is,isPointInPolygon:eh,polygonsIntersect:nh,computeCentroid:oh,quadBezierAABB:Su,cubicBezierAABB:Tu,getSelfLoopControlPoints:vs,getQuadraticCurveControlPoint:_s,getPointOnQuadraticCurve:Cu,isPointOnQuadraticCurve:Mu,getPointOnBezierCurve:Iu,isPointOnBezierCurve:Lu,getQuadraticCurveBoundingBox:Nu,getBezierCurveBoundingBox:Ou,getAABB:$_,getOBBPoints:tv,moveAABB:ev,padBounds:function(t,e){return Is(t,e)},overlapsAABB:function(t,e){return rv(t[0],t[1],t[2],t[3],e[0],e[1],e[2],e[3])},intersects:function(t,e,r,i,n,o,a,s){return n<t&&t<a&&o<e&&e<s||n<r&&r<a&&o<i&&i<s},overlaps:rv}),Kw=1,Ogma=function(){function Ogma(t){var e=this;void 0===t&&(t={}),this.node=function(t){return new vi(t,e)},this.edge=function(t){return new Qr(t,e)},this.nodeList=function(t){return new yi(t||new Uint32Array(0),e)},this.edgeList=function(t){return new $r(t||new Uint32Array(0),e)},this._onReady=[],this._init(t)}return Ogma.prototype._init=function(t){var e=this;this._initParameters=t,this._debug=!!t.debug,this._token=Kw++,this.modules=new My(this,t),this.styles=new MS(this),this.algorithms=new Oy(this),this.export=new nx(this),this.keyboard=new TE(this),this.generate=new Ex(this),this.layouts=new pS(this),this.parse=new xE(this),this.transformations=new Hw(this),this.tools=new lw(this),this.view=new Xw(this),this.mouse=new mS(this),this.events=new jy(this),this.schema=new kS(this),this.rules=new xS(this),this.geo=new wx(this),this.debug=new Py(this),this._onReady.forEach(function(t){return t(e)}),this.safelyBindToInstance()},Ogma.prototype.safelyBindToInstance=function(){for(var t=0,e=Object.keys(Ogma.prototype);t<e.length;t++){var r=e[t];"function"==typeof Ogma.prototype[r]&&(this[r]=this[r].bind(this))}},Ogma.prototype.onReady=function(t){this._onReady.push(t)},Ogma.prototype._destroy=function(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null},Ogma.prototype.destroy=function(){this._destroy()},Ogma.prototype.reset=function(){var t=this._initParameters;this._destroy(),this._init(t)},Ogma.prototype.isDebug=function(){return this._debug},Ogma.libraries=E,Ogma.build={version:"3.2.0",commit:"36b8bd9",date:"Mon Nov 02 2020 19:31:51 GMT+0100 (Central European Standard Time)"},Ogma.geometry=Zw,Ogma.algorithms=xp,Ogma.utils=da,Ogma}(),Qw=[LS,Ry,By,Mx,Lx,AE,AS,wS];return Object.assign.apply(Object,x([Ogma.prototype],Qw.map(function(t){return t.prototype}))),Ogma});
//# sourceMappingURL=ogma.min.js.map
